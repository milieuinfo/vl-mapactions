parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"c3Uk":[function(require,module,exports) {
function t(i){var r="function"==typeof Map?new Map:void 0;return(t=function(t){if(null===t||!n(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(t))return r.get(t);r.set(t,i)}function i(){return e(t,arguments,c(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),o(i,t)})(i)}function e(t,n,i){return(e=h()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&o(r,n.prototype),r}).apply(null,arguments)}function n(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function i(t,e,n){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=r(t,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(n):s.value}})(t,e,n||t)}function r(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function a(t){var e=h();return function(){var n,i=c(t);if(e){var r=c(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return u(this,n)}}function u(t,e){return!e||"object"!==v(e)&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function g(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function v(t){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==v(t)&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=11)}([function(t,e,n){t.exports=function(){"use strict";function t(t,i,r,s,o){!function t(n,i,r,s,o){for(;s>r;){if(s-r>600){var a=s-r+1,u=i-r+1,l=Math.log(a),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(a-h)/a)*(u-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-u*h/a+c)),Math.min(s,Math.floor(i+(a-u)*h/a+c)),o)}var f=n[i],d=r,g=s;for(e(n,r,i),o(n[s],f)>0&&e(n,r,s);d<g;){for(e(n,d,g),d++,g--;o(n[d],f)<0;)d++;for(;o(n[g],f)>0;)g--}0===o(n[r],f)?e(n,r,g):e(n,++g,s),g<=i&&(r=g+1),i<=g&&(s=g-1)}}(t,i,r||0,s||t.length-1,o||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function s(t,e){o(t,0,t.children.length,e,t)}function o(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var s=e;s<n;s++){var o=t.children[s];a(r,t.leaf?i(o):o)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function l(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,n,i,r,s){for(var o=[n,i];o.length;)if(!((i=o.pop())-(n=o.pop())<=r)){var a=n+Math.ceil((i-n)/r/2)*r;t(e,a,n,i,s),o.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var s=0;s<e.children.length;s++){var o=e.children[s],a=e.leaf?i(o):o;d(t,a)&&(e.leaf?n.push(o):f(t,a)?this._all(o,n):r.push(o))}e=r.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],s=e.leaf?this.toBBox(r):r;if(d(t,s)){if(e.leaf||f(t,s))return!0;n.push(r)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=g([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,s,o=this.data,a=this.toBBox(t),u=[],l=[];o||u.length;){if(o||(o=u.pop(),i=u[u.length-1],n=l.pop(),s=!0),o.leaf){var h=r(t,o.children,e);if(-1!==h)return o.children.splice(h,1),u.push(o),this._condense(u),this}s||o.leaf||!f(o,a)?i?(n++,o=i.children[n],s=!1):o=null:(u.push(o),l.push(n),n=0,i=o,o=o.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=g([])).leaf=!1,r.height=i;var u=Math.ceil(o/a),l=u*Math.ceil(Math.sqrt(a));v(t,e,n,l,this.compareMinX);for(var h=e;h<=n;h+=l){var c=Math.min(h+l-1,n);v(t,h,c,u,this.compareMinY);for(var f=h;f<=c;f+=u){var d=Math.min(f+u-1,c);r.children.push(this._build(t,f,d,i-1))}}return s(r,this.toBBox),r},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,s=1/0,o=void 0,a=0;a<e.children.length;a++){var u=e.children[a],l=h(u),c=(f=t,d=u,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-l);c<s?(s=c,r=l<r?l:r,o=u):c===s&&l<r&&(r=l,o=u)}e=o||e.children[0]}var f,d;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],s=this._chooseSubtree(i,this.data,e,r);for(s.children.push(t),a(s,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,r,s,a,u,l,c,f=1/0,d=1/0,g=e;g<=n-e;g++){var v=o(t,0,g,this.toBBox),_=o(t,g,n,this.toBBox),y=(r=v,s=_,void 0,void 0,void 0,void 0,a=Math.max(r.minX,s.minX),u=Math.max(r.minY,s.minY),l=Math.min(r.maxX,s.maxX),c=Math.min(r.maxY,s.maxY),Math.max(0,l-a)*Math.max(0,c-u)),p=h(v)+h(_);y<f?(f=y,i=g,d=p<d?p:d):y===f&&p<d&&(d=p,i=g)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:l;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,s=o(t,0,e,r),u=o(t,n-e,n,r),l=c(s)+c(u),h=e;h<n-e;h++){var f=t.children[h];a(s,t.leaf?r(f):f),l+=c(s)}for(var d=n-e-1;d>=e;d--){var g=t.children[d];a(u,t.leaf?r(g):g),l+=c(u)}return l},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():s(t[e],this.toBBox)},i}()},function(t,e,n){!function(t){"use strict";var e=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"equalsWithTolerance",value:function(t,e,n){return Math.abs(t-e)<=n}}]),t}();function n(t){this.message=t}function r(t,e){this.low=0|e,this.high=0|t}function o(){}function h(){}function d(){}function v(){}function _(){}function y(t){this.name="RuntimeException",this.message=t,this.stack=(new Error).stack,Error.call(this,t)}e.constructor_=function(){},r.toBinaryString=function(t){var e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n},o.isNaN=function(t){return Number.isNaN(t)},o.isInfinite=function(t){return!Number.isFinite(t)},o.MAX_VALUE=Number.MAX_VALUE,"function"==typeof Float64Array&&"function"==typeof Int32Array?function(){var t=new Float64Array(1),e=new Int32Array(t.buffer);o.doubleToLongBits=function(n){t[0]=n;var i=0|e[0],s=0|e[1];return 2146435072==(2146435072&s)&&0!=(1048575&s)&&0!==i&&(i=0,s=2146959360),new r(s,i)},o.longBitsToDouble=function(n){return e[0]=n.low,e[1]=n.high,t[0]}}():function(){var t=Math.log2,e=Math.floor,n=Math.pow,i=function(){for(var i=53;i>0;i--){var r=n(2,i)-1;if(e(t(r))+1===i)return r}return 0}();o.doubleToLongBits=function(s){var o,a,u,l,h,c,f,d,g;if(s<0||1/s===Number.NEGATIVE_INFINITY?(c=1<<31,s=-s):c=0,0===s)return new r(d=c,g=0);if(s===1/0)return new r(d=2146435072|c,g=0);if(s!=s)return new r(d=2146959360,g=0);if(l=0,g=0,(o=e(s))>1)if(o<=i)(l=e(t(o)))<=20?(g=0,d=o<<20-l&1048575):(g=o%(a=n(2,u=l-20))<<32-u,d=o/a&1048575);else for(u=o,g=0;0!==(u=e(a=u/2));)l++,g>>>=1,g|=(1&d)<<31,d>>>=1,a!==u&&(d|=524288);if(f=l+1023,h=0===o,o=s-o,l<52&&0!==o)for(u=0;;){if((a=2*o)>=1?(o=a-1,h?(f--,h=!1):(u<<=1,u|=1,l++)):(o=a,h?0==--f&&(l++,h=!1):(u<<=1,l++)),20===l)d|=u,u=0;else if(52===l){g|=u;break}if(1===a){l<20?d|=u<<20-l:l<52&&(g|=u<<52-l);break}}return d|=f<<20,new r(d|=c,g)},o.longBitsToDouble=function(t){var e,i,r,s,o,a=t.high,u=t.low;for(r=a&1<<31?-1:1,s=((2146435072&a)>>20)-1023,o=0,i=1<<19,e=1;e<=20;e++)a&i&&(o+=n(2,-e)),i>>>=1;for(i=1<<31,e=21;e<=52;e++)u&i&&(o+=n(2,-e)),i>>>=1;if(-1023===s){if(0===o)return 0*r;s=-1022}else{if(1024===s)return 0===o?r/0:NaN;o+=1}return r*o*n(2,s)}}(),y.prototype=Object.create(Error.prototype),y.prototype.constructor=Error;var p=function(t){s(n,y);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();p.constructor_=function(){if(0===arguments.length)y.constructor_.call(this);else if(1===arguments.length){var t=arguments[0];y.constructor_.call(this,t)}};var m=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"shouldNeverReachHere",value:function(){if(0===arguments.length)t.shouldNeverReachHere(null);else if(1===arguments.length){var e=arguments[0];throw new p("Should never reach here"+(null!==e?": "+e:""))}}},{key:"isTrue",value:function(){if(1===arguments.length){var e=arguments[0];t.isTrue(e,null)}else if(2===arguments.length){var n=arguments[1];if(!arguments[0])throw null===n?new p:new p(n)}}},{key:"equals",value:function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];t.equals(e,n,null)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];if(!r.equals(i))throw new p("Expected "+i+" but encountered "+r+(null!==s?": "+s:""))}}}]),t}();m.constructor_=function(){};var k=function(){function i(){f(this,i),i.constructor_.apply(this,arguments)}return g(i,[{key:"setOrdinate",value:function(t,e){switch(t){case i.X:this.x=e;break;case i.Y:this.y=e;break;case i.Z:this.z=e;break;default:throw new n("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var n=arguments[0],i=arguments[1];return!!e.equalsWithTolerance(this.x,n.x,i)&&!!e.equalsWithTolerance(this.y,n.y,i)}}},{key:"getOrdinate",value:function(t){switch(t){case i.X:return this.x;case i.Y:return this.y;case i.Z:return this.z}throw new n("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||o.isNaN(this.z)&&o.isNaN(t.z))}},{key:"equals",value:function(t){return t instanceof i&&this.equals2D(t)}},{key:"equalInZ",value:function(t,n){return e.equalsWithTolerance(this.z,t.z,n)}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return m.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new i(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.z+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*t+i.hashCode(this.x))+i.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.z}},{key:"getClass",value:function(){return i}},{key:"interfaces_",get:function(){return[h,d,_]}}],[{key:"hashCode",value:function(){if(1===arguments.length&&"number"==typeof arguments[0]){var t=arguments[0],e=o.doubleToLongBits(t);return Math.trunc(e^e>>>32)}}}]),i}(),x=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(e,n){var i=e,r=n,s=t.compare(i.x,r.x);if(0!==s)return s;var o=t.compare(i.y,r.y);return 0!==o?o:this._dimensionsToTest<=2?0:t.compare(i.z,r.z)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:o.isNaN(t)?o.isNaN(e)?0:-1:o.isNaN(e)?1:0}}]),t}();function E(t,e){return t.interfaces_&&t.interfaces_.indexOf(e)>-1}function C(){}function I(t){this.message=t||""}function S(){}function w(t){this.message=t||""}function N(){this.array_=[],arguments[0]instanceof C&&this.addAll(arguments[0])}x.constructor_=function(){if(this._dimensionsToTest=2,0===arguments.length)x.constructor_.call(this,2);else if(1===arguments.length){var t=arguments[0];if(2!==t&&3!==t)throw new n("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}},k.DimensionalComparator=x,k.constructor_=function(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)k.constructor_.call(this,0,0);else if(1===arguments.length){var t=arguments[0];k.constructor_.call(this,t.x,t.y,t.z)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];k.constructor_.call(this,e,n,k.NULL_ORDINATE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this.x=i,this.y=r,this.z=s}},k.serialVersionUID=0x5cbf2c235c7e5800,k.NULL_ORDINATE=o.NaN,k.X=0,k.Y=1,k.Z=2,C.prototype.add=function(){},C.prototype.addAll=function(){},C.prototype.isEmpty=function(){},C.prototype.iterator=function(){},C.prototype.size=function(){},C.prototype.toArray=function(){},C.prototype.remove=function(){},I.prototype=new Error,I.prototype.name="IndexOutOfBoundsException",S.prototype=Object.create(C.prototype),S.prototype.constructor=S,S.prototype.get=function(){},S.prototype.set=function(){},S.prototype.isEmpty=function(){},w.prototype=new Error,w.prototype.name="NoSuchElementException",N.prototype=Object.create(S.prototype),N.prototype.constructor=N,N.prototype.ensureCapacity=function(){},N.prototype.interfaces_=[S,C],N.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],0,arguments[1]),!0},N.prototype.clear=function(){this.array_=[]},N.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},N.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},N.prototype.iterator=function(){return new L(this)},N.prototype.get=function(t){if(t<0||t>=this.size())throw new I;return this.array_[t]},N.prototype.isEmpty=function(){return 0===this.array_.length},N.prototype.size=function(){return this.array_.length},N.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},N.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},N.prototype.removeAll=function(t){for(var e=t.iterator();e.hasNext();)this.remove(e.next());return!0};var L=function(t){this.arrayList_=t,this.position_=0};L.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new w;return this.arrayList_.get(this.position_++)},L.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},L.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},L.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))};var R=function(t){s(n,N);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getCoordinate",value:function(t){return this.get(t)}},{key:"addAll",value:function(){if(2===arguments.length&&"boolean"==typeof arguments[1]&&E(arguments[0],C)){for(var t=arguments[1],e=!1,r=arguments[0].iterator();r.hasNext();)this.add(r.next(),t),e=!0;return e}return i(c(n.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var t=i(c(n.prototype),"clone",this).call(this),e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}},{key:"toCoordinateArray",value:function(){return this.toArray(n.coordArrayType)}},{key:"add",value:function(){if(1===arguments.length){var t=arguments[0];i(c(n.prototype),"add",this).call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],r=arguments[1];return this.add(e,r,!0),!0}if(arguments[0]instanceof k&&"boolean"==typeof arguments[1]){var s=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(s))return null;i(c(n.prototype),"add",this).call(this,s)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],a=arguments[1];return this.add(o,a),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var u=arguments[0],l=arguments[1];if(arguments[2])for(var h=0;h<u.length;h++)this.add(u[h],l);else for(var f=u.length-1;f>=0;f--)this.add(u[f],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof k){var d=arguments[0],g=arguments[1];if(!arguments[2]){var v=this.size();if(v>0){if(d>0&&this.get(d-1).equals2D(g))return null;if(d<v&&this.get(d).equals2D(g))return null}}i(c(n.prototype),"add",this).call(this,d,g)}}else if(4===arguments.length){var _=arguments[0],y=arguments[1],p=arguments[2],m=arguments[3],x=1;p>m&&(x=-1);for(var E=p;E!==m;E+=x)this.add(_[E],y);return!0}}},{key:"closeRing",value:function(){this.size()>0&&this.add(new k(this.get(0)),!1)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();R.constructor_=function(){if(0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}},R.coordArrayType=new Array(0).fill(null);var T=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()}},{key:"intersection",value:function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new t;var n=this._minx>e._minx?this._minx:e._minx,i=this._miny>e._miny?this._miny:e._miny;return new t(n,this._maxx<e._maxx?this._maxx:e._maxx,i,this._maxy<e._maxy?this._maxy:e._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(1===arguments.length){if(arguments[0]instanceof k){var e=arguments[0];return this.covers(e.x,e.y)}if(arguments[0]instanceof t){var n=arguments[0];return!this.isNull()&&!n.isNull()&&n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return!this.isNull()&&i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy}}},{key:"intersects",value:function(){if(1===arguments.length){if(arguments[0]instanceof t){var e=arguments[0];return!this.isNull()&&!e.isNull()&&!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}if(arguments[0]instanceof k){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(2===arguments.length){if(arguments[0]instanceof k&&arguments[1]instanceof k){var i=arguments[0],r=arguments[1];return!(this.isNull()||(i.x<r.x?i.x:r.x)>this._maxx||(i.x>r.x?i.x:r.x)<this._minx||(i.y<r.y?i.y:r.y)>this._maxy||(i.y>r.y?i.y:r.y)<this._miny)}if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var s=arguments[0],o=arguments[1];return!this.isNull()&&!(s>this._maxx||s<this._minx||o>this._maxy||o<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(1===arguments.length){if(arguments[0]instanceof k){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(1===arguments.length){if(arguments[0]instanceof t){var e=arguments[0];return this.covers(e)}if(arguments[0]instanceof k){var n=arguments[0];return this.covers(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];return this.covers(i,r)}}},{key:"centre",value:function(){return this.isNull()?null:new k((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof k){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3];s<o?(this._minx=s,this._maxx=o):(this._minx=o,this._maxx=s),a<u?(this._miny=a,this._maxy=u):(this._miny=u,this._maxy=a)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+k.hashCode(this._minx))+k.hashCode(this._maxx))+k.hashCode(this._miny))+k.hashCode(this._maxy)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h,_]}}],[{key:"intersects",value:function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=Math.min(s.x,o.x),u=Math.max(s.x,o.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(l>u||h<a||(a=Math.min(s.y,o.y),u=Math.max(s.y,o.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),l>u||h<a))}}}]),t}();function b(){}T.constructor_=function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof k){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof T){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];this.init(r,s,o,a)}},T.serialVersionUID=0x51845cd552189800;var P=function(t){s(n,b);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();function M(t){this.str=t}function O(t){this.value=t}function F(){}P.constructor_=function(){b.constructor_.call(this,"Projective point not representable on the Cartesian plane.")},M.prototype.append=function(t){this.str+=t},M.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},M.prototype.toString=function(t){return this.str},O.prototype.intValue=function(){return this.value},O.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},O.isNaN=function(t){return Number.isNaN(t)},F.isWhitespace=function(t){return t<=32&&t>=0||127===t},F.toUpperCase=function(t){return t.toUpperCase()};var D=function(){function e(){f(this,e),e.constructor_.apply(this,arguments)}return g(e,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,n){var i=this.abs(),r=e.magnitude(i._hi),s=e.TEN.pow(r);(i=i.divide(s)).gt(e.TEN)?(i=i.divide(e.TEN),r+=1):i.lt(e.ONE)&&(i=i.multiply(e.TEN),r-=1);for(var o=r+1,a=new M,u=e.MAX_PRINT_DIGITS-1,l=0;l<=u;l++){t&&l===o&&a.append(".");var h=Math.trunc(i._hi);if(h<0)break;var c=!1,f=0;h>9?(c=!0,f="9"):f="0"+h,a.append(f),i=i.subtract(e.valueOf(h)).multiply(e.TEN),c&&i.selfAdd(e.TEN);var d=!0,g=e.magnitude(i._hi);if(g<0&&Math.abs(g)>=u-l&&(d=!1),!d)break}return n[0]=r,a.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var n=arguments[0];return this.add(-n)}}},{key:"equals",value:function(){if(1===arguments.length&&arguments[0]instanceof e){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return 0===this._hi&&0===this._lo}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfDivide(n,0)}}else if(2===arguments.length){var i,r,s,o,a=arguments[0],u=arguments[1],l=null,h=null,c=null,f=null;return s=this._hi/a,f=(l=(c=e.SPLIT*s)-(l=c-s))*(h=(f=e.SPLIT*a)-(h=f-a))-(o=s*a)+l*(r=a-h)+(i=s-l)*h+i*r,f=s+(c=(this._hi-o-f+this._lo-s*u)/a),this._hi=f,this._lo=s-f+c,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof e){var t,n,i,r,s=arguments[0],a=null,u=null,l=null,h=null;return t=(i=this._hi/s._hi)-(a=(l=e.SPLIT*i)-(a=l-i)),h=a*(u=(h=e.SPLIT*s._hi)-(u=h-s._hi))-(r=i*s._hi)+a*(n=s._hi-u)+t*u+t*n,new e(h=i+(l=(this._hi-r-h+this._lo-i*s._lo)/s._hi),i-h+l)}if("number"==typeof arguments[0]){var c=arguments[0];return o.isNaN(c)?e.createNaN():e.copy(this).selfDivide(c,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(0===t)return e.valueOf(1);var n=new e(this),i=e.valueOf(1),r=Math.abs(t);if(r>1)for(;r>0;)r%2==1&&i.selfMultiply(n),(r/=2)>0&&(n=n.sqr());else i=n;return t<0?i.reciprocal():i}},{key:"ceil",value:function(){if(this.isNaN())return e.NaN;var t=Math.ceil(this._hi),n=0;return t===this._hi&&(n=Math.ceil(this._lo)),new e(t,n)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var n=arguments[0];return this.init(n),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return e.valueOf(0);if(this.isNegative())return e.NaN;var t=1/Math.sqrt(this._hi),n=this._hi*t,i=e.valueOf(n),r=this.subtract(i.sqr())._hi*(.5*t);return i.add(r)}},{key:"selfAdd",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var n,i,r,s,o,a=arguments[0],u=null;return u=(r=this._hi+a)-(s=r-this._hi),i=(o=(u=a-s+(this._hi-u))+this._lo)+(r-(n=r+o)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var l,h,c,f,d=arguments[0],g=arguments[1],v=null,_=null,y=null;c=this._hi+d,h=this._lo+g,_=c-(y=c-this._hi),v=h-(f=h-this._lo);var p=(l=c+(y=(_=d-y+(this._hi-_))+h))+(y=(v=g-f+(this._lo-v))+(y+(c-l))),m=y+(l-p);return this._hi=p,this._lo=m,this}}},{key:"selfMultiply",value:function(){if(1===arguments.length){if(arguments[0]instanceof e){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var n=arguments[0];return this.selfMultiply(n,0)}}else if(2===arguments.length){var i,r,s=arguments[0],o=arguments[1],a=null,u=null,l=null,h=null;a=(l=e.SPLIT*this._hi)-this._hi,h=e.SPLIT*s,a=l-a,i=this._hi-a,u=h-s;var c=(l=this._hi*s)+(h=a*(u=h-u)-l+a*(r=s-u)+i*u+i*r+(this._hi*o+this._lo*s)),f=h+(a=l-c);return this._hi=c,this._lo=f,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return e.NaN;var t=Math.floor(this._hi),n=0;return t===this._hi&&(n=Math.floor(this._lo)),new e(t,n)}},{key:"negate",value:function(){return this.isNaN()?this:new e(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return t.isNaN()?e.createNaN():e.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var n=arguments[0];return o.isNaN(n)?e.createNaN():e.copy(this).selfMultiply(n,0)}}},{key:"isNaN",value:function(){return o.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=e.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),i=this.extractSignificantDigits(!0,n),r=n[0]+1,s=i;if("."===i.charAt(0))s="0"+i;else if(r<0)s="0."+e.stringOfChar("0",-r)+i;else if(-1===i.indexOf(".")){var o=r-i.length;s=i+e.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+s:s}},{key:"reciprocal",value:function(){var t,n,i,r,s=null,o=null,a=null,u=null;t=(i=1/this._hi)-(s=(a=e.SPLIT*i)-(s=a-i)),o=(u=e.SPLIT*this._hi)-this._hi;var l=i+(a=(1-(r=i*this._hi)-(u=s*(o=u-o)-r+s*(n=this._hi-o)+t*o+t*n)-i*this._lo)/this._hi);return new e(l,i-l+a)}},{key:"toSciNotation",value:function(){if(this.isZero())return e.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var n=new Array(1).fill(null),i=this.extractSignificantDigits(!1,n),r=e.SCI_NOT_EXPONENT_CHAR+n[0];if("0"===i.charAt(0))throw new IllegalStateException("Found leading zero: "+i);var s="";i.length>1&&(s=i.substring(1));var o=i.charAt(0)+"."+s;return this.isNegative()?"-"+o+r:o+r}},{key:"abs",value:function(){return this.isNaN()?e.NaN:this.isNegative()?this.negate():new e(this)}},{key:"isPositive",value:function(){return this._hi>0||0===this._hi&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof e){var t=arguments[0];return e.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var n=arguments[0];return e.copy(this).selfAdd(n)}}},{key:"init",value:function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof e){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this._hi=i,this._lo=r}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||0===this._hi&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?e.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"getClass",value:function(){return e}},{key:"interfaces_",get:function(){return[_,h,d]}}],[{key:"sqr",value:function(t){return e.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if("string"==typeof arguments[0]){var t=arguments[0];return e.parse(t)}if("number"==typeof arguments[0])return new e(arguments[0])}},{key:"sqrt",value:function(t){return e.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var n=0,i=t.length;F.isWhitespace(t.charAt(n));)n++;var r=!1;if(n<i){var s=t.charAt(n);"-"!==s&&"+"!==s||(n++,"-"===s&&(r=!0))}for(var o=new e,a=0,u=0,l=0;!(n>=i);){var h=t.charAt(n);if(n++,F.isDigit(h)){var c=h-"0";o.selfMultiply(e.TEN),o.selfAdd(c),a++}else{if("."!==h){if("e"===h||"E"===h){var f=t.substring(n);try{l=O.parseInt(f)}catch(n){throw n instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+f+" in string "+t):n}break}throw new NumberFormatException("Unexpected character '"+h+"' at position "+n+" in string "+t)}u=a}}var d=o,g=a-u-l;if(0===g)d=o;else if(g>0){var v=e.TEN.pow(g);d=o.divide(v)}else if(g<0){var _=e.TEN.pow(-g);d=o.multiply(_)}return r?d.negate():d}},{key:"createNaN",value:function(){return new e(o.NaN,o.NaN)}},{key:"copy",value:function(t){return new e(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i}},{key:"stringOfChar",value:function(t,e){for(var n=new M,i=0;i<e;i++)n.append(t);return n.toString()}}]),e}();D.constructor_=function(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof D){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){var n=arguments[0];D.constructor_.call(this,D.parse(n))}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}},D.PI=new D(3.141592653589793,1.2246467991473532e-16),D.TWO_PI=new D(6.283185307179586,2.4492935982947064e-16),D.PI_2=new D(1.5707963267948966,6.123233995736766e-17),D.E=new D(2.718281828459045,1.4456468917292502e-16),D.NaN=new D(o.NaN,o.NaN),D.EPS=1.23259516440783e-32,D.SPLIT=134217729,D.MAX_PRINT_DIGITS=32,D.TEN=D.valueOf(10),D.ONE=D.valueOf(1),D.SCI_NOT_EXPONENT_CHAR="E",D.SCI_NOT_ZERO="0.0E0";var A=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"orientationIndex",value:function(e,n,i){var r=t.orientationIndexFilter(e,n,i);if(r<=1)return r;var s=D.valueOf(n.x).selfAdd(-e.x),o=D.valueOf(n.y).selfAdd(-e.y),a=D.valueOf(i.x).selfAdd(-n.x),u=D.valueOf(i.y).selfAdd(-n.y);return s.selfMultiply(u).selfSubtract(o.selfMultiply(a)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof D&&arguments[2]instanceof D&&arguments[0]instanceof D&&arguments[1]instanceof D){var t=arguments[1],e=arguments[2],n=arguments[3];return arguments[0].multiply(n).selfSubtract(t.multiply(e)).signum()}if("number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=D.valueOf(i),u=D.valueOf(r),l=D.valueOf(s),h=D.valueOf(o);return a.multiply(h).selfSubtract(u.multiply(l)).signum()}}},{key:"intersection",value:function(t,e,n,i){var r=D.valueOf(i.y).selfSubtract(n.y).selfMultiply(D.valueOf(e.x).selfSubtract(t.x)),s=D.valueOf(i.x).selfSubtract(n.x).selfMultiply(D.valueOf(e.y).selfSubtract(t.y)),o=r.subtract(s),a=D.valueOf(i.x).selfSubtract(n.x).selfMultiply(D.valueOf(t.y).selfSubtract(n.y)),u=D.valueOf(i.y).selfSubtract(n.y).selfMultiply(D.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(o).doubleValue(),h=D.valueOf(t.x).selfAdd(D.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=D.valueOf(e.x).selfSubtract(t.x).selfMultiply(D.valueOf(t.y).selfSubtract(n.y)),f=D.valueOf(e.y).selfSubtract(t.y).selfMultiply(D.valueOf(t.x).selfSubtract(n.x)),d=c.subtract(f).selfDivide(o).doubleValue(),g=D.valueOf(n.y).selfAdd(D.valueOf(i.y).selfSubtract(n.y).selfMultiply(d)).doubleValue();return new k(h,g)}},{key:"orientationIndexFilter",value:function(e,n,i){var r=null,s=(e.x-i.x)*(n.y-i.y),o=(e.y-i.y)*(n.x-i.x),a=s-o;if(s>0){if(o<=0)return t.signum(a);r=s+o}else{if(!(s<0))return t.signum(a);if(o>=0)return t.signum(a);r=-s-o}var u=t.DP_SAFE_EPSILON*r;return a>=u||-a>=u?t.signum(a):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}]),t}();A.constructor_=function(){},A.DP_SAFE_EPSILON=1e-15;var G=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"index",value:function(t,e,n){return A.orientationIndex(t,e,n)}},{key:"isCCW",value:function(e){var i=e.length-1;if(i<3)throw new n("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=e[0],s=0,o=1;o<=i;o++){var a=e[o];a.y>r.y&&(r=a,s=o)}var u=s;do{(u-=1)<0&&(u=i)}while(e[u].equals2D(r)&&u!==s);var l=s;do{l=(l+1)%i}while(e[l].equals2D(r)&&l!==s);var h=e[u],c=e[l];if(h.equals2D(r)||c.equals2D(r)||h.equals2D(c))return!1;var f=t.index(h,r,c);return 0===f?h.x>c.x:f>0}}]),t}();function B(){}G.constructor_=function(){},G.CLOCKWISE=-1,G.RIGHT=G.CLOCKWISE,G.COUNTERCLOCKWISE=1,G.LEFT=G.COUNTERCLOCKWISE,G.COLLINEAR=0,G.STRAIGHT=G.COLLINEAR,B.arraycopy=function(t,e,n,i,r){for(var s=0,o=e;o<e+r;o++)n[i+s]=t[o],s++},B.getProperty=function(t){return{"line.separator":"\n"}[t]};var V=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getY",value:function(){var t=this.y/this.w;if(o.isNaN(t)||o.isInfinite(t))throw new P;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(o.isNaN(t)||o.isInfinite(t))throw new P;return t}},{key:"getCoordinate",value:function(){var t=new k;return t.x=this.getX(),t.y=this.getY(),t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"intersection",value:function(t,e,n,i){var r=t.y-e.y,s=e.x-t.x,a=t.x*e.y-e.x*t.y,u=n.y-i.y,l=i.x-n.x,h=n.x*i.y-i.x*n.y,c=r*l-u*s,f=(s*h-l*a)/c,d=(u*a-r*h)/c;if(o.isNaN(f)||o.isInfinite(f)||o.isNaN(d)||o.isInfinite(d))throw new P;return new k(f,d)}}]),t}();V.constructor_=function(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof V&&arguments[1]instanceof V){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof k&&arguments[1]instanceof k){var s=arguments[0],o=arguments[1];this.x=s.y-o.y,this.y=o.x-s.x,this.w=s.x*o.y-o.x*s.y}}else if(3===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2];this.x=a,this.y=u,this.w=l}else if(4===arguments.length){var h=arguments[0],c=arguments[1],f=arguments[2],d=arguments[3],g=h.y-c.y,v=c.x-h.x,_=h.x*c.y-c.x*h.y,y=f.y-d.y,p=d.x-f.x,m=f.x*d.y-d.x*f.y;this.x=v*m-p*_,this.y=y*_-g*m,this.w=g*p-y*v}};var z=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"log10",value:function(e){var n=Math.log(e);return o.isInfinite(n)||o.isNaN(n)?n:n/t.LOG_10}},{key:"min",value:function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r}},{key:"clamp",value:function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],s=arguments[2];return i<r?r:i>s?s:i}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var i=arguments[1],r=arguments[2],s=arguments[3],o=arguments[0];return i>o&&(o=i),r>o&&(o=r),s>o&&(o=s),o}}},{key:"average",value:function(t,e){return(t+e)/2}}]),t}();z.constructor_=function(){},z.LOG_10=Math.log(10);var q=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"segmentToSegment",value:function(e,n,i,r){if(e.equals(n))return t.pointToSegment(e,i,r);if(i.equals(r))return t.pointToSegment(r,e,n);var s=!1;if(T.intersects(e,n,i,r)){var o=(n.x-e.x)*(r.y-i.y)-(n.y-e.y)*(r.x-i.x);if(0===o)s=!0;else{var a=(e.y-i.y)*(r.x-i.x)-(e.x-i.x)*(r.y-i.y),u=((e.y-i.y)*(n.x-e.x)-(e.x-i.x)*(n.y-e.y))/o,l=a/o;(l<0||l>1||u<0||u>1)&&(s=!0)}}else s=!0;return s?z.min(t.pointToSegment(e,i,r),t.pointToSegment(n,i,r),t.pointToSegment(i,e,n),t.pointToSegment(r,e,n)):0}},{key:"pointToSegment",value:function(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(r<=0)return t.distance(e);if(r>=1)return t.distance(n);var s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(s)*Math.sqrt(i)}},{key:"pointToLinePerpendicular",value:function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)}},{key:"pointToSegmentString",value:function(e,i){if(0===i.length)throw new n("Line array must contain at least one vertex");for(var r=e.distance(i[0]),s=0;s<i.length-1;s++){var o=t.pointToSegment(e,i[s],i[s+1]);o<r&&(r=o)}return r}}]),t}();q.constructor_=function(){};var Y=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setOrdinate",value:function(t,e,n){}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(t,e){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(t){}},{key:"getDimension",value:function(){}},{key:"getX",value:function(t){}},{key:"expandEnvelope",value:function(t){}},{key:"copy",value:function(){}},{key:"getY",value:function(t){}},{key:"toCoordinateArray",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[d]}}]),t}();Y.constructor_=function(){},Y.X=0,Y.Y=1,Y.Z=2,Y.M=3;var X=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"create",value:function(){1===arguments.length&&(arguments[0]instanceof Array||E(arguments[0],Y))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();X.constructor_=function(){};var U=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();U.constructor_=function(){};var W=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===t.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equals",value:function(){if(arguments[0]instanceof t){var e=arguments[0];return null!==e&&this.equalsTopo(e)}if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof t))return!1;var i=n;return this.equalsExact(i)}}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(t.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return null!==t&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(1===arguments.length){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return t=n,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(n,i)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(e){if(e.getTypeCode()===t.TYPECODE_GEOMETRYCOLLECTION)throw new n("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new T(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),s=i.next(),o=r.compareTo(s);if(0!==o)return o}return n.hasNext()?1:i.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===t.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===t.TYPECODE_MULTIPOINT||this.getTypeCode()===t.TYPECODE_MULTILINESTRING||this.getTypeCode()===t.TYPECODE_MULTIPOLYGON}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[d,h,_]}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1}}]),t}();W.constructor_=function(t){t&&(this._envelope=null,this._userData=null,this._factory=t,this._SRID=t.getSRID())},W.serialVersionUID=0x799ea46522854c00,W.TYPECODE_POINT=0,W.TYPECODE_MULTIPOINT=1,W.TYPECODE_LINESTRING=2,W.TYPECODE_LINEARRING=3,W.TYPECODE_MULTILINESTRING=4,W.TYPECODE_POLYGON=5,W.TYPECODE_MULTIPOLYGON=6,W.TYPECODE_GEOMETRYCOLLECTION=7,W.TYPENAME_POINT="Point",W.TYPENAME_MULTIPOINT="MultiPoint",W.TYPENAME_LINESTRING="LineString",W.TYPENAME_LINEARRING="LinearRing",W.TYPENAME_MULTILINESTRING="MultiLineString",W.TYPENAME_POLYGON="Polygon",W.TYPENAME_MULTIPOLYGON="MultiPolygon",W.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",W.geometryChangedFilter={get interfaces_(){return[U]},filter:function(t){t.geometryChangedAction()}};var H=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();H.constructor_=function(){};var j=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInBoundary",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),K=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInBoundary",value:function(t){return t%2==1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[j]}}]),t}();K.constructor_=function(){};var Z=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInBoundary",value:function(t){return t>0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[j]}}]),t}();Z.constructor_=function(){};var J=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInBoundary",value:function(t){return t>1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[j]}}]),t}();J.constructor_=function(){};var Q=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInBoundary",value:function(t){return 1===t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[j]}}]),t}();Q.constructor_=function(){},j.Mod2BoundaryNodeRule=K,j.EndPointBoundaryNodeRule=Z,j.MultiValentEndPointBoundaryNodeRule=J,j.MonoValentEndPointBoundaryNodeRule=Q,j.constructor_=function(){},j.MOD2_BOUNDARY_RULE=new K,j.ENDPOINT_BOUNDARY_RULE=new Z,j.MULTIVALENT_ENDPOINT_BOUNDARY_RULE=new J,j.MONOVALENT_ENDPOINT_BOUNDARY_RULE=new Q,j.OGC_SFS_BOUNDARY_RULE=j.MOD2_BOUNDARY_RULE;var $=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isRing",value:function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}},{key:"ptNotInList",value:function(e,n){for(var i=0;i<e.length;i++){var r=e[i];if(t.indexOf(r,n)<0)return r}return null}},{key:"scroll",value:function(e,n){var i=t.indexOf(n,e);if(i<0)return null;var r=new Array(e.length).fill(null);B.arraycopy(e,i,r,0,e.length-i),B.arraycopy(e,0,r,e.length-i,i),B.arraycopy(r,0,e,0,e.length)}},{key:"equals",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(0!==s.compare(i[o],r[o]))return!1;return!0}}},{key:"intersection",value:function(t,e){for(var n=new R,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(e){return t.hasRepeatedPoints(e)?new R(e,!1).toCoordinateArray():e}},{key:"reverse",value:function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}}},{key:"removeNull",value:function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,s=0;s<t.length;s++)null!==t[s]&&(i[r++]=t[s]);return i}},{key:"copyDeep",value:function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new k(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3],a=arguments[4],u=0;u<a;u++)s[o+u]=new k(i[r+u])}},{key:"isEqualReversed",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0}},{key:"envelope",value:function(t){for(var e=new T,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}},{key:"toCoordinateArray",value:function(e){return e.toArray(t.coordArrayType)}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1}},{key:"compare",value:function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e}},{key:"extract",value:function(t,e,n){e=z.clamp(e,0,t.length);var i=(n=z.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var s=0,o=e;o<=n;o++)r[s++]=t[o];return r}}]),t}(),tt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(t,e){var n=t,i=e;return $.compare(n,i)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}]),t}();tt.constructor_=function(){};var et=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=$.compare(n,i);return $.isEqualReversed(n,i)?0:r}},{key:"OLDcompare",value:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=$.increasingDirection(n),s=$.increasingDirection(i),o=r>0?0:n.length-1,a=s>0?0:n.length-1,u=0;u<n.length;u++){var l=n[o].compareTo(i[a]);if(0!==l)return l;o+=r,a+=s}return 0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}]),t}();function nt(){}function it(){}function rt(t){this.message=t||""}function st(){}function ot(){this.array_=[],arguments[0]instanceof C&&this.addAll(arguments[0])}et.constructor_=function(){},$.ForwardComparator=tt,$.BidirectionalComparator=et,$.constructor_=function(){},$.coordArrayType=new Array(0).fill(null),nt.prototype.get=function(){},nt.prototype.put=function(){},nt.prototype.size=function(){},nt.prototype.values=function(){},nt.prototype.entrySet=function(){},it.prototype=new nt,rt.prototype=new Error,rt.prototype.name="OperationNotSupported",st.prototype=new C,st.prototype.contains=function(){},ot.prototype=new st,ot.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},ot.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},ot.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},ot.prototype.remove=function(t){throw new rt},ot.prototype.size=function(){return this.array_.length},ot.prototype.isEmpty=function(){return 0===this.array_.length},ot.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},ot.prototype.iterator=function(){return new at(this)};var at=function(t){this.hashSet_=t,this.position_=0};function ut(t){return null==t?0:t.color}function lt(t){return null==t?null:t.parent}function ht(t,e){null!==t&&(t.color=e)}function ct(t){return null==t?null:t.left}function ft(t){return null==t?null:t.right}function dt(){this.root_=null,this.size_=0}at.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new w;return this.hashSet_.array_[this.position_++]},at.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},at.prototype.remove=function(){throw new rt},dt.prototype=new it,dt.prototype.get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},dt.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var s=r.value;return r.value=e,s}r=r.right}}while(null!==r);var o={key:t,left:null,right:null,value:e,parent:n,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=o:n.right=o,this.fixAfterInsertion(o),this.size_++,null},dt.prototype.fixAfterInsertion=function(t){var e;for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)lt(t)===ct(lt(lt(t)))?1===ut(e=ft(lt(lt(t))))?(ht(lt(t),0),ht(e,0),ht(lt(lt(t)),1),t=lt(lt(t))):(t===ft(lt(t))&&(t=lt(t),this.rotateLeft(t)),ht(lt(t),0),ht(lt(lt(t)),1),this.rotateRight(lt(lt(t)))):1===ut(e=ct(lt(lt(t))))?(ht(lt(t),0),ht(e,0),ht(lt(lt(t)),1),t=lt(lt(t))):(t===ct(lt(t))&&(t=lt(t),this.rotateRight(t)),ht(lt(t),0),ht(lt(lt(t)),1),this.rotateLeft(lt(lt(t))));this.root_.color=0},dt.prototype.values=function(){var t=new N,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=dt.successor(e));)t.add(e.value);return t},dt.prototype.entrySet=function(){var t=new ot,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=dt.successor(e));)t.add(e);return t},dt.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},dt.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null==t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},dt.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},dt.successor=function(t){var e;if(null===t)return null;if(null!==t.right){for(e=t.right;null!==e.left;)e=e.left;return e}e=t.parent;for(var n=t;null!==e&&n===e.right;)n=e,e=e.parent;return e},dt.prototype.size=function(){return this.size_},dt.prototype.containsKey=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return!0;e=e.right}}return!1};var gt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();function vt(){}function _t(){this.array_=[],arguments[0]instanceof C&&this.addAll(arguments[0])}gt.constructor_=function(){},vt.prototype=new st,_t.prototype=new vt,_t.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},_t.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},_t.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},_t.prototype.remove=function(t){throw new rt},_t.prototype.size=function(){return this.array_.length},_t.prototype.isEmpty=function(){return 0===this.array_.length},_t.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},_t.prototype.iterator=function(){return new yt(this)};var yt=function(t){this.treeSet_=t,this.position_=0};function pt(){}yt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new w;return this.treeSet_.array_[this.position_++]},yt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},yt.prototype.remove=function(){throw new rt},pt.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var s=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<s.length;t++)r.push(s[t])}else if(4===arguments.length){e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i);var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}},pt.asList=function(t){for(var e=new N,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var mt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toDimensionSymbol",value:function(e){switch(e){case t.FALSE:return t.SYM_FALSE;case t.TRUE:return t.SYM_TRUE;case t.DONTCARE:return t.SYM_DONTCARE;case t.P:return t.SYM_P;case t.L:return t.SYM_L;case t.A:return t.SYM_A}throw new n("Unknown dimension value: "+e)}},{key:"toDimensionValue",value:function(e){switch(F.toUpperCase(e)){case t.SYM_FALSE:return t.FALSE;case t.SYM_TRUE:return t.TRUE;case t.SYM_DONTCARE:return t.DONTCARE;case t.SYM_P:return t.P;case t.SYM_L:return t.L;case t.SYM_A:return t.A}throw new n("Unknown dimension symbol: "+e)}}]),t}();mt.constructor_=function(){},mt.P=0,mt.L=1,mt.A=2,mt.FALSE=-1,mt.TRUE=-2,mt.DONTCARE=-3,mt.SYM_FALSE="F",mt.SYM_TRUE="T",mt.SYM_DONTCARE="*",mt.SYM_P="0",mt.SYM_L="1",mt.SYM_A="2";var kt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();kt.constructor_=function(){};var xt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t,e){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();xt.constructor_=function(){};var Et=function(t){s(n,W);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"computeEnvelopeInternal",value:function(){for(var t=new T,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}},{key:"getGeometryN",value:function(t){return this._geometries[t]}},{key:"getCoordinates",value:function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t}},{key:"getArea",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t;if(this._geometries.length!==r._geometries.length)return!1;for(var s=0;s<this._geometries.length;s++)if(!this._geometries[s].equalsExact(r._geometries[s],e))return!1;return!0}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();pt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var t=mt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}},{key:"getTypeCode",value:function(){return W.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var t=mt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}},{key:"getLength",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"reverse",value:function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0],e=new _t(pt.asList(this._geometries)),n=new _t(pt.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[1],r=arguments[0],s=this.getNumGeometries(),o=r.getNumGeometries(),a=0;a<s&&a<o;){var u=this.getGeometryN(a),l=r.getGeometryN(a),h=u.compareToSameClass(l,i);if(0!==h)return h;a++}return a<s?1:a<o?-1:0}}},{key:"apply",value:function(){if(E(arguments[0],H))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(E(arguments[0],xt)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(E(arguments[0],kt)){var r=arguments[0];r.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(r)}else if(E(arguments[0],U)){var o=arguments[0];o.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(o)}}},{key:"getBoundary",value:function(){return this.checkNotGeometryCollection(this),m.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return W.TYPENAME_GEOMETRYCOLLECTION}},{key:"copy",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)}},{key:"isEmpty",value:function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Et.constructor_=function(){if(this._geometries=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];if(W.constructor_.call(this,e),null===t&&(t=[]),W.hasNullElements(t))throw new n("geometries must not contain null elements");this._geometries=t}},Et.serialVersionUID=-0x4f07bcb1f857d800;var Ct=function(t){s(n,Et);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&i(c(n.prototype),"equalsExact",this).call(this,t,e)}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?mt.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return W.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"reverse",value:function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)}},{key:"getBoundary",value:function(){return new It(this).getBoundary()}},{key:"getGeometryType",value:function(){return W.TYPENAME_MULTILINESTRING}},{key:"copy",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[gt]}}]),n}();Ct.constructor_=function(){var t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},Ct.serialVersionUID=0x7155d2ab4afa8000;var It=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"boundaryMultiLineString",value:function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)}},{key:"getBoundary",value:function(){return this._geom instanceof Ft?this.boundaryLineString(this._geom):this._geom instanceof Ct?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()}},{key:"boundaryLineString",value:function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])}},{key:"getEmptyMultiPoint",value:function(){return this._geomFact.createMultiPoint()}},{key:"computeBoundaryCoordinates",value:function(t){var e=new N;this._endpointMap=new dt;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var s=r.next(),o=s.getValue().count;this._bnRule.isInBoundary(o)&&e.add(s.getKey())}return $.toCoordinateArray(e)}},{key:"addEndpoint",value:function(t){var e=this._endpointMap.get(t);null===e&&(e=new St,this._endpointMap.put(t,e)),e.count++}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getBoundary",value:function(){return 1===arguments.length?new t(arguments[0]).getBoundary():2===arguments.length?new t(arguments[0],arguments[1]).getBoundary():void 0}}]),t}();It.constructor_=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0];It.constructor_.call(this,t,j.MOD2_BOUNDARY_RULE)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._geom=e,this._geomFact=e.getFactory(),this._bnRule=n}};var St=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();St.constructor_=function(){this.count=null};var wt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"ofLine",value:function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new k;t.getCoordinate(0,i);for(var r=i.x,s=i.y,o=1;o<e;o++){t.getCoordinate(o,i);var a=i.x,u=i.y,l=a-r,h=u-s;n+=Math.sqrt(l*l+h*h),r=a,s=u}return n}}]),t}();function Nt(){}function Lt(){}function Rt(){}function Tt(){}function bt(){}wt.constructor_=function(){};var Pt=function(){function e(){f(this,e),e.constructor_.apply(this,arguments)}return g(e,[{key:"getClass",value:function(){return e}},{key:"interfaces_",get:function(){return[]}}],[{key:"chars",value:function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return new String(n)}},{key:"getStackTrace",value:function(){if(1===arguments.length){var n=arguments[0],i=new Rt,r=new Nt(i);return n.printStackTrace(r),i.toString()}if(2===arguments.length){for(var s=arguments[0],o=arguments[1],a="",u=new bt(new Lt(e.getStackTrace(s))),l=0;l<o;l++)try{a+=u.readLine()+e.NEWLINE}catch(t){if(!(t instanceof Tt))throw t;m.shouldNeverReachHere()}return a}}},{key:"split",value:function(t,e){for(var n=e.length,i=new N,r=""+t,s=r.indexOf(e);s>=0;){var o=r.substring(0,s);i.add(o),s=(r=r.substring(s+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a}},{key:"toString",value:function(){if(1===arguments.length&&"number"==typeof arguments[0]){var t=arguments[0];return e.SIMPLE_ORDINATE_FORMAT.format(t)}}},{key:"spaces",value:function(t){return e.chars(" ",t)}}]),e}();function Mt(t){this.str=t}Pt.constructor_=function(){},Pt.NEWLINE=B.getProperty("line.separator"),Pt.SIMPLE_ORDINATE_FORMAT=new function(){}("0.#"),Mt.prototype.append=function(t){this.str+=t},Mt.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},Mt.prototype.toString=function(t){return this.str};var Ot=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"copyCoord",value:function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),s=0;s<r;s++)n.setOrdinate(i,s,t.getOrdinate(e,s))}},{key:"isRing",value:function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,Y.X)===t.getOrdinate(e-1,Y.X)&&t.getOrdinate(0,Y.Y)===t.getOrdinate(e-1,Y.Y)}},{key:"isEqual",value:function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var s=0;s<i;s++){var a=t.getOrdinate(r,s),u=e.getOrdinate(r,s);if(!(t.getOrdinate(r,s)===e.getOrdinate(r,s)||o.isNaN(a)&&o.isNaN(u)))return!1}return!0}},{key:"extend",value:function(e,n,i){var r=e.create(i,n.getDimension()),s=n.size();if(t.copy(n,0,r,0,s),s>0)for(var o=s;o<i;o++)t.copy(n,s-1,r,o,1);return r}},{key:"reverse",value:function(e){for(var n=e.size()-1,i=Math.trunc(n/2),r=0;r<=i;r++)t.swap(e,r,n-r)}},{key:"swap",value:function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}}},{key:"copy",value:function(e,n,i,r,s){for(var o=0;o<s;o++)t.copyCoord(e,n+o,i,r+o)}},{key:"toString",value:function(){if(1===arguments.length&&E(arguments[0],Y)){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new Mt;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var s=0;s<n;s++)s>0&&i.append(","),i.append(Pt.toString(t.getOrdinate(r,s)))}return i.append(")"),i.toString()}}},{key:"ensureValidRing",value:function(e,n){var i=n.size();return 0===i?n:i<=3?t.createClosedRing(e,n,4):n.getOrdinate(0,Y.X)===n.getOrdinate(i-1,Y.X)&&n.getOrdinate(0,Y.Y)===n.getOrdinate(i-1,Y.Y)?n:t.createClosedRing(e,n,i+1)}},{key:"createClosedRing",value:function(e,n,i){var r=e.create(i,n.getDimension()),s=n.size();t.copy(n,0,r,0,s);for(var o=s;o<i;o++)t.copy(n,0,r,o,1);return r}}]),t}();Ot.constructor_=function(){};var Ft=function(t){s(r,W);var e=a(r);function r(){var t;return f(this,r),t=e.call(this),r.constructor_.apply(l(t),arguments),t}return g(r,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new T:this._points.expandEnvelope(new T)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var s=0;s<this._points.size();s++)if(!this.equal(this._points.getCoordinate(s),n._points.getCoordinate(s),e))return!1;return!0}return i(c(r.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){var n=this._points.copy();Ot.reverse(n),this._points=n}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?mt.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return W.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return wt.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"reverse",value:function(){var t=this._points.copy();return Ot.reverse(t),this.getFactory().createLineString(t)}},{key:"compareToSameClass",value:function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}}},{key:"apply",value:function(){if(E(arguments[0],H))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(E(arguments[0],xt)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else(E(arguments[0],kt)||E(arguments[0],U))&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return new It(this).getBoundary()}},{key:"isEquivalentClass",value:function(t){return t instanceof r}},{key:"getCoordinateN",value:function(t){return this._points.getCoordinate(t)}},{key:"getGeometryType",value:function(){return W.TYPENAME_LINESTRING}},{key:"copy",value:function(){return new r(this._points.copy(),this._factory)}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return 0===this._points.size()}},{key:"init",value:function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new n("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}},{key:"isCoordinate",value:function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}},{key:"getClass",value:function(){return r}},{key:"interfaces_",get:function(){return[gt]}}]),r}();Ft.constructor_=function(){if(this._points=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];W.constructor_.call(this,e),this.init(t)}},Ft.serialVersionUID=0x2b2b51ba435c8e00;var Dt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Dt.constructor_=function(){};var At=function(t){s(n,W);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new T;var t=new T;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return mt.FALSE}},{key:"getTypeCode",value:function(){return W.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"reverse",value:function(){return this.copy()}},{key:"getX",value:function(){if(null===this.getCoordinate())throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}}},{key:"apply",value:function(){if(E(arguments[0],H)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(E(arguments[0],xt)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(E(arguments[0],kt)||E(arguments[0],U))&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return W.TYPENAME_POINT}},{key:"copy",value:function(){return new n(this._coordinates.copy(),this._factory)}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(null===this.getCoordinate())throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return 0===this._coordinates.size()}},{key:"init",value:function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),m.isTrue(t.size()<=1),this._coordinates=t}},{key:"isSimple",value:function(){return!0}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[Dt]}}]),n}();At.constructor_=function(){this._coordinates=null;var t=arguments[0],e=arguments[1];W.constructor_.call(this,e),this.init(t)},At.serialVersionUID=0x44077bad161cbc00;var Gt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var e=arguments[0];return Math.abs(t.ofRingSigned(e))}if(E(arguments[0],Y)){var n=arguments[0];return Math.abs(t.ofRingSigned(n))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,s=t[i+1].y;e+=r*(t[i-1].y-s)}return e/2}if(E(arguments[0],Y)){var o=arguments[0],a=o.size();if(a<3)return 0;var u=new k,l=new k,h=new k;o.getCoordinate(0,l),o.getCoordinate(1,h);var c=l.x;h.x-=c;for(var f=0,d=1;d<a-1;d++)u.y=l.y,l.x=h.x,l.y=h.y,o.getCoordinate(d+1,h),h.x-=c,f+=l.x*(u.y-h.y);return f/2}}}]),t}();Gt.constructor_=function(){};var Bt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Bt.constructor_=function(){};var Vt=function(t){s(n,W);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var s=this._holes[r].getCoordinates(),o=0;o<s.length;o++)t[++e]=s[o];return t}},{key:"getArea",value:function(){var t=0;t+=Gt.ofRing(this._shell.getCoordinateSequence());for(var e=0;e<this._holes.length;e++)t-=Gt.ofRing(this._holes[e].getCoordinateSequence());return t}},{key:"isRectangle",value:function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var s=t.getX(0),o=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==s==(l!==o))return!1;s=u,o=l}return!0}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var r=t,s=this._shell,o=r._shell;if(!s.equalsExact(o,e))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(r._holes[a],e))return!1;return!0}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);pt.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);B.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=$.minCoordinate(e.getCoordinates());$.scroll(i,r),B.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],G.isCCW(e.getCoordinates())===n&&$.reverse(e.getCoordinates())}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return W.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}},{key:"getNumPoints",value:function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}},{key:"reverse",value:function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"compareToSameClass",value:function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[1],r=arguments[0],s=this._shell,o=r._shell,a=s.compareToSameClass(o,i);if(0!==a)return a;for(var u=this.getNumInteriorRing(),l=r.getNumInteriorRing(),h=0;h<u&&h<l;){var c=this.getInteriorRingN(h),f=r.getInteriorRingN(h),d=c.compareToSameClass(f,i);if(0!==d)return d;h++}return h<u?1:h<l?-1:0}}},{key:"apply",value:function(){if(E(arguments[0],H)){var t=arguments[0];this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(E(arguments[0],xt)){var n=arguments[0];if(this._shell.apply(n),!n.isDone())for(var i=0;i<this._holes.length&&(this._holes[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(E(arguments[0],kt))arguments[0].filter(this);else if(E(arguments[0],U)){var r=arguments[0];r.filter(this),this._shell.apply(r);for(var s=0;s<this._holes.length;s++)this._holes[s].apply(r)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}},{key:"getGeometryType",value:function(){return W.TYPENAME_POLYGON}},{key:"copy",value:function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),i=0;i<this._holes.length;i++)e[i]=this._holes[i].copy();return new n(t,e,this._factory)}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(t){return this._holes[t]}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[Bt]}}]),n}();Vt.constructor_=function(){this._shell=null,this._holes=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(W.constructor_.call(this,i),null===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),W.hasNullElements(e))throw new n("holes must not contain null elements");if(t.isEmpty()&&W.hasNonEmptyElements(e))throw new n("shell is empty but holes are not");this._shell=t,this._holes=e},Vt.serialVersionUID=-0x307ffefd8dc97200;var zt=function(t){s(n,Et);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&i(c(n.prototype),"equalsExact",this).call(this,t,e)}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(1===arguments.length&&Number.isInteger(arguments[0])){var t=arguments[0];return this._geometries[t].getCoordinate()}return i(c(n.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return mt.FALSE}},{key:"getTypeCode",value:function(){return W.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return W.TYPENAME_MULTIPOINT}},{key:"copy",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[Dt]}}]),n}();zt.constructor_=function(){var t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},zt.serialVersionUID=-0x6fb1ed4162e0fc00;var qt=function(t){s(r,Ft);var e=a(r);function r(){var t;return f(this,r),t=e.call(this),r.constructor_.apply(l(t),arguments),t}return g(r,[{key:"getBoundaryDimension",value:function(){return mt.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||i(c(r.prototype),"isClosed",this).call(this)}},{key:"getTypeCode",value:function(){return W.TYPECODE_LINEARRING}},{key:"reverse",value:function(){var t=this._points.copy();return Ot.reverse(t),this.getFactory().createLinearRing(t)}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!i(c(r.prototype),"isClosed",this).call(this))throw new n("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<r.MINIMUM_VALID_SIZE)throw new n("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return W.TYPENAME_LINEARRING}},{key:"copy",value:function(){return new r(this._points.copy(),this._factory)}},{key:"getClass",value:function(){return r}},{key:"interfaces_",get:function(){return[]}}]),r}();qt.constructor_=function(){if(arguments[0]instanceof Array&&arguments[1]instanceof te){var t=arguments[0],e=arguments[1];qt.constructor_.call(this,e.getCoordinateSequenceFactory().create(t),e)}else if(E(arguments[0],Y)&&arguments[1]instanceof te){var n=arguments[0],i=arguments[1];Ft.constructor_.call(this,n,i),this.validateConstruction()}},qt.MINIMUM_VALID_SIZE=4,qt.serialVersionUID=-0x3b229e262367a600;var Yt=function(t){s(n,Et);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"equalsExact",value:function(){if(2===arguments.length&&"number"==typeof arguments[1]&&arguments[0]instanceof W){var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&i(c(n.prototype),"equalsExact",this).call(this,t,e)}return i(c(n.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return W.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"reverse",value:function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new N,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))}},{key:"getGeometryType",value:function(){return W.TYPENAME_MULTIPOLYGON}},{key:"copy",value:function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[Bt]}}]),n}();Yt.constructor_=function(){var t=arguments[0],e=arguments[1];Et.constructor_.call(this,t,e)},Yt.serialVersionUID=-0x7a5aa1369171980;var Xt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setCopyUserData",value:function(t){this._isUserDataCopied=t}},{key:"edit",value:function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n}},{key:"editInternal",value:function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Et?this.editGeometryCollection(t,e):t instanceof Vt?this.editPolygon(t,e):t instanceof At||t instanceof Ft?e.edit(t,this._factory):(m.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)}},{key:"editGeometryCollection",value:function(t,e){for(var n=e.edit(t,this._factory),i=new N,r=0;r<n.getNumGeometries();r++){var s=this.edit(n.getGeometryN(r),e);null===s||s.isEmpty()||i.add(s)}return n.getClass()===zt?this._factory.createMultiPoint(i.toArray([])):n.getClass()===Ct?this._factory.createMultiLineString(i.toArray([])):n.getClass()===Yt?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))}},{key:"editPolygon",value:function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon()),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new N,s=0;s<n.getNumInteriorRing();s++){var o=this.edit(n.getInteriorRingN(s),e);null===o||o.isEmpty()||r.add(o)}return this._factory.createPolygon(i,r.toArray([]))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();function Ut(){}Xt.GeometryEditorOperation=Ut;var Wt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"edit",value:function(t,e){return t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ut]}}]),t}();Wt.constructor_=function(){};var Ht=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"edit",value:function(t,e){var n=this.edit(t.getCoordinates(),t);return t instanceof qt?null===n?e.createLinearRing():e.createLinearRing(n):t instanceof Ft?null===n?e.createLineString():e.createLineString(n):t instanceof At?null===n||0===n.length?e.createPoint():e.createPoint(n[0]):t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ut]}}]),t}();Ht.constructor_=function(){};var jt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"edit",value:function(t,e){return t instanceof qt?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Ft?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof At?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ut]}}]),t}();jt.constructor_=function(){},Xt.NoOpGeometryOperation=Wt,Xt.CoordinateOperation=Ht,Xt.CoordinateSequenceOperation=jt,Xt.constructor_=function(){if(this._factory=null,this._isUserDataCopied=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._factory=t}};var Kt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setOrdinate",value:function(t,e,i){switch(e){case Y.X:this._coordinates[t].x=i;break;case Y.Y:this._coordinates[t].y=i;break;case Y.Z:this._coordinates[t].z=i;break;default:throw new n("invalid ordinateIndex")}}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case Y.X:return this._coordinates[t].x;case Y.Y:return this._coordinates[t].y;case Y.Z:return this._coordinates[t].z}return o.NaN}},{key:"getCoordinate",value:function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}}},{key:"getCoordinateCopy",value:function(t){return new k(this._coordinates[t])}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var e=new Array(this.size()).fill(null),n=0;n<this._coordinates.length;n++)e[n]=this._coordinates[n].copy();return new t(e,this._dimension)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new Mt(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Y,_]}}]),t}();Kt.constructor_=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];Kt.constructor_.call(this,t,3)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)this._coordinates[n]=new k}else if(E(arguments[0],Y)){var i=arguments[0];if(null===i)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var r=0;r<this._coordinates.length;r++)this._coordinates[r]=i.getCoordinateCopy(r)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],o=arguments[1];this._coordinates=s,this._dimension=o,null===s&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var a=arguments[0],u=arguments[1];this._coordinates=new Array(a).fill(null),this._dimension=u;for(var l=0;l<a;l++)this._coordinates[l]=new k}},Kt.serialVersionUID=-0xcb44a778db18e00;var Zt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"readResolve",value:function(){return t.instance()}},{key:"create",value:function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Kt(arguments[0]);if(E(arguments[0],Y))return new Kt(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new Kt(t):new Kt(t,e)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[X,_]}}],[{key:"instance",value:function(){return t.instanceObject}}]),t}();function Jt(){this.map_=new Map}Zt.constructor_=function(){},Zt.serialVersionUID=-0x38e49fa6cf6f2e00,Zt.instanceObject=new Zt,Jt.prototype=new nt,Jt.prototype.get=function(t){return this.map_.get(t)||null},Jt.prototype.put=function(t,e){return this.map_.set(t,e),e},Jt.prototype.values=function(){for(var t=new N,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Jt.prototype.entrySet=function(){var t=new ot;return this.map_.entries().forEach(function(e){return t.add(e)}),t},Jt.prototype.size=function(){return this.map_.size()};var Qt=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this._modelType===n._modelType&&this._scale===n._scale}},{key:"compareTo",value:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new O(n).compareTo(new O(i))}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===t.FLOATING||this._modelType===t.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var e="UNKNOWN";return this._modelType===t.FLOATING?e="Floating":this._modelType===t.FLOATING_SINGLE?e="Floating-Single":this._modelType===t.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e}},{key:"makePrecise",value:function(){if("number"==typeof arguments[0]){var e=arguments[0];return o.isNaN(e)||this._modelType===t.FLOATING_SINGLE?e:this._modelType===t.FIXED?Math.round(e*this._scale)/this._scale:e}if(arguments[0]instanceof k){var n=arguments[0];if(this._modelType===t.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}}},{key:"getMaximumSignificantDigits",value:function(){var e=16;return this._modelType===t.FLOATING?e=16:this._modelType===t.FLOATING_SINGLE?e=6:this._modelType===t.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[_,h]}}],[{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}]),t}(),$t=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"readResolve",value:function(){return t.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[_]}}]),t}();$t.constructor_=function(){this._name=null;var t=arguments[0];this._name=t,$t.nameToTypeMap.put(t,this)},$t.serialVersionUID=-552860263173159e4,$t.nameToTypeMap=new Jt,Qt.Type=$t,Qt.constructor_=function(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=Qt.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof $t){var t=arguments[0];this._modelType=t,t===Qt.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this._modelType=Qt.FIXED,this.setScale(e)}else if(arguments[0]instanceof Qt){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}},Qt.serialVersionUID=0x6bee6404e9a25c00,Qt.FIXED=new $t("FIXED"),Qt.FLOATING=new $t("FLOATING"),Qt.FLOATING_SINGLE=new $t("FLOATING SINGLE"),Qt.maximumPreciseValue=9007199254740992;var te=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new k(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new k(t.getMinX(),t.getMinY()),new k(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new k(t.getMinX(),t.getMinY()),new k(t.getMinX(),t.getMaxY()),new k(t.getMaxX(),t.getMaxY()),new k(t.getMaxX(),t.getMinY()),new k(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(0===arguments.length)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(E(arguments[0],Y))return new Ft(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return 0===arguments.length?new Ct(null,this):1===arguments.length?new Ct(arguments[0],this):void 0}},{key:"buildGeometry",value:function(e){for(var n=null,i=!1,r=!1,s=e.iterator();s.hasNext();){var o=s.next(),a=o.getClass();null===n&&(n=a),a!==n&&(i=!0),o instanceof Et&&(r=!0)}if(null===n)return this.createGeometryCollection();if(i||r)return this.createGeometryCollection(t.toGeometryArray(e));var u=e.iterator().next();if(e.size()>1){if(u instanceof Vt)return this.createMultiPolygon(t.toPolygonArray(e));if(u instanceof Ft)return this.createMultiLineString(t.toLineStringArray(e));if(u instanceof At)return this.createMultiPoint(t.toPointArray(e));m.shouldNeverReachHere("Unhandled class: "+u.getClass().getName())}return u}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof k){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(E(arguments[0],Y))return new At(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(0===arguments.length)return this.createPolygon(null,null);if(1===arguments.length){if(E(arguments[0],Y)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof qt){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Vt(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return 0===arguments.length?new Et(null,this):1===arguments.length?new Et(arguments[0],this):void 0}},{key:"createGeometry",value:function(t){return new Xt(this).edit(t,new ee(this._coordinateSequenceFactory))}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(E(arguments[0],Y))return new qt(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return 0===arguments.length?new Yt(null,this):1===arguments.length?new Yt(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(0===arguments.length)return new zt(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new zt(arguments[0],this);if(E(arguments[0],Y)){var t=arguments[0];if(null===t)return this.createMultiPoint(new Array(0).fill(null));for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=this.getCoordinateSequenceFactory().create(1,t.getDimension());Ot.copy(t,n,i,0,1),e[n]=this.createPoint(i)}return this.createMultiPoint(e)}}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[_]}}],[{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Zt.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}]),t}(),ee=function(t){s(n,Xt.CoordinateSequenceOperation);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"edit",value:function(){if(2===arguments.length&&arguments[1]instanceof W&&E(arguments[0],Y)){var t=arguments[0];return this.coordinateSequenceFactory.create(t)}return i(c(n.prototype),"edit",this).apply(this,arguments)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ee.constructor_=function(){this.coordinateSequenceFactory=null;var t=arguments[0];this.coordinateSequenceFactory=t},te.CloneOp=ee,te.constructor_=function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,0===arguments.length)te.constructor_.call(this,new Qt,0);else if(1===arguments.length){if(E(arguments[0],X)){var t=arguments[0];te.constructor_.call(this,new Qt,0,t)}else if(arguments[0]instanceof Qt){var e=arguments[0];te.constructor_.call(this,e,0,te.getDefaultCoordinateSequenceFactory())}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];te.constructor_.call(this,n,i,te.getDefaultCoordinateSequenceFactory())}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this._precisionModel=r,this._coordinateSequenceFactory=o,this._SRID=s}},te.serialVersionUID=-0x5ea75f2051eeb400;var ne={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},ie=function(){function t(e){f(this,t),this.geometryFactory=e||new te,this.precisionModel=this.geometryFactory.getPrecisionModel()}return g(t,[{key:"read",value:function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=ne.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=ne.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],se[n]&&(e=se[n].call(this,i))),void 0===e)throw new Error("Could not parse WKT "+t);return e}},{key:"write",value:function(t){return this.extractGeometry(t)}},{key:"extractGeometry",value:function(t){var e=t.getGeometryType().toLowerCase();if(!re[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+re[e].call(this,t)+")"}}]),t}(),re={coordinate:function(t){return this.precisionModel.makePrecise(t),t.x+" "+t.y},point:function(t){return re.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+re.point.call(this,t._geometries[n])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(re.coordinate.call(this,t._points._coordinates[n]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(re.coordinate.call(this,t._points._coordinates[n]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+re.linestring.call(this,t._geometries[n])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+re.linestring.call(this,t._shell)+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+re.linestring.call(this,t._holes[n])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+re.polygon.call(this,t._geometries[n])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},se={coord:function(t){var e=t.trim().split(ne.spaces),n=new k(Number.parseFloat(e[0]),Number.parseFloat(e[1]));return this.precisionModel.makePrecise(n),n},point:function(t){return void 0===t?this.geometryFactory.createPoint():this.geometryFactory.createPoint(se.coord.call(this,t))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(ne.trimParens,"$1"),i.push(se.point.call(this,e));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e=t.trim().split(","),n=[],i=0,r=e.length;i<r;++i)n.push(se.coord.call(this,e[i]));return this.geometryFactory.createLineString(n)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e=t.trim().split(","),n=[],i=0,r=e.length;i<r;++i)n.push(se.coord.call(this,e[i]));return this.geometryFactory.createLinearRing(n)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(ne.parenComma),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(ne.trimParens,"$1"),i.push(se.linestring.call(this,e));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,s=t.trim().split(ne.parenComma),o=[],a=0,u=s.length;a<u;++a)e=s[a].replace(ne.trimParens,"$1"),n=se.linestring.call(this,e),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:o.push(i);return this.geometryFactory.createPolygon(r,o)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(ne.doubleParenComma),i=[],r=0,s=n.length;r<s;++r)e=n[r].replace(ne.trimParens,"$1"),i.push(se.polygon.call(this,e));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},oe=function(){function t(e){f(this,t),this.parser=new ie(e)}return g(t,[{key:"write",value:function(t){return this.parser.write(t)}}],[{key:"toLineString",value:function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}]),t}(),ae=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new Mt;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==t.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(e,n){return t.computeEdgeDistance(this._intPt[n],this._inputLines[e][0],this._inputLines[e][1])}},{key:"isCollinear",value:function(){return this._result===t.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return oe.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+oe.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"computeEdgeDistance",value:function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),s=-1;if(t.equals(e))s=0;else if(t.equals(n))s=i>r?i:r;else{var o=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(s=i>r?o:a)||t.equals(e)||(s=Math.max(o,a))}return m.isTrue(!(0===s&&!t.equals(e)),"Bad distance calculation"),s}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,n){var i=t.x-e.x,r=t.y-e.y,s=Math.sqrt(i*i+r*r);return m.isTrue(!(0===s&&!t.equals(e)),"Invalid distance calculation"),s}}]),t}();ae.constructor_=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new k,this._intPt[1]=new k,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},ae.DONT_INTERSECT=0,ae.DO_INTERSECT=1,ae.COLLINEAR=2,ae.NO_INTERSECTION=0,ae.POINT_INTERSECTION=1,ae.COLLINEAR_INTERSECTION=2;var ue=function(t){s(n,ae);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isInSegmentEnvelopes",value:function(t){var e=new T(this._inputLines[0][0],this._inputLines[0][1]),n=new T(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)}},{key:"computeIntersection",value:function(){if(3!==arguments.length)return i(c(n.prototype),"computeIntersection",this).apply(this,arguments);var t=arguments[0],e=arguments[1],r=arguments[2];if(this._isProper=!1,T.intersects(e,r,t)&&0===G.index(e,r,t)&&0===G.index(r,e,t))return this._isProper=!0,(t.equals(e)||t.equals(r))&&(this._isProper=!1),this._result=ae.POINT_INTERSECTION,null;this._result=ae.NO_INTERSECTION}},{key:"normalizeToMinimum",value:function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y}},{key:"safeHCoordinateIntersection",value:function(t,e,i,r){var s=null;try{s=V.intersection(t,e,i,r)}catch(h){if(!(h instanceof P))throw h;s=n.nearestEndpoint(t,e,i,r)}return s}},{key:"intersection",value:function(t,e,i,r){var s=this.intersectionWithNormalization(t,e,i,r);return this.isInSegmentEnvelopes(s)||(s=new k(n.nearestEndpoint(t,e,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(s),s}},{key:"smallestInAbsValue",value:function(t,e,n,i){var r=t,s=Math.abs(r);return Math.abs(e)<s&&(r=e,s=Math.abs(e)),Math.abs(n)<s&&(r=n,s=Math.abs(n)),Math.abs(i)<s&&(r=i),r}},{key:"checkDD",value:function(t,e,n,i,r){var s=A.intersection(t,e,n,i),o=this.isInSegmentEnvelopes(s);B.out.println("DD in env = "+o+"  --------------------- "+s),r.distance(s)>1e-4&&B.out.println("Distance = "+r.distance(s))}},{key:"intersectionWithNormalization",value:function(t,e,n,i){var r=new k(t),s=new k(e),o=new k(n),a=new k(i),u=new k;this.normalizeToEnvCentre(r,s,o,a,u);var l=this.safeHCoordinateIntersection(r,s,o,a);return l.x+=u.x,l.y+=u.y,l}},{key:"computeCollinearIntersection",value:function(t,e,n,i){var r=T.intersects(t,e,n),s=T.intersects(t,e,i),o=T.intersects(n,i,t),a=T.intersects(n,i,e);return r&&s?(this._intPt[0]=n,this._intPt[1]=i,ae.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=t,this._intPt[1]=e,ae.COLLINEAR_INTERSECTION):r&&o?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||s||a?ae.COLLINEAR_INTERSECTION:ae.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||s||o?ae.COLLINEAR_INTERSECTION:ae.POINT_INTERSECTION):s&&o?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?ae.COLLINEAR_INTERSECTION:ae.POINT_INTERSECTION):s&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||o?ae.COLLINEAR_INTERSECTION:ae.POINT_INTERSECTION):ae.NO_INTERSECTION}},{key:"normalizeToEnvCentre",value:function(t,e,n,i,r){var s=t.x<e.x?t.x:e.x,o=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,d=((s>l?s:l)+(a<c?a:c))/2,g=((o>h?o:h)+(u<f?u:f))/2;r.x=d,r.y=g,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y}},{key:"computeIntersect",value:function(t,e,n,i){if(this._isProper=!1,!T.intersects(t,e,n,i))return ae.NO_INTERSECTION;var r=G.index(t,e,n),s=G.index(t,e,i);if(r>0&&s>0||r<0&&s<0)return ae.NO_INTERSECTION;var o=G.index(n,i,t),a=G.index(n,i,e);return o>0&&a>0||o<0&&a<0?ae.NO_INTERSECTION:0===r&&0===s&&0===o&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===s||0===o||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new k(n):0===s?this._intPt[0]=new k(i):0===o?this._intPt[0]=new k(t):0===a&&(this._intPt[0]=new k(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),ae.POINT_INTERSECTION)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"nearestEndpoint",value:function(t,e,n,i){var r=t,s=q.pointToSegment(t,n,i),o=q.pointToSegment(e,n,i);return o<s&&(s=o,r=e),(o=q.pointToSegment(n,t,e))<s&&(s=o,r=n),(o=q.pointToSegment(i,t,e))<s&&(s=o,r=i),r}}]),n}();ue.constructor_=function(){};var le=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof t){var e=arguments[0],n=G.index(this.p0,this.p1,e.p0),i=G.index(this.p0,this.p1,e.p1);return n>=0&&i>=0||n<=0&&i<=0?Math.max(n,i):0}if(arguments[0]instanceof k){var r=arguments[0];return G.index(this.p0,this.p1,r)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(e){if(!(e instanceof t))return!1;var n=e;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)}},{key:"intersection",value:function(t){var e=new ue;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof k){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new k(e);var n=this.projectionFactor(e),i=new k;return i.x=this.p0.x+n*(this.p1.x-this.p0.x),i.y=this.p0.y+n*(this.p1.y-this.p0.y),i}if(arguments[0]instanceof t){var r=arguments[0],s=this.projectionFactor(r.p0),o=this.projectionFactor(r.p1);if(s>=1&&o>=1)return null;if(s<=0&&o<=0)return null;var a=this.project(r.p0);s<0&&(a=this.p0),s>1&&(a=this.p1);var u=this.project(r.p1);return o<0&&(u=this.p0),o>1&&(u=this.p1),new t(a,u)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return 0===t?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return q.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return t.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?o.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=o.MAX_VALUE,r=null,s=this.closestPoint(t.p0);i=s.distance(t.p0),n[0]=s,n[1]=t.p0;var a=this.closestPoint(t.p1);(r=a.distance(t.p1))<i&&(i=r,n[0]=a,n[1]=t.p1);var u=t.closestPoint(this.p0);(r=u.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=u);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=l),n}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){try{return V.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof P))throw t}return null}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,s=this.p1.y-this.p0.y,o=Math.sqrt(r*r+s*s),a=0,u=0;if(0!==e){if(o<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");a=e*r/o,u=e*s/o}return new k(n-u,i+a)}},{key:"setCoordinates",value:function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||o.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"distance",value:function(){if(arguments[0]instanceof t){var e=arguments[0];return q.segmentToSegment(this.p0,this.p1,e.p0,e.p1)}if(arguments[0]instanceof k){var n=arguments[0];return q.pointToSegment(n,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new k;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=java.lang.Double.doubleToLongBits(this.p0.x);t^=31*java.lang.Double.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=java.lang.Double.doubleToLongBits(this.p1.x);return n^=31*java.lang.Double.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h,_]}}],[{key:"midPoint",value:function(t,e){return new k((t.x+e.x)/2,(t.y+e.y)/2)}}]),t}();le.constructor_=function(){if(this.p0=null,this.p1=null,0===arguments.length)le.constructor_.call(this,new k,new k);else if(1===arguments.length){var t=arguments[0];le.constructor_.call(this,t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];le.constructor_.call(this,new k(i,r),new k(s,o))}},le.serialVersionUID=0x2d2172135f411c00;var he=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toLocationSymbol",value:function(e){switch(e){case t.EXTERIOR:return"e";case t.BOUNDARY:return"b";case t.INTERIOR:return"i";case t.NONE:return"-"}throw new n("Unknown location value: "+e)}}]),t}();he.constructor_=function(){},he.INTERIOR=0,he.BOUNDARY=1,he.EXTERIOR=2,he.NONE=-1;var ce=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])||t.isTrue(this._matrix[he.INTERIOR][he.BOUNDARY])||t.isTrue(this._matrix[he.BOUNDARY][he.INTERIOR])||t.isTrue(this._matrix[he.BOUNDARY][he.BOUNDARY]))&&this._matrix[he.EXTERIOR][he.INTERIOR]===mt.FALSE&&this._matrix[he.EXTERIOR][he.BOUNDARY]===mt.FALSE}},{key:"isCoveredBy",value:function(){return(t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])||t.isTrue(this._matrix[he.INTERIOR][he.BOUNDARY])||t.isTrue(this._matrix[he.BOUNDARY][he.INTERIOR])||t.isTrue(this._matrix[he.BOUNDARY][he.BOUNDARY]))&&this._matrix[he.INTERIOR][he.EXTERIOR]===mt.FALSE&&this._matrix[he.BOUNDARY][he.EXTERIOR]===mt.FALSE}},{key:"set",value:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this._matrix[n][i]=mt.toDimensionValue(t.charAt(e))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this._matrix[r][s]=o}}},{key:"isContains",value:function(){return t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&this._matrix[he.EXTERIOR][he.INTERIOR]===mt.FALSE&&this._matrix[he.EXTERIOR][he.BOUNDARY]===mt.FALSE}},{key:"setAtLeast",value:function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,mt.toDimensionValue(t.charAt(e)))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this._matrix[r][s]<o&&(this._matrix[r][s]=o)}}},{key:"setAtLeastIfValid",value:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}},{key:"isWithin",value:function(){return t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&this._matrix[he.INTERIOR][he.EXTERIOR]===mt.FALSE&&this._matrix[he.BOUNDARY][he.EXTERIOR]===mt.FALSE}},{key:"isTouches",value:function(e,n){return e>n?this.isTouches(n,e):(e===mt.A&&n===mt.A||e===mt.L&&n===mt.L||e===mt.L&&n===mt.A||e===mt.P&&n===mt.A||e===mt.P&&n===mt.L)&&this._matrix[he.INTERIOR][he.INTERIOR]===mt.FALSE&&(t.isTrue(this._matrix[he.INTERIOR][he.BOUNDARY])||t.isTrue(this._matrix[he.BOUNDARY][he.INTERIOR])||t.isTrue(this._matrix[he.BOUNDARY][he.BOUNDARY]))}},{key:"isOverlaps",value:function(e,n){return e===mt.P&&n===mt.P||e===mt.A&&n===mt.A?t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&t.isTrue(this._matrix[he.INTERIOR][he.EXTERIOR])&&t.isTrue(this._matrix[he.EXTERIOR][he.INTERIOR]):e===mt.L&&n===mt.L&&1===this._matrix[he.INTERIOR][he.INTERIOR]&&t.isTrue(this._matrix[he.INTERIOR][he.EXTERIOR])&&t.isTrue(this._matrix[he.EXTERIOR][he.INTERIOR])}},{key:"isEquals",value:function(e,n){return e===n&&t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&this._matrix[he.INTERIOR][he.EXTERIOR]===mt.FALSE&&this._matrix[he.BOUNDARY][he.EXTERIOR]===mt.FALSE&&this._matrix[he.EXTERIOR][he.INTERIOR]===mt.FALSE&&this._matrix[he.EXTERIOR][he.BOUNDARY]===mt.FALSE}},{key:"toString",value:function(){for(var t=new Mt("123456789"),e=0;e<3;e++)for(var n=0;n<3;n++)t.setCharAt(3*e+n,mt.toDimensionSymbol(this._matrix[e][n]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this._matrix[e][n]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(e){if(9!==e.length)throw new n("Should be length 9: "+e);for(var i=0;i<3;i++)for(var r=0;r<3;r++)if(!t.matches(this._matrix[i][r],e.charAt(3*i+r)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}},{key:"isDisjoint",value:function(){return this._matrix[he.INTERIOR][he.INTERIOR]===mt.FALSE&&this._matrix[he.INTERIOR][he.BOUNDARY]===mt.FALSE&&this._matrix[he.BOUNDARY][he.INTERIOR]===mt.FALSE&&this._matrix[he.BOUNDARY][he.BOUNDARY]===mt.FALSE}},{key:"isCrosses",value:function(e,n){return e===mt.P&&n===mt.L||e===mt.P&&n===mt.A||e===mt.L&&n===mt.A?t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&t.isTrue(this._matrix[he.INTERIOR][he.EXTERIOR]):e===mt.L&&n===mt.P||e===mt.A&&n===mt.P||e===mt.A&&n===mt.L?t.isTrue(this._matrix[he.INTERIOR][he.INTERIOR])&&t.isTrue(this._matrix[he.EXTERIOR][he.INTERIOR]):e===mt.L&&n===mt.L&&0===this._matrix[he.INTERIOR][he.INTERIOR]}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[d]}}],[{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&"string"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return n===mt.SYM_DONTCARE||n===mt.SYM_TRUE&&(e>=0||e===mt.TRUE)||n===mt.SYM_FALSE&&e===mt.FALSE||n===mt.SYM_P&&e===mt.P||n===mt.SYM_L&&e===mt.L||n===mt.SYM_A&&e===mt.A}if("string"==typeof arguments[0]&&"string"==typeof arguments[1]){var i=arguments[1];return new t(arguments[0]).matches(i)}}},{key:"isTrue",value:function(t){return t>=0||t===mt.TRUE}}]),t}();ce.constructor_=function(){if(this._matrix=null,0===arguments.length)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(mt.FALSE);else if(1===arguments.length)if("string"==typeof arguments[0]){var t=arguments[0];ce.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof ce){var e=arguments[0];ce.constructor_.call(this),this._matrix[he.INTERIOR][he.INTERIOR]=e._matrix[he.INTERIOR][he.INTERIOR],this._matrix[he.INTERIOR][he.BOUNDARY]=e._matrix[he.INTERIOR][he.BOUNDARY],this._matrix[he.INTERIOR][he.EXTERIOR]=e._matrix[he.INTERIOR][he.EXTERIOR],this._matrix[he.BOUNDARY][he.INTERIOR]=e._matrix[he.BOUNDARY][he.INTERIOR],this._matrix[he.BOUNDARY][he.BOUNDARY]=e._matrix[he.BOUNDARY][he.BOUNDARY],this._matrix[he.BOUNDARY][he.EXTERIOR]=e._matrix[he.BOUNDARY][he.EXTERIOR],this._matrix[he.EXTERIOR][he.INTERIOR]=e._matrix[he.EXTERIOR][he.INTERIOR],this._matrix[he.EXTERIOR][he.BOUNDARY]=e._matrix[he.EXTERIOR][he.BOUNDARY],this._matrix[he.EXTERIOR][he.EXTERIOR]=e._matrix[he.EXTERIOR][he.EXTERIOR]}};var fe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(e){for(;e>Math.PI;)e-=t.PI_TIMES_2;for(;e<=-Math.PI;)e+=t.PI_TIMES_2;return e}},{key:"angle",value:function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}}},{key:"isAcute",value:function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0}},{key:"isObtuse",value:function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0}},{key:"interiorAngle",value:function(e,n,i){var r=t.angle(n,e),s=t.angle(n,i);return Math.abs(s-r)}},{key:"normalizePositive",value:function(e){if(e<0){for(;e<0;)e+=t.PI_TIMES_2;e>=t.PI_TIMES_2&&(e=0)}else{for(;e>=t.PI_TIMES_2;)e-=t.PI_TIMES_2;e<0&&(e=0)}return e}},{key:"angleBetween",value:function(e,n,i){var r=t.angle(n,e),s=t.angle(n,i);return t.diff(r,s)}},{key:"diff",value:function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(e,n){var i=Math.sin(n-e);return i>0?t.COUNTERCLOCKWISE:i<0?t.CLOCKWISE:t.NONE}},{key:"angleBetweenOriented",value:function(e,n,i){var r=t.angle(n,e),s=t.angle(n,i)-r;return s<=-Math.PI?s+t.PI_TIMES_2:s>Math.PI?s-t.PI_TIMES_2:s}}]),t}();fe.constructor_=function(){},fe.PI_TIMES_2=2*Math.PI,fe.PI_OVER_2=Math.PI/2,fe.PI_OVER_4=Math.PI/4,fe.COUNTERCLOCKWISE=G.COUNTERCLOCKWISE,fe.CLOCKWISE=G.CLOCKWISE,fe.NONE=G.COLLINEAR;var de=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"area",value:function(){return t.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return t.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(e){if(null===e)throw new n("Supplied point is null.");return t.interpolateZ(e,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return t.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return t.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return t.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return t.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return t.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return t.inCentre(this.p0,this.p1,this.p2)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"area",value:function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}},{key:"signedArea",value:function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}},{key:"det",value:function(t,e,n,i){return t*i-e*n}},{key:"interpolateZ",value:function(t,e,n,i){var r=e.x,s=e.y,o=n.x-r,a=i.x-r,u=n.y-s,l=i.y-s,h=o*l-a*u,c=t.x-r,f=t.y-s,d=(l*c-a*f)/h,g=(-u*c+o*f)/h;return e.z+d*(n.z-e.z)+g*(i.z-e.z)}},{key:"longestSideLength",value:function(t,e,n){var i=t.distance(e),r=e.distance(n),s=n.distance(t),o=i;return r>o&&(o=r),s>o&&(o=s),o}},{key:"isAcute",value:function(t,e,n){return!!fe.isAcute(t,e,n)&&!!fe.isAcute(e,n,t)&&!!fe.isAcute(n,t,e)}},{key:"circumcentre",value:function(e,n,i){var r=i.x,s=i.y,o=e.x-r,a=e.y-s,u=n.x-r,l=n.y-s,h=2*t.det(o,a,u,l),c=t.det(a,o*o+a*a,l,u*u+l*l),f=t.det(o,o*o+a*a,u,u*u+l*l);return new k(r-c/h,s+f/h)}},{key:"perpendicularBisector",value:function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new V(t.x+n/2,t.y+i/2,1),s=new V(t.x-i+n/2,t.y+n+i/2,1);return new V(r,s)}},{key:"angleBisector",value:function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),s=n.x-t.x,o=n.y-t.y;return new k(t.x+r*s,t.y+r*o)}},{key:"area3D",value:function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,o=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-s*a,h=s*o-i*u,c=i*a-r*o,f=l*l+h*h+c*c;return Math.sqrt(f)/2}},{key:"centroid",value:function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new k(i,r)}},{key:"inCentre",value:function(t,e,n){var i=e.distance(n),r=t.distance(n),s=t.distance(e),o=i+r+s,a=(i*t.x+r*e.x+s*n.x)/o,u=(i*t.y+r*e.y+s*n.y)/o;return new k(a,u)}}]),t}();de.constructor_=function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n};var ge=function(t){s(n,b);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ge.constructor_=function(){if(0===arguments.length)b.constructor_.call(this);else if(1===arguments.length){var t=arguments[0];b.constructor_.call(this,t)}};var ve=function(){function e(){f(this,e),e.constructor_.apply(this,arguments)}return g(e,[{key:"setToReflectionBasic",value:function(t,e,i,r){if(t===i&&e===r)throw new n("Reflection line points must be distinct");var s=i-t,o=r-e,a=Math.sqrt(s*s+o*o),u=o/a,l=s/a,h=2*u*l,c=l*l-u*u;return this._m00=c,this._m01=h,this._m02=0,this._m10=h,this._m11=-c,this._m12=0,this}},{key:"getInverse",value:function(){var t=this.getDeterminant();if(0===t)throw new ge("Transformation is non-invertible");var n=this._m11/t,i=-this._m10/t,r=-this._m01/t,s=this._m00/t;return new e(n,r,(this._m01*this._m12-this._m02*this._m11)/t,i,s,(-this._m00*this._m12+this._m10*this._m02)/t)}},{key:"compose",value:function(t){var e=t._m00*this._m00+t._m01*this._m10,n=t._m00*this._m01+t._m01*this._m11,i=t._m00*this._m02+t._m01*this._m12+t._m02,r=t._m10*this._m00+t._m11*this._m10,s=t._m10*this._m01+t._m11*this._m11,o=t._m10*this._m02+t._m11*this._m12+t._m12;return this._m00=e,this._m01=n,this._m02=i,this._m10=r,this._m11=s,this._m12=o,this}},{key:"equals",value:function(t){if(null===t)return!1;if(!(t instanceof e))return!1;var n=t;return this._m00===n._m00&&this._m01===n._m01&&this._m02===n._m02&&this._m10===n._m10&&this._m11===n._m11&&this._m12===n._m12}},{key:"setToScale",value:function(t,e){return this._m00=t,this._m01=0,this._m02=0,this._m10=0,this._m11=e,this._m12=0,this}},{key:"isIdentity",value:function(){return 1===this._m00&&0===this._m01&&0===this._m02&&0===this._m10&&1===this._m11&&0===this._m12}},{key:"scale",value:function(t,n){return this.compose(e.scaleInstance(t,n)),this}},{key:"setToIdentity",value:function(){return this._m00=1,this._m01=0,this._m02=0,this._m10=0,this._m11=1,this._m12=0,this}},{key:"isGeometryChanged",value:function(){return!0}},{key:"setTransformation",value:function(){if(1===arguments.length){var t=arguments[0];return this._m00=t._m00,this._m01=t._m01,this._m02=t._m02,this._m10=t._m10,this._m11=t._m11,this._m12=t._m12,this}if(6===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3],s=arguments[4],o=arguments[5];return this._m00=e,this._m01=n,this._m02=i,this._m10=r,this._m11=s,this._m12=o,this}}},{key:"setToRotation",value:function(){if(1===arguments.length){var t=arguments[0];return this.setToRotation(Math.sin(t),Math.cos(t)),this}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this._m00=n,this._m01=-e,this._m02=0,this._m10=e,this._m11=n,this._m12=0,this}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return this.setToRotation(Math.sin(i),Math.cos(i),r,s),this}if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3];return this._m00=a,this._m01=-o,this._m02=u-u*a+l*o,this._m10=o,this._m11=a,this._m12=l-u*o-l*a,this}}},{key:"getMatrixEntries",value:function(){return[this._m00,this._m01,this._m02,this._m10,this._m11,this._m12]}},{key:"filter",value:function(t,e){this.transform(t,e)}},{key:"rotate",value:function(){if(1===arguments.length){var t=arguments[0];return this.compose(e.rotationInstance(t)),this}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.compose(e.rotationInstance(n,i)),this}if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];return this.compose(e.rotationInstance(r,s,o)),this}if(4===arguments.length){var a=arguments[0],u=arguments[1];return this.compose(e.rotationInstance(a,u)),this}}},{key:"getDeterminant",value:function(){return this._m00*this._m11-this._m01*this._m10}},{key:"composeBefore",value:function(t){var e=this._m00*t._m00+this._m01*t._m10,n=this._m00*t._m01+this._m01*t._m11,i=this._m00*t._m02+this._m01*t._m12+this._m02,r=this._m10*t._m00+this._m11*t._m10,s=this._m10*t._m01+this._m11*t._m11,o=this._m10*t._m02+this._m11*t._m12+this._m12;return this._m00=e,this._m01=n,this._m02=i,this._m10=r,this._m11=s,this._m12=o,this}},{key:"setToShear",value:function(t,e){return this._m00=1,this._m01=t,this._m02=0,this._m10=e,this._m11=1,this._m12=0,this}},{key:"isDone",value:function(){return!1}},{key:"clone",value:function(){try{return null}catch(t){if(!(t instanceof b))throw t;m.shouldNeverReachHere()}return null}},{key:"translate",value:function(t,n){return this.compose(e.translationInstance(t,n)),this}},{key:"setToReflection",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new n("Reflection vector must be non-zero");if(t===e)return this._m00=0,this._m01=1,this._m02=0,this._m10=1,this._m11=0,this._m12=0,this;var i=Math.sqrt(t*t+e*e),r=e/i,s=t/i;return this.rotate(-r,s),this.scale(1,-1),this.rotate(r,s),this}if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3];if(o===u&&a===l)throw new n("Reflection line points must be distinct");this.setToTranslation(-o,-a);var h=u-o,c=l-a,f=Math.sqrt(h*h+c*c),d=c/f,g=h/f;return this.rotate(-d,g),this.scale(1,-1),this.rotate(d,g),this.translate(o,a),this}}},{key:"toString",value:function(){return"AffineTransformation[["+this._m00+", "+this._m01+", "+this._m02+"], ["+this._m10+", "+this._m11+", "+this._m12+"]]"}},{key:"setToTranslation",value:function(t,e){return this._m00=1,this._m01=0,this._m02=t,this._m10=0,this._m11=1,this._m12=e,this}},{key:"shear",value:function(t,n){return this.compose(e.shearInstance(t,n)),this}},{key:"transform",value:function(){if(1===arguments.length){var t=arguments[0].copy();return t.apply(this),t}if(2===arguments.length){if(arguments[0]instanceof k&&arguments[1]instanceof k){var e=arguments[0],n=arguments[1],i=this._m00*e.x+this._m01*e.y+this._m02,r=this._m10*e.x+this._m11*e.y+this._m12;return n.x=i,n.y=r,n}if(E(arguments[0],Y)&&Number.isInteger(arguments[1])){var s=arguments[0],o=arguments[1],a=this._m00*s.getOrdinate(o,0)+this._m01*s.getOrdinate(o,1)+this._m02,u=this._m10*s.getOrdinate(o,0)+this._m11*s.getOrdinate(o,1)+this._m12;s.setOrdinate(o,0,a),s.setOrdinate(o,1,u)}}}},{key:"reflect",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1];return this.compose(e.reflectionInstance(t,n)),this}if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];return this.compose(e.reflectionInstance(i,r,s,o)),this}}},{key:"getClass",value:function(){return e}},{key:"interfaces_",get:function(){return[d,xt]}}],[{key:"translationInstance",value:function(t,n){var i=new e;return i.setToTranslation(t,n),i}},{key:"shearInstance",value:function(t,n){var i=new e;return i.setToShear(t,n),i}},{key:"reflectionInstance",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1],i=new e;return i.setToReflection(t,n),i}if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=new e;return u.setToReflection(r,s,o,a),u}}},{key:"rotationInstance",value:function(){if(1===arguments.length){var t=arguments[0];return e.rotationInstance(Math.sin(t),Math.cos(t))}if(2===arguments.length){var n=arguments[0],i=arguments[1],r=new e;return r.setToRotation(n,i),r}if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];return e.rotationInstance(Math.sin(s),Math.cos(s),o,a)}if(4===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2],c=arguments[3],f=new e;return f.setToRotation(u,l,h,c),f}}},{key:"scaleInstance",value:function(){if(2===arguments.length){var t=arguments[0],n=arguments[1],i=new e;return i.setToScale(t,n),i}if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=new e;return u.translate(-o,-a),u.scale(r,s),u.translate(o,a),u}}}]),e}();ve.constructor_=function(){if(this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null,0===arguments.length)this.setToIdentity();else if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this._m00=t[0],this._m01=t[1],this._m02=t[2],this._m10=t[3],this._m11=t[4],this._m12=t[5]}else if(arguments[0]instanceof ve){var e=arguments[0];this.setTransformation(e)}}else if(6===arguments.length&&"number"==typeof arguments[5]&&"number"==typeof arguments[4]&&"number"==typeof arguments[3]&&"number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3],o=arguments[4],a=arguments[5];this.setTransformation(n,i,r,s,o,a)}};var _e=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"solve",value:function(e,i){var r=i.length;if(e.length!==r||e[0].length!==r)throw new n("Matrix A is incorrectly sized");for(var s=0;s<r;s++){for(var o=s,a=s+1;a<r;a++)Math.abs(e[a][s])>Math.abs(e[o][s])&&(o=a);if(0===e[o][s])return null;t.swapRows(e,s,o),t.swapRows(i,s,o);for(var u=s+1;u<r;u++){for(var l=e[u][s]/e[s][s],h=r-1;h>=s;h--)e[u][h]-=e[s][h]*l;i[u]-=i[s]*l}}for(var c=new Array(r).fill(null),f=r-1;f>=0;f--){for(var d=0,g=f+1;g<r;g++)d+=e[f][g]*c[g];c[f]=(i[f]-d)/e[f][f]}return c}},{key:"swapRows",value:function(){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var t=arguments[0],e=arguments[1],n=arguments[2];if(e===n)return null;for(var i=0;i<t[0].length;i++){var r=t[e][i];t[e][i]=t[n][i],t[n][i]=r}}else if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var s=arguments[0],o=arguments[1],a=arguments[2];if(o===a)return null;var u=s[o];s[o]=s[a],s[a]=u}}}]),t}();_e.constructor_=function(){};var ye=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"solve",value:function(t){var e=[[this._src0.x,this._src0.y,1],[this._src1.x,this._src1.y,1],[this._src2.x,this._src2.y,1]];return _e.solve(e,t)}},{key:"compute",value:function(){var t=[this._dest0.x,this._dest1.x,this._dest2.x],e=this.solve(t);if(null===e)return!1;this._m00=e[0],this._m01=e[1],this._m02=e[2];var n=[this._dest0.y,this._dest1.y,this._dest2.y],i=this.solve(n);return null!==i&&(this._m10=i[0],this._m11=i[1],this._m12=i[2],!0)}},{key:"getTransformation",value:function(){return this.compute()?new ve(this._m00,this._m01,this._m02,this._m10,this._m11,this._m12):null}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ye.constructor_=function(){this._src0=null,this._src1=null,this._src2=null,this._dest0=null,this._dest1=null,this._dest2=null,this._m00=null,this._m01=null,this._m02=null,this._m10=null,this._m11=null,this._m12=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],s=arguments[5];this._src0=t,this._src1=e,this._src2=n,this._dest0=i,this._dest1=r,this._dest2=s};var pe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"createFromBaseLines",value:function(t,e,n,i){var r=new k(t.x+i.x-n.x,t.y+i.y-n.y),s=fe.angleBetweenOriented(e,t,r),o=e.distance(t),a=i.distance(n);if(0===o)return new ve;var u=a/o,l=ve.translationInstance(-t.x,-t.y);return l.rotate(s),l.scale(u,u),l.translate(n.x,n.y),l}},{key:"createFromControlVectors",value:function(){if(2===arguments.length){if(arguments[0]instanceof k&&arguments[1]instanceof k){var e=arguments[0],i=arguments[1],r=i.x-e.x,s=i.y-e.y;return ve.translationInstance(r,s)}if(arguments[0]instanceof Array&&arguments[1]instanceof Array){var o=arguments[0],a=arguments[1];if(o.length!==a.length)throw new n("Src and Dest arrays are not the same length");if(o.length<=0)throw new n("Too few control points");if(o.length>3)throw new n("Too many control points");return 1===o.length?t.createFromControlVectors(o[0],a[0]):2===o.length?t.createFromControlVectors(o[0],o[1],a[0],a[1]):t.createFromControlVectors(o[0],o[1],o[2],a[0],a[1],a[2])}}else{if(4===arguments.length){var u=arguments[0],l=arguments[1],h=arguments[2],c=arguments[3],f=new k(c.x-h.x,c.y-h.y),d=fe.angleBetweenOriented(l,u,f),g=l.distance(u),v=c.distance(h);if(0===g)return null;var _=v/g,y=ve.translationInstance(-u.x,-u.y);return y.rotate(d),y.scale(_,_),y.translate(h.x,h.y),y}if(6===arguments.length)return new ye(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]).getTransformation()}}}]),t}();pe.constructor_=function(){};var me=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){(t instanceof Ft||t instanceof At)&&this._coords.add(t.getCoordinate())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[U]}}],[{key:"getCoordinates",value:function(e){var n=new N;return e.apply(new t(n)),n}}]),t}();me.constructor_=function(){this._coords=null;var t=arguments[0];this._coords=t};var ke=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"map",value:function(t){for(var e=new N,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(te.toGeometryArray(e))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"map",value:function(e,n){return new t(n).map(e)}}]),t}();ke.constructor_=function(){this._mapOp=null;var t=arguments[0];this._mapOp=t};var xe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"extractElements",value:function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}}},{key:"combine",value:function(){for(var t=new N,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection():null:this._geomFactory.buildGeometry(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"combine",value:function(){if(1===arguments.length)return new t(arguments[0]).combine();if(2===arguments.length){var e=arguments[0],n=arguments[1];return new t(t.createList(e,n)).combine()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return new t(t.createList(i,r,s)).combine()}}},{key:"extractFactory",value:function(t){return t.isEmpty()?null:t.iterator().next().getFactory()}},{key:"createList",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new N;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=new N;return o.add(i),o.add(r),o.add(s),o}}}]),t}();xe.constructor_=function(){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null;var t=arguments[0];this._geomFactory=xe.extractFactory(t),this._inputGeoms=t};var Ee=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(e){(null===this._geometryType||t.isOfType(e,this._geometryType))&&this._comps.add(e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[kt]}}],[{key:"isOfType",value:function(t,e){return t.getGeometryType()===e||e===W.TYPENAME_LINESTRING&&t.getGeometryType()===W.TYPENAME_LINEARRING}},{key:"extract",value:function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.extract(e,n,new N)}if(3===arguments.length){if(E(arguments[2],S)&&arguments[0]instanceof W&&"string"==typeof arguments[1]){var i=arguments[0],r=arguments[1],s=arguments[2];return i.getGeometryType()===r?s.add(i):i instanceof Et&&i.apply(new t(r,s)),s}if(E(arguments[2],S)&&arguments[0]instanceof W&&arguments[1]instanceof Class){var o=arguments[0],a=arguments[1],u=arguments[2];return t.extract(o,t.toGeometryType(a),u)}}}}]),t}();Ee.constructor_=function(){this._geometryType=null,this._comps=null;var t=arguments[0],e=arguments[1];this._geometryType=t,this._comps=e};var Ce=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"map",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ce.constructor_=function(){};var Ie=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"map",value:function(){if(arguments[0]instanceof W&&E(arguments[1],Ce)){for(var t=arguments[0],e=arguments[1],n=new N,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(E(arguments[0],C)&&E(arguments[1],Ce)){for(var s=arguments[0],o=arguments[1],a=new N,u=s.iterator();u.hasNext();){var l=u.next(),h=o.map(l);null!==h&&a.add(h)}return a}}}]),t}();Ie.constructor_=function(){};var Se=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"transformPoint",value:function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))}},{key:"transformPolygon",value:function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof qt&&!i.isEmpty()||(n=!1);for(var r=new N,s=0;s<t.getNumInteriorRing();s++){var o=this.transformLinearRing(t.getInteriorRingN(s),t);null===o||o.isEmpty()||(o instanceof qt||(n=!1),r.add(o))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new N;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)}},{key:"createCoordinateSequence",value:function(t){return this._factory.getCoordinateSequenceFactory().create(t)}},{key:"getInputGeometry",value:function(){return this._inputGeom}},{key:"transformMultiLineString",value:function(t,e){for(var n=new N,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"transformCoordinates",value:function(t,e){return this.copy(t)}},{key:"transformLineString",value:function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))}},{key:"transformMultiPoint",value:function(t,e){for(var n=new N,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"transformMultiPolygon",value:function(t,e){for(var n=new N,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)}},{key:"copy",value:function(t){return t.copy()}},{key:"transformGeometryCollection",value:function(t,e){for(var n=new N,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(te.toGeometryArray(n)):this._factory.buildGeometry(n)}},{key:"transform",value:function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof At)return this.transformPoint(t,null);if(t instanceof zt)return this.transformMultiPoint(t,null);if(t instanceof qt)return this.transformLinearRing(t,null);if(t instanceof Ft)return this.transformLineString(t,null);if(t instanceof Ct)return this.transformMultiLineString(t,null);if(t instanceof Vt)return this.transformPolygon(t,null);if(t instanceof Yt)return this.transformMultiPolygon(t,null);if(t instanceof Et)return this.transformGeometryCollection(t,null);throw new n("Unknown Geometry subtype: "+t.getClass().getName())}},{key:"transformLinearRing",value:function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Se.constructor_=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};var we=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){t instanceof Ft&&this._comps.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[kt]}}],[{key:"getGeometry",value:function(e){return e.getFactory().buildGeometry(t.getLines(e))}},{key:"getLines",value:function(){if(1===arguments.length){var e=arguments[0];return t.getLines(e,new N)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n instanceof Ft?i.add(n):n instanceof Et&&n.apply(new t(i)),i}}}]),t}();we.constructor_=function(){this._comps=null;var t=arguments[0];this._comps=t};var Ne=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){if(this._isForcedToLineString&&t instanceof qt){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Ft&&this._lines.add(t)}},{key:"setForceToLineString",value:function(t){this._isForcedToLineString=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[U]}}],[{key:"getGeometry",value:function(){if(1===arguments.length){var e=arguments[0];return e.getFactory().buildGeometry(t.getLines(e))}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n.getFactory().buildGeometry(t.getLines(n,i))}}},{key:"getLines",value:function(){if(1===arguments.length){var e=arguments[0];return t.getLines(e,!1)}if(2===arguments.length){if(E(arguments[0],C)&&E(arguments[1],C)){for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();){var r=i.next();t.getLines(r,n)}return n}if(arguments[0]instanceof W&&"boolean"==typeof arguments[1]){var s=arguments[0],o=arguments[1],a=new N;return s.apply(new t(a,o)),a}if(arguments[0]instanceof W&&E(arguments[1],C)){var u=arguments[0],l=arguments[1];return u instanceof Ft?l.add(u):u.apply(new t(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&E(arguments[0],C)&&E(arguments[1],C)){for(var h=arguments[1],c=arguments[2],f=arguments[0].iterator();f.hasNext();){var d=f.next();t.getLines(d,h,c)}return h}if("boolean"==typeof arguments[2]&&arguments[0]instanceof W&&E(arguments[1],C)){var g=arguments[1],v=arguments[2];return arguments[0].apply(new t(g,v)),g}}}}]),t}();Ne.constructor_=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};var Le={reverseOrder:function(){return{compare:function(t,e){return e.compareTo(t)}}},min:function(t){return Le.sort(t),t.get(0)},sort:function(t,e){var n=t.toArray();e?pt.sort(n,e):pt.sort(n);for(var i=t.iterator(),r=0,s=n.length;r<s;r++)i.next(),i.set(n[r])},singletonList:function(t){var e=new N;return e.add(t),e}},Re=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){t instanceof At&&this._pts.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[kt]}}],[{key:"getPoints",value:function(){if(1===arguments.length){var e=arguments[0];return e instanceof At?Le.singletonList(e):t.getPoints(e,new N)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n instanceof At?i.add(n):n instanceof Et&&n.apply(new t(i)),i}}}]),t}();Re.constructor_=function(){this._pts=null;var t=arguments[0];this._pts=t};var Te=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){t instanceof Vt&&this._comps.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[kt]}}],[{key:"getPolygons",value:function(){if(1===arguments.length){var e=arguments[0];return t.getPolygons(e,new N)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return n instanceof Vt?i.add(n):n instanceof Et&&n.apply(new t(i)),i}}}]),t}();Te.constructor_=function(){this._comps=null;var t=arguments[0];this._comps=t};var be=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"applyTo",value:function(t){for(var e=0;e<t.getNumGeometries()&&!this._isDone;e++){var n=t.getGeometryN(e);if(n instanceof Et)this.applyTo(n);else if(this.visit(n),this.isDone())return this._isDone=!0,null}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();be.constructor_=function(){this._isDone=!1};var Pe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"createSupercircle",value:function(t){for(var e=1/t,n=this._dim.getMinSize()/2,i=this._dim.getCentre(),r=Math.pow(n,t),s=n,o=Math.pow(r/2,e),a=Math.trunc(this._nPts/8),u=new Array(8*a+1).fill(null),l=o/a,h=0;h<=a;h++){var c=0,f=s;if(0!==h){c=l*h;var d=Math.pow(c,t);f=Math.pow(r-d,e)}u[h]=this.coordTrans(c,f,i),u[2*a-h]=this.coordTrans(f,c,i),u[2*a+h]=this.coordTrans(f,-c,i),u[4*a-h]=this.coordTrans(c,-f,i),u[4*a+h]=this.coordTrans(-c,-f,i),u[6*a-h]=this.coordTrans(-f,-c,i),u[6*a+h]=this.coordTrans(-f,c,i),u[8*a-h]=this.coordTrans(-c,f,i)}u[u.length-1]=new k(u[0]);var g=this._geomFact.createLinearRing(u),v=this._geomFact.createPolygon(g);return this.rotate(v)}},{key:"setNumPoints",value:function(t){this._nPts=t}},{key:"setBase",value:function(t){this._dim.setBase(t)}},{key:"setRotation",value:function(t){this._rotationAngle=t}},{key:"setWidth",value:function(t){this._dim.setWidth(t)}},{key:"createEllipse",value:function(){for(var t=this._dim.getEnvelope(),e=t.getWidth()/2,n=t.getHeight()/2,i=t.getMinX()+e,r=t.getMinY()+n,s=new Array(this._nPts+1).fill(null),o=0,a=0;a<this._nPts;a++){var u=a*(2*Math.PI/this._nPts),l=e*Math.cos(u)+i,h=n*Math.sin(u)+r;s[o++]=this.coord(l,h)}s[o]=new k(s[0]);var c=this._geomFact.createLinearRing(s),f=this._geomFact.createPolygon(c);return this.rotate(f)}},{key:"coordTrans",value:function(t,e,n){return this.coord(t+n.x,e+n.y)}},{key:"createSquircle",value:function(){return this.createSupercircle(4)}},{key:"setEnvelope",value:function(t){this._dim.setEnvelope(t)}},{key:"setCentre",value:function(t){this._dim.setCentre(t)}},{key:"createArc",value:function(t,e){var n=this._dim.getEnvelope(),i=n.getWidth()/2,r=n.getHeight()/2,s=n.getMinX()+i,o=n.getMinY()+r,a=e;(a<=0||a>2*Math.PI)&&(a=2*Math.PI);for(var u=a/(this._nPts-1),l=new Array(this._nPts).fill(null),h=0,c=0;c<this._nPts;c++){var f=t+c*u,d=i*Math.cos(f)+s,g=r*Math.sin(f)+o;l[h++]=this.coord(d,g)}var v=this._geomFact.createLineString(l);return this.rotate(v)}},{key:"rotate",value:function(t){if(0!==this._rotationAngle){var e=ve.rotationInstance(this._rotationAngle,this._dim.getCentre().x,this._dim.getCentre().y);t.apply(e)}return t}},{key:"coord",value:function(t,e){var n=new k(t,e);return this._precModel.makePrecise(n),n}},{key:"createArcPolygon",value:function(t,e){var n=this._dim.getEnvelope(),i=n.getWidth()/2,r=n.getHeight()/2,s=n.getMinX()+i,o=n.getMinY()+r,a=e;(a<=0||a>2*Math.PI)&&(a=2*Math.PI);var u=a/(this._nPts-1),l=new Array(this._nPts+2).fill(null),h=0;l[h++]=this.coord(s,o);for(var c=0;c<this._nPts;c++){var f=t+u*c,d=i*Math.cos(f)+s,g=r*Math.sin(f)+o;l[h++]=this.coord(d,g)}l[h++]=this.coord(s,o);var v=this._geomFact.createLinearRing(l),_=this._geomFact.createPolygon(v);return this.rotate(_)}},{key:"createRectangle",value:function(){var t=null,e=0,n=Math.trunc(this._nPts/4);n<1&&(n=1);var i=this._dim.getEnvelope().getWidth()/n,r=this._dim.getEnvelope().getHeight()/n,s=new Array(4*n+1).fill(null),o=this._dim.getEnvelope();for(t=0;t<n;t++){var a=o.getMinX()+t*i,u=o.getMinY();s[e++]=this.coord(a,u)}for(t=0;t<n;t++){var l=o.getMaxX(),h=o.getMinY()+t*r;s[e++]=this.coord(l,h)}for(t=0;t<n;t++){var c=o.getMaxX()-t*i,f=o.getMaxY();s[e++]=this.coord(c,f)}for(t=0;t<n;t++){var d=o.getMinX(),g=o.getMaxY()-t*r;s[e++]=this.coord(d,g)}s[e++]=new k(s[0]);var v=this._geomFact.createLinearRing(s),_=this._geomFact.createPolygon(v);return this.rotate(_)}},{key:"createCircle",value:function(){return this.createEllipse()}},{key:"setHeight",value:function(t){this._dim.setHeight(t)}},{key:"setSize",value:function(t){this._dim.setSize(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),Me=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setBase",value:function(t){this.base=t}},{key:"setWidth",value:function(t){this.width=t}},{key:"getBase",value:function(){return this.base}},{key:"getWidth",value:function(){return this.width}},{key:"setEnvelope",value:function(t){this.width=t.getWidth(),this.height=t.getHeight(),this.base=new k(t.getMinX(),t.getMinY()),this.centre=new k(t.centre())}},{key:"setCentre",value:function(t){this.centre=t}},{key:"getMinSize",value:function(){return Math.min(this.width,this.height)}},{key:"getEnvelope",value:function(){return null!==this.base?new T(this.base.x,this.base.x+this.width,this.base.y,this.base.y+this.height):null!==this.centre?new T(this.centre.x-this.width/2,this.centre.x+this.width/2,this.centre.y-this.height/2,this.centre.y+this.height/2):new T(0,this.width,0,this.height)}},{key:"getCentre",value:function(){return null===this.centre&&(this.centre=new k(this.base.x+this.width/2,this.base.y+this.height/2)),this.centre}},{key:"getHeight",value:function(){return this.height}},{key:"setHeight",value:function(t){this.height=t}},{key:"setSize",value:function(t){this.height=t,this.width=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Me.constructor_=function(){this.base=null,this.centre=null,this.width=null,this.height=null},Pe.Dimensions=Me,Pe.constructor_=function(){if(this._geomFact=null,this._precModel=null,this._dim=new Me,this._nPts=100,this._rotationAngle=0,0===arguments.length)Pe.constructor_.call(this,new te);else if(1===arguments.length){var t=arguments[0];this._geomFact=t,this._precModel=t.getPrecisionModel()}};var Oe=function(t){s(n,Pe);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"setNumArms",value:function(t){this._numArms=t}},{key:"setArmLengthRatio",value:function(t){this._armLengthRatio=t}},{key:"createSineStar",value:function(){var t=this._dim.getEnvelope(),e=t.getWidth()/2,n=this._armLengthRatio;n<0&&(n=0),n>1&&(n=1);for(var i=n*e,r=(1-n)*e,s=t.getMinX()+e,o=t.getMinY()+e,a=new Array(this._nPts+1).fill(null),u=0,l=0;l<this._nPts;l++){var h=l/this._nPts*this._numArms,c=h-Math.floor(h),f=2*Math.PI*c,d=r+i*((Math.cos(f)+1)/2),g=l*(2*Math.PI/this._nPts),v=d*Math.cos(g)+s,_=d*Math.sin(g)+o;a[u++]=this.coord(v,_)}a[u]=new k(a[0]);var y=this._geomFact.createLinearRing(a);return this._geomFact.createPolygon(y)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Oe.constructor_=function(){if(this._numArms=8,this._armLengthRatio=.5,0===arguments.length)Pe.constructor_.call(this);else if(1===arguments.length){var t=arguments[0];Pe.constructor_.call(this,t)}};var Fe=Object.freeze({__proto__:null,AffineTransformation:ve,AffineTransformationBuilder:ye,AffineTransformationFactory:pe,ComponentCoordinateExtracter:me,GeometryCollectionMapper:ke,GeometryCombiner:xe,GeometryEditor:Xt,GeometryExtracter:Ee,GeometryMapper:Ie,GeometryTransformer:Se,LineStringExtracter:we,LinearComponentExtracter:Ne,MapOp:Ce,PointExtracter:Re,PolygonExtracter:Te,ShortCircuitedGeometryVisitor:be,SineStarFactory:Oe}),De=Object.freeze({__proto__:null,Coordinate:k,CoordinateList:R,Envelope:T,LineSegment:le,GeometryFactory:te,Geometry:W,Point:At,LineString:Ft,LinearRing:qt,Polygon:Vt,GeometryCollection:Et,MultiPoint:zt,MultiLineString:Ct,MultiPolygon:Yt,Dimension:mt,IntersectionMatrix:ce,PrecisionModel:Qt,Location:he,Triangle:de,util:Fe}),Ae=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this._pt}},{key:"getCoordinate",value:function(t){return this._pt[t]}},{key:"setMinimum",value:function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}}},{key:"initialize",value:function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}}},{key:"toString",value:function(){return oe.toLineString(this._pt[0],this._pt[1])}},{key:"getDistance",value:function(){return this._distance}},{key:"setMaximum",value:function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ae.constructor_=function(){this._pt=[new k,new k],this._distance=o.NaN,this._isNull=!0};var Ge=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"computeDistance",value:function(){if(arguments[2]instanceof Ae&&arguments[0]instanceof Ft&&arguments[1]instanceof k)for(var e=arguments[0],n=arguments[1],i=arguments[2],r=new le,s=e.getCoordinates(),o=0;o<s.length-1;o++){r.setCoordinates(s[o],s[o+1]);var a=r.closestPoint(n);i.setMinimum(a,n)}else if(arguments[2]instanceof Ae&&arguments[0]instanceof Vt&&arguments[1]instanceof k){var u=arguments[0],l=arguments[1],h=arguments[2];t.computeDistance(u.getExteriorRing(),l,h);for(var c=0;c<u.getNumInteriorRing();c++)t.computeDistance(u.getInteriorRingN(c),l,h)}else if(arguments[2]instanceof Ae&&arguments[0]instanceof W&&arguments[1]instanceof k){var f=arguments[0],d=arguments[1],g=arguments[2];if(f instanceof Ft)t.computeDistance(f,d,g);else if(f instanceof Vt)t.computeDistance(f,d,g);else if(f instanceof Et)for(var v=f,_=0;_<v.getNumGeometries();_++){var y=v.getGeometryN(_);t.computeDistance(y,d,g)}else g.setMinimum(f.getCoordinate(),d)}else if(arguments[2]instanceof Ae&&arguments[0]instanceof le&&arguments[1]instanceof k){var p=arguments[1],m=arguments[2],x=arguments[0].closestPoint(p);m.setMinimum(x,p)}}}]),t}();Ge.constructor_=function(){};var Be=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this._ptDist.getCoordinates()}},{key:"setDensifyFraction",value:function(t){if(t>1||t<=0)throw new n("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t}},{key:"compute",value:function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)}},{key:"distance",value:function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()}},{key:"computeOrientedDistance",value:function(t,e,n){var i=new Ve(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new ze(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}}},{key:"orientedDistance",value:function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"distance",value:function(){if(2===arguments.length)return new t(arguments[0],arguments[1]).distance();if(3===arguments.length){var e=arguments[2],n=new t(arguments[0],arguments[1]);return n.setDensifyFraction(e),n.distance()}}}]),t}(),Ve=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){this._minPtDist.initialize(),Ge.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[H]}}]),t}();Ve.constructor_=function(){this._maxPtDist=new Ae,this._minPtDist=new Ae,this._euclideanDist=new Ge,this._geom=null;var t=arguments[0];this._geom=t};var ze=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,s=(i.y-n.y)/this._numSubSegs,o=0;o<this._numSubSegs;o++){var a=n.x+o*r,u=n.y+o*s,l=new k(a,u);this._minPtDist.initialize(),Ge.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}}},{key:"isDone",value:function(){return!1}},{key:"isGeometryChanged",value:function(){return!1}},{key:"getMaxPointDistance",value:function(){return this._maxPtDist}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[xt]}}]),t}();ze.constructor_=function(){this._maxPtDist=new Ae,this._minPtDist=new Ae,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))},Be.MaxPointDistanceFilter=Ve,Be.MaxDensifiedByFractionDistanceFilter=ze,Be.constructor_=function(){this._g0=null,this._g1=null,this._ptDist=new Ae,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e};var qe=Object.freeze({__proto__:null,DiscreteHausdorffDistance:Be,DistanceToPoint:Ge,PointPairDistance:Ae}),Ye=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visitItem",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ye.constructor_=function(){};var Xe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"locate",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Xe.constructor_=function(){};var Ue=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getMin",value:function(){return this._min}},{key:"intersects",value:function(t,e){return!(this._min>e||this._max<t)}},{key:"getMax",value:function(){return this._max}},{key:"toString",value:function(){return oe.toLineString(new k(this._min,0),new k(this._max,0))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),We=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(t,e){var n=t,i=e,r=(n._min+n._max)/2,s=(i._min+i._max)/2;return r<s?-1:r>s?1:0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}]),t}();We.constructor_=function(){},Ue.NodeComparator=We,Ue.constructor_=function(){this._min=o.POSITIVE_INFINITY,this._max=o.NEGATIVE_INFINITY};var He=function(t){s(n,Ue);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"query",value:function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();He.constructor_=function(){this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n};var je=function(t){s(n,Ue);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"buildExtent",value:function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)}},{key:"query",value:function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();je.constructor_=function(){this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)};var Ke=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"buildTree",value:function(){Le.sort(this._leaves,new Ue.NodeComparator);for(var t=this._leaves,e=null,n=new N;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}}},{key:"insert",value:function(t,e,n){if(null!==this._root)throw new IllegalStateException("Index cannot be added to once it has been queried");this._leaves.add(new He(t,e,n))}},{key:"query",value:function(t,e,n){this.init(),this._root.query(t,e,n)}},{key:"buildRoot",value:function(){if(null!==this._root)return null;this._root=this.buildTree()}},{key:"printNode",value:function(t){B.out.println(oe.toLineString(new k(t._min,this._level),new k(t._max,this._level)))}},{key:"init",value:function(){if(null!==this._root)return null;this.buildRoot()}},{key:"buildLevel",value:function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new je(t.get(n),t.get(n+1));e.add(r)}}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ke.constructor_=function(){this._leaves=new N,this._root=null,this._level=0};var Ze=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visitItem",value:function(t){this._items.add(t)}},{key:"getItems",value:function(){return this._items}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ye]}}]),t}();Ze.constructor_=function(){this._items=new N};var Je=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=G.index(t,e,this._p);if(r===G.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(r=-r),r===G.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==he.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?he.BOUNDARY:this._crossingCount%2==1?he.INTERIOR:he.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"locatePointInRing",value:function(){if(arguments[0]instanceof k&&E(arguments[1],Y)){for(var e=arguments[1],n=new t(arguments[0]),i=new k,r=new k,s=1;s<e.size();s++)if(e.getCoordinate(s,i),e.getCoordinate(s-1,r),n.countSegment(i,r),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof k&&arguments[1]instanceof Array){for(var o=arguments[1],a=new t(arguments[0]),u=1;u<o.length;u++){var l=o[u],h=o[u-1];if(a.countSegment(l,h),a.isOnSegment())return a.getLocation()}return a.getLocation()}}}]),t}();Je.constructor_=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};var Qe=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"locate",value:function(t){var e=new Je(t),n=new $e(e);return this._index.query(t.y,t.y,n),e.getLocation()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Xe]}}]),t}(),$e=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visitItem",value:function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ye]}}]),t}();$e.constructor_=function(){this._counter=null;var t=arguments[0];this._counter=t};var tn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"init",value:function(t){for(var e=Ne.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}}},{key:"addLine",value:function(t){for(var e=1;e<t.length;e++){var n=new le(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}}},{key:"query",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Ze;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._index.query(i,r,s)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();tn.constructor_=function(){this._index=new Ke;var t=arguments[0];this.init(t)},Qe.SegmentVisitor=$e,Qe.IntervalIndexedGeometry=tn,Qe.constructor_=function(){this._index=null;var t=arguments[0];if(!(E(t,Bt)||t instanceof qt))throw new n("Argument must be Polygonal or LinearRing");this._index=new tn(t)};var en=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isOnLine",value:function(){if(arguments[0]instanceof k&&E(arguments[1],Y)){for(var t=arguments[0],e=arguments[1],n=new ue,i=new k,r=new k,s=e.size(),o=1;o<s;o++)if(e.getCoordinate(o-1,i),e.getCoordinate(o,r),n.computeIntersection(t,i,r),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof k&&arguments[1]instanceof Array){for(var a=arguments[0],u=arguments[1],l=new ue,h=1;h<u.length;h++){var c=u[h-1],f=u[h];if(l.computeIntersection(a,c,f),l.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return Je.locatePointInRing(t,e)}},{key:"isInRing",value:function(e,n){return t.locateInRing(e,n)!==he.EXTERIOR}}]),t}();function nn(){}en.constructor_=function(){},nn.prototype.hasNext=function(){},nn.prototype.next=function(){},nn.prototype.remove=function(){};var rn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,t.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new w;var e=this._parent.getGeometryN(this._index++);return e instanceof Et?(this._subcollectionIterator=new t(e),this._subcollectionIterator.next()):e}},{key:"remove",value:function(){throw new rt(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[nn]}}],[{key:"isAtomic",value:function(t){return!(t instanceof Et)}}]),t}();rn.constructor_=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};var sn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"locate",value:function(e){return t.locate(e,this._geom)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Xe]}}],[{key:"locatePointInPolygon",value:function(e,n){if(n.isEmpty())return he.EXTERIOR;var i=n.getExteriorRing(),r=t.locatePointInRing(e,i);if(r!==he.INTERIOR)return r;for(var s=0;s<n.getNumInteriorRing();s++){var o=n.getInteriorRingN(s),a=t.locatePointInRing(e,o);if(a===he.BOUNDARY)return he.BOUNDARY;if(a===he.INTERIOR)return he.EXTERIOR}return he.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?en.locateInRing(t,e.getCoordinates()):he.EXTERIOR}},{key:"containsPointInPolygon",value:function(e,n){return he.EXTERIOR!==t.locatePointInPolygon(e,n)}},{key:"locateInGeometry",value:function(e,n){if(n instanceof Vt)return t.locatePointInPolygon(e,n);if(n instanceof Et)for(var i=new rn(n);i.hasNext();){var r=i.next();if(r!==n){var s=t.locateInGeometry(e,r);if(s!==he.EXTERIOR)return s}}return he.EXTERIOR}},{key:"locate",value:function(e,n){return n.isEmpty()?he.EXTERIOR:t.locateInGeometry(e,n)}}]),t}();sn.constructor_=function(){this._geom=null;var t=arguments[0];this._geom=t};var on=Object.freeze({__proto__:null,IndexedPointInAreaLocator:Qe,PointOnGeometryLocator:Xe,SimplePointInAreaLocator:sn}),an=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"measure",value:function(t,e){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();an.constructor_=function(){};var un=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"measure",value:function(t,e){return t.intersection(e).getArea()/t.union(e).getArea()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[an]}}]),t}();un.constructor_=function(){};var ln=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"measure",value:function(e,n){var i=Be.distance(e,n,t.DENSIFY_FRACTION),r=new T(e.getEnvelopeInternal());return r.expandToInclude(n.getEnvelopeInternal()),1-i/t.diagonalSize(r)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[an]}}],[{key:"diagonalSize",value:function(t){if(t.isNull())return 0;var e=t.getWidth(),n=t.getHeight();return Math.sqrt(e*e+n*n)}}]),t}();ln.constructor_=function(){},ln.DENSIFY_FRACTION=.25;var hn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"combine",value:function(t,e){return Math.min(t,e)}}]),t}();hn.constructor_=function(){};var cn=Object.freeze({__proto__:null,AreaSimilarityMeasure:un,HausdorffSimilarityMeasure:ln,SimilarityMeasure:an,SimilarityMeasureCombiner:hn}),fn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setAreaBasePoint",value:function(t){this._areaBasePt=t}},{key:"addPoint",value:function(t){this._ptCount+=1,this._ptCentSum.x+=t.x,this._ptCentSum.y+=t.y}},{key:"addLineSegments",value:function(t){for(var e=0,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);if(0!==i){e+=i;var r=(t[n].x+t[n+1].x)/2;this._lineCentSum.x+=i*r;var s=(t[n].y+t[n+1].y)/2;this._lineCentSum.y+=i*s}}this._totalLength+=e,0===e&&t.length>0&&this.addPoint(t[0])}},{key:"addHole",value:function(t){for(var e=G.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this._areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)}},{key:"getCentroid",value:function(){var t=new k;if(Math.abs(this._areasum2)>0)t.x=this._cg3.x/3/this._areasum2,t.y=this._cg3.y/3/this._areasum2;else if(this._totalLength>0)t.x=this._lineCentSum.x/this._totalLength,t.y=this._lineCentSum.y/this._totalLength;else{if(!(this._ptCount>0))return null;t.x=this._ptCentSum.x/this._ptCount,t.y=this._ptCentSum.y/this._ptCount}return t}},{key:"addShell",value:function(t){t.length>0&&this.setAreaBasePoint(t[0]);for(var e=!G.isCCW(t),n=0;n<t.length-1;n++)this.addTriangle(this._areaBasePt,t[n],t[n+1],e);this.addLineSegments(t)}},{key:"addTriangle",value:function(e,n,i,r){var s=r?1:-1;t.centroid3(e,n,i,this._triangleCent3);var o=t.area2(e,n,i);this._cg3.x+=s*o*this._triangleCent3.x,this._cg3.y+=s*o*this._triangleCent3.y,this._areasum2+=s*o}},{key:"add",value:function(){if(arguments[0]instanceof Vt){var t=arguments[0];this.addShell(t.getExteriorRing().getCoordinates());for(var e=0;e<t.getNumInteriorRing();e++)this.addHole(t.getInteriorRingN(e).getCoordinates())}else if(arguments[0]instanceof W){var n=arguments[0];if(n.isEmpty())return null;if(n instanceof At)this.addPoint(n.getCoordinate());else if(n instanceof Ft)this.addLineSegments(n.getCoordinates());else if(n instanceof Vt){var i=n;this.add(i)}else if(n instanceof Et)for(var r=n,s=0;s<r.getNumGeometries();s++)this.add(r.getGeometryN(s))}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"area2",value:function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}},{key:"centroid3",value:function(t,e,n,i){return i.x=t.x+e.x+n.x,i.y=t.y+e.y+n.y,null}},{key:"getCentroid",value:function(e){return new t(e).getCentroid()}}]),t}();function dn(t){this.message=t||""}function gn(){this.array_=[]}fn.constructor_=function(){this._areaBasePt=null,this._triangleCent3=new k,this._areasum2=0,this._cg3=new k,this._lineCentSum=new k,this._totalLength=0,this._ptCount=0,this._ptCentSum=new k;var t=arguments[0];this._areaBasePt=null,this.add(t)},dn.prototype=new Error,dn.prototype.name="EmptyStackException",gn.prototype=new S,gn.prototype.add=function(t){return this.array_.push(t),!0},gn.prototype.get=function(t){if(t<0||t>=this.size())throw new I;return this.array_[t]},gn.prototype.push=function(t){return this.array_.push(t),t},gn.prototype.pop=function(t){if(0===this.array_.length)throw new dn;return this.array_.pop()},gn.prototype.peek=function(){if(0===this.array_.length)throw new dn;return this.array_[this.array_.length-1]},gn.prototype.empty=function(){return 0===this.array_.length},gn.prototype.isEmpty=function(){return this.empty()},gn.prototype.search=function(t){return this.array_.indexOf(t)},gn.prototype.size=function(){return this.array_.length},gn.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var vn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){this.treeSet.contains(t)||(this.list.add(t),this.treeSet.add(t))}},{key:"getCoordinates",value:function(){var t=new Array(this.list.size()).fill(null);return this.list.toArray(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[H]}}],[{key:"filterCoordinates",value:function(e){for(var n=new t,i=0;i<e.length;i++)n.filter(e[i]);return n.getCoordinates()}}]),t}();vn.constructor_=function(){this.treeSet=new _t,this.list=new N};var _n=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"preSort",value:function(t){for(var e=null,n=1;n<t.length;n++)(t[n].y<t[0].y||t[n].y===t[0].y&&t[n].x<t[0].x)&&(e=t[0],t[0]=t[n],t[n]=e);return pt.sort(t,1,t.length,new yn(t[0])),t}},{key:"computeOctRing",value:function(t){var e=this.computeOctPts(t),n=new R;return n.add(e,!1),n.size()<3?null:(n.closeRing(),n.toCoordinateArray())}},{key:"lineOrPolygon",value:function(t){if(3===(t=this.cleanRing(t)).length)return this._geomFactory.createLineString([t[0],t[1]]);var e=this._geomFactory.createLinearRing(t);return this._geomFactory.createPolygon(e)}},{key:"cleanRing",value:function(t){m.equals(t[0],t[t.length-1]);for(var e=new N,n=null,i=0;i<=t.length-2;i++){var r=t[i],s=t[i+1];r.equals(s)||null!==n&&this.isBetween(n,r,s)||(e.add(r),n=r)}e.add(t[t.length-1]);var o=new Array(e.size()).fill(null);return e.toArray(o)}},{key:"isBetween",value:function(t,e,n){if(0!==G.index(t,e,n))return!1;if(t.x!==n.x){if(t.x<=e.x&&e.x<=n.x)return!0;if(n.x<=e.x&&e.x<=t.x)return!0}if(t.y!==n.y){if(t.y<=e.y&&e.y<=n.y)return!0;if(n.y<=e.y&&e.y<=t.y)return!0}return!1}},{key:"reduce",value:function(t){var e=this.computeOctRing(t);if(null===e)return t;for(var n=new _t,i=0;i<e.length;i++)n.add(e[i]);for(var r=0;r<t.length;r++)en.isInRing(t[r],e)||n.add(t[r]);var s=$.toCoordinateArray(n);return s.length<3?this.padArray3(s):s}},{key:"getConvexHull",value:function(){if(0===this._inputPts.length)return this._geomFactory.createGeometryCollection();if(1===this._inputPts.length)return this._geomFactory.createPoint(this._inputPts[0]);if(2===this._inputPts.length)return this._geomFactory.createLineString(this._inputPts);var t=this._inputPts;this._inputPts.length>50&&(t=this.reduce(this._inputPts));var e=this.preSort(t),n=this.grahamScan(e),i=this.toCoordinateArray(n);return this.lineOrPolygon(i)}},{key:"padArray3",value:function(t){for(var e=new Array(3).fill(null),n=0;n<e.length;n++)n<t.length?e[n]=t[n]:e[n]=t[0];return e}},{key:"computeOctPts",value:function(t){for(var e=new Array(8).fill(null),n=0;n<e.length;n++)e[n]=t[0];for(var i=1;i<t.length;i++)t[i].x<e[0].x&&(e[0]=t[i]),t[i].x-t[i].y<e[1].x-e[1].y&&(e[1]=t[i]),t[i].y>e[2].y&&(e[2]=t[i]),t[i].x+t[i].y>e[3].x+e[3].y&&(e[3]=t[i]),t[i].x>e[4].x&&(e[4]=t[i]),t[i].x-t[i].y>e[5].x-e[5].y&&(e[5]=t[i]),t[i].y<e[6].y&&(e[6]=t[i]),t[i].x+t[i].y<e[7].x+e[7].y&&(e[7]=t[i]);return e}},{key:"toCoordinateArray",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<t.size();n++){var i=t.get(n);e[n]=i}return e}},{key:"grahamScan",value:function(t){var e=null,n=new gn;n.push(t[0]),n.push(t[1]),n.push(t[2]);for(var i=3;i<t.length;i++){for(e=n.pop();!n.empty()&&G.index(n.peek(),e,t[i])>0;)e=n.pop();n.push(e),n.push(t[i])}return n.push(t[0]),n}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"extractCoordinates",value:function(t){var e=new vn;return t.apply(e),e.getCoordinates()}}]),t}(),yn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(e,n){var i=e,r=n;return t.polarCompare(this._origin,i,r)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}],[{key:"polarCompare",value:function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=n.x-t.x,o=n.y-t.y,a=G.index(t,e,n);if(a===G.COUNTERCLOCKWISE)return 1;if(a===G.CLOCKWISE)return-1;var u=i*i+r*r,l=s*s+o*o;return u<l?-1:u>l?1:0}}]),t}();yn.constructor_=function(){this._origin=null;var t=arguments[0];this._origin=t},_n.RadialComparator=yn,_n.constructor_=function(){if(this._geomFactory=null,this._inputPts=null,1===arguments.length){var t=arguments[0];_n.constructor_.call(this,_n.extractCoordinates(t),t.getFactory())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._inputPts=vn.filterCoordinates(e),this._geomFactory=n}};var pn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addPolygon",value:function(e){if(e.isEmpty())return null;var n=null,i=null,r=this.horizontalBisector(e);if(0===r.getLength())i=0,n=r.getCoordinate();else{var s=r.intersection(e),o=this.widestGeometry(s);i=o.getEnvelopeInternal().getWidth(),n=t.centre(o.getEnvelopeInternal())}(null===this._interiorPoint||i>this._maxWidth)&&(this._interiorPoint=n,this._maxWidth=i)}},{key:"getInteriorPoint",value:function(){return this._interiorPoint}},{key:"widestGeometry",value:function(){if(arguments[0]instanceof Et){var t=arguments[0];if(t.isEmpty())return t;for(var e=t.getGeometryN(0),n=1;n<t.getNumGeometries();n++)t.getGeometryN(n).getEnvelopeInternal().getWidth()>e.getEnvelopeInternal().getWidth()&&(e=t.getGeometryN(n));return e}if(arguments[0]instanceof W){var i=arguments[0];return i instanceof Et?this.widestGeometry(i):i}}},{key:"horizontalBisector",value:function(t){var e=t.getEnvelopeInternal(),n=mn.getBisectorY(t);return this._factory.createLineString([new k(e.getMinX(),n),new k(e.getMaxX(),n)])}},{key:"add",value:function(t){if(t instanceof Vt)this.addPolygon(t);else if(t instanceof Et)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"centre",value:function(e){return new k(t.avg(e.getMinX(),e.getMaxX()),t.avg(e.getMinY(),e.getMaxY()))}},{key:"avg",value:function(t,e){return(t+e)/2}}]),t}(),mn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"updateInterval",value:function(t){t<=this._centreY?t>this._loY&&(this._loY=t):t>this._centreY&&t<this._hiY&&(this._hiY=t)}},{key:"getBisectorY",value:function(){this.process(this._poly.getExteriorRing());for(var t=0;t<this._poly.getNumInteriorRing();t++)this.process(this._poly.getInteriorRingN(t));return pn.avg(this._hiY,this._loY)}},{key:"process",value:function(t){for(var e=t.getCoordinateSequence(),n=0;n<e.size();n++){var i=e.getY(n);this.updateInterval(i)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getBisectorY",value:function(e){return new t(e).getBisectorY()}}]),t}();mn.constructor_=function(){this._poly=null,this._centreY=null,this._hiY=o.MAX_VALUE,this._loY=-o.MAX_VALUE;var t=arguments[0];this._poly=t,this._hiY=t.getEnvelopeInternal().getMaxY(),this._loY=t.getEnvelopeInternal().getMinY(),this._centreY=pn.avg(this._loY,this._hiY)},pn.SafeBisectorFinder=mn,pn.constructor_=function(){this._factory=null,this._interiorPoint=null,this._maxWidth=0;var t=arguments[0];this._factory=t.getFactory(),this.add(t)};var kn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addEndpoints",value:function(){if(arguments[0]instanceof W){var t=arguments[0];if(t instanceof Ft)this.addEndpoints(t.getCoordinates());else if(t instanceof Et)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addEndpoints(e.getGeometryN(n))}else if(arguments[0]instanceof Array){var i=arguments[0];this.add(i[0]),this.add(i[i.length-1])}}},{key:"getInteriorPoint",value:function(){return this._interiorPoint}},{key:"addInterior",value:function(){if(arguments[0]instanceof W){var t=arguments[0];if(t instanceof Ft)this.addInterior(t.getCoordinates());else if(t instanceof Et)for(var e=t,n=0;n<e.getNumGeometries();n++)this.addInterior(e.getGeometryN(n))}else if(arguments[0]instanceof Array)for(var i=arguments[0],r=1;r<i.length-1;r++)this.add(i[r])}},{key:"add",value:function(t){var e=t.distance(this._centroid);e<this._minDistance&&(this._interiorPoint=new k(t),this._minDistance=e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();kn.constructor_=function(){this._centroid=null,this._minDistance=o.MAX_VALUE,this._interiorPoint=null;var t=arguments[0];t.isEmpty()?this._centroid=new k:this._centroid=fn.getCentroid(t),this.addInterior(t),null===this._interiorPoint&&this.addEndpoints(t)};var xn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getInteriorPoint",value:function(){return this._interiorPoint}},{key:"add",value:function(){if(arguments[0]instanceof W){var t=arguments[0];if(t instanceof At)this.add(t.getCoordinate());else if(t instanceof Et)for(var e=t,n=0;n<e.getNumGeometries();n++)this.add(e.getGeometryN(n))}else if(arguments[0]instanceof k){var i=arguments[0],r=i.distance(this._centroid);r<this._minDistance&&(this._interiorPoint=new k(i),this._minDistance=r)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();xn.constructor_=function(){this._centroid=null,this._minDistance=o.MAX_VALUE,this._interiorPoint=null;var t=arguments[0];this._centroid=t.getCentroid().getCoordinate(),this.add(t)};var En=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"locateInPolygonRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?en.locateInRing(t,e.getCoordinates()):he.EXTERIOR}},{key:"intersects",value:function(t,e){return this.locate(t,e)!==he.EXTERIOR}},{key:"updateLocationInfo",value:function(t){t===he.INTERIOR&&(this._isIn=!0),t===he.BOUNDARY&&this._numBoundaries++}},{key:"computeLocation",value:function(t,e){if(e instanceof At&&this.updateLocationInfo(this.locateOnPoint(t,e)),e instanceof Ft)this.updateLocationInfo(this.locateOnLineString(t,e));else if(e instanceof Vt)this.updateLocationInfo(this.locateInPolygon(t,e));else if(e instanceof Ct)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateOnLineString(t,r))}else if(e instanceof Yt)for(var s=e,o=0;o<s.getNumGeometries();o++){var a=s.getGeometryN(o);this.updateLocationInfo(this.locateInPolygon(t,a))}else if(e instanceof Et)for(var u=new rn(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}}},{key:"locateOnPoint",value:function(t,e){return e.getCoordinate().equals2D(t)?he.INTERIOR:he.EXTERIOR}},{key:"locateOnLineString",value:function(t,e){if(!e.getEnvelopeInternal().intersects(t))return he.EXTERIOR;var n=e.getCoordinateSequence();return e.isClosed()||!t.equals(n.getCoordinate(0))&&!t.equals(n.getCoordinate(n.size()-1))?en.isOnLine(t,n)?he.INTERIOR:he.EXTERIOR:he.BOUNDARY}},{key:"locateInPolygon",value:function(t,e){if(e.isEmpty())return he.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===he.EXTERIOR)return he.EXTERIOR;if(i===he.BOUNDARY)return he.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var s=e.getInteriorRingN(r),o=this.locateInPolygonRing(t,s);if(o===he.INTERIOR)return he.EXTERIOR;if(o===he.BOUNDARY)return he.BOUNDARY}return he.INTERIOR}},{key:"locate",value:function(t,e){return e.isEmpty()?he.EXTERIOR:e instanceof Ft?this.locateOnLineString(t,e):e instanceof Vt?this.locateInPolygon(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?he.BOUNDARY:this._numBoundaries>0||this._isIn?he.INTERIOR:he.EXTERIOR)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();En.constructor_=function(){if(this._boundaryRule=j.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new n("Rule must be non-null");this._boundaryRule=t}};var Cn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getRadius",value:function(){return this.compute(),this._radius}},{key:"getDiameter",value:function(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[1];return this._input.getFactory().createLineString([t,e])}},{key:"getExtremalPoints",value:function(){return this.compute(),this._extremalPts}},{key:"computeCirclePoints",value:function(){if(this._input.isEmpty())return this._extremalPts=new Array(0).fill(null),null;if(1===this._input.getNumPoints()){var e=this._input.getCoordinates();return this._extremalPts=[new k(e[0])],null}var n=this._input.convexHull().getCoordinates(),i=n;if(n[0].equals2D(n[n.length-1])&&(i=new Array(n.length-1).fill(null),$.copyDeep(n,0,i,0,n.length-1)),i.length<=2)return this._extremalPts=$.copyDeep(i),null;for(var r=t.lowestPoint(i),s=t.pointWitMinAngleWithX(i,r),o=0;o<i.length;o++){var a=t.pointWithMinAngleWithSegment(i,r,s);if(fe.isObtuse(r,a,s))return this._extremalPts=[new k(r),new k(s)],null;if(fe.isObtuse(a,r,s))r=a;else{if(!fe.isObtuse(a,s,r))return this._extremalPts=[new k(r),new k(s),new k(a)],null;s=a}}m.shouldNeverReachHere("Logic failure in Minimum Bounding Circle algorithm!")}},{key:"compute",value:function(){if(null!==this._extremalPts)return null;this.computeCirclePoints(),this.computeCentre(),null!==this._centre&&(this._radius=this._centre.distance(this._extremalPts[0]))}},{key:"getFarthestPoints",value:function(){switch(this.compute(),this._extremalPts.length){case 0:return this._input.getFactory().createLineString();case 1:return this._input.getFactory().createPoint(this._centre)}var t=this._extremalPts[0],e=this._extremalPts[this._extremalPts.length-1];return this._input.getFactory().createLineString([t,e])}},{key:"getCircle",value:function(){if(this.compute(),null===this._centre)return this._input.getFactory().createPolygon();var t=this._input.getFactory().createPoint(this._centre);return 0===this._radius?t:t.buffer(this._radius)}},{key:"getCentre",value:function(){return this.compute(),this._centre}},{key:"computeCentre",value:function(){switch(this._extremalPts.length){case 0:this._centre=null;break;case 1:this._centre=this._extremalPts[0];break;case 2:this._centre=new k((this._extremalPts[0].x+this._extremalPts[1].x)/2,(this._extremalPts[0].y+this._extremalPts[1].y)/2);break;case 3:this._centre=de.circumcentre(this._extremalPts[0],this._extremalPts[1],this._extremalPts[2])}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"pointWitMinAngleWithX",value:function(t,e){for(var n=o.MAX_VALUE,i=null,r=0;r<t.length;r++){var s=t[r];if(s!==e){var a=s.x-e.x,u=s.y-e.y;u<0&&(u=-u);var l=u/Math.sqrt(a*a+u*u);l<n&&(n=l,i=s)}}return i}},{key:"lowestPoint",value:function(t){for(var e=t[0],n=1;n<t.length;n++)t[n].y<e.y&&(e=t[n]);return e}},{key:"pointWithMinAngleWithSegment",value:function(t,e,n){for(var i=o.MAX_VALUE,r=null,s=0;s<t.length;s++){var a=t[s];if(a!==e&&a!==n){var u=fe.angleBetween(e,a,n);u<i&&(i=u,r=a)}}return r}}]),t}();Cn.constructor_=function(){this._input=null,this._extremalPts=null,this._centre=null,this._radius=0;var t=arguments[0];this._input=t};var In=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getWidthCoordinate",value:function(){return this.computeMinimumDiameter(),this._minWidthPt}},{key:"getSupportingSegment",value:function(){return this.computeMinimumDiameter(),this._inputGeom.getFactory().createLineString([this._minBaseSeg.p0,this._minBaseSeg.p1])}},{key:"getDiameter",value:function(){if(this.computeMinimumDiameter(),null===this._minWidthPt)return this._inputGeom.getFactory().createLineString();var t=this._minBaseSeg.project(this._minWidthPt);return this._inputGeom.getFactory().createLineString([t,this._minWidthPt])}},{key:"computeWidthConvex",value:function(t){this._convexHullPts=t instanceof Vt?t.getExteriorRing().getCoordinates():t.getCoordinates(),0===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=null,this._minBaseSeg=null):1===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[0]):2===this._convexHullPts.length||3===this._convexHullPts.length?(this._minWidth=0,this._minWidthPt=this._convexHullPts[0],this._minBaseSeg.p0=this._convexHullPts[0],this._minBaseSeg.p1=this._convexHullPts[1]):this.computeConvexRingMinDiameter(this._convexHullPts)}},{key:"computeConvexRingMinDiameter",value:function(t){this._minWidth=o.MAX_VALUE;for(var e=1,n=new le,i=0;i<t.length-1;i++)n.p0=t[i],n.p1=t[i+1],e=this.findMaxPerpDistance(t,n,e)}},{key:"computeMinimumDiameter",value:function(){if(null!==this._minWidthPt)return null;if(this._isConvex)this.computeWidthConvex(this._inputGeom);else{var t=new _n(this._inputGeom).getConvexHull();this.computeWidthConvex(t)}}},{key:"getLength",value:function(){return this.computeMinimumDiameter(),this._minWidth}},{key:"findMaxPerpDistance",value:function(e,n,i){for(var r=n.distancePerpendicular(e[i]),s=r,o=i,a=o;s>=r;)r=s,o=a,a=t.nextIndex(e,o),s=n.distancePerpendicular(e[a]);return r<this._minWidth&&(this._minPtIndex=o,this._minWidth=r,this._minWidthPt=e[this._minPtIndex],this._minBaseSeg=new le(n)),o}},{key:"getMinimumRectangle",value:function(){if(this.computeMinimumDiameter(),0===this._minWidth)return this._minBaseSeg.p0.equals2D(this._minBaseSeg.p1)?this._inputGeom.getFactory().createPoint(this._minBaseSeg.p0):this._minBaseSeg.toGeometry(this._inputGeom.getFactory());for(var e=this._minBaseSeg.p1.x-this._minBaseSeg.p0.x,n=this._minBaseSeg.p1.y-this._minBaseSeg.p0.y,i=o.MAX_VALUE,r=-o.MAX_VALUE,s=o.MAX_VALUE,a=-o.MAX_VALUE,u=0;u<this._convexHullPts.length;u++){var l=t.computeC(e,n,this._convexHullPts[u]);l>r&&(r=l),l<i&&(i=l);var h=t.computeC(-n,e,this._convexHullPts[u]);h>a&&(a=h),h<s&&(s=h)}var c=t.computeSegmentForLine(-e,-n,a),f=t.computeSegmentForLine(-e,-n,s),d=t.computeSegmentForLine(-n,e,r),g=t.computeSegmentForLine(-n,e,i),v=d.lineIntersection(c),_=g.lineIntersection(c),y=g.lineIntersection(f),p=d.lineIntersection(f),m=this._inputGeom.getFactory().createLinearRing([v,_,y,p,v]);return this._inputGeom.getFactory().createPolygon(m)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"nextIndex",value:function(t,e){return++e>=t.length&&(e=0),e}},{key:"computeC",value:function(t,e,n){return t*n.y-e*n.x}},{key:"getMinimumDiameter",value:function(e){return new t(e).getDiameter()}},{key:"getMinimumRectangle",value:function(e){return new t(e).getMinimumRectangle()}},{key:"computeSegmentForLine",value:function(t,e,n){var i=null,r=null;return Math.abs(e)>Math.abs(t)?(i=new k(0,n/e),r=new k(1,n/e-t/e)):(i=new k(n/t,0),r=new k(n/t-e/t,1)),new le(i,r)}}]),t}();In.constructor_=function(){if(this._inputGeom=null,this._isConvex=null,this._convexHullPts=null,this._minBaseSeg=new le,this._minWidthPt=null,this._minPtIndex=null,this._minWidth=0,1===arguments.length){var t=arguments[0];In.constructor_.call(this,t,!1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._inputGeom=e,this._isConvex=n}};var Sn=Object.freeze({__proto__:null,distance:qe,locate:on,match:cn,Angle:fe,Area:Gt,Centroid:fn,ConvexHull:_n,Distance:q,InteriorPointArea:pn,InteriorPointLine:kn,InteriorPointPoint:xn,Length:wt,Orientation:G,PointLocation:en,PointLocator:En,RobustLineIntersector:ue,MinimumBoundingCircle:Cn,MinimumDiameter:In}),wn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getResultGeometry",value:function(){return new Nn(this._distanceTolerance).transform(this._inputGeom)}},{key:"setDistanceTolerance",value:function(t){if(t<=0)throw new n("Tolerance must be positive");this._distanceTolerance=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"densifyPoints",value:function(t,e,n){for(var i=new le,r=new R,s=0;s<t.length-1;s++){i.p0=t[s],i.p1=t[s+1],r.add(i.p0,!1);var o=i.getLength(),a=Math.trunc(o/e)+1;if(a>1)for(var u=o/a,l=1;l<a;l++){var h=l*u/o,c=i.pointAlong(h);n.makePrecise(c),r.add(c,!1)}}return r.add(t[t.length-1],!1),r.toCoordinateArray()}},{key:"densify",value:function(e,n){var i=new t(e);return i.setDistanceTolerance(n),i.getResultGeometry()}}]),t}(),Nn=function(t){s(n,Se);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"transformMultiPolygon",value:function(t,e){var r=i(c(n.prototype),"transformMultiPolygon",this).call(this,t,e);return this.createValidArea(r)}},{key:"transformPolygon",value:function(t,e){var r=i(c(n.prototype),"transformPolygon",this).call(this,t,e);return e instanceof Yt?r:this.createValidArea(r)}},{key:"transformCoordinates",value:function(t,e){var n=t.toCoordinateArray(),i=wn.densifyPoints(n,this.distanceTolerance,e.getPrecisionModel());return e instanceof Ft&&1===i.length&&(i=new Array(0).fill(null)),this._factory.getCoordinateSequenceFactory().create(i)}},{key:"createValidArea",value:function(t){return t.buffer(0)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Nn.constructor_=function(){this.distanceTolerance=null;var t=arguments[0];this.distanceTolerance=t},wn.DensifyTransformer=Nn,wn.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null;var t=arguments[0];this._inputGeom=t};var Ln=Object.freeze({__proto__:null,Densifier:wn}),Rn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isNorthern",value:function(e){return e===t.NE||e===t.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&2==(t-e+4)%4}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n}},{key:"isInHalfPlane",value:function(e,n){return n===t.SE?e===t.SE||e===t.SW:e===n||e===n+1}},{key:"quadrant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new n("Cannot compute the quadrant for point ( "+e+", "+i+" )");return e>=0?i>=0?t.NE:t.SE:i>=0?t.NW:t.SW}if(arguments[0]instanceof k&&arguments[1]instanceof k){var r=arguments[0],s=arguments[1];if(s.x===r.x&&s.y===r.y)throw new n("Cannot compute the quadrant for two identical points "+r);return s.x>=r.x?s.y>=r.y?t.NE:t.SE:s.y>=r.y?t.NW:t.SW}}}]),t}();Rn.constructor_=function(){},Rn.NE=0,Rn.NW=1,Rn.SW=2,Rn.SE=3;var Tn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"find",value:function(t){var e=this;do{if(null===e)return null;if(e.dest().equals2D(t))return e;e=e.oNext()}while(e!==this);return null}},{key:"dest",value:function(){return this._sym._orig}},{key:"oNext",value:function(){return this._sym._next}},{key:"insert",value:function(t){if(this.oNext()===this)return this.insertAfter(t),null;var e=this.compareTo(t),n=this;do{var i=n.oNext();if(i.compareTo(t)!==e||i===this)return n.insertAfter(t),null;n=i}while(n!==this);m.shouldNeverReachHere()}},{key:"insertAfter",value:function(t){m.equals(this._orig,t.orig());var e=this.oNext();this._sym.setNext(t),t.sym().setNext(e)}},{key:"degree",value:function(){var t=0,e=this;do{t++,e=e.oNext()}while(e!==this);return t}},{key:"equals",value:function(){if(2===arguments.length&&arguments[1]instanceof k&&arguments[0]instanceof k){var t=arguments[0],e=arguments[1];return this._orig.equals2D(t)&&this._sym._orig.equals(e)}}},{key:"deltaY",value:function(){return this._sym._orig.y-this._orig.y}},{key:"sym",value:function(){return this._sym}},{key:"prev",value:function(){return this._sym.next()._sym}},{key:"compareAngularDirection",value:function(t){var e=this.deltaX(),n=this.deltaY(),i=t.deltaX(),r=t.deltaY();if(e===i&&n===r)return 0;var s=Rn.quadrant(e,n),o=Rn.quadrant(i,r);return s>o?1:s<o?-1:G.index(t._orig,t.dest(),this.dest())}},{key:"prevNode",value:function(){for(var t=this;2===t.degree();)if((t=t.prev())===this)return null;return t}},{key:"compareTo",value:function(t){var e=t;return this.compareAngularDirection(e)}},{key:"next",value:function(){return this._next}},{key:"setSym",value:function(t){this._sym=t}},{key:"orig",value:function(){return this._orig}},{key:"toString",value:function(){return"HE("+this._orig.x+" "+this._orig.y+", "+this._sym._orig.x+" "+this._sym._orig.y+")"}},{key:"setNext",value:function(t){this._next=t}},{key:"init",value:function(t){this.setSym(t),t.setSym(this),this.setNext(t),t.setNext(this)}},{key:"deltaX",value:function(){return this._sym._orig.x-this._orig.x}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"init",value:function(t,e){if(null!==t._sym||null!==e._sym||null!==t._next||null!==e._next)throw new IllegalStateException("Edges are already initialized");return t.init(e),t}},{key:"create",value:function(e,n){var i=new t(e),r=new t(n);return i.init(r),i}}]),t}();Tn.constructor_=function(){this._orig=null,this._sym=null,this._next=null;var t=arguments[0];this._orig=t};var bn=function(t){s(n,Tn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"mark",value:function(){this._isMarked=!0}},{key:"setMark",value:function(t){this._isMarked=t}},{key:"isMarked",value:function(){return this._isMarked}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"setMarkBoth",value:function(t,e){t.setMark(e),t.sym().setMark(e)}},{key:"isMarked",value:function(t){return t.isMarked()}},{key:"setMark",value:function(t,e){t.setMark(e)}},{key:"markBoth",value:function(t){t.mark(),t.sym().mark()}},{key:"mark",value:function(t){t.mark()}}]),n}();bn.constructor_=function(){this._isMarked=!1;var t=arguments[0];Tn.constructor_.call(this,t)};var Pn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insert",value:function(t,e,n){var i=this.create(t,e);null!==n?n.insert(i):this._vertexMap.put(t,i);var r=this._vertexMap.get(e);return null!==r?r.insert(i.sym()):this._vertexMap.put(e,i.sym()),i}},{key:"create",value:function(t,e){var n=this.createEdge(t),i=this.createEdge(e);return Tn.init(n,i),n}},{key:"createEdge",value:function(t){return new Tn(t)}},{key:"addEdge",value:function(e,n){if(!t.isValidEdge(e,n))return null;var i=this._vertexMap.get(e),r=null;return null!==i&&(r=i.find(n)),null!==r?r:this.insert(e,n,i)}},{key:"getVertexEdges",value:function(){return this._vertexMap.values()}},{key:"findEdge",value:function(t,e){var n=this._vertexMap.get(t);return null===n?null:n.find(e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isValidEdge",value:function(t,e){return 0!==e.compareTo(t)}}]),t}();Pn.constructor_=function(){this._vertexMap=new Jt};var Mn=function(t){s(n,bn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"setStart",value:function(){this._isStart=!0}},{key:"isStart",value:function(){return this._isStart}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Mn.constructor_=function(){this._isStart=!1;var t=arguments[0];bn.constructor_.call(this,t)};var On=function(t){s(n,Pn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"createEdge",value:function(t){return new Mn(t)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();On.constructor_=function(){};var Fn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addLine",value:function(t){this._lines.add(this._factory.createLineString(t.toCoordinateArray()))}},{key:"updateRingStartEdge",value:function(t){return t.isStart()||(t=t.sym()).isStart()?null===this._ringStartEdge?(this._ringStartEdge=t,null):void(t.orig().compareTo(this._ringStartEdge.orig())<0&&(this._ringStartEdge=t)):null}},{key:"getResult",value:function(){return null===this._result&&this.computeResult(),this._result}},{key:"process",value:function(t){var e=t.prevNode();null===e&&(e=t),this.stackEdges(e),this.buildLines()}},{key:"buildRing",value:function(t){var e=new R,n=t;for(e.add(n.orig().copy(),!1);2===n.sym().degree();){var i=n.next();if(i===t)break;e.add(i.orig().copy(),!1),n=i}e.add(n.dest().copy(),!1),this.addLine(e)}},{key:"buildLine",value:function(t){var e=new R,n=t;for(this._ringStartEdge=null,bn.markBoth(n),e.add(n.orig().copy(),!1);2===n.sym().degree();){this.updateRingStartEdge(n);var i=n.next();if(i===t)return this.buildRing(this._ringStartEdge),null;e.add(i.orig().copy(),!1),n=i,bn.markBoth(n)}e.add(n.dest().clone(),!1),this.stackEdges(n.sym()),this.addLine(e)}},{key:"stackEdges",value:function(t){var e=t;do{bn.isMarked(e)||this._nodeEdgeStack.add(e),e=e.oNext()}while(e!==t)}},{key:"computeResult",value:function(){for(var t=this._graph.getVertexEdges().iterator();t.hasNext();){var e=t.next();bn.isMarked(e)||this.process(e)}this._result=this._factory.buildGeometry(this._lines)}},{key:"buildLines",value:function(){for(;!this._nodeEdgeStack.empty();){var t=this._nodeEdgeStack.pop();bn.isMarked(t)||this.buildLine(t)}}},{key:"add",value:function(){if(arguments[0]instanceof W)arguments[0].apply(new(function(){function t(){f(this,t)}return g(t,[{key:"filter",value:function(t){t instanceof Ft&&this.add(t)}},{key:"interfaces_",get:function(){return[U]}}]),t}()));else if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){var n=arguments[0];null===this._factory&&(this._factory=n.getFactory());for(var i=n.getCoordinateSequence(),r=!1,s=1;s<i.size();s++){var o=this._graph.addEdge(i.getCoordinate(s-1),i.getCoordinate(s));null!==o&&(r||(o.setStart(),r=!0))}}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"dissolve",value:function(e){var n=new t;return n.add(e),n.getResult()}}]),t}();Fn.constructor_=function(){this._result=null,this._factory=null,this._graph=null,this._lines=new N,this._nodeEdgeStack=new gn,this._ringStartEdge=null,this._graph=new On};var Dn=Object.freeze({__proto__:null,LineDissolver:Fn}),An=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"opposite",value:function(e){return e===t.LEFT?t.RIGHT:e===t.RIGHT?t.LEFT:e}}]),t}();An.constructor_=function(){},An.ON=0,An.LEFT=1,An.RIGHT=2;var Gn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"computeIntersections",value:function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Gn.constructor_=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};var Bn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isDelete",value:function(){return this._eventType===t.DELETE}},{key:"setDeleteEventIndex",value:function(t){this._deleteEventIndex=t}},{key:"getObject",value:function(){return this._obj}},{key:"compareTo",value:function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0}},{key:"getInsertEvent",value:function(){return this._insertEvent}},{key:"isInsert",value:function(){return this._eventType===t.INSERT}},{key:"isSameLabel",value:function(t){return null!==this._label&&this._label===t._label}},{key:"getDeleteEventIndex",value:function(){return this._deleteEventIndex}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();Bn.constructor_=function(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this._eventType=Bn.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._eventType=Bn.INSERT,this._label=n,this._xValue=i,this._obj=r}},Bn.INSERT=1,Bn.DELETE=2;var Vn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Vn.constructor_=function(){};var zn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isTrivialIntersection",value:function(e,n,i,r){if(e===i&&1===this._li.getIntersectionNum()){if(t.isAdjacentSegments(n,r))return!0;if(e.isClosed()){var s=e.getNumPoints()-1;if(0===n&&r===s||0===r&&n===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"setIsDoneIfProperInt",value:function(t){this._isDoneWhenProperInt=t}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"isBoundaryPointInternal",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return this._isDone}},{key:"isBoundaryPoint",value:function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))}},{key:"setBoundaryNodes",value:function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e}},{key:"addIntersections",value:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isAdjacentSegments",value:function(t,e){return 1===Math.abs(t-e)}}]),t}();zn.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};var qn=function(t){s(n,Vn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"prepareEvents",value:function(){Le.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}}},{key:"computeIntersections",value:function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof zn&&E(arguments[0],S)&&E(arguments[1],S)){var i=arguments[0],r=arguments[1],s=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(s)}else if("boolean"==typeof arguments[2]&&E(arguments[0],S)&&arguments[1]instanceof zn){var o=arguments[0],a=arguments[1];arguments[2]?this.addEdges(o,null):this.addEdges(o),this.computeIntersections(a)}}},{key:"addEdge",value:function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var s=new Gn(n,r),o=new Bn(e,n.getMinX(r),s);this.events.add(o),this.events.add(new Bn(n.getMaxX(r),o))}}},{key:"processOverlaps",value:function(t,e,n,i){for(var r=n.getObject(),s=t;s<e;s++){var o=this.events.get(s);if(o.isInsert()){var a=o.getObject();n.isSameLabel(o)||(r.computeIntersections(a,i),this.nOverlaps++)}}}},{key:"addEdges",value:function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();){var r=i.next();this.addEdge(r,n)}}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();qn.constructor_=function(){this.events=new N,this.nOverlaps=null};var Yn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==he.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===he.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return 1===this.location.length}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[An.ON]=this.location[An.ON],e[An.LEFT]=he.NONE,e[An.RIGHT]=he.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===he.NONE&&n<t.location.length&&(this.location[n]=t.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[An.LEFT];this.location[An.LEFT]=this.location[An.RIGHT],this.location[An.RIGHT]=t}},{key:"toString",value:function(){var t=new M;return this.location.length>1&&t.append(he.toLocationSymbol(this.location[An.LEFT])),t.append(he.toLocationSymbol(this.location[An.ON])),this.location.length>1&&t.append(he.toLocationSymbol(this.location[An.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,n){this.location[An.ON]=t,this.location[An.LEFT]=e,this.location[An.RIGHT]=n}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:he.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===he.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(1===arguments.length){var t=arguments[0];this.setLocation(An.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(he.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Yn.constructor_=function(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[An.ON]=e}else if(arguments[0]instanceof Yn){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.init(3),this.location[An.ON]=r,this.location[An.LEFT]=s,this.location[An.RIGHT]=o}};var Xn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Yn(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(An.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}}},{key:"toString",value:function(){var t=new M;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(An.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new Yn(this.elt[t].location[0]))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toLineLabel",value:function(e){for(var n=new t(he.NONE),i=0;i<2;i++)n.setLocation(i,e.getLocation(i));return n}}]),t}();Xn.constructor_=function(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new Yn(t),this.elt[1]=new Yn(t)}else if(arguments[0]instanceof Xn){var e=arguments[0];this.elt[0]=new Yn(e.elt[0]),this.elt[1]=new Yn(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new Yn(he.NONE),this.elt[1]=new Yn(he.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];this.elt[0]=new Yn(r,s,o),this.elt[1]=new Yn(r,s,o)}else if(4===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2],h=arguments[3];this.elt[0]=new Yn(he.NONE,he.NONE,he.NONE),this.elt[1]=new Yn(he.NONE,he.NONE,he.NONE),this.elt[a].setLocations(u,l,h)}};var Un=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}},{key:"compareTo",value:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)}},{key:"isEndPoint",value:function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();Un.constructor_=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new k(t),this.segmentIndex=e,this.dist=n};var Wn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}},{key:"addEndpoints",value:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}},{key:"createSplitEdge",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new k(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this.edge.pts[a];return r&&(s[o]=e.coord),new Jn(s,new Xn(this.edge._label))}},{key:"add",value:function(t,e,n){var i=new Un(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)}},{key:"isIntersection",value:function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Wn.constructor_=function(){this._nodeMap=new dt,this.edge=null;var t=arguments[0];this.edge=t};var Hn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getChainStartIndices",value:function(e){var n=0,i=new N;i.add(new O(n));do{var r=this.findChainEnd(e,n);i.add(new O(r)),n=r}while(n<e.length-1);return t.toIntArray(i)}},{key:"findChainEnd",value:function(t,e){for(var n=Rn.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Rn.quadrant(t[i-1],t[i])===n;)i++;return i-1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}}]),t}();Hn.constructor_=function(){};var jn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}},{key:"getMinX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}},{key:"computeIntersectsForChain",value:function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5];if(s-r==1&&u-a==1)return l.addIntersections(this.e,r,o.e,a),null;if(!this.overlaps(r,s,o,a,u))return null;var h=Math.trunc((r+s)/2),c=Math.trunc((a+u)/2);r<h&&(a<c&&this.computeIntersectsForChain(r,h,o,a,c,l),c<u&&this.computeIntersectsForChain(r,h,o,c,u,l)),h<s&&(a<c&&this.computeIntersectsForChain(h,s,o,a,c,l),c<u&&this.computeIntersectsForChain(h,s,o,c,u,l))}}},{key:"overlaps",value:function(t,e,n,i,r){return T.intersects(this.pts[t],this.pts[e],n.pts[i],n.pts[r])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();jn.constructor_=function(){this.e=null,this.pts=null,this.startIndex=null;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Hn;this.startIndex=e.getChainStartIndices(this.pts)};var Kn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,n){this._depth[t][e]=n}},{key:"isNull",value:function(){if(0===arguments.length){for(var e=0;e<2;e++)for(var n=0;n<3;n++)if(this._depth[e][n]!==t.NULL_VALUE)return!1;return!0}if(1===arguments.length){var i=arguments[0];return this._depth[i][1]===t.NULL_VALUE}if(2===arguments.length){var r=arguments[0],s=arguments[1];return this._depth[r][s]===t.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}}},{key:"getDelta",value:function(t){return this._depth[t][An.RIGHT]-this._depth[t][An.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?he.EXTERIOR:he.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(1===arguments.length)for(var e=arguments[0],n=0;n<2;n++)for(var i=1;i<3;i++){var r=e.getLocation(n,i);r!==he.EXTERIOR&&r!==he.INTERIOR||(this.isNull(n,i)?this._depth[n][i]=t.depthAtLocation(r):this._depth[n][i]+=t.depthAtLocation(r))}else if(3===arguments.length){var s=arguments[0],o=arguments[1];arguments[2]===he.INTERIOR&&this._depth[s][o]++}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"depthAtLocation",value:function(e){return e===he.EXTERIOR?0:e===he.INTERIOR?1:t.NULL_VALUE}}]),t}();Kn.constructor_=function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=Kn.NULL_VALUE},Kn.NULL_VALUE=-1;var Zn=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setVisited",value:function(t){this._isVisited=t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(t){this._label=t}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(t){this._isCovered=t,this._isCoveredSet=!0}},{key:"updateIM",value:function(t){m.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Zn.constructor_=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};var Jn=function(t){s(n,Zn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new n(t,Xn.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(t){this._isIsolated=t}},{key:"setName",value:function(t){this._name=t}},{key:"equals",value:function(t){if(!(t instanceof n))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var i=!0,r=!0,s=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(i=!1),this.pts[o].equals2D(e.pts[--s])||(r=!1),!i&&!r)return!1;return!0}},{key:"getCoordinate",value:function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}}},{key:"print",value:function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(t){n.updateIM(this._label,t)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")}},{key:"getMonotoneChainEdge",value:function(){return null===this._mce&&(this._mce=new jn(this)),this._mce}},{key:"getEnvelope",value:function(){if(null===this._env){this._env=new T;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env}},{key:"addIntersection",value:function(t,e,n,i){var r=new k(t.getIntersection(i)),s=e,o=t.getEdgeDistance(n,i),a=s+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(s=a,o=0)}this.eiList.add(r,s,o)}},{key:"toString",value:function(){var t=new Mt;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()}},{key:"isPointwiseEqual",value:function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0}},{key:"setDepthDelta",value:function(t){this._depthDelta=t}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"updateIM",value:function(){if(!(2===arguments.length&&arguments[1]instanceof ce&&arguments[0]instanceof Xn))return i(c(n),"updateIM",this).apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,An.ON),t.getLocation(1,An.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,An.LEFT),t.getLocation(1,An.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,An.RIGHT),t.getLocation(1,An.RIGHT),2))}}]),n}();Jn.constructor_=function(){if(this.pts=null,this._env=null,this.eiList=new Wn(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Kn,this._depthDelta=0,1===arguments.length){var t=arguments[0];Jn.constructor_.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.pts=e,this._label=n}};var Qn=function(t){s(n,Zn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isIncidentEdgeInResult",value:function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(t){t.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(t){}},{key:"computeMergedLocation",value:function(t,e){var n=he.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==he.BOUNDARY&&(n=i)}return n}},{key:"setLabel",value:function(){if(2!==arguments.length||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return i(c(n.prototype),"setLabel",this).apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new Xn(t,e):this._label.setLocation(t,e)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof n){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Xn)for(var e=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(e,i);this._label.getLocation(i)===he.NONE&&this._label.setLocation(i,r)}}},{key:"add",value:function(t){this._edges.insert(t),t.setNode(this)}},{key:"setLabelBoundary",value:function(t){if(null===this._label)return null;var e=he.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case he.BOUNDARY:n=he.INTERIOR;break;case he.INTERIOR:default:n=he.BOUNDARY}this._label.setLocation(t,n)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Qn.constructor_=function(){this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new Xn(0,he.NONE)};var $n=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"find",value:function(t){return this.nodeMap.get(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof k){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Qn){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}}},{key:"print",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(t){for(var e=new N,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===he.BOUNDARY&&e.add(i)}return e}},{key:"add",value:function(t){var e=t.getCoordinate();this.addNode(e).add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();$n.constructor_=function(){this.nodeMap=new dt,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};var ti=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:G.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Rn.quadrant(this._dx,this._dy),m.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();ti.constructor_=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];ti.constructor_.call(this,e,n,i,null)}else if(4===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2],a=arguments[3];ti.constructor_.call(this,r),this.init(s,o),this._label=a}};var ei=function(t){s(n,y);var e=a(n);function n(){var t;if(f(this,n),1===arguments.length){var i=arguments[0];t=e.call(this,i),y.call(l(t),i)}else{if(2!==arguments.length)throw Error();var r=arguments[0],s=arguments[1];(t=e.call(this,n.msgWithCoord(r,s))).name="TopologyException",t.pt=new k(s)}return u(t)}return g(n,[{key:"getCoordinate",value:function(){return this.pt}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"msgWithCoord",value:function(t,e){return null!==e?t+" [ "+e+" ]":t}}]),n}(),ni=function(t){s(n,ti);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(t){return this._depth[t]}},{key:"setVisited",value:function(t){this._isVisited=t}},{key:"computeDirectedLabel",value:function(){this._label=new Xn(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new ei("assigned depths do not match",this.getCoordinate());this._depth[t]=e}},{key:"isInteriorAreaEdge",value:function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,An.LEFT)===he.INTERIOR&&this._label.getLocation(e,An.RIGHT)===he.INTERIOR||(t=!1);return t}},{key:"setNextMin",value:function(t){this._nextMin=t}},{key:"print",value:function(t){i(c(n.prototype),"print",this).call(this,t),t.print(" "+this._depth[An.LEFT]+"/"+this._depth[An.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")}},{key:"setMinEdgeRing",value:function(t){this._minEdgeRing=t}},{key:"isLineEdge",value:function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,he.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,he.EXTERIOR);return t&&e&&n}},{key:"setEdgeRing",value:function(t){this._edgeRing=t}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)}},{key:"setSym",value:function(t){this._sym=t}},{key:"setVisitedEdge",value:function(t){this.setVisited(t),this._sym.setVisited(t)}},{key:"setEdgeDepths",value:function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===An.LEFT&&(i=-1);var r=An.opposite(t),s=e+n*i;this.setDepth(t,e),this.setDepth(r,s)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(t){this._next=t}},{key:"isVisited",value:function(){return this._isVisited}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"depthFactor",value:function(t,e){return t===he.EXTERIOR&&e===he.INTERIOR?1:t===he.INTERIOR&&e===he.EXTERIOR?-1:0}}]),n}();ni.constructor_=function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var t=arguments[0],e=arguments[1];if(ti.constructor_.call(this,t),this._isForward=e,e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()};var ii=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"createNode",value:function(t){return new Qn(t,null)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ii.constructor_=function(){};var ri=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"printEdges",value:function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}}},{key:"find",value:function(t){return this._nodes.find(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof Qn){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof k){var e=arguments[0];return this._nodes.addNode(e)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(t){B.out.println(t)}},{key:"isBoundaryNode",value:function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===he.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(t,e,n,i){return!!t.equals(n)&&G.index(t,e,i)===G.COLLINEAR&&Rn.quadrant(t,e)===Rn.quadrant(n,i)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(t){B.out.print(t)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null}},{key:"insertEdge",value:function(t){this._edges.add(t)}},{key:"findEdgeEnd",value:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null}},{key:"addEdges",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new ni(n,!0),r=new ni(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}}},{key:"add",value:function(t){this._nodes.add(t),this._edgeEndList.add(t)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"linkResultDirectedEdges",value:function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}}]),t}();ri.constructor_=function(){if(this._edges=new N,this._nodes=null,this._edgeEndList=new N,0===arguments.length)this._nodes=new $n(new ii);else if(1===arguments.length){var t=arguments[0];this._nodes=new $n(t)}};var si=function(t){s(n,ri);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"insertBoundaryPoint",value:function(t,e){var i=this._nodes.addNode(e).getLabel(),r=1;he.NONE;i.getLocation(t,An.ON)===he.BOUNDARY&&r++;var s=n.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,s)}},{key:"computeSelfNodes",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],i=arguments[2],r=new zn(arguments[0],!0,!1);r.setIsDoneIfProperInt(i);var s=this.createEdgeSetIntersector(),o=this._parentGeom instanceof qt||this._parentGeom instanceof Vt||this._parentGeom instanceof Yt,a=n||!o;return s.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}}},{key:"computeSplitEdges",value:function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)}},{key:"computeEdgeIntersections",value:function(t,e,n){var i=new zn(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i}},{key:"getGeometry",value:function(){return this._parentGeom}},{key:"getBoundaryNodeRule",value:function(){return this._boundaryNodeRule}},{key:"hasTooFewPoints",value:function(){return this._hasTooFewPoints}},{key:"addPoint",value:function(){if(arguments[0]instanceof At){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,he.INTERIOR)}else if(arguments[0]instanceof k){var e=arguments[0];this.insertPoint(this._argIndex,e,he.INTERIOR)}}},{key:"addPolygon",value:function(t){this.addPolygonRing(t.getExteriorRing(),he.EXTERIOR,he.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,he.INTERIOR,he.EXTERIOR)}}},{key:"addEdge",value:function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],he.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],he.BOUNDARY)}},{key:"addLineString",value:function(t){var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Jn(e,new Xn(this._argIndex,he.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),m.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])}},{key:"getInvalidPoint",value:function(){return this._invalidPoint}},{key:"getBoundaryPoints",value:function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e}},{key:"getBoundaryNodes",value:function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes}},{key:"addSelfIntersectionNode",value:function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===he.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)}},{key:"addPolygonRing",value:function(t,e,n){if(t.isEmpty())return null;var i=$.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,s=n;G.isCCW(i)&&(r=n,s=e);var o=new Jn(i,new Xn(this._argIndex,he.BOUNDARY,r,s));this._lineEdgeMap.put(t,o),this.insertEdge(o),this.insertPoint(this._argIndex,i[0],he.BOUNDARY)}},{key:"insertPoint",value:function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Xn(t,n):r.setLocation(t,n)}},{key:"createEdgeSetIntersector",value:function(){return new qn}},{key:"addSelfIntersectionNodes",value:function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var s=r.next();this.addSelfIntersectionNode(t,s.coord,i)}}},{key:"add",value:function(){if(!(1===arguments.length&&arguments[0]instanceof W))return i(c(n.prototype),"add",this).apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof Yt&&(this._useBoundaryDeterminationRule=!1),t instanceof Vt)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof At)this.addPoint(t);else if(t instanceof zt)this.addCollection(t);else if(t instanceof Ct)this.addCollection(t);else if(t instanceof Yt)this.addCollection(t);else{if(!(t instanceof Et))throw new rt(t.getClass().getName());this.addCollection(t)}}},{key:"addCollection",value:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}}},{key:"locate",value:function(t){return E(this._parentGeom,Bt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new Qe(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)}},{key:"findEdge",value:function(){if(1===arguments.length&&arguments[0]instanceof Ft){var t=arguments[0];return this._lineEdgeMap.get(t)}return i(c(n.prototype),"findEdge",this).apply(this,arguments)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"determineBoundary",value:function(t,e){return t.isInBoundary(e)?he.BOUNDARY:he.INTERIOR}}]),n}();si.constructor_=function(){if(this._parentGeom=null,this._lineEdgeMap=new Jt,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new En,2===arguments.length){var t=arguments[0],e=arguments[1];si.constructor_.call(this,t,e,j.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._argIndex=n,this._parentGeom=i,this._boundaryNodeRule=r,null!==i&&this.add(i)}};var oi=Object.freeze({__proto__:null,GeometryGraph:si}),ai=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visit",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ai.constructor_=function(){};var ui=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isRepeated",value:function(){return this._count>1}},{key:"getRight",value:function(){return this._right}},{key:"getCoordinate",value:function(){return this._p}},{key:"setLeft",value:function(t){this._left=t}},{key:"getX",value:function(){return this._p.x}},{key:"getData",value:function(){return this._data}},{key:"getCount",value:function(){return this._count}},{key:"getLeft",value:function(){return this._left}},{key:"getY",value:function(){return this._p.y}},{key:"increment",value:function(){this._count=this._count+1}},{key:"setRight",value:function(t){this._right=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ui.constructor_=function(){if(this._p=null,this._data=null,this._left=null,this._right=null,this._count=null,2===arguments.length){var t=arguments[0],e=arguments[1];this._p=new k(t),this._left=null,this._right=null,this._count=1,this._data=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._p=new k(n,i),this._left=null,this._right=null,this._count=1,this._data=r}};var li=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insert",value:function(){if(1===arguments.length){var t=arguments[0];return this.insert(t,null)}if(2===arguments.length){var e=arguments[0],n=arguments[1];if(null===this._root)return this._root=new ui(e,n),this._root;if(this._tolerance>0){var i=this.findBestMatchNode(e);if(null!==i)return i.increment(),i}return this.insertExact(e,n)}}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0],e=new N;return this.query(t,e),e}if(2===arguments.length)if(arguments[0]instanceof T&&E(arguments[1],S)){var n=arguments[0],i=arguments[1];this.queryNode(this._root,n,!0,new(function(){function t(){f(this,t)}return g(t,[{key:"visit",value:function(t){i.add(t)}},{key:"interfaces_",get:function(){return[ai]}}]),t}()))}else if(arguments[0]instanceof T&&E(arguments[1],ai)){var r=arguments[0],s=arguments[1];this.queryNode(this._root,r,!0,s)}}},{key:"queryNode",value:function(t,e,n,i){if(null===t)return null;var r=null,s=null,o=null;n?(r=e.getMinX(),s=e.getMaxX(),o=t.getX()):(r=e.getMinY(),s=e.getMaxY(),o=t.getY());var a=o<=s;r<o&&this.queryNode(t.getLeft(),e,!n,i),e.contains(t.getCoordinate())&&i.visit(t),a&&this.queryNode(t.getRight(),e,!n,i)}},{key:"findBestMatchNode",value:function(t){var e=new hi(t,this._tolerance);return this.query(e.queryEnvelope(),e),e.getNode()}},{key:"isEmpty",value:function(){return null===this._root}},{key:"insertExact",value:function(t,e){for(var n=this._root,i=this._root,r=!0,s=!0;null!==n;){if(null!==n&&t.distance(n.getCoordinate())<=this._tolerance)return n.increment(),n;s=r?t.x<n.getX():t.y<n.getY(),i=n,n=s?n.getLeft():n.getRight(),r=!r}this._numberOfNodes=this._numberOfNodes+1;var o=new ui(t,e);return s?i.setLeft(o):i.setRight(o),o}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toCoordinates",value:function(){if(1===arguments.length){var e=arguments[0];return t.toCoordinates(e,!1)}if(2===arguments.length){for(var n=arguments[0],i=arguments[1],r=new R,s=n.iterator();s.hasNext();)for(var o=s.next(),a=i?o.getCount():1,u=0;u<a;u++)r.add(o.getCoordinate(),!0);return r.toCoordinateArray()}}}]),t}(),hi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visit",value:function(t){var e=this._p.distance(t.getCoordinate());if(!(e<=this._tolerance))return null;var n=!1;(null===this._matchNode||e<this._matchDist||null!==this._matchNode&&e===this._matchDist&&t.getCoordinate().compareTo(this._matchNode.getCoordinate())<1)&&(n=!0),n&&(this._matchNode=t,this._matchDist=e)}},{key:"queryEnvelope",value:function(){var t=new T(this._p);return t.expandBy(this._tolerance),t}},{key:"getNode",value:function(){return this._matchNode}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[ai]}}]),t}();hi.constructor_=function(){this._tolerance=null,this._matchNode=null,this._matchDist=0,this._p=null;var t=arguments[0],e=arguments[1];this._p=t,this._tolerance=e},li.BestMatchVisitor=hi,li.constructor_=function(){if(this._root=null,this._numberOfNodes=null,this._tolerance=null,0===arguments.length)li.constructor_.call(this,0);else if(1===arguments.length){var t=arguments[0];this._tolerance=t}};var ci=Object.freeze({__proto__:null,KdTree:li}),fi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"hasChildren",value:function(){for(var t=0;t<4;t++)if(null!==this._subnode[t])return!0;return!1}},{key:"isPrunable",value:function(){return!(this.hasChildren()||this.hasItems())}},{key:"addAllItems",value:function(t){t.addAll(this._items);for(var e=0;e<4;e++)null!==this._subnode[e]&&this._subnode[e].addAllItems(t);return t}},{key:"getNodeCount",value:function(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+1}},{key:"size",value:function(){for(var t=0,e=0;e<4;e++)null!==this._subnode[e]&&(t+=this._subnode[e].size());return t+this._items.size()}},{key:"addAllItemsFromOverlapping",value:function(t,e){if(!this.isSearchMatch(t))return null;e.addAll(this._items);for(var n=0;n<4;n++)null!==this._subnode[n]&&this._subnode[n].addAllItemsFromOverlapping(t,e)}},{key:"visitItems",value:function(t,e){for(var n=this._items.iterator();n.hasNext();)e.visitItem(n.next())}},{key:"hasItems",value:function(){return!this._items.isEmpty()}},{key:"remove",value:function(t,e){if(!this.isSearchMatch(t))return!1;for(var n=!1,i=0;i<4;i++)if(null!==this._subnode[i]&&(n=this._subnode[i].remove(t,e))){this._subnode[i].isPrunable()&&(this._subnode[i]=null);break}return n||(n=this._items.remove(e))}},{key:"visit",value:function(t,e){if(!this.isSearchMatch(t))return null;this.visitItems(t,e);for(var n=0;n<4;n++)null!==this._subnode[n]&&this._subnode[n].visit(t,e)}},{key:"getItems",value:function(){return this._items}},{key:"depth",value:function(){for(var t=0,e=0;e<4;e++)if(null!==this._subnode[e]){var n=this._subnode[e].depth();n>t&&(t=n)}return t+1}},{key:"isEmpty",value:function(){var t=!0;if(this._items.isEmpty()){for(var e=0;e<4;e++)if(null!==this._subnode[e]&&!this._subnode[e].isEmpty()){t=!1;break}}else t=!1;return t}},{key:"add",value:function(t){this._items.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[_]}}],[{key:"getSubnodeIndex",value:function(t,e,n){var i=-1;return t.getMinX()>=e&&(t.getMinY()>=n&&(i=3),t.getMaxY()<=n&&(i=1)),t.getMaxX()<=e&&(t.getMinY()>=n&&(i=2),t.getMaxY()<=n&&(i=0)),i}}]),t}();function di(){}fi.constructor_=function(){this._items=new N,this._subnode=new Array(4).fill(null)},di.exponent=function(t){return function(t,e){var n,i,r,s;if(s||(n=e<0||1/e<0,isFinite(e)||(s={d:32752,c:0,b:0,a:0},n&&(s.d+=32768),i=Math.pow(2,11)-1,r=0)),!s){for(i=1023,r=Math.abs(e);r>=2;)i++,r/=2;for(;r<1&&i>0;)i--,r*=2;i<=0&&(r/=2)}return i}(0,t)-1023},di.powerOf2=function(t){return Math.pow(2,t)};var gi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getLevel",value:function(){return this._level}},{key:"computeKey",value:function(){if(1===arguments.length){var e=arguments[0];for(this._level=t.computeQuadLevel(e),this._env=new T,this.computeKey(this._level,e);!this._env.contains(e);)this._level+=1,this.computeKey(this._level,e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=di.powerOf2(n);this._pt.x=Math.floor(i.getMinX()/r)*r,this._pt.y=Math.floor(i.getMinY()/r)*r,this._env.init(this._pt.x,this._pt.x+r,this._pt.y,this._pt.y+r)}}},{key:"getEnvelope",value:function(){return this._env}},{key:"getCentre",value:function(){return new k((this._env.getMinX()+this._env.getMaxX())/2,(this._env.getMinY()+this._env.getMaxY())/2)}},{key:"getPoint",value:function(){return this._pt}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"computeQuadLevel",value:function(t){var e=t.getWidth(),n=t.getHeight(),i=e>n?e:n;return di.exponent(i)+1}}]),t}();gi.constructor_=function(){this._pt=new k,this._level=0,this._env=null;var t=arguments[0];this.computeKey(t)};var vi=function(t){s(n,fi);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"find",value:function(t){var e=fi.getSubnodeIndex(t,this._centrex,this._centrey);return-1===e?this:null!==this._subnode[e]?this._subnode[e].find(t):this}},{key:"isSearchMatch",value:function(t){return null!==t&&this._env.intersects(t)}},{key:"getSubnode",value:function(t){return null===this._subnode[t]&&(this._subnode[t]=this.createSubnode(t)),this._subnode[t]}},{key:"getEnvelope",value:function(){return this._env}},{key:"getNode",value:function(t){var e=fi.getSubnodeIndex(t,this._centrex,this._centrey);return-1!==e?this.getSubnode(e).getNode(t):this}},{key:"createSubnode",value:function(t){var e=0,i=0,r=0,s=0;switch(t){case 0:e=this._env.getMinX(),i=this._centrex,r=this._env.getMinY(),s=this._centrey;break;case 1:e=this._centrex,i=this._env.getMaxX(),r=this._env.getMinY(),s=this._centrey;break;case 2:e=this._env.getMinX(),i=this._centrex,r=this._centrey,s=this._env.getMaxY();break;case 3:e=this._centrex,i=this._env.getMaxX(),r=this._centrey,s=this._env.getMaxY()}return new n(new T(e,i,r,s),this._level-1)}},{key:"insertNode",value:function(t){m.isTrue(null===this._env||this._env.contains(t._env));var e=fi.getSubnodeIndex(t._env,this._centrex,this._centrey);if(t._level===this._level-1)this._subnode[e]=t;else{var n=this.createSubnode(e);n.insertNode(t),this._subnode[e]=n}}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"createNode",value:function(t){var e=new gi(t);return new n(e.getEnvelope(),e.getLevel())}},{key:"createExpanded",value:function(t,e){var i=new T(e);null!==t&&i.expandToInclude(t._env);var r=n.createNode(i);return null!==t&&r.insertNode(t),r}}]),n}();vi.constructor_=function(){this._env=null,this._centrex=null,this._centrey=null,this._level=null;var t=arguments[0],e=arguments[1];this._env=t,this._level=e,this._centrex=(t.getMinX()+t.getMaxX())/2,this._centrey=(t.getMinY()+t.getMaxY())/2};var _i=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isZeroWidth",value:function(e,n){var i=n-e;if(0===i)return!0;var r=i/Math.max(Math.abs(e),Math.abs(n));return di.exponent(r)<=t.MIN_BINARY_EXPONENT}}]),t}();_i.constructor_=function(){},_i.MIN_BINARY_EXPONENT=-50;var yi=function(t){s(n,fi);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"insert",value:function(t,e){var i=fi.getSubnodeIndex(t,n.origin.x,n.origin.y);if(-1===i)return this.add(e),null;var r=this._subnode[i];if(null===r||!r.getEnvelope().contains(t)){var s=vi.createExpanded(r,t);this._subnode[i]=s}this.insertContained(this._subnode[i],t,e)}},{key:"isSearchMatch",value:function(t){return!0}},{key:"insertContained",value:function(t,e,n){m.isTrue(t.getEnvelope().contains(e));var i=_i.isZeroWidth(e.getMinX(),e.getMaxX()),r=_i.isZeroWidth(e.getMinY(),e.getMaxY());(i||r?t.find(e):t.getNode(e)).add(n)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();yi.constructor_=function(){},yi.origin=new k(0,0);var pi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insert",value:function(t,e){}},{key:"remove",value:function(t,e){}},{key:"query",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();pi.constructor_=function(){};var mi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"size",value:function(){return null!==this._root?this._root.size():0}},{key:"insert",value:function(e,n){this.collectStats(e);var i=t.ensureExtent(e,this._minExtent);this._root.insert(i,n)}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0],e=new Ze;return this.query(t,e),e.getItems()}if(2===arguments.length){var n=arguments[0],i=arguments[1];this._root.visit(n,i)}}},{key:"queryAll",value:function(){var t=new N;return this._root.addAllItems(t),t}},{key:"remove",value:function(e,n){var i=t.ensureExtent(e,this._minExtent);return this._root.remove(i,n)}},{key:"collectStats",value:function(t){var e=t.getWidth();e<this._minExtent&&e>0&&(this._minExtent=e);var n=t.getHeight();n<this._minExtent&&n>0&&(this._minExtent=n)}},{key:"depth",value:function(){return null!==this._root?this._root.depth():0}},{key:"isEmpty",value:function(){return null===this._root||this._root.isEmpty()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[pi,_]}}],[{key:"ensureExtent",value:function(t,e){var n=t.getMinX(),i=t.getMaxX(),r=t.getMinY(),s=t.getMaxY();return n!==i&&r!==s?t:(n===i&&(i=(n-=e/2)+e/2),r===s&&(s=(r-=e/2)+e/2),new T(n,i,r,s))}}]),t}();mi.constructor_=function(){this._root=null,this._minExtent=1,this._root=new yi},mi.serialVersionUID=-0x678b60c967a25400;var ki=Object.freeze({__proto__:null,Quadtree:mi}),xi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getBounds",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();xi.constructor_=function(){};var Ei=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[xi,_]}}]),t}();Ei.constructor_=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};var Ci=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"poll",value:function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return 0===this._size}},{key:"add",value:function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ci.constructor_=function(){this._size=null,this._items=null,this._size=0,this._items=new N,this._items.add(null)};var Ii=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(t){m.isTrue(null===this._bounds),this._childBoundables.add(t)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[xi,_]}}]),t}();Ii.constructor_=function(){if(this._childBoundables=new N,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Ii.serialVersionUID=0x5a1e55ec41369800;var Si=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"expandToQueue",value:function(e,i){var r=t.isComposite(this._boundable1),s=t.isComposite(this._boundable2);if(r&&s)return t.area(this._boundable1)>t.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,i),null):(this.expand(this._boundable2,this._boundable1,e,i),null);if(r)return this.expand(this._boundable1,this._boundable2,e,i),null;if(s)return this.expand(this._boundable2,this._boundable1,e,i),null;throw new n("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(t.isComposite(this._boundable1)||t.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(e,n,i,r){for(var s=e.getChildBoundables().iterator();s.hasNext();){var o=new t(s.next(),n,this._itemDistance);o.getDistance()<r&&i.add(o)}}},{key:"getBoundable",value:function(t){return 0===t?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}],[{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof Ii}}]),t}();Si.constructor_=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};var wi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"queryInternal",value:function(){if(E(arguments[2],Ye)&&arguments[0]instanceof Object&&arguments[1]instanceof Ii)for(var t=arguments[0],e=arguments[2],n=arguments[1].getChildBoundables(),i=0;i<n.size();i++){var r=n.get(i);this.getIntersectsOp().intersects(r.getBounds(),t)&&(r instanceof Ii?this.queryInternal(t,r,e):r instanceof Ei?e.visitItem(r.getItem()):m.shouldNeverReachHere())}else if(E(arguments[2],S)&&arguments[0]instanceof Object&&arguments[1]instanceof Ii)for(var s=arguments[0],o=arguments[2],a=arguments[1].getChildBoundables(),u=0;u<a.size();u++){var l=a.get(u);this.getIntersectsOp().intersects(l.getBounds(),s)&&(l instanceof Ii?this.queryInternal(s,l,o):l instanceof Ei?o.add(l.getItem()):m.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Ii?t+=this.size(n):n instanceof Ei&&(t+=1)}return t}}},{key:"removeItem",value:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Ei&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new N:t}if(1===arguments.length){for(var e=arguments[0],n=new N,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Ii){var s=this.itemsTree(r);null!==s&&n.add(s)}else r instanceof Ei?n.add(r.getItem()):m.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(t,e){m.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Ei(t,e))}},{key:"boundablesAtLevel",value:function(){if(1===arguments.length){var t=arguments[0],e=new N;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(m.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var s=i.getChildBoundables().iterator();s.hasNext();){var o=s.next();o instanceof Ii?this.boundablesAtLevel(n,o,r):(m.isTrue(o instanceof Ei),-1===n&&r.add(o))}return null}}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new N;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,i)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=this.removeItem(i,r);if(s)return!0;for(var o=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Ii&&(s=this.remove(n,u,r))){o=u;break}}return null!==o&&o.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(o),s}}},{key:"createHigherLevels",value:function(t,e){m.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)}},{key:"depth",value:function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Ii){var i=this.depth(n);i>t&&(t=i)}}return t+1}}},{key:"createParentBoundables",value:function(t,e){m.isTrue(!t.isEmpty());var n=new N;n.add(this.createNode(e));var i=new N(t);Le.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var s=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(s)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[_]}}],[{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}]),t}();wi.IntersectsOp=function(){},wi.constructor_=function(){if(this._root=null,this._built=!1,this._itemBoundables=new N,this._nodeCapacity=null,0===arguments.length)wi.constructor_.call(this,wi.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];m.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}},wi.serialVersionUID=-0x35ef64c82d4c5400,wi.DEFAULT_NODE_CAPACITY=10;var Ni=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"distance",value:function(t,e){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ni.constructor_=function(){};var Li=function(t){s(n,wi);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"createParentBoundablesFromVerticalSlices",value:function(t,e){m.isTrue(t.length>0);for(var n=new N,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n}},{key:"createNode",value:function(t){return new Ri(t)}},{key:"size",value:function(){return 0===arguments.length?i(c(n.prototype),"size",this).call(this):i(c(n.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof T))return i(c(n.prototype),"insert",this).apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;i(c(n.prototype),"insert",this).call(this,t,e)}},{key:"getIntersectsOp",value:function(){return n.intersectsOp}},{key:"verticalSlices",value:function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),s=0;s<e;s++){i[s]=new N;for(var o=0;r.hasNext()&&o<n;){var a=r.next();i[s].add(a),o++}}return i}},{key:"query",value:function(){if(1===arguments.length){var t=arguments[0];return i(c(n.prototype),"query",this).call(this,t)}if(2===arguments.length){var e=arguments[0],r=arguments[1];i(c(n.prototype),"query",this).call(this,e,r)}}},{key:"getComparator",value:function(){return n.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(t,e){return i(c(n.prototype),"createParentBoundables",this).call(this,t,e)}},{key:"remove",value:function(){if(2===arguments.length&&arguments[1]instanceof Object&&arguments[0]instanceof T){var t=arguments[0],e=arguments[1];return i(c(n.prototype),"remove",this).call(this,t,e)}return i(c(n.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return 0===arguments.length?i(c(n.prototype),"depth",this).call(this):i(c(n.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(t,e){m.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new N(t);Le.sort(r,n.xComparator);var s=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(s,e)}},{key:"nearestNeighbour",value:function(){if(1===arguments.length){if(E(arguments[0],Ni)){var t=arguments[0],e=new Si(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Si){var i=arguments[0];return this.nearestNeighbour(i,o.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&E(arguments[1],Ni)){var r=arguments[0],s=arguments[1],a=new Si(this.getRoot(),r.getRoot(),s);return this.nearestNeighbour(a)}if(arguments[0]instanceof Si&&"number"==typeof arguments[1]){var u=arguments[0],l=arguments[1],h=null,c=new Ci;for(c.add(u);!c.isEmpty()&&l>0;){var f=c.poll(),d=f.getDistance();if(d>=l)break;f.isLeaves()?(l=d,h=f):f.expandToQueue(c,l)}return[h.getBoundable(0).getItem(),h.getBoundable(1).getItem()]}if(arguments[0]instanceof Si&&Number.isInteger(arguments[1])){var g=arguments[0],v=arguments[1];return this.nearestNeighbour(g,o.POSITIVE_INFINITY,v)}}else if(3===arguments.length){if(E(arguments[2],Ni)&&arguments[0]instanceof T&&arguments[1]instanceof Object){var _=arguments[2],y=new Ei(arguments[0],arguments[1]),p=new Si(this.getRoot(),y,_);return this.nearestNeighbour(p)[0]}if(Number.isInteger(arguments[2])&&arguments[0]instanceof Si&&"number"==typeof arguments[1]){var m=arguments[0],k=arguments[2],x=arguments[1],C=new Ci;C.add(m);for(var I=new Ci;!C.isEmpty()&&x>=0;){var S=C.poll(),w=S.getDistance();if(w>=x)break;S.isLeaves()?I.size()<k?I.add(S):(I.peek().getDistance()>w&&(I.poll(),I.add(S)),x=I.peek().getDistance()):S.expandToQueue(C,x)}return n.getItems(I)}}else if(4===arguments.length){var N=arguments[2],L=arguments[3],R=new Ei(arguments[0],arguments[1]),b=new Si(this.getRoot(),R,N);return this.nearestNeighbour(b,L)}}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[pi,_]}}],[{key:"centreX",value:function(t){return n.avg(t.getMinX(),t.getMaxX())}},{key:"avg",value:function(t,e){return(t+e)/2}},{key:"getItems",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;!t.isEmpty();){var i=t.poll();e[n]=i.getBoundable(0).getItem(),n++}return e}},{key:"centreY",value:function(t){return n.avg(t.getMinY(),t.getMaxY())}}]),n}(),Ri=function(t){s(n,Ii);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"computeBounds",value:function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new T(n.getBounds()):t.expandToInclude(n.getBounds())}return t}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Ri.constructor_=function(){var t=arguments[0];Ii.constructor_.call(this,t)},Li.STRtreeNode=Ri,Li.constructor_=function(){if(0===arguments.length)Li.constructor_.call(this,Li.DEFAULT_NODE_CAPACITY);else if(1===arguments.length){var t=arguments[0];wi.constructor_.call(this,t)}},Li.serialVersionUID=0x39920f7d5f261e0,Li.xComparator=new(function(){function t(){f(this,t)}return g(t,[{key:"compare",value:function(t,e){return wi.compareDoubles(Li.centreX(t.getBounds()),Li.centreX(e.getBounds()))}},{key:"interfaces_",get:function(){return[v]}}]),t}()),Li.yComparator=new(function(){function t(){f(this,t)}return g(t,[{key:"compare",value:function(t,e){return wi.compareDoubles(Li.centreY(t.getBounds()),Li.centreY(e.getBounds()))}},{key:"interfaces_",get:function(){return[v]}}]),t}()),Li.intersectsOp=new(function(){function t(){f(this,t)}return g(t,[{key:"intersects",value:function(t,e){return t.intersects(e)}},{key:"interfaces_",get:function(){return[IntersectsOp]}}]),t}()),Li.DEFAULT_NODE_CAPACITY=10;var Ti=Object.freeze({__proto__:null,STRtree:Li}),bi=Object.freeze({__proto__:null,kdtree:ci,quadtree:ki,strtree:Ti}),Pi=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Mi=function(){function t(e){f(this,t),this.geometryFactory=e||new te}return g(t,[{key:"read",value:function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!Oi[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Pi.indexOf(n)?Oi[n].call(this,e.coordinates):"GeometryCollection"===n?Oi[n].call(this,e.geometries):Oi[n].call(this,e)}},{key:"write",value:function(t){var e=t.getGeometryType();if(!Fi[e])throw new Error("Geometry is not supported");return Fi[e].call(this,t)}}]),t}(),Oi={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!Oi[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=Oi.bbox.call(this,t.bbox)),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.call(this,t.bbox)),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new k(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new k(t[0],t[1]),new k(t[2],t[1]),new k(t[2],t[3]),new k(t[0],t[3]),new k(t[0],t[1])])},Point:function(t){var e=new k(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Oi.Point.call(this,t[n]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=Oi.coordinates.call(this,t);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(Oi.LineString.call(this,t[n]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=Oi.coordinates.call(this,t[0]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var s=t[r],o=Oi.coordinates.call(this,s),a=this.geometryFactory.createLinearRing(o);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(Oi.Polygon.call(this,i))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Fi={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Fi.coordinate.call(this,t.getCoordinate())}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Fi.Point.call(this,i);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Fi.coordinate.call(this,r))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Fi.LineString.call(this,i);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Fi.LineString.call(this,t._shell);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],s=Fi.LineString.call(this,r);e.push(s.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Fi.Polygon.call(this,i);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(Fi[r].call(this,i))}return{type:"GeometryCollection",geometries:e}}};function Di(t){return[t.x,t.y]}var Ai=Object.freeze({__proto__:null,GeoJSONReader:function(){function t(e){f(this,t),this.parser=new Mi(e||new te)}return g(t,[{key:"read",value:function(t){return this.parser.read(t)}}]),t}(),GeoJSONWriter:function(){function t(){f(this,t),this.parser=new Mi(this.geometryFactory)}return g(t,[{key:"write",value:function(t){return this.parser.write(t)}}]),t}(),OL3Parser:function(){function t(e,n){f(this,t),this.geometryFactory=e||new te,this.ol=n||"undefined"!=typeof ol&&ol}return g(t,[{key:"inject",value:function(t,e,n,i,r,s,o,a){this.ol={geom:{Point:t,LineString:e,LinearRing:n,Polygon:i,MultiPoint:r,MultiLineString:s,MultiPolygon:o,GeometryCollection:a}}}},{key:"read",value:function(t){var e=this.ol;return t instanceof e.geom.Point?this.convertFromPoint(t):t instanceof e.geom.LineString?this.convertFromLineString(t):t instanceof e.geom.LinearRing?this.convertFromLinearRing(t):t instanceof e.geom.Polygon?this.convertFromPolygon(t):t instanceof e.geom.MultiPoint?this.convertFromMultiPoint(t):t instanceof e.geom.MultiLineString?this.convertFromMultiLineString(t):t instanceof e.geom.MultiPolygon?this.convertFromMultiPolygon(t):t instanceof e.geom.GeometryCollection?this.convertFromCollection(t):void 0}},{key:"convertFromPoint",value:function(t){var e=t.getCoordinates();return this.geometryFactory.createPoint(new k(e[0],e[1]))}},{key:"convertFromLineString",value:function(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(t){return new k(t[0],t[1])}))}},{key:"convertFromLinearRing",value:function(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(t){return new k(t[0],t[1])}))}},{key:"convertFromPolygon",value:function(t){for(var e=t.getLinearRings(),n=null,i=[],r=0;r<e.length;r++){var s=this.convertFromLinearRing(e[r]);0===r?n=s:i.push(s)}return this.geometryFactory.createPolygon(n,i)}},{key:"convertFromMultiPoint",value:function(t){var e=t.getPoints().map(function(t){return this.convertFromPoint(t)},this);return this.geometryFactory.createMultiPoint(e)}},{key:"convertFromMultiLineString",value:function(t){var e=t.getLineStrings().map(function(t){return this.convertFromLineString(t)},this);return this.geometryFactory.createMultiLineString(e)}},{key:"convertFromMultiPolygon",value:function(t){var e=t.getPolygons().map(function(t){return this.convertFromPolygon(t)},this);return this.geometryFactory.createMultiPolygon(e)}},{key:"convertFromCollection",value:function(t){var e=t.getGeometries().map(function(t){return this.read(t)},this);return this.geometryFactory.createGeometryCollection(e)}},{key:"write",value:function(t){return"Point"===t.getGeometryType()?this.convertToPoint(t.getCoordinate()):"LineString"===t.getGeometryType()?this.convertToLineString(t):"LinearRing"===t.getGeometryType()?this.convertToLinearRing(t):"Polygon"===t.getGeometryType()?this.convertToPolygon(t):"MultiPoint"===t.getGeometryType()?this.convertToMultiPoint(t):"MultiLineString"===t.getGeometryType()?this.convertToMultiLineString(t):"MultiPolygon"===t.getGeometryType()?this.convertToMultiPolygon(t):"GeometryCollection"===t.getGeometryType()?this.convertToCollection(t):void 0}},{key:"convertToPoint",value:function(t){return new this.ol.geom.Point([t.x,t.y])}},{key:"convertToLineString",value:function(t){var e=t._points._coordinates.map(Di);return new this.ol.geom.LineString(e)}},{key:"convertToLinearRing",value:function(t){var e=t._points._coordinates.map(Di);return new this.ol.geom.LinearRing(e)}},{key:"convertToPolygon",value:function(t){for(var e=[t._shell._points._coordinates.map(Di)],n=0;n<t._holes.length;n++)e.push(t._holes[n]._points._coordinates.map(Di));return new this.ol.geom.Polygon(e)}},{key:"convertToMultiPoint",value:function(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(Di))}},{key:"convertToMultiLineString",value:function(t){for(var e=[],n=0;n<t._geometries.length;n++)e.push(this.convertToLineString(t._geometries[n]).getCoordinates());return new this.ol.geom.MultiLineString(e)}},{key:"convertToMultiPolygon",value:function(t){for(var e=[],n=0;n<t._geometries.length;n++)e.push(this.convertToPolygon(t._geometries[n]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}},{key:"convertToCollection",value:function(t){for(var e=[],n=0;n<t._geometries.length;n++){var i=t._geometries[n];e.push(this.write(i))}return new this.ol.geom.GeometryCollection(e)}}]),t}(),WKTReader:function(){function t(e){f(this,t),this.parser=new ie(e||new te)}return g(t,[{key:"read",value:function(t){return this.parser.read(t)}}]),t}(),WKTWriter:oe}),Gi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(e,n,i){if(n.equals2D(i))return 0;var r=t.relativeSign(n.x,i.x),s=t.relativeSign(n.y,i.y);switch(e){case 0:return t.compareValue(r,s);case 1:return t.compareValue(s,r);case 2:return t.compareValue(s,-r);case 3:return t.compareValue(-r,s);case 4:return t.compareValue(-r,-s);case 5:return t.compareValue(-s,-r);case 6:return t.compareValue(-s,r);case 7:return t.compareValue(r,-s)}return m.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}]),t}();Gi.constructor_=function(){};var Bi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Gi.compare(this._segmentOctant,this.coord,e.coord)}},{key:"isEndPoint",value:function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t}},{key:"isInterior",value:function(){return this._isInterior}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();Bi.constructor_=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new k(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};var Vi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getSplitCoordinates",value:function(){var t=new R;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var t=new N;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}}},{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"findCollapsesFromExistingVertices",value:function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=(this._edge.getCoordinate(e+1),this._edge.getCoordinate(e+2));n.equals2D(i)&&t.add(new O(e+1))}}},{key:"addEdgeCoordinates",value:function(t,e,n){e.segmentIndex,t.segmentIndex;var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new k(t.coord),!1);for(var s=t.segmentIndex+1;s<=e.segmentIndex;s++)n.add(this._edge.getCoordinate(s));r&&n.add(new k(e.coord))}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}}},{key:"findCollapseIndex",value:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new O(e[0])),i=r}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}},{key:"createSplitEdge",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var s=new Array(n).fill(null),o=0;s[o++]=new k(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)s[o++]=this._edge.getCoordinate(a);return r&&(s[o]=new k(e.coord)),new Xi(s,this._edge.getData())}},{key:"add",value:function(t,e){var n=new Bi(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(m.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}},{key:"checkSplitEdgesCorrectness",value:function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new y("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new y("bad split edge end point at "+r)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Vi.constructor_=function(){this._nodeMap=new dt,this._edge=null;var t=arguments[0];this._edge=t};var zi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"octant",value:function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],i=arguments[1];if(0===e&&0===i)throw new n("Cannot compute the octant for point ( "+e+", "+i+" )");var r=Math.abs(e),s=Math.abs(i);return e>=0?i>=0?r>=s?0:1:r>=s?7:6:i>=0?r>=s?3:2:r>=s?4:5}if(arguments[0]instanceof k&&arguments[1]instanceof k){var o=arguments[0],a=arguments[1],u=a.x-o.x,l=a.y-o.y;if(0===u&&0===l)throw new n("Cannot compute the octant for two identical points "+o);return t.octant(u,l)}}}]),t}();zi.constructor_=function(){};var qi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(t){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(t){}},{key:"getData",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();qi.constructor_=function(){};var Yi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addIntersection",value:function(t,e){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[qi]}}]),t}();Yi.constructor_=function(){};var Xi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:zi.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],i=arguments[3],r=new k(arguments[0].getIntersection(i));this.addIntersection(r,n)}}},{key:"toString",value:function(){return oe.toLineString(new Kt(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)}},{key:"addIntersections",value:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Yi]}}],[{key:"getNodedSubstrings",value:function(){if(1===arguments.length){var e=arguments[0],n=new N;return t.getNodedSubstrings(e,n),n}if(2===arguments.length)for(var i=arguments[1],r=arguments[0].iterator();r.hasNext();)r.next().getNodeList().addSplitEdges(i)}}]),t}();Xi.constructor_=function(){this._nodeList=new Vi(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};var Ui=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"overlap",value:function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ui.constructor_=function(){this._overlapSeg1=new le,this._overlapSeg2=new le};var Wi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getLineSegment",value:function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}},{key:"computeSelect",value:function(t,e,n,i){var r=this._pts[e],s=this._pts[n];if(n-e==1)return i.select(this,e),null;if(!t.intersects(r,s))return null;var o=Math.trunc((e+n)/2);e<o&&this.computeSelect(t,e,o,i),o<n&&this.computeSelect(t,o,n,i)}},{key:"getCoordinates",value:function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}},{key:"computeOverlaps",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(6===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3],o=arguments[4],a=arguments[5];if(i-n==1&&o-s==1)return a.overlap(this,n,r,s),null;if(!this.overlaps(n,i,r,s,o))return null;var u=Math.trunc((n+i)/2),l=Math.trunc((s+o)/2);n<u&&(s<l&&this.computeOverlaps(n,u,r,s,l,a),l<o&&this.computeOverlaps(n,u,r,l,o,a)),u<i&&(s<l&&this.computeOverlaps(u,i,r,s,l,a),l<o&&this.computeOverlaps(u,i,r,l,o,a))}}},{key:"setId",value:function(t){this._id=t}},{key:"select",value:function(t,e){this.computeSelect(t,this._start,this._end,e)}},{key:"getEnvelope",value:function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new T(t,e)}return this._env}},{key:"overlaps",value:function(t,e,n,i,r){return T.intersects(this._pts[t],this._pts[e],n._pts[i],n._pts[r])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Wi.constructor_=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};var Hi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getChainStartIndices",value:function(e){var n=0,i=new N;i.add(new O(n));do{var r=t.findChainEnd(e,n);i.add(new O(r)),n=r}while(n<e.length-1);return t.toIntArray(i)}},{key:"findChainEnd",value:function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Rn.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Rn.quadrant(t[r-1],t[r])===i);)r++;return r-1}},{key:"getChains",value:function(){if(1===arguments.length){var e=arguments[0];return t.getChains(e,null)}if(2===arguments.length){for(var n=arguments[0],i=arguments[1],r=new N,s=t.getChainStartIndices(n),o=0;o<s.length-1;o++){var a=new Wi(n,s[o],s[o+1],i);r.add(a)}return r}}},{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}}]),t}();Hi.constructor_=function(){};var ji=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"computeNodes",value:function(t){}},{key:"getNodedSubstrings",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ji.constructor_=function(){};var Ki=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setSegmentIntersector",value:function(t){this._segInt=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[ji]}}]),t}();Ki.constructor_=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};var Zi=function(t){s(n,Ki);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Xi.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(t){for(var e=Hi.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var t=new Ji(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}(),Ji=function(t){s(n,Ui);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"overlap",value:function(){if(4!==arguments.length)return i(c(n.prototype),"overlap",this).apply(this,arguments);var t=arguments[1],e=arguments[2],r=arguments[3],s=arguments[0].getContext(),o=e.getContext();this._si.processIntersections(s,t,o,r)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Ji.constructor_=function(){this._si=null;var t=arguments[0];this._si=t},Zi.SegmentOverlapAction=Ji,Zi.constructor_=function(){if(this._monoChains=new N,this._index=new Li,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];Ki.constructor_.call(this,t)}};var Qi=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"rescale",value:function(){if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){var n=arguments[0];2===n.length&&(new k(n[0]),new k(n[1]));for(var i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&B.out.println(n)}}},{key:"scale",value:function(){if(E(arguments[0],C)){for(var t=arguments[0],e=new N(t.size()),n=t.iterator();n.hasNext();){var i=n.next();e.add(new Xi(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],s=new Array(r.length).fill(null),o=0;o<r.length;o++)s[o]=new k(Math.round((r[o].x-this._offsetX)*this._scaleFactor),Math.round((r[o].y-this._offsetY)*this._scaleFactor),r[o].z);return $.removeRepeatedPoints(s)}}},{key:"isIntegerPrecision",value:function(){return 1===this._scaleFactor}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[ji]}}]),t}();Qi.constructor_=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];Qi.constructor_.call(this,t,e,0,0)}else if(4===arguments.length){var n=arguments[0],i=arguments[1];this._noder=n,this._scaleFactor=i,this._isScaled=!this.isIntegerPrecision()}};var $i=Object.freeze({__proto__:null,MCIndexNoder:Zi,ScaledNoder:Qi,SegmentString:qi}),tr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isSimpleMultiPoint",value:function(t){if(t.isEmpty())return!0;for(var e=new _t,n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n).getCoordinate();if(e.contains(i))return this._nonSimpleLocation=i,!1;e.add(i)}return!0}},{key:"isSimplePolygonal",value:function(t){for(var e=Ne.getLines(t).iterator();e.hasNext();){var n=e.next();if(!this.isSimpleLinearGeometry(n))return!1}return!0}},{key:"hasClosedEndpointIntersection",value:function(t){for(var e=new dt,n=t.getEdgeIterator();n.hasNext();){var i=n.next(),r=(i.getMaximumSegmentIndex(),i.isClosed()),s=i.getCoordinate(0);this.addEndpoint(e,s,r);var o=i.getCoordinate(i.getNumPoints()-1);this.addEndpoint(e,o,r)}for(var a=e.values().iterator();a.hasNext();){var u=a.next();if(u.isClosed&&2!==u.degree)return this._nonSimpleLocation=u.getCoordinate(),!0}return!1}},{key:"getNonSimpleLocation",value:function(){return this._nonSimpleLocation}},{key:"isSimpleLinearGeometry",value:function(t){if(t.isEmpty())return!0;var e=new si(0,t),n=new ue,i=e.computeSelfNodes(n,!0);return!(i.hasIntersection()&&(i.hasProperIntersection()?(this._nonSimpleLocation=i.getProperIntersectionPoint(),1):this.hasNonEndpointIntersection(e)||this._isClosedEndpointsInInterior&&this.hasClosedEndpointIntersection(e)))}},{key:"hasNonEndpointIntersection",value:function(t){for(var e=t.getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getMaximumSegmentIndex(),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next();if(!s.isEndPoint(i))return this._nonSimpleLocation=s.getCoordinate(),!0}return!1}},{key:"addEndpoint",value:function(t,e,n){var i=t.get(e);null===i&&(i=new er(e),t.put(e,i)),i.addEndpoint(n)}},{key:"computeSimple",value:function(t){return this._nonSimpleLocation=null,!!t.isEmpty()||(t instanceof Ft||t instanceof Ct?this.isSimpleLinearGeometry(t):t instanceof zt?this.isSimpleMultiPoint(t):E(t,Bt)?this.isSimplePolygonal(t):!(t instanceof Et)||this.isSimpleGeometryCollection(t))}},{key:"isSimple",value:function(){return this._nonSimpleLocation=null,this.computeSimple(this._inputGeom)}},{key:"isSimpleGeometryCollection",value:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.computeSimple(n))return!1}return!0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isSimple",value:function(){return 1===arguments.length?new t(arguments[0]).isSimple():2===arguments.length?new t(arguments[0],arguments[1]).isSimple():void 0}}]),t}(),er=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addEndpoint",value:function(t){this.degree++,this.isClosed|=t}},{key:"getCoordinate",value:function(){return this.pt}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();er.constructor_=function(){this.pt=null,this.isClosed=null,this.degree=null;var t=arguments[0];this.pt=t,this.isClosed=!1,this.degree=0},tr.EndpointInfo=er,tr.constructor_=function(){if(this._inputGeom=null,this._isClosedEndpointsInInterior=!0,this._nonSimpleLocation=null,1===arguments.length){var t=arguments[0];this._inputGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._inputGeom=e,this._isClosedEndpointsInInterior=!n.isInBoundary(2)}};var nr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(e){this._quadrantSegments=e,0===this._quadrantSegments&&(this._joinStyle=t.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=t.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==t.JOIN_ROUND&&(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}]),t}();nr.constructor_=function(){if(this._quadrantSegments=nr.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=nr.CAP_ROUND,this._joinStyle=nr.JOIN_ROUND,this._mitreLimit=nr.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=nr.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2],o=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(s),this.setMitreLimit(o)}},nr.CAP_ROUND=1,nr.CAP_FLAT=2,nr.CAP_SQUARE=3,nr.JOIN_ROUND=1,nr.JOIN_MITRE=2,nr.JOIN_BEVEL=3,nr.DEFAULT_QUADRANT_SEGMENTS=8,nr.DEFAULT_MITRE_LIMIT=5,nr.DEFAULT_SIMPLIFY_FACTOR=.01;var ir=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}},{key:"findRightmostEdgeAtVertex",value:function(){var t=this._minDe.getEdge().getCoordinates();m.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=G.index(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===G.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===G.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=An.LEFT;return n[e].y<n[e+1].y&&(i=An.RIGHT),i}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}},{key:"findRightmostEdgeAtNode",value:function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}m.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===An.LEFT&&(this._orientedDe=this._minDe.getSym())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();function rr(){this.array_=[]}ir.constructor_=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null},rr.prototype.addLast=function(t){this.array_.push(t)},rr.prototype.removeFirst=function(){return this.array_.shift()},rr.prototype.isEmpty=function(){return 0===this.array_.length};var sr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"clearVisitedEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new ei("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var s=r.next();s.setVisited(!0),this.copySymDepths(s)}}},{key:"computeDepth",value:function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(An.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}},{key:"create",value:function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(An.RIGHT)>=1&&e.getDepth(An.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}},{key:"computeDepths",value:function(t){var e=new ot,n=new rr,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var s=r.getEdges().iterator();s.hasNext();){var o=s.next().getSym();if(!o.isVisited()){var a=o.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}}},{key:"compareTo",value:function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(null===this._env){for(var t=new T,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env}},{key:"addReachable",value:function(t){var e=new gn;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}}},{key:"copySymDepths",value:function(t){var e=t.getSym();e.setDepth(An.LEFT,t.getDepth(An.RIGHT)),e.setDepth(An.RIGHT,t.getDepth(An.LEFT))}},{key:"add",value:function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();sr.constructor_=function(){this._finder=null,this._dirEdgeList=new N,this._nodes=new N,this._rightMostCoord=null,this._env=null,this._finder=new ir};var or=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"computeRing",value:function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=G.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return 1===this._label.getGeometryCount()}},{key:"computePoints",value:function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new ei("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new ei("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();m.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(t){return this._pts.get(t)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var s=r;s<i.length;s++)this._pts.add(i[s])}else{var o=i.length-2;n&&(o=i.length-1);for(var a=o;a>=0;a--)this._pts.add(i[a])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)}},{key:"containsPoint",value:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!en.isInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0}},{key:"addHole",value:function(t){this._holes.add(t)}},{key:"isShell",value:function(){return null===this._shell}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,An.RIGHT);if(n===he.NONE)return null;if(this._label.getLocation(e)===he.NONE)return this._label.setLocation(e,n),null}}},{key:"setShell",value:function(t){this._shell=t,null!==t&&t.addHole(this)}},{key:"toPolygon",value:function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();or.constructor_=function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new N,this._pts=new N,this._label=new Xn(he.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new N,this._geometryFactory=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}};var ar=function(t){s(n,or);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"setEdgeRing",value:function(t,e){t.setMinEdgeRing(e)}},{key:"getNext",value:function(t){return t.getNextMin()}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ar.constructor_=function(){var t=arguments[0],e=arguments[1];or.constructor_.call(this,t,e)};var ur=function(t){s(n,or);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"buildMinimalRings",value:function(){var t=new N,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new ar(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t}},{key:"setEdgeRing",value:function(t,e){t.setEdgeRing(e)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)}},{key:"getNext",value:function(t){return t.getNext()}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ur.constructor_=function(){var t=arguments[0],e=arguments[1];or.constructor_.call(this,t,e)};var lr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"sortShellsAndHoles",value:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}}},{key:"computePolygons",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e}},{key:"placeFreeHoles",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new ei("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,n){for(var i=new N,r=t.iterator();r.hasNext();){var s=r.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var o=s.buildMinimalRings(),a=this.findShell(o);null!==a?(this.placePolygonHoles(a,o),e.add(a)):n.addAll(o)}else i.add(s)}return i}},{key:"containsPoint",value:function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new ur(i,this._geometryFactory);e.add(r),r.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findEdgeRingContaining",value:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==s&&(o=s.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&en.isInRing(r,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(h))&&(s=u)}return s}},{key:"findShell",value:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return m.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];ri.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new N,s=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(s,this._shellList,r),this.placeFreeHoles(this._shellList,r)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();lr.constructor_=function(){this._geometryFactory=null,this._shellList=new N;var t=arguments[0];this._geometryFactory=t};var hr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isDeletable",value:function(t,e,n,i){var r=this._inputLine[t],s=this._inputLine[e],o=this._inputLine[n];return!!this.isConcave(r,s,o)&&!!this.isShallow(r,s,o,i)&&this.isShallowSampled(r,s,t,n,i)}},{key:"deleteShallowConcavities",value:function(){var e=1;this._inputLine.length;for(var n=this.findNextNonDeletedIndex(e),i=this.findNextNonDeletedIndex(n),r=!1;i<this._inputLine.length;){var s=!1;this.isDeletable(e,n,i,this._distanceTol)&&(this._isDeleted[n]=t.DELETE,s=!0,r=!0),e=s?i:n,n=this.findNextNonDeletedIndex(e),i=this.findNextNonDeletedIndex(n)}return r}},{key:"isShallowConcavity",value:function(t,e,n,i){return G.index(t,e,n)===this._angleOrientation&&q.pointToSegment(e,t,n)<i}},{key:"isShallowSampled",value:function(e,n,i,r,s){var o=Math.trunc((r-i)/t.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var a=i;a<r;a+=o)if(!this.isShallow(e,n,this._inputLine[a],s))return!1;return!0}},{key:"isConcave",value:function(t,e,n){return G.index(t,e,n)===this._angleOrientation}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=G.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(e){for(var n=e+1;n<this._inputLine.length&&this._isDeleted[n]===t.DELETE;)n++;return n}},{key:"isShallow",value:function(t,e,n,i){return q.pointToSegment(e,t,n)<i}},{key:"collapseLine",value:function(){for(var e=new R,n=0;n<this._inputLine.length;n++)this._isDeleted[n]!==t.DELETE&&e.add(this._inputLine[n]);return e.toCoordinateArray()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){return new t(e).simplify(n)}}]),t}();hr.constructor_=function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=G.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t},hr.INIT=0,hr.DELETE=1,hr.KEEP=1,hr.NUM_PTS_TO_CHECK=10;var cr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this._ptList.toArray(t.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new k(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return(new te).createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new k(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(this._ptList.size()>=2&&this._ptList.get(this._ptList.size()-2),t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();cr.constructor_=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new N},cr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var fr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=G.index(this._s0,this._s1,this._s2),i=n===G.CLOCKWISE&&this._side===An.LEFT||n===G.COUNTERCLOCKWISE&&this._side===An.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}},{key:"addLineEndCap",value:function(t,e){var n=new le(t,e),i=new le;this.computeOffsetSegment(n,An.LEFT,this._distance,i);var r=new le;this.computeOffsetSegment(n,An.RIGHT,this._distance,r);var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s);switch(this._bufParams.getEndCapStyle()){case nr.CAP_ROUND:this._segList.addPt(i.p1),this.addDirectedFillet(e,a+Math.PI/2,a-Math.PI/2,G.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case nr.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case nr.CAP_SQUARE:var u=new k;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new k(i.p1.x+u.x,i.p1.y+u.y),h=new k(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,n,i){var r=!0,s=null;try{s=V.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:s.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof P))throw t;s=new k(0,0),r=!1}r?this._segList.addPt(s):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(e,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*t.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===nr.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===nr.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new k(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new k(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new k(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new k(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,n,i,r){var s=e.x-t.x,o=e.y-t.y,a=Math.atan2(o,s),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===G.CLOCKWISE?a<=h&&(a+=2*Math.PI):a>=h&&(a-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,a,h,i,r),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,n,i){var r=this._seg0.p1,s=fe.angle(r,this._seg0.p0),o=(fe.angle(r,this._seg1.p1),fe.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2),a=fe.normalize(s+o),u=fe.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(o)),c=r.x+l*Math.cos(u),f=r.y+l*Math.sin(u),d=new k(c,f),g=new le(r,d),v=g.pointAlongOffset(1,h),_=g.pointAlongOffset(1,-h);this._side===An.LEFT?(this._segList.addPt(v),this._segList.addPt(_)):(this._segList.addPt(_),this._segList.addPt(v))}},{key:"addDirectedFillet",value:function(t,e,n,i,r){var s=i===G.CLOCKWISE?-1:1,o=Math.abs(e-n),a=Math.trunc(o/this._filletAngleQuantum+.5);if(a<1)return null;var u;u=o/a;for(var l=0,h=new k;l<o;){var c=e+s*l;h.x=t.x+r*Math.cos(c),h.y=t.y+r*Math.sin(c),this._segList.addPt(h),l+=u}}},{key:"computeOffsetSegment",value:function(t,e,n,i){var r=e===An.LEFT?1:-1,s=t.p1.x-t.p0.x,o=t.p1.y-t.p0.y,a=Math.sqrt(s*s+o*o),u=r*n*s/a,l=r*n*o/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u}},{key:"addInsideTurn",value:function(e,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*t.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var i=new k((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i);var r=new k((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new k(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new cr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*t.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===nr.JOIN_BEVEL||this._bufParams.getJoinStyle()===nr.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,G.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();fr.constructor_=function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new le,this._seg1=new le,this._offset0=new le,this._offset1=new le,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new ue,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===nr.JOIN_ROUND&&(this._closingSegLengthFactor=fr.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)},fr.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,fr.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,fr.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,fr.MAX_CLOSING_SEG_LEN_FACTOR=80;var dr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var s=r.getCoordinates();return n&&$.reverse(s),s}},{key:"computeSingleSidedBufferCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=hr.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],An.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{n.addSegments(t,!1);var a=hr.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],An.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);e===An.RIGHT&&(i=-i);var r=hr.simplify(t,i),s=r.length-1;n.initSideSegments(r[s-1],r[0],e);for(var o=1;o<=s;o++){var a=1!==o;n.addNextSegment(r[o],a)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var n=this.simplifyTolerance(this._distance),i=hr.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],An.LEFT);for(var s=2;s<=r;s++)e.addNextSegment(i[s],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var o=hr.simplify(t,-n),a=o.length-1;e.initSideSegments(o[a],o[a-1],An.LEFT);for(var u=a-2;u>=0;u--)e.addNextSegment(o[u],!0);e.addLastSegment(),e.addLineEndCap(o[1],o[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case nr.CAP_ROUND:e.createCircle(t);break;case nr.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(e,n,i){if(this._distance=i,e.length<=2)return this.getLineCurve(e,i);if(0===i)return t.copyCoordinates(e);var r=this.getSegGen(i);return this.computeRingBufferCurve(e,n,r),r.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=hr.simplify(t,-i),s=r.length-1;n.initSideSegments(r[s],r[s-1],An.LEFT),n.addFirstSegment();for(var o=s-2;o>=0;o--)n.addNextSegment(r[o],!0)}else{var a=hr.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],An.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()}},{key:"getSegGen",value:function(t){return new fr(this._precisionModel,this._bufParams,t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new k(t[n]);return e}}]),t}();dr.constructor_=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};var gr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"findStabbedSegments",value:function(){if(1===arguments.length){for(var t=arguments[0],e=new N,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(E(arguments[2],S)&&arguments[0]instanceof k&&arguments[1]instanceof ni){for(var s=arguments[0],o=arguments[1],a=arguments[2],u=o.getEdge().getCoordinates(),l=0;l<u.length-1;l++)if(!(this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),Math.max(this._seg.p0.x,this._seg.p1.x)<s.x||this._seg.isHorizontal()||s.y<this._seg.p0.y||s.y>this._seg.p1.y||G.index(this._seg.p0,this._seg.p1,s)===G.RIGHT)){var h=o.getDepth(An.LEFT);this._seg.p0.equals(u[l])||(h=o.getDepth(An.RIGHT));var c=new vr(this._seg,h);a.add(c)}}else if(E(arguments[2],S)&&arguments[0]instanceof k&&E(arguments[1],S))for(var f=arguments[0],d=arguments[2],g=arguments[1].iterator();g.hasNext();){var v=g.next();v.isForward()&&this.findStabbedSegments(f,v,d)}}},{key:"getDepth",value:function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Le.min(e)._leftDepth}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),vr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compareTo",value:function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!==(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)}},{key:"compareX",value:function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}]),t}();vr.constructor_=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new le(t),this._leftDepth=e},gr.DepthSegment=vr,gr.constructor_=function(){this._subgraphs=null,this._seg=new le;var t=arguments[0];this._subgraphs=t};var _r=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addPoint",value:function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,he.EXTERIOR,he.INTERIOR)}},{key:"addPolygon",value:function(t){var e=this._distance,n=An.LEFT;this._distance<0&&(e=-this._distance,n=An.RIGHT);var i=t.getExteriorRing(),r=$.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,he.EXTERIOR,he.INTERIOR);for(var s=0;s<t.getNumInteriorRing();s++){var o=t.getInteriorRingN(s),a=$.removeRepeatedPoints(o.getCoordinates());this._distance>0&&this.isErodedCompletely(o,-this._distance)||this.addPolygonRing(a,e,An.opposite(n),he.INTERIOR,he.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(t,e){var n=new de(t[0],t[1],t[2]),i=n.inCentre();return q.pointToSegment(i,n.p0,n.p1)<Math.abs(e)}},{key:"addLineString",value:function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=$.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,he.EXTERIOR,he.INTERIOR)}},{key:"addCurve",value:function(t,e,n){if(null===t||t.length<2)return null;var i=new Xi(t,new Xn(0,he.BOUNDARY,e,n));this._curveList.add(i)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"addPolygonRing",value:function(t,e,n,i,r){if(0===e&&t.length<qt.MINIMUM_VALID_SIZE)return null;var s=i,o=r;t.length>=qt.MINIMUM_VALID_SIZE&&G.isCCW(t)&&(s=r,o=i,n=An.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,s,o)}},{key:"add",value:function(t){if(t.isEmpty())return null;if(t instanceof Vt)this.addPolygon(t);else if(t instanceof Ft)this.addLineString(t);else if(t instanceof At)this.addPoint(t);else if(t instanceof zt)this.addCollection(t);else if(t instanceof Ct)this.addCollection(t);else if(t instanceof Yt)this.addCollection(t);else{if(!(t instanceof Et))throw new rt(t.getClass().getName());this.addCollection(t)}}},{key:"isErodedCompletely",value:function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r}},{key:"addCollection",value:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();_r.constructor_=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new N;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};var yr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getNextCW",value:function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)}},{key:"propagateSideLabels",value:function(t){for(var e=he.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,An.LEFT)!==he.NONE&&(e=i.getLocation(t,An.LEFT))}if(e===he.NONE)return null;for(var r=e,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getLabel();if(a.getLocation(t,An.ON)===he.NONE&&a.setLocation(t,An.ON,r),a.isArea(t)){var u=a.getLocation(t,An.LEFT),l=a.getLocation(t,An.RIGHT);if(l!==he.NONE){if(l!==r)throw new ei("side location conflict",o.getCoordinate());u===he.NONE&&m.shouldNeverReachHere("found single null side (at "+o.getCoordinate()+")"),r=u}else m.isTrue(a.getLocation(t,An.LEFT)===he.NONE,"found single null side"),a.setLocation(t,An.RIGHT,r),a.setLocation(t,An.LEFT,r)}}}},{key:"getCoordinate",value:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}},{key:"print",value:function(t){B.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"isAreaLabelsConsistent",value:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,An.LEFT);m.isTrue(i!==he.NONE,"Found unlabelled area edge");for(var r=i,s=this.iterator();s.hasNext();){var o=s.next().getLabel();m.isTrue(o.isArea(t),"Found non-area edge");var a=o.getLocation(t,An.LEFT),u=o.getLocation(t,An.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0}},{key:"findIndex",value:function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return null===this._edgeList&&(this._edgeList=new N(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(t,e,n){return this._ptInAreaLocation[t]===he.NONE&&(this._ptInAreaLocation[t]=sn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}},{key:"toString",value:function(){var t=new M;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()}},{key:"computeEdgeEndLabels",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)}},{key:"computeLabelling",value:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===he.BOUNDARY&&(e[r]=!0);for(var s=this.iterator();s.hasNext();)for(var o=s.next(),a=o.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=he.NONE;if(e[u])l=he.EXTERIOR;else{var h=o.getCoordinate();l=this.getLocation(u,h,t)}a.setAllLocationsIfNull(u,l)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(t,e){this._edgeMap.put(t,e),this._edgeList=null}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();yr.constructor_=function(){this._edgeMap=new dt,this._edgeList=null,this._ptInAreaLocation=[he.NONE,he.NONE]};var pr=function(t){s(n,yr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),s=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!s.isInResult())continue;e=s,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new ei("no outgoing dirEdge found",this.getCoordinate());m.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}}},{key:"insert",value:function(t){var e=t;this.insertEdgeEnd(e,e)}},{key:"getRightmostEdge",value:function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),s=i.getQuadrant();return Rn.isNorthern(r)&&Rn.isNorthern(s)?n:Rn.isNorthern(r)||Rn.isNorthern(s)?0!==n.getDy()?n:0!==i.getDy()?i:(m.shouldNeverReachHere("found two horizontal edges incident on node"),null):i}},{key:"print",value:function(t){B.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}}},{key:"getResultAreaEdges",value:function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new N;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)}},{key:"computeDepths",value:function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(An.LEFT),i=t.getDepth(An.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new ei("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var s=arguments[1],o=arguments[2],a=arguments[0];a<s;a++){var u=this._edgeList.get(a);u.setEdgeDepths(An.RIGHT,o),o=u.getDepth(An.LEFT)}return o}}},{key:"mergeSymLabels",value:function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var s=this._resultAreaEdgeList.get(r),o=s.getSym();switch(null===e&&s.getEdgeRing()===t&&(e=s),i){case this._SCANNING_FOR_INCOMING:if(o.getEdgeRing()!==t)continue;n=o,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(s.getEdgeRing()!==t)continue;n.setNextMin(s),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(m.isTrue(null!==e,"found null for first outgoing dirEdge"),m.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))}},{key:"getOutgoingDegree",value:function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var t=he.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=he.INTERIOR;break}if(i.isInResult()){t=he.EXTERIOR;break}}}if(t===he.NONE)return null;for(var r=t,s=this.iterator();s.hasNext();){var o=s.next(),a=o.getSym();o.isLineEdge()?o.getEdge().setCovered(r===he.INTERIOR):(o.isInResult()&&(r=he.EXTERIOR),a.isInResult()&&(r=he.INTERIOR))}}},{key:"computeLabelling",value:function(t){i(c(n.prototype),"computeLabelling",this).call(this,t),this._label=new Xn(he.NONE);for(var e=this.iterator();e.hasNext();)for(var r=e.next().getEdge().getLabel(),s=0;s<2;s++){var o=r.getLocation(s);o!==he.INTERIOR&&o!==he.BOUNDARY||this._label.setLocation(s,he.INTERIOR)}}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();pr.constructor_=function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2};var mr=function(t){s(n,ii);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"createNode",value:function(t){return new Qn(t,new pr)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();mr.constructor_=function(){};var kr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compareTo",value:function(e){var n=e;return t.compareOriented(this._pts,this._orientation,n._pts,n._orientation)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}],[{key:"orientation",value:function(t){return 1===$.increasingDirection(t)}},{key:"compareOriented",value:function(t,e,n,i){for(var r=e?1:-1,s=i?1:-1,o=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===o,f=(l+=s)===a;if(c&&!f)return-1;if(!c&&f)return 1;if(c&&f)return 0}}}]),t}();kr.constructor_=function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=kr.orientation(t)};var xr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"print",value:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")}},{key:"addAll",value:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())}},{key:"findEdgeIndex",value:function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(t){return this._edges.get(t)}},{key:"findEqualEdge",value:function(t){var e=new kr(t.getCoordinates());return this._ocaMap.get(e)}},{key:"add",value:function(t){this._edges.add(t);var e=new kr(t.getCoordinates());this._ocaMap.put(e,t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();xr.constructor_=function(){this._edges=new N,this._ocaMap=new dt};var Er=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"processIntersections",value:function(t,e,n,i){}},{key:"isDone",value:function(){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Er.constructor_=function(){};var Cr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isTrivialIntersection",value:function(e,n,i,r){if(e===i&&1===this._li.getIntersectionNum()){if(t.isAdjacentSegments(n,r))return!0;if(e.isClosed()){var s=e.size()-1;if(0===n&&r===s||0===r&&n===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Er]}}],[{key:"isAdjacentSegments",value:function(t,e){return 1===Math.abs(t-e)}}]),t}();Cr.constructor_=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};var Ir=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(e){var n=this._edgeList.findEqualEdge(e);if(null!==n){var i=n.getLabel(),r=e.getLabel();n.isPointwiseEqual(e)||(r=new Xn(e.getLabel())).flip(),i.merge(r);var s=t.depthDelta(r),o=n.getDepthDelta()+s;n.setDepthDelta(o)}else this._edgeList.add(e),e.setDepthDelta(t.depthDelta(e.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var n=new N,i=t.iterator();i.hasNext();){var r=i.next(),s=r.getRightmostCoordinate(),o=new gr(n).getDepth(s);r.computeDepth(o),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new N,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new sr;r.create(i),e.add(r)}}return Le.sort(e,Le.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new Zi,n=new ue;return n.setPrecisionModel(t),e.setSegmentIntersector(new Cr(n)),e}},{key:"buffer",value:function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new dr(n,this._bufParams),r=new _r(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new ri(new mr),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),o=new lr(this._geomFact);this.buildSubgraphs(s,o);var a=o.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)}},{key:"computeNodedEdges",value:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),s=r.getCoordinates();if(2!==s.length||!s[0].equals2D(s[1])){var o=r.getData(),a=new Jn(r.getCoordinates(),new Xn(o));this.insertUniqueEdge(a)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"depthDelta",value:function(t){var e=t.getLocation(0,An.LEFT),n=t.getLocation(0,An.RIGHT);return e===he.INTERIOR&&n===he.EXTERIOR?1:e===he.EXTERIOR&&n===he.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new te,n=new N;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)}}]),t}();Ir.constructor_=function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new xr;var t=arguments[0];this._bufParams=t};var Sr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"checkEndPtVertexIntersections",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),s=1;s<r.length-1;s++)if(r[s].equals(n))throw new y("found endpt/interior pt intersection at index "+s+" :pt "+n)}},{key:"checkInteriorIntersections",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],s=arguments[1],o=r.getCoordinates(),a=s.getCoordinates(),u=0;u<o.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,s,l);else if(4===arguments.length){var h=arguments[0],c=arguments[1],f=arguments[2],d=arguments[3];if(h===f&&c===d)return null;var g=h.getCoordinates()[c],v=h.getCoordinates()[c+1],_=f.getCoordinates()[d],p=f.getCoordinates()[d+1];if(this._li.computeIntersection(g,v,_,p),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,g,v)||this.hasInteriorIntersection(this._li,_,p)))throw new y("found non-noded intersection at "+g+"-"+v+" and "+_+"-"+p)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])}},{key:"hasInteriorIntersection",value:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(e,n,i){if(e.equals(i))throw new y("found non-noded collapse at "+t.fact.createLineString([e,n,i]))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Sr.constructor_=function(){this._li=new ue,this._segStrings=null;var t=arguments[0];this._segStrings=t},Sr.fact=new te;var wr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"intersectsScaled",value:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),s=Math.max(t.y,e.y),o=this._maxx<n||this._minx>i||this._maxy<r||this._miny>s;if(o)return!1;var a=this.intersectsToleranceSquare(t,e);return m.isTrue(!(o&&a),"Found bad envelope test"),a}},{key:"initCorners",value:function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new k(this._maxx,this._maxy),this._corner[1]=new k(this._minx,this._maxy),this._corner[2]=new k(this._minx,this._miny),this._corner[3]=new k(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(null===this._safeEnv){var e=t.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new T(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))}},{key:"intersectsToleranceSquare",value:function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))}},{key:"addSnappedNode",value:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();wr.constructor_=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],i=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=i,e<=0)throw new n("Scale factor must be non-zero");1!==e&&(this._pt=new k(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new k,this._p1Scaled=new k),this.initCorners(this._pt)},wr.SAFE_ENV_EXPANSION_FACTOR=.75;var Nr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"select",value:function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Nr.constructor_=function(){this.selectedSegment=new le};var Lr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"snap",value:function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),s=new Rr(e,n,i);return this._index.query(r,new(function(){function t(){f(this,t)}return g(t,[{key:"visitItem",value:function(t){t.select(r,s)}},{key:"interfaces_",get:function(){return[Ye]}}]),t}())),s.isNodeAdded()}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),Rr=function(t){s(n,Nr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(2===arguments.length&&Number.isInteger(arguments[1])&&arguments[0]instanceof Wi))return i(c(n.prototype),"select",this).apply(this,arguments);var t=arguments[1],e=arguments[0].getContext();if(null!==this._parentEdge&&e===this._parentEdge&&t===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(e,t)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Rr.constructor_=function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n},Lr.HotPixelSnapAction=Rr,Lr.constructor_=function(){this._index=null;var t=arguments[0];this._index=t};var Tr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"processIntersections",value:function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Er]}}]),t}();Tr.constructor_=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new N};var br=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"checkCorrectness",value:function(t){var e=Xi.getNodedSubstrings(t),n=new Sr(e);try{n.checkValid()}catch(t){if(!(t instanceof b))throw t;t.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Xi.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}},{key:"findInteriorIntersections",value:function(t,e){var n=new Tr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Xi)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var s=new wr(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(s,n,r)&&n.addIntersection(i[r],r)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t,this._noder=new Zi,this._pointSnapper=new Lr(this._noder.getIndex()),this.snapRound(t,this._li)}},{key:"computeIntersectionSnaps",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new wr(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[ji]}}]),t}();br.constructor_=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new ue,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};var Pr=function(){function e(){f(this,e),e.constructor_.apply(this,arguments)}return g(e,[{key:"bufferFixedPrecision",value:function(t){var e=new Qi(new br(new Qt(1)),t.getScale()),n=new Ir(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(0===arguments.length){for(var n=e.MAX_PRECISION_DIGITS;n>=0;n--){try{this.bufferReducedPrecision(n)}catch(t){if(!(t instanceof ei))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var i=arguments[0],r=e.precisionScaleFactor(this._argGeom,this._distance,i),s=new Qt(r);this.bufferFixedPrecision(s)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Qt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var e=new Ir(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof y))throw t;this._saveException=t}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}},{key:"getClass",value:function(){return e}},{key:"interfaces_",get:function(){return[]}}],[{key:"bufferOp",value:function(){if(2===arguments.length){var t=arguments[1];return new e(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof W&&"number"==typeof arguments[1]){var n=arguments[1],i=arguments[2],r=new e(arguments[0]);return r.setQuadrantSegments(i),r.getResultGeometry(n)}if(arguments[2]instanceof nr&&arguments[0]instanceof W&&"number"==typeof arguments[1]){var s=arguments[1];return new e(arguments[0],arguments[2]).getResultGeometry(s)}}else if(4===arguments.length){var o=arguments[1],a=arguments[2],u=arguments[3],l=new e(arguments[0]);return l.setQuadrantSegments(a),l.setEndCapStyle(u),l.getResultGeometry(o)}}},{key:"precisionScaleFactor",value:function(t,e,n){var i=t.getEnvelopeInternal(),r=z.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),s=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,s)}}]),e}();Pr.constructor_=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new nr,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},Pr.CAP_ROUND=nr.CAP_ROUND,Pr.CAP_BUTT=nr.CAP_FLAT,Pr.CAP_FLAT=nr.CAP_FLAT,Pr.CAP_SQUARE=nr.CAP_SQUARE,Pr.MAX_PRECISION_DIGITS=12;var Mr=Object.freeze({__proto__:null,BufferOp:Pr,BufferParameters:nr}),Or=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isInsideArea",value:function(){return this._segIndex===t.INSIDE_AREA}},{key:"getCoordinate",value:function(){return this._pt}},{key:"getGeometryComponent",value:function(){return this._component}},{key:"getSegmentIndex",value:function(){return this._segIndex}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Or.constructor_=function(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length){var t=arguments[0],e=arguments[1];Or.constructor_.call(this,t,Or.INSIDE_AREA,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._component=n,this._segIndex=i,this._pt=r}},Or.INSIDE_AREA=-1;var Fr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){(t instanceof At||t instanceof Ft||t instanceof Vt)&&this._locations.add(new Or(t,0,t.getCoordinate()))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[kt]}}],[{key:"getLocations",value:function(e){var n=new N;return e.apply(new t(n)),n}}]),t}();Fr.constructor_=function(){this._locations=null;var t=arguments[0];this._locations=t};var Dr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"computeContainmentDistance",value:function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=this._geom[e];if(i.getDimension()<2)return null;var r=1-e,s=Te.getPolygons(i);if(s.size()>0){var o=Fr.getLocations(this._geom[r]);if(this.computeContainmentDistance(o,s,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[r]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&E(arguments[0],S)&&E(arguments[1],S)){for(var a=arguments[0],u=arguments[1],l=arguments[2],h=0;h<a.size();h++)for(var c=a.get(h),f=0;f<u.size();f++)if(this.computeContainmentDistance(c,u.get(f),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Or&&arguments[1]instanceof Vt){var d=arguments[0],g=arguments[1],v=arguments[2],_=d.getCoordinate();if(he.EXTERIOR!==this._ptLocator.locate(_,g))return this._minDistance=0,v[0]=d,v[1]=new Or(g,_),null}}},{key:"computeMinDistanceLinesPoints",value:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this._minDistance<=this._terminateDistance)return null}}},{key:"computeFacetDistance",value:function(){var t=new Array(2).fill(null),e=Ne.getLines(this._geom[0]),n=Ne.getLines(this._geom[1]),i=Re.getPoints(this._geom[0]),r=Re.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))}},{key:"nearestLocations",value:function(){return this.computeMinDistance(),this._minDistanceLocation}},{key:"updateMinDistance",value:function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])}},{key:"nearestPoints",value:function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]}},{key:"computeMinDistance",value:function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof At){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),s=0;s<i.length-1;s++){var o=q.pointToSegment(r,i[s],i[s+1]);if(o<this._minDistance){this._minDistance=o;var a=new le(i[s],i[s+1]).closestPoint(r);n[0]=new Or(t,s,a),n[1]=new Or(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ft&&arguments[1]instanceof Ft){var u=arguments[0],l=arguments[1],h=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var c=u.getCoordinates(),f=l.getCoordinates(),d=0;d<c.length-1;d++)for(var g=0;g<f.length-1;g++){var v=q.segmentToSegment(c[d],c[d+1],f[g],f[g+1]);if(v<this._minDistance){this._minDistance=v;var _=new le(c[d],c[d+1]),y=new le(f[g],f[g+1]),p=_.closestPoints(y);h[0]=new Or(u,d,p[0]),h[1]=new Or(l,g,p[1])}if(this._minDistance<=this._terminateDistance)return null}}}},{key:"computeMinDistancePoints",value:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s),a=r.getCoordinate().distance(o.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Or(r,0,r.getCoordinate()),n[1]=new Or(o,0,o.getCoordinate())),this._minDistance<=this._terminateDistance)return null}}},{key:"distance",value:function(){if(null===this._geom[0]||null===this._geom[1])throw new n("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)}},{key:"computeMinDistanceLines",value:function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),s=0;s<e.size();s++){var o=e.get(s);if(this.computeMinDistance(r,o,n),this._minDistance<=this._terminateDistance)return null}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"distance",value:function(e,n){return new t(e,n).distance()}},{key:"isWithinDistance",value:function(e,n,i){return!(e.getEnvelopeInternal().distance(n.getEnvelopeInternal())>i)&&new t(e,n,i).distance()<=i}},{key:"nearestPoints",value:function(e,n){return new t(e,n).nearestPoints()}}]),t}();Dr.constructor_=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new En,this._minDistanceLocation=null,this._minDistance=o.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];Dr.constructor_.call(this,t,e,0)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};var Ar=Object.freeze({__proto__:null,DistanceOp:Dr}),Gr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){if(null===this._coordinates){for(var t=0,e=0,n=new R,i=this._directedEdges.iterator();i.hasNext();){var r=i.next();r.getEdgeDirection()?t++:e++,n.add(r.getEdge().getLine().getCoordinates(),!1,r.getEdgeDirection())}this._coordinates=n.toCoordinateArray(),e>t&&$.reverse(this._coordinates)}return this._coordinates}},{key:"toLineString",value:function(){return this._factory.createLineString(this.getCoordinates())}},{key:"add",value:function(t){this._directedEdges.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Gr.constructor_=function(){this._factory=null,this._directedEdges=new N,this._coordinates=null;var t=arguments[0];this._factory=t};var Br=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setVisited",value:function(t){this._isVisited=t}},{key:"isMarked",value:function(){return this._isMarked}},{key:"setData",value:function(t){this._data=t}},{key:"getData",value:function(){return this._data}},{key:"setMarked",value:function(t){this._isMarked=t}},{key:"getContext",value:function(){return this._data}},{key:"isVisited",value:function(){return this._isVisited}},{key:"setContext",value:function(t){this._data=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getComponentWithVisitedState",value:function(t,e){for(;t.hasNext();){var n=t.next();if(n.isVisited()===e)return n}return null}},{key:"setVisited",value:function(t,e){for(;t.hasNext();)t.next().setVisited(e)}},{key:"setMarked",value:function(t,e){for(;t.hasNext();)t.next().setMarked(e)}}]),t}();Br.constructor_=function(){this._isMarked=!1,this._isVisited=!1,this._data=null};var Vr=function(t){s(n,Br);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isRemoved",value:function(){return null===this._parentEdge}},{key:"compareDirection",value:function(t){return this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:G.index(t._p0,t._p1,this._p1)}},{key:"getCoordinate",value:function(){return this._from.getCoordinate()}},{key:"print",value:function(t){var e=this.getClass().getName(),n=e.lastIndexOf("."),i=e.substring(n+1);t.print("  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+this._angle)}},{key:"getDirectionPt",value:function(){return this._p1}},{key:"getAngle",value:function(){return this._angle}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getFromNode",value:function(){return this._from}},{key:"getSym",value:function(){return this._sym}},{key:"setEdge",value:function(t){this._parentEdge=t}},{key:"remove",value:function(){this._sym=null,this._parentEdge=null}},{key:"getEdge",value:function(){return this._parentEdge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"setSym",value:function(t){this._sym=t}},{key:"getToNode",value:function(){return this._to}},{key:"getEdgeDirection",value:function(){return this._edgeDirection}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[h]}}],[{key:"toEdges",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();)e.add(n.next()._parentEdge);return e}}]),n}();Vr.constructor_=function(){if(this._parentEdge=null,this._from=null,this._to=null,this._p0=null,this._p1=null,this._sym=null,this._edgeDirection=null,this._quadrant=null,this._angle=null,0===arguments.length);else if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._from=t,this._to=e,this._edgeDirection=i,this._p0=t.getCoordinate(),this._p1=n;var r=this._p1.x-this._p0.x,s=this._p1.y-this._p0.y;this._quadrant=Rn.quadrant(r,s),this._angle=Math.atan2(s,r)}};var zr=function(t){s(n,Vr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getNext",value:function(){return 2!==this.getToNode().getDegree()?null:this.getToNode().getOutEdges().getEdges().get(0)===this.getSym()?this.getToNode().getOutEdges().getEdges().get(1):(m.isTrue(this.getToNode().getOutEdges().getEdges().get(1)===this.getSym()),this.getToNode().getOutEdges().getEdges().get(0))}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();zr.constructor_=function(){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Vr.constructor_.call(this,t,e,n,i)};var qr=function(t){s(n,Br);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isRemoved",value:function(){return null===this._dirEdge}},{key:"setDirectedEdges",value:function(t,e){this._dirEdge=[t,e],t.setEdge(this),e.setEdge(this),t.setSym(e),e.setSym(t),t.getFromNode().addOutEdge(t),e.getFromNode().addOutEdge(e)}},{key:"getDirEdge",value:function(){if(Number.isInteger(arguments[0])){var t=arguments[0];return this._dirEdge[t]}if(arguments[0]instanceof Xr){var e=arguments[0];return this._dirEdge[0].getFromNode()===e?this._dirEdge[0]:this._dirEdge[1].getFromNode()===e?this._dirEdge[1]:null}}},{key:"remove",value:function(){this._dirEdge=null}},{key:"getOppositeNode",value:function(t){return this._dirEdge[0].getFromNode()===t?this._dirEdge[0].getToNode():this._dirEdge[1].getFromNode()===t?this._dirEdge[1].getToNode():null}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();qr.constructor_=function(){if(this._dirEdge=null,0===arguments.length);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.setDirectedEdges(t,e)}};var Yr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getNextEdge",value:function(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e+1))}},{key:"getCoordinate",value:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}},{key:"iterator",value:function(){return this.sortEdges(),this._outEdges.iterator()}},{key:"sortEdges",value:function(){this._sorted||(Le.sort(this._outEdges),this._sorted=!0)}},{key:"remove",value:function(t){this._outEdges.remove(t)}},{key:"getEdges",value:function(){return this.sortEdges(),this._outEdges}},{key:"getNextCWEdge",value:function(t){var e=this.getIndex(t);return this._outEdges.get(this.getIndex(e-1))}},{key:"getIndex",value:function(){if(arguments[0]instanceof qr){var t=arguments[0];this.sortEdges();for(var e=0;e<this._outEdges.size();e++)if(this._outEdges.get(e).getEdge()===t)return e;return-1}if(arguments[0]instanceof Vr){var n=arguments[0];this.sortEdges();for(var i=0;i<this._outEdges.size();i++)if(this._outEdges.get(i)===n)return i;return-1}if(Number.isInteger(arguments[0])){var r=arguments[0]%this._outEdges.size();return r<0&&(r+=this._outEdges.size()),r}}},{key:"add",value:function(t){this._outEdges.add(t),this._sorted=!1}},{key:"getDegree",value:function(){return this._outEdges.size()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Yr.constructor_=function(){this._outEdges=new N,this._sorted=!1};var Xr=function(t){s(n,Br);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isRemoved",value:function(){return null===this._pt}},{key:"addOutEdge",value:function(t){this._deStar.add(t)}},{key:"getCoordinate",value:function(){return this._pt}},{key:"getOutEdges",value:function(){return this._deStar}},{key:"remove",value:function(){if(0===arguments.length)this._pt=null;else if(1===arguments.length){var t=arguments[0];this._deStar.remove(t)}}},{key:"getIndex",value:function(t){return this._deStar.getIndex(t)}},{key:"getDegree",value:function(){return this._deStar.getDegree()}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"getEdgesBetween",value:function(t,e){var n=new ot(Vr.toEdges(t.getOutEdges().getEdges())),i=Vr.toEdges(e.getOutEdges().getEdges());return n.retainAll(i),n}}]),n}();Xr.constructor_=function(){if(this._pt=null,this._deStar=null,1===arguments.length){var t=arguments[0];Xr.constructor_.call(this,t,new Yr)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._pt=e,this._deStar=n}};var Ur=function(t){s(n,qr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getLine",value:function(){return this._line}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Ur.constructor_=function(){this._line=null;var t=arguments[0];this._line=t};var Wr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"find",value:function(t){return this._nodeMap.get(t)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"remove",value:function(t){return this._nodeMap.remove(t)}},{key:"values",value:function(){return this._nodeMap.values()}},{key:"add",value:function(t){return this._nodeMap.put(t.getCoordinate(),t),t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Wr.constructor_=function(){this._nodeMap=new dt};var Hr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"findNodesOfDegree",value:function(t){for(var e=new N,n=this.nodeIterator();n.hasNext();){var i=n.next();i.getDegree()===t&&e.add(i)}return e}},{key:"dirEdgeIterator",value:function(){return this._dirEdges.iterator()}},{key:"edgeIterator",value:function(){return this._edges.iterator()}},{key:"remove",value:function(){if(arguments[0]instanceof qr){var t=arguments[0];this.remove(t.getDirEdge(0)),this.remove(t.getDirEdge(1)),this._edges.remove(t),t.remove()}else if(arguments[0]instanceof Vr){var e=arguments[0],n=e.getSym();null!==n&&n.setSym(null),e.getFromNode().remove(e),e.remove(),this._dirEdges.remove(e)}else if(arguments[0]instanceof Xr){for(var i=arguments[0],r=i.getOutEdges().getEdges().iterator();r.hasNext();){var s=r.next(),o=s.getSym();null!==o&&this.remove(o),this._dirEdges.remove(s);var a=s.getEdge();null!==a&&this._edges.remove(a)}this._nodeMap.remove(i.getCoordinate()),i.remove()}}},{key:"findNode",value:function(t){return this._nodeMap.find(t)}},{key:"getEdges",value:function(){return this._edges}},{key:"nodeIterator",value:function(){return this._nodeMap.iterator()}},{key:"contains",value:function(){if(arguments[0]instanceof qr){var t=arguments[0];return this._edges.contains(t)}if(arguments[0]instanceof Vr){var e=arguments[0];return this._dirEdges.contains(e)}}},{key:"add",value:function(){if(arguments[0]instanceof Xr){var t=arguments[0];this._nodeMap.add(t)}else if(arguments[0]instanceof qr){var e=arguments[0];this._edges.add(e),this.add(e.getDirEdge(0)),this.add(e.getDirEdge(1))}else if(arguments[0]instanceof Vr){var n=arguments[0];this._dirEdges.add(n)}}},{key:"getNodes",value:function(){return this._nodeMap.values()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Hr.constructor_=function(){this._edges=new ot,this._dirEdges=new ot,this._nodeMap=new Wr};var jr=function(t){s(n,Hr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"addEdge",value:function(t){if(t.isEmpty())return null;var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<=1)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new zr(r,s,e[1],!0),a=new zr(s,r,e[e.length-2],!1),u=new Ur(t);u.setDirectedEdges(o,a),this.add(u)}},{key:"getNode",value:function(t){var e=this.findNode(t);return null===e&&(e=new Xr(t),this.add(e)),e}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();jr.constructor_=function(){};var Kr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"buildEdgeStringsForUnprocessedNodes",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();e.isMarked()||(m.isTrue(2===e.getDegree()),this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}},{key:"buildEdgeStringsForNonDegree2Nodes",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next();2!==e.getDegree()&&(this.buildEdgeStringsStartingAt(e),e.setMarked(!0))}}},{key:"buildEdgeStringsForObviousStartNodes",value:function(){this.buildEdgeStringsForNonDegree2Nodes()}},{key:"getMergedLineStrings",value:function(){return this.merge(),this._mergedLineStrings}},{key:"buildEdgeStringsStartingAt",value:function(t){for(var e=t.getOutEdges().iterator();e.hasNext();){var n=e.next();n.getEdge().isMarked()||this._edgeStrings.add(this.buildEdgeStringStartingWith(n))}}},{key:"merge",value:function(){if(null!==this._mergedLineStrings)return null;Br.setMarked(this._graph.nodeIterator(),!1),Br.setMarked(this._graph.edgeIterator(),!1),this._edgeStrings=new N,this.buildEdgeStringsForObviousStartNodes(),this.buildEdgeStringsForIsolatedLoops(),this._mergedLineStrings=new N;for(var t=this._edgeStrings.iterator();t.hasNext();){var e=t.next();this._mergedLineStrings.add(e.toLineString())}}},{key:"addLineString",value:function(t){null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t)}},{key:"buildEdgeStringStartingWith",value:function(t){var e=new Gr(this._factory),n=t;do{e.add(n),n.getEdge().setMarked(!0),n=n.getNext()}while(null!==n&&n!==t);return e}},{key:"add",value:function(){if(arguments[0]instanceof W)for(var t=arguments[0],e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);n instanceof Ft&&this.addLineString(n)}else if(E(arguments[0],C)){var i=arguments[0];this._mergedLineStrings=null;for(var r=i.iterator();r.hasNext();){var s=r.next();this.add(s)}}}},{key:"buildEdgeStringsForIsolatedLoops",value:function(){this.buildEdgeStringsForUnprocessedNodes()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Kr.constructor_=function(){this._graph=new jr,this._mergedLineStrings=null,this._factory=null,this._edgeStrings=null};var Zr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"dirEdgeIterator",value:function(){return this._dirEdges.iterator()}},{key:"edgeIterator",value:function(){return this._edges.iterator()}},{key:"getParent",value:function(){return this._parentGraph}},{key:"nodeIterator",value:function(){return this._nodeMap.iterator()}},{key:"contains",value:function(t){return this._edges.contains(t)}},{key:"add",value:function(t){if(this._edges.contains(t))return null;this._edges.add(t),this._dirEdges.add(t.getDirEdge(0)),this._dirEdges.add(t.getDirEdge(1)),this._nodeMap.add(t.getDirEdge(0).getFromNode()),this._nodeMap.add(t.getDirEdge(1).getFromNode())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Zr.constructor_=function(){this._parentGraph=null,this._edges=new ot,this._dirEdges=new N,this._nodeMap=new Wr;var t=arguments[0];this._parentGraph=t};var Jr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addReachable",value:function(t,e){var n=new gn;for(n.add(t);!n.empty();){var i=n.pop();this.addEdges(i,n,e)}}},{key:"findSubgraph",value:function(t){var e=new Zr(this._graph);return this.addReachable(t,e),e}},{key:"getConnectedSubgraphs",value:function(){var t=new N;Br.setVisited(this._graph.nodeIterator(),!1);for(var e=this._graph.edgeIterator();e.hasNext();){var n=e.next().getDirEdge(0).getFromNode();n.isVisited()||t.add(this.findSubgraph(n))}return t}},{key:"addEdges",value:function(t,e,n){t.setVisited(!0);for(var i=t.getOutEdges().iterator();i.hasNext();){var r=i.next();n.add(r.getEdge());var s=r.getToNode();s.isVisited()||e.push(s)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Jr.constructor_=function(){this._graph=null;var t=arguments[0];this._graph=t};var Qr=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addLine",value:function(t){null===this._factory&&(this._factory=t.getFactory()),this._graph.addEdge(t),this._lineCount++}},{key:"hasSequence",value:function(t){for(var e=0,n=t.nodeIterator();n.hasNext();)n.next().getDegree()%2==1&&e++;return e<=2}},{key:"computeSequence",value:function(){if(this._isRun)return null;this._isRun=!0;var t=this.findSequences();if(null===t)return null;this._sequencedGeometry=this.buildSequencedGeometry(t),this._isSequenceable=!0;var e=this._sequencedGeometry.getNumGeometries();m.isTrue(this._lineCount===e,"Lines were missing from result"),m.isTrue(this._sequencedGeometry instanceof Ft||this._sequencedGeometry instanceof Ct,"Result is not lineal")}},{key:"findSequences",value:function(){for(var t=new N,e=new Jr(this._graph).getConnectedSubgraphs().iterator();e.hasNext();){var n=e.next();if(!this.hasSequence(n))return null;var i=this.findSequence(n);t.add(i)}return t}},{key:"addReverseSubpath",value:function(e,n,i){for(var r=e.getToNode(),s=null;;){n.add(e.getSym()),e.getEdge().setVisited(!0),s=e.getFromNode();var o=t.findUnvisitedBestOrientedDE(s);if(null===o)break;e=o.getSym()}i&&m.isTrue(s===r,"path not contiguous")}},{key:"findSequence",value:function(e){Br.setVisited(e.edgeIterator(),!1);var n=t.findLowestDegreeNode(e).getOutEdges().iterator().next().getSym(),i=new rr,r=i.listIterator();for(this.addReverseSubpath(n,r,!1);r.hasPrevious();){var s=r.previous(),o=t.findUnvisitedBestOrientedDE(s.getFromNode());null!==o&&this.addReverseSubpath(o.getSym(),r,!0)}return this.orient(i)}},{key:"reverse",value:function(t){for(var e=new rr,n=t.iterator();n.hasNext();){var i=n.next();e.addFirst(i.getSym())}return e}},{key:"orient",value:function(t){var e=t.get(0),n=t.get(t.size()-1),i=e.getFromNode(),r=n.getToNode(),s=!1;if(1===i.getDegree()||1===r.getDegree()){var o=!1;1===n.getToNode().getDegree()&&!1===n.getEdgeDirection()&&(o=!0,s=!0),1===e.getFromNode().getDegree()&&!0===e.getEdgeDirection()&&(o=!0,s=!1),o||1===e.getFromNode().getDegree()&&(s=!0)}return s?this.reverse(t):t}},{key:"buildSequencedGeometry",value:function(e){for(var n=new N,i=e.iterator();i.hasNext();)for(var r=i.next().iterator();r.hasNext();){var s=r.next(),o=s.getEdge().getLine(),a=o;s.getEdgeDirection()||o.isClosed()||(a=t.reverse(o)),n.add(a)}return 0===n.size()?this._factory.createMultiLineString(new Array(0).fill(null)):this._factory.buildGeometry(n)}},{key:"getSequencedLineStrings",value:function(){return this.computeSequence(),this._sequencedGeometry}},{key:"isSequenceable",value:function(){return this.computeSequence(),this._isSequenceable}},{key:"add",value:function(){if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else arguments[0]instanceof W&&arguments[0].apply(new(function(){function t(){f(this,t)}return g(t,[{key:"filter",value:function(t){t instanceof Ft&&this.addLine(t)}},{key:"interfaces_",get:function(){return[U]}}]),t}()))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"findUnvisitedBestOrientedDE",value:function(t){for(var e=null,n=null,i=t.getOutEdges().iterator();i.hasNext();){var r=i.next();r.getEdge().isVisited()||(n=r,r.getEdgeDirection()&&(e=r))}return null!==e?e:n}},{key:"findLowestDegreeNode",value:function(t){for(var e=O.MAX_VALUE,n=null,i=t.nodeIterator();i.hasNext();){var r=i.next();(null===n||r.getDegree()<e)&&(e=r.getDegree(),n=r)}return n}},{key:"isSequenced",value:function(t){if(!(t instanceof Ct))return!0;for(var e=t,n=new _t,i=null,r=new N,s=0;s<e.getNumGeometries();s++){var o=e.getGeometryN(s),a=o.getCoordinateN(0),u=o.getCoordinateN(o.getNumPoints()-1);if(n.contains(a))return!1;if(n.contains(u))return!1;null!==i&&(a.equals(i)||(n.addAll(r),r.clear())),r.add(a),r.add(u),i=u}return!0}},{key:"reverse",value:function(t){for(var e=t.getCoordinates(),n=new Array(e.length).fill(null),i=e.length,r=0;r<i;r++)n[i-1-r]=new k(e[r]);return t.getFactory().createLineString(n)}},{key:"sequence",value:function(e){var n=new t;return n.add(e),n.getSequencedLineStrings()}}]),t}();Qr.constructor_=function(){this._graph=new jr,this._factory=new te,this._lineCount=0,this._isRun=!1,this._sequencedGeometry=null,this._isSequenceable=!1};var $r=Object.freeze({__proto__:null,LineMerger:Kr,LineSequencer:Qr}),ts=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"snapVertices",value:function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),s=this.findSnapForVertex(r,e);null!==s&&(t.set(i,new k(s)),0===i&&this._isClosed&&t.set(t.size()-1,new k(s)))}}},{key:"findSnapForVertex",value:function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null}},{key:"snapTo",value:function(t){var e=new R(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()}},{key:"snapSegments",value:function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],s=this.findSegmentIndexToSnap(r,t);s>=0&&t.add(s+1,new k(r),!1)}}},{key:"findSegmentIndexToSnap",value:function(t,e){for(var n=o.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var s=this._seg.distance(t);s<this._snapTolerance&&s<n&&(n=s,i=r)}return i}},{key:"setAllowSnappingToSourceVertices",value:function(t){this._allowSnappingToSourceVertices=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isClosed",value:function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])}}]),t}();ts.constructor_=function(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new le,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Ft&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];ts.constructor_.call(this,t.getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this._srcPts=n,this._isClosed=ts.isClosed(n),this._snapTolerance=i}};var es=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"snapTo",value:function(t,e){var n=this.extractTargetCoordinates(t);return new ns(e,n).transform(this._srcGeom)}},{key:"snapToSelf",value:function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new ns(t,n,!0).transform(this._srcGeom),r=i;return e&&E(r,Bt)&&(r=i.buffer(0)),r}},{key:"computeSnapTolerance",value:function(t){return this.computeMinimumSegmentLength(t)/10}},{key:"extractTargetCoordinates",value:function(t){for(var e=new _t,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))}},{key:"computeMinimumSegmentLength",value:function(t){for(var e=o.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"snap",value:function(e,n,i){var r=new Array(2).fill(null),s=new t(e);r[0]=s.snapTo(n,i);var o=new t(n);return r[1]=o.snapTo(r[0],i),r}},{key:"computeOverlaySnapTolerance",value:function(){if(1===arguments.length){var e=arguments[0],n=t.computeSizeBasedSnapTolerance(e),i=e.getPrecisionModel();if(i.getType()===Qt.FIXED){var r=1/i.getScale()*2/1.415;r>n&&(n=r)}return n}if(2===arguments.length){var s=arguments[0],o=arguments[1];return Math.min(t.computeOverlaySnapTolerance(s),t.computeOverlaySnapTolerance(o))}}},{key:"computeSizeBasedSnapTolerance",value:function(e){var n=e.getEnvelopeInternal();return Math.min(n.getHeight(),n.getWidth())*t.SNAP_PRECISION_FACTOR}},{key:"snapToSelf",value:function(e,n,i){return new t(e).snapToSelf(n,i)}}]),t}();es.constructor_=function(){this._srcGeom=null;var t=arguments[0];this._srcGeom=t},es.SNAP_PRECISION_FACTOR=1e-9;var ns=function(t){s(n,Se);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"snapLine",value:function(t,e){var n=new ts(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)}},{key:"transformCoordinates",value:function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ns.constructor_=function(){if(this._snapTolerance=null,this._snapPts=null,this._isSelfSnap=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._snapTolerance=t,this._snapPts=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._snapTolerance=n,this._snapPts=i,this._isSelfSnap=r}};var is=Object.freeze({__proto__:null,GeometrySnapper:es,LineStringSnapper:ts}),rs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:zi.octant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"getData",value:function(){return this._data}},{key:"toString",value:function(){return oe.toLineString(new Kt(this._pts))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[qi]}}]),t}();rs.constructor_=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};var ss=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getInteriorIntersection",value:function(){return this._interiorIntersection}},{key:"setCheckEndSegmentsOnly",value:function(t){this._isCheckEndSegmentsOnly=t}},{key:"getIntersectionSegments",value:function(){return this._intSegments}},{key:"count",value:function(){return this._intersectionCount}},{key:"getIntersections",value:function(){return this._intersections}},{key:"setFindAllIntersections",value:function(t){this._findAllIntersections=t}},{key:"setKeepIntersections",value:function(t){this._keepIntersections=t}},{key:"processIntersections",value:function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],s=t.getCoordinates()[e+1],o=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,s,o,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=s,this._intSegments[2]=o,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)}},{key:"isEndSegment",value:function(t,e){return 0===e||e>=t.size()-2}},{key:"hasIntersection",value:function(){return null!==this._interiorIntersection}},{key:"isDone",value:function(){return!this._findAllIntersections&&null!==this._interiorIntersection}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Er]}}],[{key:"createAllIntersectionsFinder",value:function(e){var n=new t(e);return n.setFindAllIntersections(!0),n}},{key:"createAnyIntersectionFinder",value:function(e){return new t(e)}},{key:"createIntersectionCounter",value:function(e){var n=new t(e);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n}}]),t}();ss.constructor_=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new N,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};var os=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"execute",value:function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()}},{key:"getIntersections",value:function(){return this._segInt.getIntersections()}},{key:"isValid",value:function(){return this.execute(),this._isValid}},{key:"setFindAllIntersections",value:function(t){this._findAllIntersections=t}},{key:"checkInteriorIntersections",value:function(){this._isValid=!0,this._segInt=new ss(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new Zi;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null}},{key:"checkValid",value:function(){if(this.execute(),!this._isValid)throw new ei(this.getErrorMessage(),this._segInt.getInteriorIntersection())}},{key:"getErrorMessage",value:function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+oe.toLineString(t[0],t[1])+" and "+oe.toLineString(t[2],t[3])}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"computeIntersections",value:function(e){var n=new t(e);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()}}]),t}();os.constructor_=function(){this._li=new ue,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};var as=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"checkValid",value:function(){this._nv.checkValid()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"toSegmentStrings",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next();e.add(new rs(i.getCoordinates(),i))}return e}},{key:"checkValid",value:function(e){new t(e).checkValid()}}]),t}();as.constructor_=function(){this._nv=null;var t=arguments[0];this._nv=new os(as.toSegmentStrings(t))};var us=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"collectLines",value:function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}}},{key:"labelIsolatedLine",value:function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)}},{key:"build",value:function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList}},{key:"collectLineEdge",value:function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!ys.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))}},{key:"findCoveredLineEdges",value:function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}}},{key:"labelIsolatedLines",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}}},{key:"buildLines",value:function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=(n.getLabel(),this._geometryFactory.createLineString(n.getCoordinates()));this._resultLineList.add(i),n.setInResult(!0)}}},{key:"collectBoundaryTouchEdge",value:function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(m.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(ys.isResultOfOp(i,e)&&e===ys.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();us.constructor_=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new N,this._resultLineList=new N;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};var ls=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filterCoveredNodeToPoint",value:function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}}},{key:"extractNonCoveredResultNodes",value:function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==ys.INTERSECTION)){var i=n.getLabel();ys.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}}},{key:"build",value:function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ls.constructor_=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new N;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};var hs=function(){function t(){f(this,t),this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=new r,this._commonSignExp=null}return g(t,[{key:"getCommon",value:function(){return o.longBitsToDouble(this._commonBits)}},{key:"add",value:function(e){var n=o.doubleToLongBits(e);return this._isFirst?(this._commonBits=n,this._commonSignExp=t.signExpBits(this._commonBits),this._isFirst=!1,null):t.signExpBits(n)!==this._commonSignExp?(this._commonBits.high=0,this._commonBits.low=0,null):(this._commonMantissaBitsCount=t.numCommonMostSigMantissaBits(this._commonBits,n),void(this._commonBits=t.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))}},{key:"toString",value:function(){if(1===arguments.length){var t=arguments[0],e=o.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+r.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getBit",value:function(t,e){var n=1<<e%32;return e<32?0!=(t.low&n)?1:0:0!=(t.high&n)?1:0}},{key:"signExpBits",value:function(t){return t.high>>>20}},{key:"zeroLowerBits",value:function(t,e){var n="low";if(e>32&&(t.low=0,e%=32,n="high"),e>0){var i=e<32?~((1<<e)-1):0;t[n]&=i}return t}},{key:"numCommonMostSigMantissaBits",value:function(e,n){for(var i=0,r=52;r>=0;r--){if(t.getBit(e,r)!==t.getBit(n,r))return i;i++}return 52}}]),t}(),cs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addCommonBits",value:function(t){var e=new ds(this._commonCoord);t.apply(e),t.geometryChanged()}},{key:"removeCommonBits",value:function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new k(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ds(e);return t.apply(n),t.geometryChanged(),t}},{key:"getCommonCoordinate",value:function(){return this._commonCoord}},{key:"add",value:function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),fs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)}},{key:"getCommonCoordinate",value:function(){return new k(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[H]}}]),t}();fs.constructor_=function(){this._commonBitsX=new hs,this._commonBitsY=new hs};var ds=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)}},{key:"isDone",value:function(){return!1}},{key:"isGeometryChanged",value:function(){return!0}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[xt]}}]),t}();ds.constructor_=function(){this.trans=null;var t=arguments[0];this.trans=t},cs.CommonCoordinateFilter=fs,cs.Translater=ds,cs.constructor_=function(){this._commonCoord=null,this._ccFilter=new fs};var gs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"selfSnap",value:function(t){return new es(t).snapTo(t,this._snapTolerance)}},{key:"removeCommonBits",value:function(t){this._cbr=new cs,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e}},{key:"prepareResult",value:function(t){return this._cbr.addCommonBits(t),t}},{key:"getResultGeometry",value:function(t){var e=this.snap(this._geom),n=ys.overlayOp(e[0],e[1],t);return this.prepareResult(n)}},{key:"checkValid",value:function(t){t.isValid()||B.out.println("Snapped geometry is invalid")}},{key:"computeSnapTolerance",value:function(){this._snapTolerance=es.computeOverlaySnapTolerance(this._geom[0],this._geom[1])}},{key:"snap",value:function(t){var e=this.removeCommonBits(t);return es.snap(e[0],e[1],this._snapTolerance)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"overlayOp",value:function(e,n,i){return new t(e,n).getResultGeometry(i)}},{key:"union",value:function(e,n){return t.overlayOp(e,n,ys.UNION)}},{key:"intersection",value:function(e,n){return t.overlayOp(e,n,ys.INTERSECTION)}},{key:"symDifference",value:function(e,n){return t.overlayOp(e,n,ys.SYMDIFFERENCE)}},{key:"difference",value:function(e,n){return t.overlayOp(e,n,ys.DIFFERENCE)}}]),t}();gs.constructor_=function(){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null;var t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};var vs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getResultGeometry",value:function(t){var e=null,n=!1,i=null;try{e=ys.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof y))throw t;i=t}if(!n)try{e=gs.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof y?i:t}return e}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"overlayOp",value:function(e,n,i){return new t(e,n).getResultGeometry(i)}},{key:"union",value:function(e,n){return t.overlayOp(e,n,ys.UNION)}},{key:"intersection",value:function(e,n){return t.overlayOp(e,n,ys.INTERSECTION)}},{key:"symDifference",value:function(e,n){return t.overlayOp(e,n,ys.SYMDIFFERENCE)}},{key:"difference",value:function(e,n){return t.overlayOp(e,n,ys.DIFFERENCE)}}]),t}();vs.constructor_=function(){this._geom=new Array(2).fill(null);var t=arguments[0],e=arguments[1];this._geom[0]=t,this._geom[1]=e};var _s=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getArgGeometry",value:function(t){return this._arg[t].getGeometry()}},{key:"setComputationPrecision",value:function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();_s.constructor_=function(){if(this._li=new ue,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new si(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];_s.constructor_.call(this,e,n,j.OGC_SFS_BOUNDARY_RULE)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];i.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(i.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new si(0,i,s),this._arg[1]=new si(1,r,s)}};var ys=function(t){s(i,_s);var e=a(i);function i(){var t;return f(this,i),t=e.call(this),i.constructor_.apply(l(t),arguments),t}return g(i,[{key:"insertUniqueEdge",value:function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Xn(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)}},{key:"getGraph",value:function(){return this._graph}},{key:"cancelDuplicateResultEdges",value:function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}}},{key:"isCoveredByLA",value:function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)}},{key:"computeGeometry",value:function(t,e,n,r){var s=new N;return s.addAll(t),s.addAll(e),s.addAll(n),s.isEmpty()?i.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)}},{key:"mergeSymLabels",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()}},{key:"isCovered",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==he.EXTERIOR)return!0}return!1}},{key:"replaceCollapsedEdges",value:function(){for(var t=new N,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)}},{key:"updateNodeLabelling",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}}},{key:"getResultGeometry",value:function(t){return this.computeOverlay(t),this._resultGeom}},{key:"insertUniqueEdges",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}}},{key:"computeOverlay",value:function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new N;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),as.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new lr(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new us(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new ls(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)}},{key:"labelIncompleteNode",value:function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)}},{key:"copyPoints",value:function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}},{key:"findResultAreaEdges",value:function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),r=n.getLabel();r.isArea()&&!n.isInteriorAreaEdge()&&i.isResultOfOp(r.getLocation(0,An.RIGHT),r.getLocation(1,An.RIGHT),t)&&n.setInResult(!0)}}},{key:"computeLabelsFromDepths",value:function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(m.isTrue(!i.isNull(r,An.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,An.LEFT,i.getLocation(r,An.LEFT)),m.isTrue(!i.isNull(r,An.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,An.RIGHT,i.getLocation(r,An.RIGHT))))}}}},{key:"computeLabelling",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()}},{key:"labelIncompleteNodes",value:function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}}},{key:"isCoveredByA",value:function(t){return!!this.isCovered(t,this._resultPolyList)}},{key:"getClass",value:function(){return i}},{key:"interfaces_",get:function(){return[]}}],[{key:"overlayOp",value:function(t,e,n){return new i(t,e).getResultGeometry(n)}},{key:"union",value:function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return i.createEmptyResult(i.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new n("This method does not support GeometryCollection arguments");return vs.overlayOp(t,e,i.UNION)}},{key:"intersection",value:function(t,e){if(t.isEmpty()||e.isEmpty())return i.createEmptyResult(i.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return ke.map(t,new(function(){function t(){f(this,t)}return g(t,[{key:"map",value:function(t){return i.intersection(t,n)}},{key:"interfaces_",get:function(){return[Ce]}}]),t}()))}return vs.overlayOp(t,e,i.INTERSECTION)}},{key:"symDifference",value:function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return i.createEmptyResult(i.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}if(t.isGeometryCollection()||e.isGeometryCollection())throw new n("This method does not support GeometryCollection arguments");return vs.overlayOp(t,e,i.SYMDIFFERENCE)}},{key:"resultDimension",value:function(t,e,n){var r=e.getDimension(),s=n.getDimension(),o=-1;switch(t){case i.INTERSECTION:o=Math.min(r,s);break;case i.UNION:o=Math.max(r,s);break;case i.DIFFERENCE:o=r;break;case i.SYMDIFFERENCE:o=Math.max(r,s)}return o}},{key:"createEmptyResult",value:function(t,e,n,r){var s=null;switch(i.resultDimension(t,e,n)){case-1:s=r.createGeometryCollection();break;case 0:s=r.createPoint();break;case 1:s=r.createLineString();break;case 2:s=r.createPolygon()}return s}},{key:"difference",value:function(t,e){if(t.isEmpty())return i.createEmptyResult(i.DIFFERENCE,t,e,t.getFactory());if(e.isEmpty())return t.copy();if(t.isGeometryCollection()||e.isGeometryCollection())throw new n("This method does not support GeometryCollection arguments");return vs.overlayOp(t,e,i.DIFFERENCE)}},{key:"isResultOfOp",value:function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return i.isResultOfOp(n,r,e)}if(3===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2];switch(s===he.BOUNDARY&&(s=he.INTERIOR),o===he.BOUNDARY&&(o=he.INTERIOR),a){case i.INTERSECTION:return s===he.INTERIOR&&o===he.INTERIOR;case i.UNION:return s===he.INTERIOR||o===he.INTERIOR;case i.DIFFERENCE:return s===he.INTERIOR&&o!==he.INTERIOR;case i.SYMDIFFERENCE:return s===he.INTERIOR&&o!==he.INTERIOR||s!==he.INTERIOR&&o===he.INTERIOR}return!1}}}]),i}();ys.constructor_=function(){this._ptLocator=new En,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new xr,this._resultPolyList=new N,this._resultLineList=new N,this._resultPointList=new N;var t=arguments[0],e=arguments[1];_s.constructor_.call(this,t,e),this._graph=new ri(new mr),this._geomFact=t.getFactory()},ys.INTERSECTION=1,ys.UNION=2,ys.DIFFERENCE=3,ys.SYMDIFFERENCE=4;var ps=Object.freeze({__proto__:null,snap:is,OverlayOp:ys}),ms=function(t){s(n,Vr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getNext",value:function(){return this._next}},{key:"isInRing",value:function(){return null!==this._edgeRing}},{key:"setRing",value:function(t){this._edgeRing=t}},{key:"setLabel",value:function(t){this._label=t}},{key:"getLabel",value:function(){return this._label}},{key:"setNext",value:function(t){this._next=t}},{key:"getRing",value:function(){return this._edgeRing}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ms.constructor_=function(){this._edgeRing=null,this._next=null,this._label=-1;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];Vr.constructor_.call(this,t,e,n,i)};var ks=function(t){s(n,qr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getLine",value:function(){return this._line}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ks.constructor_=function(){this._line=null;var t=arguments[0];this._line=t};var xs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visitInteriorRing",value:function(e,n){var i=e.getCoordinates(),r=i[0],s=t.findDifferentPoint(i,r),o=n.findEdgeInSameDirection(r,s),a=n.findEdgeEnd(o),u=null;a.getLabel().getLocation(0,An.RIGHT)===he.INTERIOR?u=a:a.getSym().getLabel().getLocation(0,An.RIGHT)===he.INTERIOR&&(u=a.getSym()),m.isTrue(null!==u,"unable to find dirEdge with Interior on RHS"),this.visitLinkedDirectedEdges(u)}},{key:"visitShellInteriors",value:function(t,e){if(t instanceof Vt){var n=t;this.visitInteriorRing(n.getExteriorRing(),e)}if(t instanceof Yt)for(var i=t,r=0;r<i.getNumGeometries();r++){var s=i.getGeometryN(r);this.visitInteriorRing(s.getExteriorRing(),e)}}},{key:"getCoordinate",value:function(){return this._disconnectedRingcoord}},{key:"setInteriorEdgesInResult",value:function(t){for(var e=t.getEdgeEnds().iterator();e.hasNext();){var n=e.next();n.getLabel().getLocation(0,An.RIGHT)===he.INTERIOR&&n.setInResult(!0)}}},{key:"visitLinkedDirectedEdges",value:function(t){var e=t,n=t;do{m.isTrue(null!==n,"found null Directed Edge"),n.setVisited(!0),n=n.getNext()}while(n!==e)}},{key:"buildEdgeRings",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&null===i.getEdgeRing()){var r=new ur(i,this._geometryFactory);r.linkDirectedEdgesForMinimalEdgeRings();var s=r.buildMinimalRings();e.addAll(s)}}return e}},{key:"hasUnvisitedShellEdge",value:function(t){for(var e=0;e<t.size();e++){var n=t.get(e);if(!n.isHole()){var i=n.getEdges(),r=i.get(0);if(r.getLabel().getLocation(0,An.RIGHT)===he.INTERIOR)for(var s=0;s<i.size();s++)if(!(r=i.get(s)).isVisited())return this._disconnectedRingcoord=r.getCoordinate(),!0}}return!1}},{key:"isInteriorsConnected",value:function(){var t=new N;this._geomGraph.computeSplitEdges(t);var e=new ri(new mr);e.addEdges(t),this.setInteriorEdgesInResult(e),e.linkResultDirectedEdges();var n=this.buildEdgeRings(e.getEdgeEnds());return this.visitShellInteriors(this._geomGraph.getGeometry(),e),!this.hasUnvisitedShellEdge(n)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"findDifferentPoint",value:function(t,e){for(var n=0;n<t.length;n++)if(!t[n].equals(e))return t[n];return null}}]),t}();xs.constructor_=function(){this._geometryFactory=new te,this._geomGraph=null,this._disconnectedRingcoord=null;var t=arguments[0];this._geomGraph=t};var Es=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"createEdgeEndForNext",value:function(t,e,n,i){var r=n.segmentIndex+1;if(r>=t.getNumPoints()&&null===i)return null;var s=t.getCoordinate(r);null!==i&&i.segmentIndex===n.segmentIndex&&(s=i.coord);var o=new ti(t,n.coord,s,new Xn(t.getLabel()));e.add(o)}},{key:"createEdgeEndForPrev",value:function(t,e,n,i){var r=n.segmentIndex;if(0===n.dist){if(0===r)return null;r--}var s=t.getCoordinate(r);null!==i&&i.segmentIndex>=r&&(s=i.coord);var o=new Xn(t.getLabel());o.flip();var a=new ti(t,n.coord,s,o);e.add(a)}},{key:"computeEdgeEnds",value:function(){if(1===arguments.length){for(var t=arguments[0],e=new N,n=t;n.hasNext();){var i=n.next();this.computeEdgeEnds(i,e)}return e}if(2===arguments.length){var r=arguments[0],s=arguments[1],o=r.getEdgeIntersectionList();o.addEndpoints();var a=o.iterator(),u=null,l=null;if(!a.hasNext())return null;var h=a.next();do{u=l,l=h,h=null,a.hasNext()&&(h=a.next()),null!==l&&(this.createEdgeEndForPrev(r,s,l,u),this.createEdgeEndForNext(r,s,l,h))}while(null!==l)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Es.constructor_=function(){};var Cs=function(t){s(n,ti);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"insert",value:function(t){this._edgeEnds.add(t)}},{key:"print",value:function(t){t.println("EdgeEndBundle--\x3e Label: "+this._label);for(var e=this.iterator();e.hasNext();)e.next().print(t),t.println()}},{key:"iterator",value:function(){return this._edgeEnds.iterator()}},{key:"getEdgeEnds",value:function(){return this._edgeEnds}},{key:"computeLabelOn",value:function(t,e){for(var n=0,i=!1,r=this.iterator();r.hasNext();){var s=r.next().getLabel().getLocation(t);s===he.BOUNDARY&&n++,s===he.INTERIOR&&(i=!0)}var o=he.NONE;i&&(o=he.INTERIOR),n>0&&(o=si.determineBoundary(e,n)),this._label.setLocation(t,o)}},{key:"computeLabelSide",value:function(t,e){for(var n=this.iterator();n.hasNext();){var i=n.next();if(i.getLabel().isArea()){var r=i.getLabel().getLocation(t,e);if(r===he.INTERIOR)return this._label.setLocation(t,e,he.INTERIOR),null;r===he.EXTERIOR&&this._label.setLocation(t,e,he.EXTERIOR)}}}},{key:"getLabel",value:function(){return this._label}},{key:"computeLabelSides",value:function(t){this.computeLabelSide(t,An.LEFT),this.computeLabelSide(t,An.RIGHT)}},{key:"updateIM",value:function(t){Jn.updateIM(this._label,t)}},{key:"computeLabel",value:function(t){for(var e=!1,n=this.iterator();n.hasNext();)n.next().getLabel().isArea()&&(e=!0);this._label=e?new Xn(he.NONE,he.NONE,he.NONE):new Xn(he.NONE);for(var i=0;i<2;i++)this.computeLabelOn(i,t),e&&this.computeLabelSides(i)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Cs.constructor_=function(){if(this._edgeEnds=new N,1===arguments.length){var t=arguments[0];Cs.constructor_.call(this,null,t)}else if(2===arguments.length){var e=arguments[1];ti.constructor_.call(this,e.getEdge(),e.getCoordinate(),e.getDirectedCoordinate(),new Xn(e.getLabel())),this.insert(e)}};var Is=function(t){s(n,yr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"updateIM",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().updateIM(t)}},{key:"insert",value:function(t){var e=this._edgeMap.get(t);null===e?(e=new Cs(t),this.insertEdgeEnd(t,e)):e.insert(t)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Is.constructor_=function(){};var Ss=function(t){s(n,Qn);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"updateIMFromEdges",value:function(t){this._edges.updateIM(t)}},{key:"computeIM",value:function(t){t.setAtLeastIfValid(this._label.getLocation(0),this._label.getLocation(1),0)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Ss.constructor_=function(){var t=arguments[0],e=arguments[1];Qn.constructor_.call(this,t,e)};var ws=function(t){s(n,ii);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"createNode",value:function(t){return new Ss(t,new Is)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ws.constructor_=function(){};var Ns=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insertEdgeEnds",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._nodes.add(n)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"copyNodesAndLabels",value:function(t,e){for(var n=t.getNodeIterator();n.hasNext();){var i=n.next();this._nodes.addNode(i.getCoordinate()).setLabel(e,i.getLabel().getLocation(e))}}},{key:"build",value:function(t){this.computeIntersectionNodes(t,0),this.copyNodesAndLabels(t,0);var e=(new Es).computeEdgeEnds(t.getEdgeIterator());this.insertEdgeEnds(e)}},{key:"computeIntersectionNodes",value:function(t,e){for(var n=t.getEdgeIterator();n.hasNext();)for(var i=n.next(),r=i.getLabel().getLocation(e),s=i.getEdgeIntersectionList().iterator();s.hasNext();){var o=s.next(),a=this._nodes.addNode(o.coord);r===he.BOUNDARY?a.setLabelBoundary(e):a.getLabel().isNull(e)&&a.setLabel(e,he.INTERIOR)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ns.constructor_=function(){this._nodes=new $n(new ws)};var Ls=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isNodeEdgeAreaLabelsConsistent",value:function(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();){var e=t.next();if(!e.getEdges().isAreaLabelsConsistent(this._geomGraph))return this._invalidPoint=e.getCoordinate().copy(),!1}return!0}},{key:"getInvalidPoint",value:function(){return this._invalidPoint}},{key:"hasDuplicateRings",value:function(){for(var t=this._nodeGraph.getNodeIterator();t.hasNext();)for(var e=t.next().getEdges().iterator();e.hasNext();){var n=e.next();if(n.getEdgeEnds().size()>1)return this._invalidPoint=n.getEdge().getCoordinate(0),!0}return!1}},{key:"isNodeConsistentArea",value:function(){var t=this._geomGraph.computeSelfNodes(this._li,!0,!0);return t.hasProperIntersection()?(this._invalidPoint=t.getProperIntersectionPoint(),!1):(this._nodeGraph.build(this._geomGraph),this.isNodeEdgeAreaLabelsConsistent())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ls.constructor_=function(){this._li=new ue,this._geomGraph=null,this._nodeGraph=new Ns,this._invalidPoint=null;var t=arguments[0];this._geomGraph=t};var Rs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"buildIndex",value:function(){this._index=new Li;for(var t=0;t<this._rings.size();t++){var e=this._rings.get(t),n=e.getEnvelopeInternal();this._index.insert(n,e)}}},{key:"getNestedPoint",value:function(){return this._nestedPt}},{key:"isNonNested",value:function(){this.buildIndex();for(var t=0;t<this._rings.size();t++)for(var e=this._rings.get(t),n=e.getCoordinates(),i=this._index.query(e.getEnvelopeInternal()),r=0;r<i.size();r++){var s=i.get(r),o=s.getCoordinates();if(e!==s&&e.getEnvelopeInternal().intersects(s.getEnvelopeInternal())){var a=bs.findPtNotNode(n,s,this._graph);if(null!==a&&en.isInRing(a,o))return this._nestedPt=a,!1}}return!0}},{key:"add",value:function(t){this._rings.add(t),this._totalEnv.expandToInclude(t.getEnvelopeInternal())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Rs.constructor_=function(){this._graph=null,this._rings=new N,this._totalEnv=new T,this._index=null,this._nestedPt=null;var t=arguments[0];this._graph=t};var Ts=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getErrorType",value:function(){return this._errorType}},{key:"getMessage",value:function(){return t.errMsg[this._errorType]}},{key:"getCoordinate",value:function(){return this._pt}},{key:"toString",value:function(){var t="";return null!==this._pt&&(t=" at or near point "+this._pt),this.getMessage()+t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ts.constructor_=function(){if(this._errorType=null,this._pt=null,1===arguments.length){var t=arguments[0];Ts.constructor_.call(this,t,null)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._errorType=e,null!==n&&(this._pt=n.copy())}},Ts.ERROR=0,Ts.REPEATED_POINT=1,Ts.HOLE_OUTSIDE_SHELL=2,Ts.NESTED_HOLES=3,Ts.DISCONNECTED_INTERIOR=4,Ts.SELF_INTERSECTION=5,Ts.RING_SELF_INTERSECTION=6,Ts.NESTED_SHELLS=7,Ts.DUPLICATE_RINGS=8,Ts.TOO_FEW_POINTS=9,Ts.INVALID_COORDINATE=10,Ts.RING_NOT_CLOSED=11,Ts.errMsg=["Topology Validation Error","Repeated Point","Hole lies outside shell","Holes are nested","Interior is disconnected","Self-intersection","Ring Self-intersection","Nested shells","Duplicate Rings","Too few distinct points in geometry component","Invalid Coordinate","Ring is not closed"];var bs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"checkInvalidCoordinates",value:function(){if(arguments[0]instanceof Array){for(var e=arguments[0],n=0;n<e.length;n++)if(!t.isValid(e[n]))return this._validErr=new Ts(Ts.INVALID_COORDINATE,e[n]),null}else if(arguments[0]instanceof Vt){var i=arguments[0];if(this.checkInvalidCoordinates(i.getExteriorRing().getCoordinates()),null!==this._validErr)return null;for(var r=0;r<i.getNumInteriorRing();r++)if(this.checkInvalidCoordinates(i.getInteriorRingN(r).getCoordinates()),null!==this._validErr)return null}}},{key:"checkHolesNotNested",value:function(t,e){for(var n=new Rs(e),i=0;i<t.getNumInteriorRing();i++){var r=t.getInteriorRingN(i);n.add(r)}n.isNonNested()||(this._validErr=new Ts(Ts.NESTED_HOLES,n.getNestedPoint()))}},{key:"checkConsistentArea",value:function(t){var e=new Ls(t);if(!e.isNodeConsistentArea())return this._validErr=new Ts(Ts.SELF_INTERSECTION,e.getInvalidPoint()),null;e.hasDuplicateRings()&&(this._validErr=new Ts(Ts.DUPLICATE_RINGS,e.getInvalidPoint()))}},{key:"isValid",value:function(){return this.checkValid(this._parentGeometry),null===this._validErr}},{key:"checkShellInsideHole",value:function(e,n,i){var r=e.getCoordinates(),s=n.getCoordinates(),o=t.findPtNotNode(r,n,i);if(null!==o&&!en.isInRing(o,s))return o;var a=t.findPtNotNode(s,e,i);return null!==a?en.isInRing(a,r)?a:null:(m.shouldNeverReachHere("points in shell and hole appear to be equal"),null)}},{key:"checkNoSelfIntersectingRings",value:function(t){for(var e=t.getEdgeIterator();e.hasNext();){var n=e.next();if(this.checkNoSelfIntersectingRing(n.getEdgeIntersectionList()),null!==this._validErr)return null}}},{key:"checkConnectedInteriors",value:function(t){var e=new xs(t);e.isInteriorsConnected()||(this._validErr=new Ts(Ts.DISCONNECTED_INTERIOR,e.getCoordinate()))}},{key:"checkNoSelfIntersectingRing",value:function(t){for(var e=new _t,n=!0,i=t.iterator();i.hasNext();){var r=i.next();if(n)n=!1;else{if(e.contains(r.coord))return this._validErr=new Ts(Ts.RING_SELF_INTERSECTION,r.coord),null;e.add(r.coord)}}}},{key:"checkHolesInShell",value:function(e,n){for(var i=e.getExteriorRing(),r=new Qe(i),s=0;s<e.getNumInteriorRing();s++){var o=e.getInteriorRingN(s),a=t.findPtNotNode(o.getCoordinates(),i,n);if(null===a)return null;if(he.EXTERIOR===r.locate(a))return this._validErr=new Ts(Ts.HOLE_OUTSIDE_SHELL,a),null}}},{key:"checkTooFewPoints",value:function(t){if(t.hasTooFewPoints())return this._validErr=new Ts(Ts.TOO_FEW_POINTS,t.getInvalidPoint()),null}},{key:"getValidationError",value:function(){return this.checkValid(this._parentGeometry),this._validErr}},{key:"checkValid",value:function(){if(arguments[0]instanceof At){var t=arguments[0];this.checkInvalidCoordinates(t.getCoordinates())}else if(arguments[0]instanceof zt){var e=arguments[0];this.checkInvalidCoordinates(e.getCoordinates())}else if(arguments[0]instanceof qt){var n=arguments[0];if(this.checkInvalidCoordinates(n.getCoordinates()),null!==this._validErr)return null;if(this.checkClosedRing(n),null!==this._validErr)return null;var i=new si(0,n);if(this.checkTooFewPoints(i),null!==this._validErr)return null;var r=new ue;i.computeSelfNodes(r,!0,!0),this.checkNoSelfIntersectingRings(i)}else if(arguments[0]instanceof Ft){var s=arguments[0];if(this.checkInvalidCoordinates(s.getCoordinates()),null!==this._validErr)return null;var o=new si(0,s);this.checkTooFewPoints(o)}else if(arguments[0]instanceof Vt){var a=arguments[0];if(this.checkInvalidCoordinates(a),null!==this._validErr)return null;if(this.checkClosedRings(a),null!==this._validErr)return null;var u=new si(0,a);if(this.checkTooFewPoints(u),null!==this._validErr)return null;if(this.checkConsistentArea(u),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(u),null!==this._validErr))return null;if(this.checkHolesInShell(a,u),null!==this._validErr)return null;if(this.checkHolesNotNested(a,u),null!==this._validErr)return null;this.checkConnectedInteriors(u)}else if(arguments[0]instanceof Yt){for(var l=arguments[0],h=0;h<l.getNumGeometries();h++){var c=l.getGeometryN(h);if(this.checkInvalidCoordinates(c),null!==this._validErr)return null;if(this.checkClosedRings(c),null!==this._validErr)return null}var f=new si(0,l);if(this.checkTooFewPoints(f),null!==this._validErr)return null;if(this.checkConsistentArea(f),null!==this._validErr)return null;if(!this._isSelfTouchingRingFormingHoleValid&&(this.checkNoSelfIntersectingRings(f),null!==this._validErr))return null;for(var d=0;d<l.getNumGeometries();d++){var g=l.getGeometryN(d);if(this.checkHolesInShell(g,f),null!==this._validErr)return null}for(var v=0;v<l.getNumGeometries();v++){var _=l.getGeometryN(v);if(this.checkHolesNotNested(_,f),null!==this._validErr)return null}if(this.checkShellsNotNested(l,f),null!==this._validErr)return null;this.checkConnectedInteriors(f)}else if(arguments[0]instanceof Et)for(var y=arguments[0],p=0;p<y.getNumGeometries();p++){var m=y.getGeometryN(p);if(this.checkValid(m),null!==this._validErr)return null}else if(arguments[0]instanceof W){var k=arguments[0];if(this._validErr=null,k.isEmpty())return null;if(k instanceof At)this.checkValid(k);else if(k instanceof zt)this.checkValid(k);else if(k instanceof qt)this.checkValid(k);else if(k instanceof Ft)this.checkValid(k);else if(k instanceof Vt)this.checkValid(k);else if(k instanceof Yt)this.checkValid(k);else{if(!(k instanceof Et))throw new rt(k.getClass().getName());this.checkValid(k)}}}},{key:"setSelfTouchingRingFormingHoleValid",value:function(t){this._isSelfTouchingRingFormingHoleValid=t}},{key:"checkShellNotNested",value:function(e,n,i){var r=e.getCoordinates(),s=n.getExteriorRing(),o=s.getCoordinates(),a=t.findPtNotNode(r,s,i);if(null===a)return null;if(!en.isInRing(a,o))return null;if(n.getNumInteriorRing()<=0)return this._validErr=new Ts(Ts.NESTED_SHELLS,a),null;for(var u=null,l=0;l<n.getNumInteriorRing();l++){var h=n.getInteriorRingN(l);if(null===(u=this.checkShellInsideHole(e,h,i)))return null}this._validErr=new Ts(Ts.NESTED_SHELLS,u)}},{key:"checkClosedRings",value:function(t){if(this.checkClosedRing(t.getExteriorRing()),null!==this._validErr)return null;for(var e=0;e<t.getNumInteriorRing();e++)if(this.checkClosedRing(t.getInteriorRingN(e)),null!==this._validErr)return null}},{key:"checkClosedRing",value:function(t){if(!t.isClosed()){var e=null;t.getNumPoints()>=1&&(e=t.getCoordinateN(0)),this._validErr=new Ts(Ts.RING_NOT_CLOSED,e)}}},{key:"checkShellsNotNested",value:function(t,e){for(var n=0;n<t.getNumGeometries();n++)for(var i=t.getGeometryN(n).getExteriorRing(),r=0;r<t.getNumGeometries();r++)if(n!==r){var s=t.getGeometryN(r);if(this.checkShellNotNested(i,s,e),null!==this._validErr)return null}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"findPtNotNode",value:function(t,e,n){for(var i=n.findEdge(e).getEdgeIntersectionList(),r=0;r<t.length;r++){var s=t[r];if(!i.isIntersection(s))return s}return null}},{key:"isValid",value:function(){if(arguments[0]instanceof W)return new t(arguments[0]).isValid();if(arguments[0]instanceof k){var e=arguments[0];return!(o.isNaN(e.x)||o.isInfinite(e.x)||o.isNaN(e.y)||o.isInfinite(e.y))}}}]),t}();bs.constructor_=function(){this._parentGeometry=null,this._isSelfTouchingRingFormingHoleValid=!1,this._validErr=null;var t=arguments[0];this._parentGeometry=t};var Ps=function(){function e(){f(this,e),e.constructor_.apply(this,arguments)}return g(e,[{key:"isIncluded",value:function(){return this._isIncluded}},{key:"getCoordinates",value:function(){if(null===this._ringPts){for(var t=new R,n=this._deList.iterator();n.hasNext();){var i=n.next(),r=i.getEdge();e.addEdge(r.getLine().getCoordinates(),i.getEdgeDirection(),t)}this._ringPts=t.toCoordinateArray()}return this._ringPts}},{key:"isIncludedSet",value:function(){return this._isIncludedSet}},{key:"isValid",value:function(){return this.getCoordinates(),!(this._ringPts.length<=3)&&(this.getRing(),bs.isValid(this._ring))}},{key:"build",value:function(t){var e=t;do{this.add(e),e.setRing(this),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t)}},{key:"isOuterHole",value:function(){return!!this._isHole&&!this.hasShell()}},{key:"getPolygon",value:function(){var t=null;if(null!==this._holes){t=new Array(this._holes.size()).fill(null);for(var e=0;e<this._holes.size();e++)t[e]=this._holes.get(e)}return this._factory.createPolygon(this._ring,t)}},{key:"isHole",value:function(){return this._isHole}},{key:"isProcessed",value:function(){return this._isProcessed}},{key:"addHole",value:function(){if(arguments[0]instanceof qt){var t=arguments[0];null===this._holes&&(this._holes=new N),this._holes.add(t)}else if(arguments[0]instanceof e){var n=arguments[0];n.setShell(this);var i=n.getRing();null===this._holes&&(this._holes=new N),this._holes.add(i)}}},{key:"setIncluded",value:function(t){this._isIncluded=t,this._isIncludedSet=!0}},{key:"getOuterHole",value:function(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing();if(e.isOuterHole())return e}return null}},{key:"computeHole",value:function(){var t=this.getRing();this._isHole=G.isCCW(t.getCoordinates())}},{key:"hasShell",value:function(){return null!==this._shell}},{key:"isOuterShell",value:function(){return null!==this.getOuterHole()}},{key:"getLineString",value:function(){return this.getCoordinates(),this._factory.createLineString(this._ringPts)}},{key:"toString",value:function(){return oe.toLineString(new Kt(this.getCoordinates()))}},{key:"getShell",value:function(){return this.isHole()?this._shell:this}},{key:"add",value:function(t){this._deList.add(t)}},{key:"getRing",value:function(){if(null!==this._ring)return this._ring;this.getCoordinates(),this._ringPts.length<3&&B.out.println(this._ringPts);try{this._ring=this._factory.createLinearRing(this._ringPts)}catch(t){if(!(t instanceof b))throw t;B.out.println(this._ringPts)}return this._ring}},{key:"updateIncluded",value:function(){if(this.isHole())return null;for(var t=0;t<this._deList.size();t++){var e=this._deList.get(t).getSym().getRing().getShell();if(null!==e&&e.isIncludedSet())return this.setIncluded(!e.isIncluded()),null}}},{key:"setShell",value:function(t){this._shell=t}},{key:"setProcessed",value:function(t){this._isProcessed=t}},{key:"getClass",value:function(){return e}},{key:"interfaces_",get:function(){return[]}}],[{key:"findDirEdgesInRing",value:function(t){var e=t,n=new N;do{n.add(e),e=e.getNext(),m.isTrue(null!==e,"found null DE in ring"),m.isTrue(e===t||!e.isInRing(),"found DE already in ring")}while(e!==t);return n}},{key:"addEdge",value:function(t,e,n){if(e)for(var i=0;i<t.length;i++)n.add(t[i],!1);else for(var r=t.length-1;r>=0;r--)n.add(t[r],!1)}},{key:"findEdgeRingContaining",value:function(t,e){for(var n=t.getRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),s=null,o=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getRing(),h=l.getEnvelopeInternal();if(!h.equals(i)&&h.contains(i)){r=$.ptNotInList(n.getCoordinates(),l.getCoordinates());var c=!1;en.isInRing(r,l.getCoordinates())&&(c=!0),c&&(null===s||o.contains(h))&&(o=(s=u).getRing().getEnvelopeInternal())}}return s}}]),e}(),Ms=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"compare",value:function(t,e){var n=e;return t.getRing().getEnvelope().compareTo(n.getRing().getEnvelope())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[v]}}]),t}();Ms.constructor_=function(){},Ps.EnvelopeComparator=Ms,Ps.constructor_=function(){this._factory=null,this._deList=new N,this._lowestEdge=null,this._ring=null,this._ringPts=null,this._holes=null,this._shell=null,this._isHole=null,this._isProcessed=!1,this._isIncludedSet=!1,this._isIncluded=!1;var t=arguments[0];this._factory=t};var Os=function(t){s(n,Hr);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"findEdgeRing",value:function(t){var e=new Ps(this._factory);return e.build(t),e}},{key:"computeDepthParity",value:function(){if(0===arguments.length)for(;;)return null}},{key:"computeNextCWEdges",value:function(){for(var t=this.nodeIterator();t.hasNext();){var e=t.next();n.computeNextCWEdges(e)}}},{key:"addEdge",value:function(t){if(t.isEmpty())return null;var e=$.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return null;var n=e[0],i=e[e.length-1],r=this.getNode(n),s=this.getNode(i),o=new ms(r,s,e[1],!0),a=new ms(s,r,e[e.length-2],!1),u=new ks(t);u.setDirectedEdges(o,a),this.add(u)}},{key:"deleteCutEdges",value:function(){this.computeNextCWEdges(),n.findLabeledEdgeRings(this._dirEdges);for(var t=new N,e=this._dirEdges.iterator();e.hasNext();){var i=e.next();if(!i.isMarked()){var r=i.getSym();if(i.getLabel()===r.getLabel()){i.setMarked(!0),r.setMarked(!0);var s=i.getEdge();t.add(s.getLine())}}}return t}},{key:"getEdgeRings",value:function(){this.computeNextCWEdges(),n.label(this._dirEdges,-1);var t=n.findLabeledEdgeRings(this._dirEdges);this.convertMaximalToMinimalEdgeRings(t);for(var e=new N,i=this._dirEdges.iterator();i.hasNext();){var r=i.next();if(!r.isMarked()&&!r.isInRing()){var s=this.findEdgeRing(r);e.add(s)}}return e}},{key:"getNode",value:function(t){var e=this.findNode(t);return null===e&&(e=new Xr(t),this.add(e)),e}},{key:"convertMaximalToMinimalEdgeRings",value:function(t){for(var e=t.iterator();e.hasNext();){var i=e.next(),r=i.getLabel(),s=n.findIntersectionNodes(i,r);if(null!==s)for(var o=s.iterator();o.hasNext();){var a=o.next();n.computeNextCCWEdges(a,r)}}}},{key:"deleteDangles",value:function(){for(var t=this.findNodesOfDegree(1),e=new ot,i=new gn,r=t.iterator();r.hasNext();)i.push(r.next());for(;!i.isEmpty();){var s=i.pop();n.deleteAllEdges(s);for(var o=s.getOutEdges().getEdges().iterator();o.hasNext();){var a=o.next();a.setMarked(!0);var u=a.getSym();null!==u&&u.setMarked(!0);var l=a.getEdge();e.add(l.getLine());var h=a.getToNode();1===n.getDegreeNonDeleted(h)&&i.push(h)}}return e}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"findLabeledEdgeRings",value:function(t){for(var e=new N,i=1,r=t.iterator();r.hasNext();){var s=r.next();if(!s.isMarked()&&!(s.getLabel()>=0)){e.add(s);var o=Ps.findDirEdgesInRing(s);n.label(o,i),i++}}return e}},{key:"getDegreeNonDeleted",value:function(t){for(var e=0,n=t.getOutEdges().getEdges().iterator();n.hasNext();)n.next().isMarked()||e++;return e}},{key:"deleteAllEdges",value:function(t){for(var e=t.getOutEdges().getEdges().iterator();e.hasNext();){var n=e.next();n.setMarked(!0);var i=n.getSym();null!==i&&i.setMarked(!0)}}},{key:"label",value:function(t,e){for(var n=t.iterator();n.hasNext();)n.next().setLabel(e)}},{key:"computeNextCWEdges",value:function(t){for(var e=null,n=null,i=t.getOutEdges().getEdges().iterator();i.hasNext();){var r=i.next();r.isMarked()||(null===e&&(e=r),null!==n&&n.getSym().setNext(r),n=r)}null!==n&&n.getSym().setNext(e)}},{key:"computeNextCCWEdges",value:function(t,e){for(var n=null,i=null,r=t.getOutEdges().getEdges(),s=r.size()-1;s>=0;s--){var o=r.get(s),a=o.getSym(),u=null;o.getLabel()===e&&(u=o);var l=null;a.getLabel()===e&&(l=a),null===u&&null===l||(null!==l&&(i=l),null!==u&&(null!==i&&(i.setNext(u),i=null),null===n&&(n=u)))}null!==i&&(m.isTrue(null!==n),i.setNext(n))}},{key:"getDegree",value:function(t,e){for(var n=0,i=t.getOutEdges().getEdges().iterator();i.hasNext();)i.next().getLabel()===e&&n++;return n}},{key:"findIntersectionNodes",value:function(t,e){var i=t,r=null;do{var s=i.getFromNode();n.getDegree(s,e)>1&&(null===r&&(r=new N),r.add(s)),i=i.getNext(),m.isTrue(null!==i,"found null DE in ring"),m.isTrue(i===t||!i.isInRing(),"found DE already in ring")}while(i!==t);return r}}]),n}();Os.constructor_=function(){this._factory=null;var t=arguments[0];this._factory=t};var Fs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getGeometry",value:function(){return null===this._geomFactory&&(this._geomFactory=new te),this.polygonize(),this._extractOnlyPolygonal?this._geomFactory.buildGeometry(this._polyList):this._geomFactory.createGeometryCollection(te.toGeometryArray(this._polyList))}},{key:"getInvalidRingLines",value:function(){return this.polygonize(),this._invalidRingLines}},{key:"findValidRings",value:function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isValid()?e.add(r):n.add(r.getLineString())}}},{key:"polygonize",value:function(){if(null!==this._polyList)return null;if(this._polyList=new N,null===this._graph)return null;this._dangles=this._graph.deleteDangles(),this._cutEdges=this._graph.deleteCutEdges();var e=this._graph.getEdgeRings(),n=new N;this._invalidRingLines=new N,this._isCheckingRingsValid?this.findValidRings(e,n,this._invalidRingLines):n=e,this.findShellsAndHoles(n),t.assignHolesToShells(this._holeList,this._shellList),Le.sort(this._shellList,new Ps.EnvelopeComparator);var i=!0;this._extractOnlyPolygonal&&(t.findDisjointShells(this._shellList),i=!1),this._polyList=t.extractPolygons(this._shellList,i)}},{key:"getDangles",value:function(){return this.polygonize(),this._dangles}},{key:"getCutEdges",value:function(){return this.polygonize(),this._cutEdges}},{key:"getPolygons",value:function(){return this.polygonize(),this._polyList}},{key:"add",value:function(){if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.add(e)}else if(arguments[0]instanceof Ft){var n=arguments[0];this._geomFactory=n.getFactory(),null===this._graph&&(this._graph=new Os(this._geomFactory)),this._graph.addEdge(n)}else arguments[0]instanceof W&&arguments[0].apply(this._lineStringAdder)}},{key:"setCheckRingsValid",value:function(t){this._isCheckingRingsValid=t}},{key:"findShellsAndHoles",value:function(t){this._holeList=new N,this._shellList=new N;for(var e=t.iterator();e.hasNext();){var n=e.next();n.computeHole(),n.isHole()?this._holeList.add(n):this._shellList.add(n)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"findOuterShells",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getOuterHole();null===i||i.isProcessed()||(n.setIncluded(!0),i.setProcessed(!0))}}},{key:"extractPolygons",value:function(t,e){for(var n=new N,i=t.iterator();i.hasNext();){var r=i.next();(e||r.isIncluded())&&n.add(r.getPolygon())}return n}},{key:"assignHolesToShells",value:function(e,n){for(var i=e.iterator();i.hasNext();){var r=i.next();t.assignHoleToShell(r,n)}}},{key:"assignHoleToShell",value:function(t,e){var n=Ps.findEdgeRingContaining(t,e);null!==n&&n.addHole(t)}},{key:"findDisjointShells",value:function(e){t.findOuterShells(e);var n=null;do{n=!1;for(var i=e.iterator();i.hasNext();){var r=i.next();r.isIncludedSet()||(r.updateIncluded(),r.isIncludedSet()||(n=!0))}}while(n)}}]),t}(),Ds=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){t instanceof Ft&&this.p.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[U]}}]),t}();Ds.constructor_=function(){this.p=null;var t=arguments[0];this.p=t},Fs.LineStringAdder=Ds,Fs.constructor_=function(){if(this._lineStringAdder=new Ds(this),this._graph=null,this._dangles=new N,this._cutEdges=new N,this._invalidRingLines=new N,this._holeList=null,this._shellList=null,this._polyList=null,this._isCheckingRingsValid=!0,this._extractOnlyPolygonal=null,this._geomFactory=null,0===arguments.length)Fs.constructor_.call(this,!1);else if(1===arguments.length){var t=arguments[0];this._extractOnlyPolygonal=t}};var As=Object.freeze({__proto__:null,Polygonizer:Fs}),Gs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insertEdgeEnds",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._nodes.add(n)}}},{key:"computeProperIntersectionIM",value:function(t,e){var n=this._arg[0].getGeometry().getDimension(),i=this._arg[1].getGeometry().getDimension(),r=t.hasProperIntersection(),s=t.hasProperInteriorIntersection();2===n&&2===i?r&&e.setAtLeast("212101212"):2===n&&1===i?(r&&e.setAtLeast("FFF0FFFF2"),s&&e.setAtLeast("1FFFFF1FF")):1===n&&2===i?(r&&e.setAtLeast("F0FFFFFF2"),s&&e.setAtLeast("1F1FFFFFF")):1===n&&1===i&&s&&e.setAtLeast("0FFFFFFFF")}},{key:"labelIsolatedEdges",value:function(t,e){for(var n=this._arg[t].getEdgeIterator();n.hasNext();){var i=n.next();i.isIsolated()&&(this.labelIsolatedEdge(i,e,this._arg[e].getGeometry()),this._isolatedEdges.add(i))}}},{key:"labelIsolatedEdge",value:function(t,e,n){if(n.getDimension()>0){var i=this._ptLocator.locate(t.getCoordinate(),n);t.getLabel().setAllLocations(e,i)}else t.getLabel().setAllLocations(e,he.EXTERIOR)}},{key:"computeIM",value:function(){var t=new ce;if(t.set(he.EXTERIOR,he.EXTERIOR,2),!this._arg[0].getGeometry().getEnvelopeInternal().intersects(this._arg[1].getGeometry().getEnvelopeInternal()))return this.computeDisjointIM(t),t;this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1);var e=this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!1);this.computeIntersectionNodes(0),this.computeIntersectionNodes(1),this.copyNodesAndLabels(0),this.copyNodesAndLabels(1),this.labelIsolatedNodes(),this.computeProperIntersectionIM(e,t);var n=new Es,i=n.computeEdgeEnds(this._arg[0].getEdgeIterator());this.insertEdgeEnds(i);var r=n.computeEdgeEnds(this._arg[1].getEdgeIterator());return this.insertEdgeEnds(r),this.labelNodeEdges(),this.labelIsolatedEdges(0,1),this.labelIsolatedEdges(1,0),this.updateIM(t),t}},{key:"labelNodeEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg)}},{key:"copyNodesAndLabels",value:function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._nodes.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}}},{key:"labelIntersectionNodes",value:function(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this._nodes.find(s.coord);o.getLabel().isNull(t)&&(i===he.BOUNDARY?o.setLabelBoundary(t):o.setLabel(t,he.INTERIOR))}}},{key:"labelIsolatedNode",value:function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setAllLocations(e,n)}},{key:"computeIntersectionNodes",value:function(t){for(var e=this._arg[t].getEdgeIterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.getEdgeIntersectionList().iterator();r.hasNext();){var s=r.next(),o=this._nodes.addNode(s.coord);i===he.BOUNDARY?o.setLabelBoundary(t):o.getLabel().isNull(t)&&o.setLabel(t,he.INTERIOR)}}},{key:"labelIsolatedNodes",value:function(){for(var t=this._nodes.iterator();t.hasNext();){var e=t.next(),n=e.getLabel();m.isTrue(n.getGeometryCount()>0,"node with empty label found"),e.isIsolated()&&(n.isNull(0)?this.labelIsolatedNode(e,0):this.labelIsolatedNode(e,1))}}},{key:"updateIM",value:function(t){for(var e=this._isolatedEdges.iterator();e.hasNext();)e.next().updateIM(t);for(var n=this._nodes.iterator();n.hasNext();){var i=n.next();i.updateIM(t),i.updateIMFromEdges(t)}}},{key:"computeDisjointIM",value:function(t){var e=this._arg[0].getGeometry();e.isEmpty()||(t.set(he.INTERIOR,he.EXTERIOR,e.getDimension()),t.set(he.BOUNDARY,he.EXTERIOR,e.getBoundaryDimension()));var n=this._arg[1].getGeometry();n.isEmpty()||(t.set(he.EXTERIOR,he.INTERIOR,n.getDimension()),t.set(he.EXTERIOR,he.BOUNDARY,n.getBoundaryDimension()))}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Gs.constructor_=function(){this._li=new ue,this._ptLocator=new En,this._arg=null,this._nodes=new $n(new ws),this._im=null,this._isolatedEdges=new N,this._invalidPoint=null;var t=arguments[0];this._arg=t};var Bs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"isContainedInBoundary",value:function(t){if(t instanceof Vt)return!1;if(t instanceof At)return this.isPointContainedInBoundary(t);if(t instanceof Ft)return this.isLineStringContainedInBoundary(t);for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);if(!this.isContainedInBoundary(n))return!1}return!0}},{key:"isLineSegmentContainedInBoundary",value:function(t,e){if(t.equals(e))return this.isPointContainedInBoundary(t);if(t.x===e.x){if(t.x===this._rectEnv.getMinX()||t.x===this._rectEnv.getMaxX())return!0}else if(t.y===e.y&&(t.y===this._rectEnv.getMinY()||t.y===this._rectEnv.getMaxY()))return!0;return!1}},{key:"isLineStringContainedInBoundary",value:function(t){for(var e=t.getCoordinateSequence(),n=new k,i=new k,r=0;r<e.size()-1;r++)if(e.getCoordinate(r,n),e.getCoordinate(r+1,i),!this.isLineSegmentContainedInBoundary(n,i))return!1;return!0}},{key:"isPointContainedInBoundary",value:function(){if(arguments[0]instanceof At){var t=arguments[0];return this.isPointContainedInBoundary(t.getCoordinate())}if(arguments[0]instanceof k){var e=arguments[0];return e.x===this._rectEnv.getMinX()||e.x===this._rectEnv.getMaxX()||e.y===this._rectEnv.getMinY()||e.y===this._rectEnv.getMaxY()}}},{key:"contains",value:function(t){return!!this._rectEnv.contains(t.getEnvelopeInternal())&&!this.isContainedInBoundary(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"contains",value:function(e,n){return new t(e).contains(n)}}]),t}();Bs.constructor_=function(){this._rectEnv=null;var t=arguments[0];this._rectEnv=t.getEnvelopeInternal()};var Vs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"intersects",value:function(t,e){var n=new T(t,e);if(!this._rectEnv.intersects(n))return!1;if(this._rectEnv.intersects(t))return!0;if(this._rectEnv.intersects(e))return!0;if(t.compareTo(e)>0){var i=t;t=e,e=i}var r=!1;return e.y>t.y&&(r=!0),r?this._li.computeIntersection(t,e,this._diagDown0,this._diagDown1):this._li.computeIntersection(t,e,this._diagUp0,this._diagUp1),!!this._li.hasIntersection()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Vs.constructor_=function(){this._li=new ue,this._rectEnv=null,this._diagUp0=null,this._diagUp1=null,this._diagDown0=null,this._diagDown1=null;var t=arguments[0];this._rectEnv=t,this._diagUp0=new k(t.getMinX(),t.getMinY()),this._diagUp1=new k(t.getMaxX(),t.getMaxY()),this._diagDown0=new k(t.getMinX(),t.getMaxY()),this._diagDown1=new k(t.getMaxX(),t.getMinY())};var zs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"intersects",value:function(t){if(!this._rectEnv.intersects(t.getEnvelopeInternal()))return!1;var e=new qs(this._rectEnv);if(e.applyTo(t),e.intersects())return!0;var n=new Ys(this._rectangle);if(n.applyTo(t),n.containsPoint())return!0;var i=new Xs(this._rectangle);return i.applyTo(t),!!i.intersects()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"intersects",value:function(e,n){return new t(e).intersects(n)}}]),t}();zs.constructor_=function(){this._rectangle=null,this._rectEnv=null;var t=arguments[0];this._rectangle=t,this._rectEnv=t.getEnvelopeInternal()};var qs=function(t){s(n,be);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isDone",value:function(){return!0===this._intersects}},{key:"visit",value:function(t){var e=t.getEnvelopeInternal();return this._rectEnv.intersects(e)?this._rectEnv.contains(e)||e.getMinX()>=this._rectEnv.getMinX()&&e.getMaxX()<=this._rectEnv.getMaxX()||e.getMinY()>=this._rectEnv.getMinY()&&e.getMaxY()<=this._rectEnv.getMaxY()?(this._intersects=!0,null):void 0:null}},{key:"intersects",value:function(){return this._intersects}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();qs.constructor_=function(){this._rectEnv=null,this._intersects=!1;var t=arguments[0];this._rectEnv=t};var Ys=function(t){s(n,be);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"isDone",value:function(){return!0===this._containsPoint}},{key:"visit",value:function(t){if(!(t instanceof Vt))return null;var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;for(var n=new k,i=0;i<4;i++)if(this._rectSeq.getCoordinate(i,n),e.contains(n)&&sn.containsPointInPolygon(n,t))return this._containsPoint=!0,null}},{key:"containsPoint",value:function(){return this._containsPoint}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Ys.constructor_=function(){this._rectSeq=null,this._rectEnv=null,this._containsPoint=!1;var t=arguments[0];this._rectSeq=t.getExteriorRing().getCoordinateSequence(),this._rectEnv=t.getEnvelopeInternal()};var Xs=function(t){s(n,be);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"intersects",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!0===this._hasIntersection}},{key:"visit",value:function(t){var e=t.getEnvelopeInternal();if(!this._rectEnv.intersects(e))return null;var n=Ne.getLines(t);this.checkIntersectionWithLineStrings(n)}},{key:"checkIntersectionWithLineStrings",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();if(this.checkIntersectionWithSegments(n),this._hasIntersection)return null}}},{key:"checkIntersectionWithSegments",value:function(t){for(var e=t.getCoordinateSequence(),n=1;n<e.size();n++)if(e.getCoordinate(n-1,this._p0),e.getCoordinate(n,this._p1),this._rectIntersector.intersects(this._p0,this._p1))return this._hasIntersection=!0,null}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();Xs.constructor_=function(){this._rectEnv=null,this._rectIntersector=null,this._hasIntersection=!1,this._p0=new k,this._p1=new k;var t=arguments[0];this._rectEnv=t.getEnvelopeInternal(),this._rectIntersector=new Vs(this._rectEnv)};var Us=function(t){s(n,_s);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getIntersectionMatrix",value:function(){return this._relate.computeIM()}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"covers",value:function(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().covers(e.getEnvelopeInternal())&&(!!t.isRectangle()||new n(t,e).getIntersectionMatrix().isCovers())}},{key:"intersects",value:function(t,e){if(!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal()))return!1;if(t.isRectangle())return zs.intersects(t,e);if(e.isRectangle())return zs.intersects(e,t);if(t.isGeometryCollection()||e.isGeometryCollection()){for(var i=0;i<t.getNumGeometries();i++)for(var r=0;r<e.getNumGeometries();r++)if(t.getGeometryN(i).intersects(e.getGeometryN(r)))return!0;return!1}return new n(t,e).getIntersectionMatrix().isIntersects()}},{key:"touches",value:function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new n(t,e).getIntersectionMatrix().isTouches(t.getDimension(),e.getDimension())}},{key:"equalsTopo",value:function(t,e){return!!t.getEnvelopeInternal().equals(e.getEnvelopeInternal())&&n.relate(t,e).isEquals(t.getDimension(),e.getDimension())}},{key:"relate",value:function(){return 2===arguments.length?new n(arguments[0],arguments[1]).getIntersectionMatrix():3===arguments.length?new n(arguments[0],arguments[1],arguments[2]).getIntersectionMatrix():void 0}},{key:"overlaps",value:function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new n(t,e).getIntersectionMatrix().isOverlaps(t.getDimension(),e.getDimension())}},{key:"crosses",value:function(t,e){return!!t.getEnvelopeInternal().intersects(e.getEnvelopeInternal())&&new n(t,e).getIntersectionMatrix().isCrosses(t.getDimension(),e.getDimension())}},{key:"contains",value:function(t,e){return!(2===e.getDimension()&&t.getDimension()<2)&&!(1===e.getDimension()&&t.getDimension()<1&&e.getLength()>0)&&!!t.getEnvelopeInternal().contains(e.getEnvelopeInternal())&&(t.isRectangle()?Bs.contains(t,e):new n(t,e).getIntersectionMatrix().isContains())}}]),n}();Us.constructor_=function(){if(this._relate=null,2===arguments.length){var t=arguments[0],e=arguments[1];_s.constructor_.call(this,t,e),this._relate=new Gs(this._arg)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];_s.constructor_.call(this,n,i,r),this._relate=new Gs(this._arg)}};var Ws=Object.freeze({__proto__:null,RelateOp:Us}),Hs=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"union",value:function(){for(var t=new En,e=new _t,n=0;n<this._pointGeom.getNumGeometries();n++){var i=this._pointGeom.getGeometryN(n).getCoordinate();t.locate(i,this._otherGeom)===he.EXTERIOR&&e.add(i)}if(0===e.size())return this._otherGeom;var r,s=$.toCoordinateArray(e);return r=1===s.length?this._geomFact.createPoint(s[0]):this._geomFact.createMultiPointFromCoords(s),xe.combine(r,this._otherGeom)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"union",value:function(e,n){return new t(e,n).union()}}]),t}();Hs.constructor_=function(){this._pointGeom=null,this._otherGeom=null,this._geomFact=null;var t=arguments[0],e=arguments[1];this._pointGeom=t,this._otherGeom=e,this._geomFact=e.getFactory()};var js=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"reduceToGeometries",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next(),r=null;E(i,S)?r=this.unionTree(i):i instanceof W&&(r=i),e.add(r)}return e}},{key:"extractByEnvelope",value:function(t,e,n){for(var i=new N,r=0;r<e.getNumGeometries();r++){var s=e.getGeometryN(r);s.getEnvelopeInternal().intersects(t)?i.add(s):n.add(s)}return this._geomFactory.buildGeometry(i)}},{key:"unionOptimized",value:function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return xe.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)}},{key:"union",value:function(){if(null===this._inputPolys)throw new IllegalStateException("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new Li(t.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var i=n.next();e.insert(i.getEnvelopeInternal(),i)}this._inputPolys=null;var r=e.itemsTree();return this.unionTree(r)}},{key:"binaryUnion",value:function(){if(1===arguments.length){var e=arguments[0];return this.binaryUnion(e,0,e.size())}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(r-i<=1){var s=t.getGeometry(n,i);return this.unionSafe(s,null)}if(r-i==2)return this.unionSafe(t.getGeometry(n,i),t.getGeometry(n,i+1));var o=Math.trunc((r+i)/2),a=this.binaryUnion(n,i,o),u=this.binaryUnion(n,o,r);return this.unionSafe(a,u)}}},{key:"repeatedUnion",value:function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e}},{key:"unionSafe",value:function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)}},{key:"unionActual",value:function(e,n){return t.restrictToPolygons(e.union(n))}},{key:"unionTree",value:function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)}},{key:"unionUsingEnvelopeIntersection",value:function(t,e,n){var i=new N,r=this.extractByEnvelope(n,t,i),s=this.extractByEnvelope(n,e,i),o=this.unionActual(r,s);return i.add(o),xe.combine(i)}},{key:"bufferUnion",value:function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"restrictToPolygons",value:function(t){if(E(t,Bt))return t;var e=Te.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(te.toPolygonArray(e))}},{key:"getGeometry",value:function(t,e){return e>=t.size()?null:t.get(e)}},{key:"union",value:function(e){return new t(e).union()}}]),t}();js.constructor_=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new N)},js.STRTREE_NODE_CAPACITY=4;var Ks=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"unionNoOpt",value:function(t){var e=this._geomFact.createPoint();return vs.overlayOp(t,e,ys.UNION)}},{key:"unionWithNull",value:function(t,e){return null===t&&null===e?null:null===e?t:null===t?e:t.union(e)}},{key:"extract",value:function(){if(E(arguments[0],C))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.extract(e)}else if(arguments[0]instanceof W){var n=arguments[0];null===this._geomFact&&(this._geomFact=n.getFactory()),Ee.extract(n,W.TYPENAME_POLYGON,this._polygons),Ee.extract(n,W.TYPENAME_LINESTRING,this._lines),Ee.extract(n,W.TYPENAME_POINT,this._points)}}},{key:"union",value:function(){if(null===this._geomFact)return null;var t=null;if(this._points.size()>0){var e=this._geomFact.buildGeometry(this._points);t=this.unionNoOpt(e)}var n=null;if(this._lines.size()>0){var i=this._geomFact.buildGeometry(this._lines);n=this.unionNoOpt(i)}var r=null;this._polygons.size()>0&&(r=js.union(this._polygons));var s,o=this.unionWithNull(n,r);return null===(s=null===t?o:null===o?t:Hs.union(t,o))?this._geomFact.createGeometryCollection():s}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"union",value:function(){if(1===arguments.length){if(E(arguments[0],C))return new t(arguments[0]).union();if(arguments[0]instanceof W)return new t(arguments[0]).union()}else if(2===arguments.length)return new t(arguments[0],arguments[1]).union()}}]),t}();Ks.constructor_=function(){if(this._polygons=new N,this._lines=new N,this._points=new N,this._geomFact=null,1===arguments.length){if(E(arguments[0],C)){var t=arguments[0];this.extract(t)}else if(arguments[0]instanceof W){var e=arguments[0];this.extract(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geomFact=i,this.extract(n)}};var Zs=Object.freeze({__proto__:null,UnaryUnionOp:Ks}),Js=Object.freeze({__proto__:null,IsValidOp:bs,ConsistentAreaTester:Ls}),Qs=Object.freeze({__proto__:null,BoundaryOp:It,IsSimpleOp:tr,buffer:Mr,distance:Ar,linemerge:$r,overlay:ps,polygonize:As,relate:Ws,union:Zs,valid:Js}),$s=function(t){s(n,Xt.CoordinateOperation);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"edit",value:function(){if(2===arguments.length&&arguments[1]instanceof W&&arguments[0]instanceof Array){var t=arguments[0],e=arguments[1];if(0===t.length)return null;for(var r=new Array(t.length).fill(null),s=0;s<t.length;s++){var o=new k(t[s]);this._targetPM.makePrecise(o),r[s]=o}var a=new R(r,!1).toCoordinateArray(),u=0;e instanceof Ft&&(u=2),e instanceof qt&&(u=4);var l=r;return this._removeCollapsed&&(l=null),a.length<u?l:a}return i(c(n.prototype),"edit",this).apply(this,arguments)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();$s.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0;var t=arguments[0],e=arguments[1];this._targetPM=t,this._removeCollapsed=e};var to=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"fixPolygonalTopology",value:function(t){var e=t;this._changePrecisionModel||(e=this.changePM(t,this._targetPM));var n=Pr.bufferOp(e,0),i=n;return this._changePrecisionModel||(i=t.getFactory().createGeometry(n)),i}},{key:"reducePointwise",value:function(t){var e=null;if(this._changePrecisionModel){var n=this.createFactory(t.getFactory(),this._targetPM);e=new Xt(n)}else e=new Xt;var i=this._removeCollapsed;return t.getDimension()>=2&&(i=!0),e.edit(t,new $s(this._targetPM,i))}},{key:"changePM",value:function(t,e){return this.createEditor(t.getFactory(),e).edit(t,new Xt.NoOpGeometryOperation)}},{key:"setRemoveCollapsedComponents",value:function(t){this._removeCollapsed=t}},{key:"createFactory",value:function(t,e){return new te(e,t.getSRID(),t.getCoordinateSequenceFactory())}},{key:"setChangePrecisionModel",value:function(t){this._changePrecisionModel=t}},{key:"reduce",value:function(t){var e=this.reducePointwise(t);return this._isPointwise?e:E(e,Bt)?bs.isValid(e)?e:this.fixPolygonalTopology(e):e}},{key:"setPointwise",value:function(t){this._isPointwise=t}},{key:"createEditor",value:function(t,e){if(t.getPrecisionModel()===e)return new Xt;var n=this.createFactory(t,e);return new Xt(n)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"reduce",value:function(e,n){return new t(n).reduce(e)}},{key:"reducePointwise",value:function(e,n){var i=new t(n);return i.setPointwise(!0),i.reduce(e)}}]),t}();to.constructor_=function(){this._targetPM=null,this._removeCollapsed=!0,this._changePrecisionModel=!1,this._isPointwise=!1;var t=arguments[0];this._targetPM=t};var eo=Object.freeze({__proto__:null,GeometryPrecisionReducer:to}),no=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"simplifySection",value:function(t,e){if(t+1===e)return null;this._seg.p0=this._pts[t],this._seg.p1=this._pts[e];for(var n=-1,i=t,r=t+1;r<e;r++){var s=this._seg.distance(this._pts[r]);s>n&&(n=s,i=r)}if(n<=this._distanceTolerance)for(var o=t+1;o<e;o++)this._usePt[o]=!1;else this.simplifySection(t,i),this.simplifySection(i,e)}},{key:"setDistanceTolerance",value:function(t){this._distanceTolerance=t}},{key:"simplify",value:function(){this._usePt=new Array(this._pts.length).fill(null);for(var t=0;t<this._pts.length;t++)this._usePt[t]=!0;this.simplifySection(0,this._pts.length-1);for(var e=new R,n=0;n<this._pts.length;n++)this._usePt[n]&&e.add(new k(this._pts[n]));return e.toCoordinateArray()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){var i=new t(e);return i.setDistanceTolerance(n),i.simplify()}}]),t}();no.constructor_=function(){this._pts=null,this._usePt=null,this._distanceTolerance=null,this._seg=new le;var t=arguments[0];this._pts=t};var io=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setEnsureValid",value:function(t){this._isEnsureValidTopology=t}},{key:"getResultGeometry",value:function(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new ro(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}},{key:"setDistanceTolerance",value:function(t){if(t<0)throw new n("Tolerance must be non-negative");this._distanceTolerance=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){var i=new t(e);return i.setDistanceTolerance(n),i.getResultGeometry()}}]),t}(),ro=function(t){s(n,Se);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"transformPolygon",value:function(t,e){if(t.isEmpty())return null;var r=i(c(n.prototype),"transformPolygon",this).call(this,t,e);return e instanceof Yt?r:this.createValidArea(r)}},{key:"createValidArea",value:function(t){return this._isEnsureValidTopology?t.buffer(0):t}},{key:"transformCoordinates",value:function(t,e){var n,i=t.toCoordinateArray();return n=0===i.length?new Array(0).fill(null):no.simplify(i,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(n)}},{key:"transformMultiPolygon",value:function(t,e){var r=i(c(n.prototype),"transformMultiPolygon",this).call(this,t,e);return this.createValidArea(r)}},{key:"transformLinearRing",value:function(t,e){var r=e instanceof Vt,s=i(c(n.prototype),"transformLinearRing",this).call(this,t,e);return!r||s instanceof qt?s:null}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();ro.constructor_=function(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;var t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e},io.DPTransformer=ro,io.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;var t=arguments[0];this._inputGeom=t};var so=function(t){s(n,le);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getIndex",value:function(){return this._index}},{key:"getParent",value:function(){return this._parent}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();so.constructor_=function(){if(this._parent=null,this._index=null,2===arguments.length){var t=arguments[0],e=arguments[1];so.constructor_.call(this,t,e,null,-1)}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],s=arguments[3];le.constructor_.call(this,n,i),this._parent=r,this._index=s}};var oo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"addToResult",value:function(t){this._resultSegs.add(t)}},{key:"asLineString",value:function(){return this._parentLine.getFactory().createLineString(t.extractCoordinates(this._resultSegs))}},{key:"getResultSize",value:function(){var t=this._resultSegs.size();return 0===t?0:t+1}},{key:"getParent",value:function(){return this._parentLine}},{key:"getSegment",value:function(t){return this._segs[t]}},{key:"getParentCoordinates",value:function(){return this._parentLine.getCoordinates()}},{key:"getMinimumSize",value:function(){return this._minimumSize}},{key:"asLinearRing",value:function(){return this._parentLine.getFactory().createLinearRing(t.extractCoordinates(this._resultSegs))}},{key:"getSegments",value:function(){return this._segs}},{key:"init",value:function(){var t=this._parentLine.getCoordinates();this._segs=new Array(t.length-1).fill(null);for(var e=0;e<t.length-1;e++){var n=new so(t[e],t[e+1],this._parentLine,e);this._segs[e]=n}}},{key:"getResultCoordinates",value:function(){return t.extractCoordinates(this._resultSegs)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"extractCoordinates",value:function(t){for(var e=new Array(t.size()+1).fill(null),n=null,i=0;i<t.size();i++)n=t.get(i),e[i]=n.p0;return e[e.length-1]=n.p1,e}}]),t}();oo.constructor_=function(){if(this._parentLine=null,this._segs=null,this._resultSegs=new N,this._minimumSize=null,1===arguments.length){var t=arguments[0];oo.constructor_.call(this,t,2)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._parentLine=e,this._minimumSize=n,this.init()}};var ao=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"remove",value:function(t){this._index.remove(new T(t.p0,t.p1),t)}},{key:"add",value:function(){if(arguments[0]instanceof oo)for(var t=arguments[0].getSegments(),e=0;e<t.length;e++){var n=t[e];this.add(n)}else if(arguments[0]instanceof le){var i=arguments[0];this._index.insert(new T(i.p0,i.p1),i)}}},{key:"query",value:function(t){var e=new T(t.p0,t.p1),n=new uo(t);return this._index.query(e,n),n.getItems()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ao.constructor_=function(){this._index=new mi};var uo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visitItem",value:function(t){var e=t;T.intersects(e.p0,e.p1,this._querySeg.p0,this._querySeg.p1)&&this._items.add(t)}},{key:"getItems",value:function(){return this._items}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Ye]}}]),t}();uo.constructor_=function(){this._querySeg=null,this._items=new N;var t=arguments[0];this._querySeg=t};var lo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"flatten",value:function(t,e){var n=this._linePts[t],i=this._linePts[e],r=new le(n,i);return this.remove(this._line,t,e),this._outputIndex.add(r),r}},{key:"hasBadIntersection",value:function(t,e,n){return!!this.hasBadOutputIntersection(n)||!!this.hasBadInputIntersection(t,e,n)}},{key:"setDistanceTolerance",value:function(t){this._distanceTolerance=t}},{key:"simplifySection",value:function(t,e,n){n+=1;var i=new Array(2).fill(null);if(t+1===e){var r=this._line.getSegment(t);return this._line.addToResult(r),null}var s=!0;this._line.getResultSize()<this._line.getMinimumSize()&&n+1<this._line.getMinimumSize()&&(s=!1);var o=new Array(1).fill(null),a=this.findFurthestPoint(this._linePts,t,e,o);o[0]>this._distanceTolerance&&(s=!1);var u=new le;if(u.p0=this._linePts[t],u.p1=this._linePts[e],i[0]=t,i[1]=e,this.hasBadIntersection(this._line,i,u)&&(s=!1),s){var l=this.flatten(t,e);return this._line.addToResult(l),null}this.simplifySection(t,a,n),this.simplifySection(a,e,n)}},{key:"hasBadOutputIntersection",value:function(t){for(var e=this._outputIndex.query(t).iterator();e.hasNext();){var n=e.next();if(this.hasInteriorIntersection(n,t))return!0}return!1}},{key:"findFurthestPoint",value:function(t,e,n,i){var r=new le;r.p0=t[e],r.p1=t[n];for(var s=-1,o=e,a=e+1;a<n;a++){var u=t[a],l=r.distance(u);l>s&&(s=l,o=a)}return i[0]=s,o}},{key:"simplify",value:function(t){this._line=t,this._linePts=t.getParentCoordinates(),this.simplifySection(0,this._linePts.length-1,0)}},{key:"remove",value:function(t,e,n){for(var i=e;i<n;i++){var r=t.getSegment(i);this._inputIndex.remove(r)}}},{key:"hasInteriorIntersection",value:function(t,e){return this._li.computeIntersection(t.p0,t.p1,e.p0,e.p1),this._li.isInteriorIntersection()}},{key:"hasBadInputIntersection",value:function(e,n,i){for(var r=this._inputIndex.query(i).iterator();r.hasNext();){var s=r.next();if(this.hasInteriorIntersection(s,i)){if(t.isInLineSection(e,n,s))continue;return!0}}return!1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"isInLineSection",value:function(t,e,n){if(n.getParent()!==t.getParent())return!1;var i=n.getIndex();return i>=e[0]&&i<e[1]}}]),t}();lo.constructor_=function(){this._li=new ue,this._inputIndex=new ao,this._outputIndex=new ao,this._line=null,this._linePts=null,this._distanceTolerance=0;var t=arguments[0],e=arguments[1];this._inputIndex=t,this._outputIndex=e};var ho=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setDistanceTolerance",value:function(t){this._distanceTolerance=t}},{key:"simplify",value:function(t){for(var e=t.iterator();e.hasNext();)this._inputIndex.add(e.next());for(var n=t.iterator();n.hasNext();){var i=new lo(this._inputIndex,this._outputIndex);i.setDistanceTolerance(this._distanceTolerance),i.simplify(n.next())}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();ho.constructor_=function(){this._inputIndex=new ao,this._outputIndex=new ao,this._distanceTolerance=0};var co=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getResultGeometry",value:function(){return this._inputGeom.isEmpty()?this._inputGeom.copy():(this._linestringMap=new Jt,this._inputGeom.apply(new go(this)),this._lineSimplifier.simplify(this._linestringMap.values()),new fo(this._linestringMap).transform(this._inputGeom))}},{key:"setDistanceTolerance",value:function(t){if(t<0)throw new n("Tolerance must be non-negative");this._lineSimplifier.setDistanceTolerance(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){var i=new t(e);return i.setDistanceTolerance(n),i.getResultGeometry()}}]),t}(),fo=function(t){s(n,Se);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"transformCoordinates",value:function(t,e){if(0===t.size())return null;if(e instanceof Ft){var r=this._linestringMap.get(e);return this.createCoordinateSequence(r.getResultCoordinates())}return i(c(n.prototype),"transformCoordinates",this).call(this,t,e)}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();fo.constructor_=function(){this._linestringMap=null;var t=arguments[0];this._linestringMap=t};var go=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){if(t instanceof Ft){var e=t;if(e.isEmpty())return null;var n=e.isClosed()?4:2,i=new oo(e,n);this.tps._linestringMap.put(e,i)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[U]}}]),t}();go.constructor_=function(){this.tps=null;var t=arguments[0];this.tps=t},co.LineStringTransformer=fo,co.LineStringMapBuilderFilter=go,co.constructor_=function(){this._inputGeom=null,this._lineSimplifier=new ho,this._linestringMap=null;var t=arguments[0];this._inputGeom=t};var vo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"simplifyVertex",value:function(t){for(var e=t,n=e.getArea(),i=null;null!==e;){var r=e.getArea();r<n&&(n=r,i=e),e=e._next}return null!==i&&n<this._tolerance&&i.remove(),t.isLive()?n:-1}},{key:"simplify",value:function(){var t=_o.buildLine(this._pts),e=this._tolerance;do{e=this.simplifyVertex(t)}while(e<this._tolerance);var n=t.getCoordinates();return n.length<2?[n[0],new k(n[0])]:n}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){return new t(e,n).simplify()}}]),t}(),_o=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getCoordinates",value:function(){var t=new R,e=this;do{t.add(e._pt,!1),e=e._next}while(null!==e);return t.toCoordinateArray()}},{key:"getArea",value:function(){return this._area}},{key:"updateArea",value:function(){if(null===this._prev||null===this._next)return this._area=t.MAX_AREA,null;this._area=Math.abs(de.area(this._prev._pt,this._pt,this._next._pt))}},{key:"remove",value:function(){var t=this._prev,e=this._next,n=null;return null!==this._prev&&(this._prev.setNext(e),this._prev.updateArea(),n=this._prev),null!==this._next&&(this._next.setPrev(t),this._next.updateArea(),null===n&&(n=this._next)),this._isLive=!1,n}},{key:"isLive",value:function(){return this._isLive}},{key:"setPrev",value:function(t){this._prev=t}},{key:"setNext",value:function(t){this._next=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"buildLine",value:function(e){for(var n=null,i=null,r=0;r<e.length;r++){var s=new t(e[r]);null===n&&(n=s),s.setPrev(i),null!==i&&(i.setNext(s),i.updateArea()),i=s}return n}}]),t}();_o.constructor_=function(){this._pt=null,this._prev=null,this._next=null,this._area=_o.MAX_AREA,this._isLive=!0;var t=arguments[0];this._pt=t},_o.MAX_AREA=o.MAX_VALUE,vo.VWVertex=_o,vo.constructor_=function(){this._pts=null,this._tolerance=null;var t=arguments[0],e=arguments[1];this._pts=t,this._tolerance=e*e};var yo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"setEnsureValid",value:function(t){this._isEnsureValidTopology=t}},{key:"getResultGeometry",value:function(){return this._inputGeom.isEmpty()?this._inputGeom.copy():new po(this._isEnsureValidTopology,this._distanceTolerance).transform(this._inputGeom)}},{key:"setDistanceTolerance",value:function(t){if(t<0)throw new n("Tolerance must be non-negative");this._distanceTolerance=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"simplify",value:function(e,n){var i=new t(e);return i.setDistanceTolerance(n),i.getResultGeometry()}}]),t}(),po=function(t){s(n,Se);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"transformPolygon",value:function(t,e){if(t.isEmpty())return null;var r=i(c(n.prototype),"transformPolygon",this).call(this,t,e);return e instanceof Yt?r:this.createValidArea(r)}},{key:"createValidArea",value:function(t){return this._isEnsureValidTopology?t.buffer(0):t}},{key:"transformCoordinates",value:function(t,e){var n,i=t.toCoordinateArray();return n=0===i.length?new Array(0).fill(null):vo.simplify(i,this._distanceTolerance),this._factory.getCoordinateSequenceFactory().create(n)}},{key:"transformMultiPolygon",value:function(t,e){var r=i(c(n.prototype),"transformMultiPolygon",this).call(this,t,e);return this.createValidArea(r)}},{key:"transformLinearRing",value:function(t,e){var r=e instanceof Vt,s=i(c(n.prototype),"transformLinearRing",this).call(this,t,e);return!r||s instanceof qt?s:null}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();po.constructor_=function(){this._isEnsureValidTopology=!0,this._distanceTolerance=null;var t=arguments[0],e=arguments[1];this._isEnsureValidTopology=t,this._distanceTolerance=e},yo.VWTransformer=po,yo.constructor_=function(){this._inputGeom=null,this._distanceTolerance=null,this._isEnsureValidTopology=!0;var t=arguments[0];this._inputGeom=t};var mo=Object.freeze({__proto__:null,DouglasPeuckerSimplifier:io,TopologyPreservingSimplifier:co,VWSimplifier:yo}),ko=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"splitAt",value:function(){if(1===arguments.length){var e=arguments[0],n=this._minimumLen/this._segLen;if(e.distance(this._seg.p0)<this._minimumLen)return this._splitPt=this._seg.pointAlong(n),null;if(e.distance(this._seg.p1)<this._minimumLen)return this._splitPt=t.pointAlongReverse(this._seg,n),null;this._splitPt=e}else if(2===arguments.length){var i=arguments[0],r=arguments[1],s=this.getConstrainedLength(i)/this._segLen;r.equals2D(this._seg.p0)?this._splitPt=this._seg.pointAlong(s):this._splitPt=t.pointAlongReverse(this._seg,s)}}},{key:"setMinimumLength",value:function(t){this._minimumLen=t}},{key:"getConstrainedLength",value:function(t){return t<this._minimumLen?this._minimumLen:t}},{key:"getSplitPoint",value:function(){return this._splitPt}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"pointAlongReverse",value:function(t,e){var n=new k;return n.x=t.p1.x-e*(t.p1.x-t.p0.x),n.y=t.p1.y-e*(t.p1.y-t.p0.y),n}}]),t}();ko.constructor_=function(){this._seg=null,this._segLen=null,this._splitPt=null,this._minimumLen=0;var t=arguments[0];this._seg=t,this._segLen=t.getLength()};var xo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"findSplitPoint",value:function(t,e){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();xo.constructor_=function(){};var Eo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"findSplitPoint",value:function(e,n){var i=e.getLineSegment(),r=i.getLength()/2,s=new ko(i),o=t.projectedSplitPoint(e,n),a=2*o.distance(n)*.8;return a>r&&(a=r),s.setMinimumLength(a),s.splitAt(o),s.getSplitPoint()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[xo]}}],[{key:"projectedSplitPoint",value:function(t,e){return t.getLineSegment().project(e)}}]),t}();Eo.constructor_=function(){};var Co=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"triArea",value:function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)}},{key:"isInCircleDDNormalized",value:function(t,e,n,i){var r=D.valueOf(t.x).selfSubtract(i.x),s=D.valueOf(t.y).selfSubtract(i.y),o=D.valueOf(e.x).selfSubtract(i.x),a=D.valueOf(e.y).selfSubtract(i.y),u=D.valueOf(n.x).selfSubtract(i.x),l=D.valueOf(n.y).selfSubtract(i.y),h=r.multiply(a).selfSubtract(o.multiply(s)),c=o.multiply(l).selfSubtract(u.multiply(a)),f=u.multiply(s).selfSubtract(r.multiply(l)),d=r.multiply(r).selfAdd(s.multiply(s)),g=o.multiply(o).selfAdd(a.multiply(a)),v=u.multiply(u).selfAdd(l.multiply(l));return d.selfMultiply(c).selfAdd(g.selfMultiply(f)).selfAdd(v.selfMultiply(h)).doubleValue()>0}},{key:"checkRobustInCircle",value:function(e,n,i,r){var s=t.isInCircleNonRobust(e,n,i,r),o=t.isInCircleDDSlow(e,n,i,r),a=t.isInCircleCC(e,n,i,r),u=de.circumcentre(e,n,i);B.out.println("p radius diff a = "+Math.abs(r.distance(u)-e.distance(u))/e.distance(u)),s===o&&s===a||(B.out.println("inCircle robustness failure (double result = "+s+", DD result = "+o+", CC result = "+a+")"),B.out.println(oe.toLineString(new Kt([e,n,i,r]))),B.out.println("Circumcentre = "+oe.toPoint(u)+" radius = "+e.distance(u)),B.out.println("p radius diff a = "+Math.abs(r.distance(u)/e.distance(u)-1)),B.out.println("p radius diff b = "+Math.abs(r.distance(u)/n.distance(u)-1)),B.out.println("p radius diff c = "+Math.abs(r.distance(u)/i.distance(u)-1)),B.out.println())}},{key:"isInCircleDDFast",value:function(e,n,i,r){var s=D.sqr(e.x).selfAdd(D.sqr(e.y)).selfMultiply(t.triAreaDDFast(n,i,r)),o=D.sqr(n.x).selfAdd(D.sqr(n.y)).selfMultiply(t.triAreaDDFast(e,i,r)),a=D.sqr(i.x).selfAdd(D.sqr(i.y)).selfMultiply(t.triAreaDDFast(e,n,r)),u=D.sqr(r.x).selfAdd(D.sqr(r.y)).selfMultiply(t.triAreaDDFast(e,n,i));return s.selfSubtract(o).selfAdd(a).selfSubtract(u).doubleValue()>0}},{key:"isInCircleCC",value:function(t,e,n,i){var r=de.circumcentre(t,e,n),s=t.distance(r);return i.distance(r)-s<=0}},{key:"isInCircleNormalized",value:function(t,e,n,i){var r=t.x-i.x,s=t.y-i.y,o=e.x-i.x,a=e.y-i.y,u=n.x-i.x,l=n.y-i.y;return(r*r+s*s)*(o*l-u*a)+(o*o+a*a)*(u*s-r*l)+(u*u+l*l)*(r*a-o*s)>0}},{key:"isInCircleDDSlow",value:function(e,n,i,r){var s=D.valueOf(r.x),o=D.valueOf(r.y),a=D.valueOf(e.x),u=D.valueOf(e.y),l=D.valueOf(n.x),h=D.valueOf(n.y),c=D.valueOf(i.x),f=D.valueOf(i.y),d=a.multiply(a).add(u.multiply(u)).multiply(t.triAreaDDSlow(l,h,c,f,s,o)),g=l.multiply(l).add(h.multiply(h)).multiply(t.triAreaDDSlow(a,u,c,f,s,o)),v=c.multiply(c).add(f.multiply(f)).multiply(t.triAreaDDSlow(a,u,l,h,s,o)),_=s.multiply(s).add(o.multiply(o)).multiply(t.triAreaDDSlow(a,u,l,h,c,f));return d.subtract(g).add(v).subtract(_).doubleValue()>0}},{key:"isInCircleNonRobust",value:function(e,n,i,r){return(e.x*e.x+e.y*e.y)*t.triArea(n,i,r)-(n.x*n.x+n.y*n.y)*t.triArea(e,i,r)+(i.x*i.x+i.y*i.y)*t.triArea(e,n,r)-(r.x*r.x+r.y*r.y)*t.triArea(e,n,i)>0}},{key:"isInCircleRobust",value:function(e,n,i,r){return t.isInCircleNormalized(e,n,i,r)}},{key:"triAreaDDSlow",value:function(t,e,n,i,r,s){return n.subtract(t).multiply(s.subtract(e)).subtract(i.subtract(e).multiply(r.subtract(t)))}},{key:"triAreaDDFast",value:function(t,e,n){var i=D.valueOf(e.x).selfSubtract(t.x).selfMultiply(D.valueOf(n.y).selfSubtract(t.y)),r=D.valueOf(e.y).selfSubtract(t.y).selfMultiply(D.valueOf(n.x).selfSubtract(t.x));return i.selfSubtract(r)}}]),t}();Co.constructor_=function(){};var Io=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"circleCenter",value:function(e,n){var i=new t(this.getX(),this.getY()),r=this.bisector(i,e),s=this.bisector(e,n),o=new V(r,s),a=null;try{a=new t(o.getX(),o.getY())}catch(r){if(!(r instanceof P))throw r;B.err.println("a: "+i+"  b: "+e+"  c: "+n),B.err.println(r)}return a}},{key:"dot",value:function(t){return this._p.x*t.getX()+this._p.y*t.getY()}},{key:"magn",value:function(){return Math.sqrt(this._p.x*this._p.x+this._p.y*this._p.y)}},{key:"getZ",value:function(){return this._p.z}},{key:"bisector",value:function(t,e){var n=e.getX()-t.getX(),i=e.getY()-t.getY(),r=new V(t.getX()+n/2,t.getY()+i/2,1),s=new V(t.getX()-i+n/2,t.getY()+n+i/2,1);return new V(r,s)}},{key:"equals",value:function(){if(1===arguments.length){var t=arguments[0];return this._p.x===t.getX()&&this._p.y===t.getY()}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this._p.distance(e.getCoordinate())<n}}},{key:"getCoordinate",value:function(){return this._p}},{key:"isInCircle",value:function(t,e,n){return Co.isInCircleRobust(t._p,e._p,n._p,this._p)}},{key:"interpolateZValue",value:function(t,e,n){var i=t.getX(),r=t.getY(),s=e.getX()-i,o=n.getX()-i,a=e.getY()-r,u=n.getY()-r,l=s*u-o*a,h=this.getX()-i,c=this.getY()-r,f=(u*h-o*c)/l,d=(-a*h+s*c)/l;return t.getZ()+f*(e.getZ()-t.getZ())+d*(n.getZ()-t.getZ())}},{key:"midPoint",value:function(e){return new t((this._p.x+e.getX())/2,(this._p.y+e.getY())/2,(this._p.z+e.getZ())/2)}},{key:"rightOf",value:function(t){return this.isCCW(t.dest(),t.orig())}},{key:"isCCW",value:function(t,e){return(t._p.x-this._p.x)*(e._p.y-this._p.y)-(t._p.y-this._p.y)*(e._p.x-this._p.x)>0}},{key:"getX",value:function(){return this._p.x}},{key:"crossProduct",value:function(t){return this._p.x*t.getY()-this._p.y*t.getX()}},{key:"setZ",value:function(t){this._p.z=t}},{key:"times",value:function(e){return new t(e*this._p.x,e*this._p.y)}},{key:"cross",value:function(){return new t(this._p.y,-this._p.x)}},{key:"leftOf",value:function(t){return this.isCCW(t.orig(),t.dest())}},{key:"toString",value:function(){return"POINT ("+this._p.x+" "+this._p.y+")"}},{key:"sub",value:function(e){return new t(this._p.x-e.getX(),this._p.y-e.getY())}},{key:"getY",value:function(){return this._p.y}},{key:"classify",value:function(e,n){var i=n.sub(e),r=this.sub(e),s=i.crossProduct(r);return s>0?t.LEFT:s<0?t.RIGHT:i.getX()*r.getX()<0||i.getY()*r.getY()<0?t.BEHIND:i.magn()<r.magn()?t.BEYOND:e.equals(this)?t.ORIGIN:n.equals(this)?t.DESTINATION:t.BETWEEN}},{key:"sum",value:function(e){return new t(this._p.x+e.getX(),this._p.y+e.getY())}},{key:"distance",value:function(t,e){return Math.sqrt(Math.pow(e.getX()-t.getX(),2)+Math.pow(e.getY()-t.getY(),2))}},{key:"circumRadiusRatio",value:function(t,e){var n=this.circleCenter(t,e),i=this.distance(n,t),r=this.distance(this,t),s=this.distance(t,e);return s<r&&(r=s),(s=this.distance(e,this))<r&&(r=s),i/r}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"interpolateZ",value:function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=e.distance(n),r=t.distance(e),s=n.z-e.z;return e.z+s*(r/i)}if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3],h=a.x,c=a.y,f=u.x-h,d=l.x-h,g=u.y-c,v=l.y-c,_=f*v-d*g,y=o.x-h,p=o.y-c,m=(v*y-d*p)/_,k=(-g*y+f*p)/_;return a.z+m*(u.z-a.z)+k*(l.z-a.z)}}}]),t}();Io.constructor_=function(){if(this._p=null,1===arguments.length){var t=arguments[0];this._p=new k(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._p=new k(e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._p=new k(i,r,s)}},Io.LEFT=0,Io.RIGHT=1,Io.BEYOND=2,Io.BEHIND=3,Io.BETWEEN=4,Io.ORIGIN=5,Io.DESTINATION=6;var So=function(t){s(n,Io);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getConstraint",value:function(){return this._constraint}},{key:"setOnConstraint",value:function(t){this._isOnConstraint=t}},{key:"merge",value:function(t){t._isOnConstraint&&(this._isOnConstraint=!0,this._constraint=t._constraint)}},{key:"isOnConstraint",value:function(){return this._isOnConstraint}},{key:"setConstraint",value:function(t){this._isOnConstraint=!0,this._constraint=t}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}]),n}();So.constructor_=function(){this._isOnConstraint=null,this._constraint=null;var t=arguments[0];Io.constructor_.call(this,t)};var wo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"equalsNonOriented",value:function(t){return!!this.equalsOriented(t)||!!this.equalsOriented(t.sym())}},{key:"toLineSegment",value:function(){return new le(this._vertex.getCoordinate(),this.dest().getCoordinate())}},{key:"dest",value:function(){return this.sym().orig()}},{key:"oNext",value:function(){return this._next}},{key:"equalsOriented",value:function(t){return!(!this.orig().getCoordinate().equals2D(t.orig().getCoordinate())||!this.dest().getCoordinate().equals2D(t.dest().getCoordinate()))}},{key:"dNext",value:function(){return this.sym().oNext().sym()}},{key:"lPrev",value:function(){return this._next.sym()}},{key:"rPrev",value:function(){return this.sym().oNext()}},{key:"rot",value:function(){return this._rot}},{key:"oPrev",value:function(){return this._rot._next._rot}},{key:"sym",value:function(){return this._rot._rot}},{key:"setOrig",value:function(t){this._vertex=t}},{key:"lNext",value:function(){return this.invRot().oNext().rot()}},{key:"getLength",value:function(){return this.orig().getCoordinate().distance(this.dest().getCoordinate())}},{key:"invRot",value:function(){return this._rot.sym()}},{key:"setDest",value:function(t){this.sym().setOrig(t)}},{key:"setData",value:function(t){this._data=t}},{key:"getData",value:function(){return this._data}},{key:"delete",value:function(){this._rot=null}},{key:"orig",value:function(){return this._vertex}},{key:"rNext",value:function(){return this._rot._next.invRot()}},{key:"toString",value:function(){var t=this._vertex.getCoordinate(),e=this.dest().getCoordinate();return oe.toLineString(t,e)}},{key:"isLive",value:function(){return null!==this._rot}},{key:"getPrimary",value:function(){return this.orig().getCoordinate().compareTo(this.dest().getCoordinate())<=0?this:this.sym()}},{key:"dPrev",value:function(){return this.invRot().oNext().invRot()}},{key:"setNext",value:function(t){this._next=t}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"makeEdge",value:function(e,n){var i=new t,r=new t,s=new t,o=new t;i._rot=r,r._rot=s,s._rot=o,o._rot=i,i.setNext(i),r.setNext(o),s.setNext(s),o.setNext(r);var a=i;return a.setOrig(e),a.setDest(n),a}},{key:"swap",value:function(e){var n=e.oPrev(),i=e.sym().oPrev();t.splice(e,n),t.splice(e.sym(),i),t.splice(e,n.lNext()),t.splice(e.sym(),i.lNext()),e.setOrig(n.dest()),e.setDest(i.dest())}},{key:"splice",value:function(t,e){var n=t.oNext().rot(),i=e.oNext().rot(),r=e.oNext(),s=t.oNext(),o=i.oNext(),a=n.oNext();t.setNext(r),e.setNext(s),n.setNext(o),i.setNext(a)}},{key:"connect",value:function(e,n){var i=t.makeEdge(e.dest(),n.orig());return t.splice(i,e.lNext()),t.splice(i.sym(),n),i}}]),t}();wo.constructor_=function(){this._rot=null,this._vertex=null,this._next=null,this._data=null};var No=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"insertSite",value:function(t){var e=this._subdiv.locate(t);if(this._subdiv.isVertexOfEdge(e,t))return e;this._subdiv.isOnEdge(e,t.getCoordinate())&&(e=e.oPrev(),this._subdiv.delete(e.oNext()));var n=this._subdiv.makeEdge(e.orig(),t);wo.splice(n,e);var i=n;do{e=(n=this._subdiv.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);for(;;){var r=e.oPrev();if(r.dest().rightOf(e)&&t.isInCircle(e.orig(),r.dest(),e.dest()))wo.swap(e),e=e.oPrev();else{if(e.oNext()===i)return n;e=e.oNext().lPrev()}}}},{key:"insertSites",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();No.constructor_=function(){this._subdiv=null,this._isUsingTolerance=!1;var t=arguments[0];this._subdiv=t,this._isUsingTolerance=t.getTolerance()>0};var Lo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"locate",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Lo.constructor_=function(){};var Ro=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"init",value:function(){this._lastEdge=this.findEdge()}},{key:"locate",value:function(t){this._lastEdge.isLive()||this.init();var e=this._subdiv.locateFromEdge(t,this._lastEdge);return this._lastEdge=e,e}},{key:"findEdge",value:function(){return this._subdiv.getEdges().iterator().next()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[Lo]}}]),t}();Ro.constructor_=function(){this._subdiv=null,this._lastEdge=null;var t=arguments[0];this._subdiv=t,this.init()};var To=function(t){s(n,y);var e=a(n);function n(){var t;return f(this,n),t=e.call(this),n.constructor_.apply(l(t),arguments),t}return g(n,[{key:"getSegment",value:function(){return this._seg}},{key:"getClass",value:function(){return n}},{key:"interfaces_",get:function(){return[]}}],[{key:"msgWithSpatial",value:function(t,e){return null!==e?t+" [ "+e+" ]":t}}]),n}();To.constructor_=function(){if(this._seg=null,1===arguments.length){if("string"==typeof arguments[0]){var t=arguments[0];y.constructor_.call(this,t)}else if(arguments[0]instanceof le){var e=arguments[0];y.constructor_.call(this,"Locate failed to converge (at edge: "+e+").  Possible causes include invalid Subdivision topology or very close sites"),this._seg=new le(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];y.constructor_.call(this,To.msgWithSpatial(n,i)),this._seg=new le(i)}};var bo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visit",value:function(t){}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();bo.constructor_=function(){};var Po=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getTriangleVertices",value:function(t){var e=new Fo;return this.visitTriangles(e,t),e.getTriangleVertices()}},{key:"isFrameVertex",value:function(t){return!!t.equals(this._frameVertex[0])||!!t.equals(this._frameVertex[1])||!!t.equals(this._frameVertex[2])}},{key:"isVertexOfEdge",value:function(t,e){return!(!e.equals(t.orig(),this._tolerance)&&!e.equals(t.dest(),this._tolerance))}},{key:"connect",value:function(t,e){var n=wo.connect(t,e);return this._quadEdges.add(n),n}},{key:"getVoronoiCellPolygon",value:function(t,e){var n=new N,i=t;do{var r=t.rot().orig().getCoordinate();n.add(r),t=t.oPrev()}while(t!==i);var s=new R;s.addAll(n,!1),s.closeRing(),s.size()<4&&(B.out.println(s),s.add(s.get(s.size()-1),!0));var o=s.toCoordinateArray(),a=e.createPolygon(e.createLinearRing(o)),u=i.orig();return a.setUserData(u.getCoordinate()),a}},{key:"setLocator",value:function(t){this._locator=t}},{key:"initSubdiv",value:function(){var t=this.makeEdge(this._frameVertex[0],this._frameVertex[1]),e=this.makeEdge(this._frameVertex[1],this._frameVertex[2]);wo.splice(t.sym(),e);var n=this.makeEdge(this._frameVertex[2],this._frameVertex[0]);return wo.splice(e.sym(),n),wo.splice(n.sym(),t),t}},{key:"isFrameBorderEdge",value:function(e){var n=new Array(3).fill(null);t.getTriangleEdges(e,n);var i=new Array(3).fill(null);t.getTriangleEdges(e.sym(),i);var r=e.lNext().dest();if(this.isFrameVertex(r))return!0;var s=e.sym().lNext().dest();return!!this.isFrameVertex(s)}},{key:"makeEdge",value:function(t,e){var n=wo.makeEdge(t,e);return this._quadEdges.add(n),n}},{key:"visitTriangles",value:function(t,e){this._visitedKey++;var n=new gn;n.push(this._startingEdge);for(var i=new ot;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=this.fetchTriangleToVisit(r,n,e,i);null!==s&&t.visit(s)}}}},{key:"isFrameEdge",value:function(t){return!(!this.isFrameVertex(t.orig())&&!this.isFrameVertex(t.dest()))}},{key:"isOnEdge",value:function(t,e){return this._seg.setCoordinates(t.orig().getCoordinate(),t.dest().getCoordinate()),this._seg.distance(e)<this._edgeCoincidenceTolerance}},{key:"getEnvelope",value:function(){return new T(this._frameEnv)}},{key:"createFrame",value:function(t){var e,n=t.getWidth(),i=t.getHeight();e=n>i?10*n:10*i,this._frameVertex[0]=new Io((t.getMaxX()+t.getMinX())/2,t.getMaxY()+e),this._frameVertex[1]=new Io(t.getMinX()-e,t.getMinY()-e),this._frameVertex[2]=new Io(t.getMaxX()+e,t.getMinY()-e),this._frameEnv=new T(this._frameVertex[0].getCoordinate(),this._frameVertex[1].getCoordinate()),this._frameEnv.expandToInclude(this._frameVertex[2].getCoordinate())}},{key:"getTriangleCoordinates",value:function(t){var e=new Do;return this.visitTriangles(e,t),e.getTriangles()}},{key:"getVertices",value:function(t){for(var e=new ot,n=this._quadEdges.iterator();n.hasNext();){var i=n.next(),r=i.orig();!t&&this.isFrameVertex(r)||e.add(r);var s=i.dest();!t&&this.isFrameVertex(s)||e.add(s)}return e}},{key:"fetchTriangleToVisit",value:function(t,e,n,i){var r=t,s=0,o=!1;do{this._triEdges[s]=r,this.isFrameEdge(r)&&(o=!0);var a=r.sym();i.contains(a)||e.push(a),i.add(r),s++,r=r.lNext()}while(r!==t);return o&&!n?null:this._triEdges}},{key:"getEdges",value:function(){if(0===arguments.length)return this._quadEdges;if(1===arguments.length){for(var t=arguments[0],e=this.getPrimaryEdges(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createLineString([s.orig().getCoordinate(),s.dest().getCoordinate()])}return t.createMultiLineString(n)}}},{key:"getVertexUniqueEdges",value:function(t){for(var e=new N,n=new ot,i=this._quadEdges.iterator();i.hasNext();){var r=i.next(),s=r.orig();n.contains(s)||(n.add(s),!t&&this.isFrameVertex(s)||e.add(r));var o=r.sym(),a=o.orig();n.contains(a)||(n.add(a),!t&&this.isFrameVertex(a)||e.add(o))}return e}},{key:"getTriangleEdges",value:function(t){var e=new Oo;return this.visitTriangles(e,t),e.getTriangleEdges()}},{key:"getPrimaryEdges",value:function(t){this._visitedKey++;var e=new N,n=new gn;n.push(this._startingEdge);for(var i=new ot;!n.empty();){var r=n.pop();if(!i.contains(r)){var s=r.getPrimary();!t&&this.isFrameEdge(s)||e.add(s),n.push(r.oNext()),n.push(r.sym().oNext()),i.add(r),i.add(r.sym())}}return e}},{key:"delete",value:function(t){wo.splice(t,t.oPrev()),wo.splice(t.sym(),t.sym().oPrev());var e=t.sym(),n=t.rot(),i=t.rot().sym();this._quadEdges.remove(t),this._quadEdges.remove(e),this._quadEdges.remove(n),this._quadEdges.remove(i),t.delete(),e.delete(),n.delete(),i.delete()}},{key:"locateFromEdge",value:function(t,e){for(var n=0,i=this._quadEdges.size(),r=e;;){if(++n>i)throw new To(r.toLineSegment());if(t.equals(r.orig())||t.equals(r.dest()))break;if(t.rightOf(r))r=r.sym();else if(t.rightOf(r.oNext())){if(t.rightOf(r.dPrev()))break;r=r.dPrev()}else r=r.oNext()}return r}},{key:"getTolerance",value:function(){return this._tolerance}},{key:"getVoronoiCellPolygons",value:function(t){this.visitTriangles(new Mo,!0);for(var e=new N,n=this.getVertexUniqueEdges(!1).iterator();n.hasNext();){var i=n.next();e.add(this.getVoronoiCellPolygon(i,t))}return e}},{key:"getVoronoiDiagram",value:function(t){var e=this.getVoronoiCellPolygons(t);return t.createGeometryCollection(te.toGeometryArray(e))}},{key:"getTriangles",value:function(t){for(var e=this.getTriangleCoordinates(!1),n=new Array(e.size()).fill(null),i=0,r=e.iterator();r.hasNext();){var s=r.next();n[i++]=t.createPolygon(t.createLinearRing(s))}return t.createGeometryCollection(n)}},{key:"insertSite",value:function(t){var e=this.locate(t);if(t.equals(e.orig(),this._tolerance)||t.equals(e.dest(),this._tolerance))return e;var n=this.makeEdge(e.orig(),t);wo.splice(n,e);var i=n;do{e=(n=this.connect(e,n.sym())).oPrev()}while(e.lNext()!==i);return i}},{key:"locate",value:function(){if(1===arguments.length){if(arguments[0]instanceof Io){var t=arguments[0];return this._locator.locate(t)}if(arguments[0]instanceof k){var e=arguments[0];return this._locator.locate(new Io(e))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1],r=this._locator.locate(new Io(n));if(null===r)return null;var s=r;r.dest().getCoordinate().equals2D(n)&&(s=r.sym());var o=s;do{if(o.dest().getCoordinate().equals2D(i))return o;o=o.oNext()}while(o!==s);return null}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getTriangleEdges",value:function(t,e){if(e[0]=t,e[1]=e[0].lNext(),e[2]=e[1].lNext(),e[2].lNext()!==e[0])throw new n("Edges do not form a triangle")}}]),t}(),Mo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visit",value:function(t){for(var e=t[0].orig().getCoordinate(),n=t[1].orig().getCoordinate(),i=t[2].orig().getCoordinate(),r=de.circumcentre(e,n,i),s=new Io(r),o=0;o<3;o++)t[o].rot().setOrig(s)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[bo]}}]),t}();Mo.constructor_=function(){};var Oo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getTriangleEdges",value:function(){return this._triList}},{key:"visit",value:function(t){this._triList.add(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[bo]}}]),t}();Oo.constructor_=function(){this._triList=new N};var Fo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"visit",value:function(t){this._triList.add([t[0].orig(),t[1].orig(),t[2].orig()])}},{key:"getTriangleVertices",value:function(){return this._triList}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[bo]}}]),t}();Fo.constructor_=function(){this._triList=new N};var Do=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"checkTriangleSize",value:function(t){t.length>=2?oe.toLineString(t[0],t[1]):t.length>=1&&oe.toPoint(t[0])}},{key:"visit",value:function(t){this._coordList.clear();for(var e=0;e<3;e++){var n=t[e].orig();this._coordList.add(n.getCoordinate())}if(this._coordList.size()>0){this._coordList.closeRing();var i=this._coordList.toCoordinateArray();if(4!==i.length)return null;this._triCoords.add(i)}}},{key:"getTriangles",value:function(){return this._triCoords}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[bo]}}]),t}();Do.constructor_=function(){this._coordList=new R,this._triCoords=new N},Po.TriangleCircumcentreVisitor=Mo,Po.TriangleEdgesListVisitor=Oo,Po.TriangleVertexListVisitor=Fo,Po.TriangleCoordinatesVisitor=Do,Po.constructor_=function(){this._visitedKey=0,this._quadEdges=new N,this._startingEdge=null,this._tolerance=null,this._edgeCoincidenceTolerance=null,this._frameVertex=new Array(3).fill(null),this._frameEnv=null,this._locator=null,this._seg=new le,this._triEdges=new Array(3).fill(null);var t=arguments[0],e=arguments[1];this._tolerance=e,this._edgeCoincidenceTolerance=e/Po.EDGE_COINCIDENCE_TOL_FACTOR,this.createFrame(t),this._startingEdge=this.initSubdiv(),this._locator=new Ro(this)},Po.EDGE_COINCIDENCE_TOL_FACTOR=1e3;var Ao=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getLineSegment",value:function(){return this._ls}},{key:"getEndZ",value:function(){return this._ls.getCoordinate(1).z}},{key:"getStartZ",value:function(){return this._ls.getCoordinate(0).z}},{key:"intersection",value:function(t){return this._ls.intersection(t.getLineSegment())}},{key:"getStart",value:function(){return this._ls.getCoordinate(0)}},{key:"getEnd",value:function(){return this._ls.getCoordinate(1)}},{key:"getEndY",value:function(){return this._ls.getCoordinate(1).y}},{key:"getStartX",value:function(){return this._ls.getCoordinate(0).x}},{key:"equalsTopo",value:function(t){return this._ls.equalsTopo(t.getLineSegment())}},{key:"getStartY",value:function(){return this._ls.getCoordinate(0).y}},{key:"setData",value:function(t){this._data=t}},{key:"getData",value:function(){return this._data}},{key:"getEndX",value:function(){return this._ls.getCoordinate(1).x}},{key:"toString",value:function(){return this._ls.toString()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Ao.constructor_=function(){if(this._ls=null,this._data=null,2===arguments.length){var t=arguments[0],e=arguments[1];this._ls=new le(t,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._ls=new le(n,i),this._data=r}else if(6===arguments.length){var s=arguments[0],o=arguments[1],a=arguments[2],u=arguments[3],l=arguments[4],h=arguments[5];Ao.constructor_.call(this,new k(s,o,a),new k(u,l,h))}else if(7===arguments.length){var c=arguments[0],f=arguments[1],d=arguments[2],g=arguments[3],v=arguments[4],_=arguments[5],y=arguments[6];Ao.constructor_.call(this,new k(c,f,d),new k(g,v,_),y)}};var Go=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getInitialVertices",value:function(){return this._initialVertices}},{key:"getKDT",value:function(){return this._kdt}},{key:"enforceConstraints",value:function(){this.addConstraintVertices();var e=0,n=0;do{n=this.enforceGabriel(this._segments),e++}while(n>0&&e<t.MAX_SPLIT_ITER)}},{key:"insertSites",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertSite(n)}}},{key:"getVertexFactory",value:function(){return this._vertexFactory}},{key:"getPointArray",value:function(){for(var t=new Array(this._initialVertices.size()+this._segVertices.size()).fill(null),e=0,n=this._initialVertices.iterator();n.hasNext();){var i=n.next();t[e++]=i.getCoordinate()}for(var r=this._segVertices.iterator();r.hasNext();){var s=r.next();t[e++]=s.getCoordinate()}return t}},{key:"setConstraints",value:function(t,e){this._segments=t,this._segVertices=e}},{key:"computeConvexHull",value:function(){var t=new te,e=this.getPointArray(),n=new _n(e,t);this._convexHull=n.getConvexHull()}},{key:"addConstraintVertices",value:function(){this.computeConvexHull(),this.insertSites(this._segVertices)}},{key:"findNonGabrielPoint",value:function(t){var e=t.getStart(),n=t.getEnd(),i=new k((e.x+n.x)/2,(e.y+n.y)/2),r=e.distance(i),s=new T(i);s.expandBy(r);for(var a=this._kdt.query(s),u=null,l=o.MAX_VALUE,h=a.iterator();h.hasNext();){var c=h.next().getCoordinate();if(!c.equals2D(e)&&!c.equals2D(n)){var f=i.distance(c);if(f<r){(null===u||f<l)&&(u=c,l=f)}}}return u}},{key:"getConstraintSegments",value:function(){return this._segments}},{key:"setSplitPointFinder",value:function(t){this._splitFinder=t}},{key:"getConvexHull",value:function(){return this._convexHull}},{key:"getTolerance",value:function(){return this._tolerance}},{key:"enforceGabriel",value:function(t){for(var e=new N,n=0,i=new N,r=t.iterator();r.hasNext();){var s=r.next(),o=this.findNonGabrielPoint(s);if(null!==o){this._splitPt=this._splitFinder.findSplitPoint(s,o);var a=this.createVertex(this._splitPt,s);this.insertSite(a).getCoordinate().equals2D(this._splitPt);var u=new Ao(s.getStartX(),s.getStartY(),s.getStartZ(),a.getX(),a.getY(),a.getZ(),s.getData()),l=new Ao(a.getX(),a.getY(),a.getZ(),s.getEndX(),s.getEndY(),s.getEndZ(),s.getData());e.add(u),e.add(l),i.add(s),n+=1}}return t.removeAll(i),t.addAll(e),n}},{key:"createVertex",value:function(){if(1===arguments.length){var t=arguments[0];return null!==this._vertexFactory?this._vertexFactory.createVertex(t,null):new So(t)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=null;return(i=null!==this._vertexFactory?this._vertexFactory.createVertex(e,n):new So(e)).setOnConstraint(!0),i}}},{key:"getSubdivision",value:function(){return this._subdiv}},{key:"computeBoundingBox",value:function(){var e=t.computeVertexEnvelope(this._initialVertices),n=t.computeVertexEnvelope(this._segVertices),i=new T(e);i.expandToInclude(n);var r=.2*i.getWidth(),s=.2*i.getHeight(),o=Math.max(r,s);this._computeAreaEnv=new T(i),this._computeAreaEnv.expandBy(o)}},{key:"setVertexFactory",value:function(t){this._vertexFactory=t}},{key:"formInitialDelaunay",value:function(){this.computeBoundingBox(),this._subdiv=new Po(this._computeAreaEnv,this._tolerance),this._subdiv.setLocator(new Ro(this._subdiv)),this._incDel=new No(this._subdiv),this.insertSites(this._initialVertices)}},{key:"insertSite",value:function(){if(arguments[0]instanceof So){var t=arguments[0],e=this._kdt.insert(t.getCoordinate(),t);if(e.isRepeated()){var n=e.getData();return n.merge(t),n}return this._incDel.insertSite(t),t}if(arguments[0]instanceof k){var i=arguments[0];this.insertSite(this.createVertex(i))}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"computeVertexEnvelope",value:function(t){for(var e=new T,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i.getCoordinate())}return e}}]),t}();Go.constructor_=function(){this._initialVertices=null,this._segVertices=null,this._segments=new N,this._subdiv=null,this._incDel=null,this._convexHull=null,this._splitFinder=new Eo,this._kdt=null,this._vertexFactory=null,this._computeAreaEnv=null,this._splitPt=null,this._tolerance=null;var t=arguments[0],e=arguments[1];this._initialVertices=new N(t),this._tolerance=e,this._kdt=new li(e)},Go.MAX_SPLIT_ITER=99;var Bo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"create",value:function(){if(null!==this._subdiv)return null;var e=t.envelope(this._siteCoords),n=t.toVertices(this._siteCoords);this._subdiv=new Po(e,this._tolerance),new No(this._subdiv).insertSites(n)}},{key:"setTolerance",value:function(t){this._tolerance=t}},{key:"setSites",value:function(){if(arguments[0]instanceof W){var e=arguments[0];this._siteCoords=t.extractUniqueCoordinates(e)}else if(E(arguments[0],C)){var n=arguments[0];this._siteCoords=t.unique($.toCoordinateArray(n))}}},{key:"getEdges",value:function(t){return this.create(),this._subdiv.getEdges(t)}},{key:"getSubdivision",value:function(){return this.create(),this._subdiv}},{key:"getTriangles",value:function(t){return this.create(),this._subdiv.getTriangles(t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"extractUniqueCoordinates",value:function(e){if(null===e)return new R;var n=e.getCoordinates();return t.unique(n)}},{key:"envelope",value:function(t){for(var e=new T,n=t.iterator();n.hasNext();){var i=n.next();e.expandToInclude(i)}return e}},{key:"unique",value:function(t){var e=$.copyDeep(t);return pt.sort(e),new R(e,!1)}},{key:"toVertices",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Io(i))}return e}}]),t}();Bo.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null};var Vo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"createSiteVertices",value:function(t){for(var e=new N,n=t.iterator();n.hasNext();){var i=n.next();this._constraintVertexMap.containsKey(i)||e.add(new So(i))}return e}},{key:"create",value:function(){if(null!==this._subdiv)return null;var e=Bo.envelope(this._siteCoords),n=new N;null!==this._constraintLines&&(e.expandToInclude(this._constraintLines.getEnvelopeInternal()),this.createVertices(this._constraintLines),n=t.createConstraintSegments(this._constraintLines));var i=this.createSiteVertices(this._siteCoords),r=new Go(i,this._tolerance);r.setConstraints(n,new N(this._constraintVertexMap.values())),r.formInitialDelaunay(),r.enforceConstraints(),this._subdiv=r.getSubdivision()}},{key:"setTolerance",value:function(t){this._tolerance=t}},{key:"setConstraints",value:function(t){this._constraintLines=t}},{key:"setSites",value:function(t){this._siteCoords=Bo.extractUniqueCoordinates(t)}},{key:"getEdges",value:function(t){return this.create(),this._subdiv.getEdges(t)}},{key:"getSubdivision",value:function(){return this.create(),this._subdiv}},{key:"getTriangles",value:function(t){return this.create(),this._subdiv.getTriangles(t)}},{key:"createVertices",value:function(t){for(var e=t.getCoordinates(),n=0;n<e.length;n++){var i=new So(e[n]);this._constraintVertexMap.put(e[n],i)}}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"createConstraintSegments",value:function(){if(1===arguments.length){for(var e=arguments[0],n=Ne.getLines(e),i=new N,r=n.iterator();r.hasNext();){var s=r.next();t.createConstraintSegments(s,i)}return i}if(2===arguments.length)for(var o=arguments[1],a=arguments[0].getCoordinates(),u=1;u<a.length;u++)o.add(new Ao(a[u-1],a[u]))}}]),t}();Vo.constructor_=function(){this._siteCoords=null,this._constraintLines=null,this._tolerance=0,this._subdiv=null,this._constraintVertexMap=new dt};var zo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"create",value:function(){if(null!==this._subdiv)return null;var t=Bo.envelope(this._siteCoords);this._diagramEnv=t;var e=Math.max(this._diagramEnv.getWidth(),this._diagramEnv.getHeight());this._diagramEnv.expandBy(e),null!==this._clipEnv&&this._diagramEnv.expandToInclude(this._clipEnv);var n=Bo.toVertices(this._siteCoords);this._subdiv=new Po(t,this._tolerance),new No(this._subdiv).insertSites(n)}},{key:"getDiagram",value:function(e){this.create();var n=this._subdiv.getVoronoiDiagram(e);return t.clipGeometryCollection(n,this._diagramEnv)}},{key:"setTolerance",value:function(t){this._tolerance=t}},{key:"setSites",value:function(){if(arguments[0]instanceof W){var t=arguments[0];this._siteCoords=Bo.extractUniqueCoordinates(t)}else if(E(arguments[0],C)){var e=arguments[0];this._siteCoords=Bo.unique($.toCoordinateArray(e))}}},{key:"setClipEnvelope",value:function(t){this._clipEnv=t}},{key:"getSubdivision",value:function(){return this.create(),this._subdiv}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"clipGeometryCollection",value:function(t,e){for(var n=t.getFactory().toGeometry(e),i=new N,r=0;r<t.getNumGeometries();r++){var s=t.getGeometryN(r),o=null;e.contains(s.getEnvelopeInternal())?o=s:e.intersects(s.getEnvelopeInternal())&&(o=n.intersection(s)).setUserData(s.getUserData()),null===o||o.isEmpty()||i.add(o)}return t.getFactory().createGeometryCollection(te.toGeometryArray(i))}}]),t}();zo.constructor_=function(){this._siteCoords=null,this._tolerance=0,this._subdiv=null,this._clipEnv=null,this._diagramEnv=null};var qo=Object.freeze({__proto__:null,Vertex:Io}),Yo=Object.freeze({__proto__:null,ConformingDelaunayTriangulationBuilder:Vo,DelaunayTriangulationBuilder:Bo,VoronoiDiagramBuilder:zo,quadedge:qo}),Xo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getSegmentIndex",value:function(){return this._segmentIndex}},{key:"getComponentIndex",value:function(){return this._componentIndex}},{key:"isEndpoint",value:function(t){var e=t.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex>=e||this._segmentIndex===e&&this._segmentFraction>=1}},{key:"isValid",value:function(t){if(this._componentIndex<0||this._componentIndex>=t.getNumGeometries())return!1;var e=t.getGeometryN(this._componentIndex);return!(this._segmentIndex<0||this._segmentIndex>e.getNumPoints()||this._segmentIndex===e.getNumPoints()&&0!==this._segmentFraction||this._segmentFraction<0||this._segmentFraction>1)}},{key:"normalize",value:function(){this._segmentFraction<0&&(this._segmentFraction=0),this._segmentFraction>1&&(this._segmentFraction=1),this._componentIndex<0&&(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0),this._segmentIndex<0&&(this._segmentIndex=0,this._segmentFraction=0),1===this._segmentFraction&&(this._segmentFraction=0,this._segmentIndex+=1)}},{key:"toLowest",value:function(e){var n=e.getGeometryN(this._componentIndex).getNumPoints()-1;return this._segmentIndex<n?this:new t(this._componentIndex,n,1,!1)}},{key:"getCoordinate",value:function(e){var n=e.getGeometryN(this._componentIndex),i=n.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=n.getNumPoints()-1)return i;var r=n.getCoordinateN(this._segmentIndex+1);return t.pointAlongSegmentByFraction(i,r,this._segmentFraction)}},{key:"getSegmentFraction",value:function(){return this._segmentFraction}},{key:"getSegment",value:function(t){var e=t.getGeometryN(this._componentIndex),n=e.getCoordinateN(this._segmentIndex);if(this._segmentIndex>=e.getNumPoints()-1){var i=e.getCoordinateN(e.getNumPoints()-2);return new le(i,n)}var r=e.getCoordinateN(this._segmentIndex+1);return new le(n,r)}},{key:"clamp",value:function(t){if(this._componentIndex>=t.getNumGeometries())return this.setToEnd(t),null;if(this._segmentIndex>=t.getNumPoints()){var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}}},{key:"setToEnd",value:function(t){this._componentIndex=t.getNumGeometries()-1;var e=t.getGeometryN(this._componentIndex);this._segmentIndex=e.getNumPoints()-1,this._segmentFraction=1}},{key:"compareTo",value:function(t){var e=t;return this._componentIndex<e._componentIndex?-1:this._componentIndex>e._componentIndex?1:this._segmentIndex<e._segmentIndex?-1:this._segmentIndex>e._segmentIndex?1:this._segmentFraction<e._segmentFraction?-1:this._segmentFraction>e._segmentFraction?1:0}},{key:"copy",value:function(){return new t(this._componentIndex,this._segmentIndex,this._segmentFraction)}},{key:"toString",value:function(){return"LinearLoc["+this._componentIndex+", "+this._segmentIndex+", "+this._segmentFraction+"]"}},{key:"isOnSameSegment",value:function(t){return this._componentIndex===t._componentIndex&&(this._segmentIndex===t._segmentIndex||t._segmentIndex-this._segmentIndex==1&&0===t._segmentFraction||this._segmentIndex-t._segmentIndex==1&&0===this._segmentFraction)}},{key:"snapToVertex",value:function(t,e){if(this._segmentFraction<=0||this._segmentFraction>=1)return null;var n=this.getSegmentLength(t),i=this._segmentFraction*n,r=n-i;i<=r&&i<e?this._segmentFraction=0:r<=i&&r<e&&(this._segmentFraction=1)}},{key:"compareLocationValues",value:function(t,e,n){return this._componentIndex<t?-1:this._componentIndex>t?1:this._segmentIndex<e?-1:this._segmentIndex>e?1:this._segmentFraction<n?-1:this._segmentFraction>n?1:0}},{key:"getSegmentLength",value:function(t){var e=t.getGeometryN(this._componentIndex),n=this._segmentIndex;this._segmentIndex>=e.getNumPoints()-1&&(n=e.getNumPoints()-2);var i=e.getCoordinateN(n),r=e.getCoordinateN(n+1);return i.distance(r)}},{key:"isVertex",value:function(){return this._segmentFraction<=0||this._segmentFraction>=1}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[h]}}],[{key:"getEndLocation",value:function(e){var n=new t;return n.setToEnd(e),n}},{key:"pointAlongSegmentByFraction",value:function(t,e,n){if(n<=0)return t;if(n>=1)return e;var i=(e.x-t.x)*n+t.x,r=(e.y-t.y)*n+t.y,s=(e.z-t.z)*n+t.z;return new k(i,r,s)}},{key:"compareLocationValues",value:function(t,e,n,i,r,s){return t<i?-1:t>i?1:e<r?-1:e>r?1:n<s?-1:n>s?1:0}}]),t}();Xo.constructor_=function(){if(this._componentIndex=0,this._segmentIndex=0,this._segmentFraction=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._componentIndex=t._componentIndex,this._segmentIndex=t._segmentIndex,this._segmentFraction=t._segmentFraction}else if(2===arguments.length){var e=arguments[0],n=arguments[1];Xo.constructor_.call(this,0,e,n)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];this._componentIndex=i,this._segmentIndex=r,this._segmentFraction=s,this.normalize()}else if(4===arguments.length){var o=arguments[0],a=arguments[1],u=arguments[2],l=arguments[3];this._componentIndex=o,this._segmentIndex=a,this._segmentFraction=u,l&&this.normalize()}};var Uo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getComponentIndex",value:function(){return this._componentIndex}},{key:"getLine",value:function(){return this._currentLine}},{key:"getVertexIndex",value:function(){return this._vertexIndex}},{key:"getSegmentEnd",value:function(){return this._vertexIndex<this.getLine().getNumPoints()-1?this._currentLine.getCoordinateN(this._vertexIndex+1):null}},{key:"next",value:function(){if(!this.hasNext())return null;this._vertexIndex++,this._vertexIndex>=this._currentLine.getNumPoints()&&(this._componentIndex++,this.loadCurrentLine(),this._vertexIndex=0)}},{key:"loadCurrentLine",value:function(){if(this._componentIndex>=this._numLines)return this._currentLine=null,null;this._currentLine=this._linearGeom.getGeometryN(this._componentIndex)}},{key:"getSegmentStart",value:function(){return this._currentLine.getCoordinateN(this._vertexIndex)}},{key:"isEndOfLine",value:function(){return!(this._componentIndex>=this._numLines||this._vertexIndex<this._currentLine.getNumPoints()-1)}},{key:"hasNext",value:function(){return!(this._componentIndex>=this._numLines||this._componentIndex===this._numLines-1&&this._vertexIndex>=this._currentLine.getNumPoints())}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"segmentEndVertexIndex",value:function(t){return t.getSegmentFraction()>0?t.getSegmentIndex()+1:t.getSegmentIndex()}}]),t}();Uo.constructor_=function(){if(this._linearGeom=null,this._numLines=null,this._currentLine=null,this._componentIndex=0,this._vertexIndex=0,1===arguments.length){var t=arguments[0];Uo.constructor_.call(this,t,0,0)}else if(2===arguments.length){var e=arguments[0],i=arguments[1];Uo.constructor_.call(this,e,i.getComponentIndex(),Uo.segmentEndVertexIndex(i))}else if(3===arguments.length){var r=arguments[0],s=arguments[1],o=arguments[2];if(!E(r,gt))throw new n("Lineal geometry is required");this._linearGeom=r,this._numLines=r.getNumGeometries(),this._componentIndex=s,this._vertexIndex=o,this.loadCurrentLine()}};var Wo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"indexOf",value:function(t){return this.indexOfFromStart(t,null)}},{key:"indexOfFromStart",value:function(t,e){for(var n=o.MAX_VALUE,i=0,r=0,s=-1,a=new le,u=new Uo(this._linearGeom);u.hasNext();u.next())if(!u.isEndOfLine()){a.p0=u.getSegmentStart(),a.p1=u.getSegmentEnd();var l=a.distance(t),h=a.segmentFraction(t),c=u.getComponentIndex(),f=u.getVertexIndex();l<n&&(null===e||e.compareLocationValues(c,f,h)<0)&&(i=c,r=f,s=h,n=l)}return n===o.MAX_VALUE?new Xo(e):new Xo(i,r,s)}},{key:"indexOfAfter",value:function(t,e){if(null===e)return this.indexOf(t);var n=Xo.getEndLocation(this._linearGeom);if(n.compareTo(e)<=0)return n;var i=this.indexOfFromStart(t,e);return m.isTrue(i.compareTo(e)>=0,"computed location is before specified minimum location"),i}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"indexOf",value:function(e,n){return new t(e).indexOf(n)}},{key:"indexOfAfter",value:function(e,n,i){return new t(e).indexOfAfter(n,i)}}]),t}();Wo.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t};var Ho=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"indicesOf",value:function(t){var e=t.getGeometryN(0).getCoordinateN(0),n=t.getGeometryN(t.getNumGeometries()-1),i=n.getCoordinateN(n.getNumPoints()-1),r=new Wo(this._linearGeom),s=new Array(2).fill(null);return s[0]=r.indexOf(e),0===t.getLength()?s[1]=s[0].copy():s[1]=r.indexOfAfter(i,s[0]),s}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"indicesOf",value:function(e,n){return new t(e).indicesOf(n)}}]),t}();Ho.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t};var jo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getGeometry",value:function(){return this.endLine(),this._geomFact.buildGeometry(this._lines)}},{key:"getLastCoordinate",value:function(){return this._lastPt}},{key:"endLine",value:function(){if(null===this._coordList)return null;if(this._ignoreInvalidLines&&this._coordList.size()<2)return this._coordList=null,null;var t=this._coordList.toCoordinateArray(),e=t;this._fixInvalidLines&&(e=this.validCoordinateSequence(t)),this._coordList=null;var i=null;try{i=this._geomFact.createLineString(e)}catch(t){if(!(t instanceof n))throw t;if(!this._ignoreInvalidLines)throw t}null!==i&&this._lines.add(i)}},{key:"setFixInvalidLines",value:function(t){this._fixInvalidLines=t}},{key:"add",value:function(){if(1===arguments.length){var t=arguments[0];this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];null===this._coordList&&(this._coordList=new R),this._coordList.add(e,n),this._lastPt=e}}},{key:"setIgnoreInvalidLines",value:function(t){this._ignoreInvalidLines=t}},{key:"validCoordinateSequence",value:function(t){return t.length>=2?t:[t[0],t[0]]}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();jo.constructor_=function(){this._geomFact=null,this._lines=new N,this._coordList=null,this._ignoreInvalidLines=!1,this._fixInvalidLines=!1,this._lastPt=null;var t=arguments[0];this._geomFact=t};var Ko=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"computeLinear",value:function(t,e){var n=new jo(this._line.getFactory());n.setFixInvalidLines(!0),t.isVertex()||n.add(t.getCoordinate(this._line));for(var i=new Uo(this._line,t);i.hasNext()&&!(e.compareLocationValues(i.getComponentIndex(),i.getVertexIndex(),0)<0);i.next()){var r=i.getSegmentStart();n.add(r),i.isEndOfLine()&&n.endLine()}return e.isVertex()||n.add(e.getCoordinate(this._line)),n.getGeometry()}},{key:"computeLine",value:function(t,e){var n=this._line.getCoordinates(),i=new R,r=t.getSegmentIndex();t.getSegmentFraction()>0&&(r+=1);var s=e.getSegmentIndex();1===e.getSegmentFraction()&&(s+=1),s>=n.length&&(s=n.length-1),t.isVertex()||i.add(t.getCoordinate(this._line));for(var o=r;o<=s;o++)i.add(n[o]);e.isVertex()||i.add(e.getCoordinate(this._line)),i.size()<=0&&i.add(t.getCoordinate(this._line));var a=i.toCoordinateArray();return a.length<=1&&(a=[a[0],a[0]]),this._line.getFactory().createLineString(a)}},{key:"extract",value:function(t,e){return e.compareTo(t)<0?this.reverse(this.computeLinear(e,t)):this.computeLinear(t,e)}},{key:"reverse",value:function(t){return t instanceof Ft||t instanceof Ct?t.reverse():(m.shouldNeverReachHere("non-linear geometry encountered"),null)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"extract",value:function(e,n,i){return new t(e).extract(n,i)}}]),t}();Ko.constructor_=function(){this._line=null;var t=arguments[0];this._line=t};var Zo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"clampIndex",value:function(t){var e=t.copy();return e.clamp(this._linearGeom),e}},{key:"project",value:function(t){return Wo.indexOf(this._linearGeom,t)}},{key:"checkGeometryType",value:function(){if(!(this._linearGeom instanceof Ft||this._linearGeom instanceof Ct))throw new n("Input geometry must be linear")}},{key:"extractPoint",value:function(){if(1===arguments.length)return arguments[0].getCoordinate(this._linearGeom);if(2===arguments.length){var t=arguments[1],e=arguments[0].toLowest(this._linearGeom);return e.getSegment(this._linearGeom).pointAlongOffset(e.getSegmentFraction(),t)}}},{key:"isValidIndex",value:function(t){return t.isValid(this._linearGeom)}},{key:"getEndIndex",value:function(){return Xo.getEndLocation(this._linearGeom)}},{key:"getStartIndex",value:function(){return new Xo}},{key:"indexOfAfter",value:function(t,e){return Wo.indexOfAfter(this._linearGeom,t,e)}},{key:"extractLine",value:function(t,e){return Ko.extract(this._linearGeom,t,e)}},{key:"indexOf",value:function(t){return Wo.indexOf(this._linearGeom,t)}},{key:"indicesOf",value:function(t){return Ho.indicesOf(this._linearGeom,t)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();Zo.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t,this.checkGeometryType()};var Jo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"indexOf",value:function(t){return this.indexOfFromStart(t,-1)}},{key:"indexOfFromStart",value:function(t,e){for(var n=o.MAX_VALUE,i=e,r=0,s=new le,a=new Uo(this._linearGeom);a.hasNext();){if(!a.isEndOfLine()){s.p0=a.getSegmentStart(),s.p1=a.getSegmentEnd();var u=s.distance(t),l=this.segmentNearestMeasure(s,t,r);u<n&&l>e&&(i=l,n=u),r+=s.getLength()}a.next()}return i}},{key:"indexOfAfter",value:function(t,e){if(e<0)return this.indexOf(t);var n=this._linearGeom.getLength();if(n<e)return n;var i=this.indexOfFromStart(t,e);return m.isTrue(i>=e,"computed index is before specified minimum index"),i}},{key:"segmentNearestMeasure",value:function(t,e,n){var i=t.projectionFactor(e);return i<=0?n:i<=1?n+i*t.getLength():n+t.getLength()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"indexOf",value:function(e,n){return new t(e).indexOf(n)}},{key:"indexOfAfter",value:function(e,n,i){return new t(e).indexOfAfter(n,i)}}]),t}();Jo.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t};var Qo=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getLength",value:function(t){for(var e=0,n=new Uo(this._linearGeom);n.hasNext();){if(!n.isEndOfLine()){var i=n.getSegmentStart(),r=n.getSegmentEnd().distance(i);if(t.getComponentIndex()===n.getComponentIndex()&&t.getSegmentIndex()===n.getVertexIndex())return e+r*t.getSegmentFraction();e+=r}n.next()}return e}},{key:"resolveHigher",value:function(t){if(!t.isEndpoint(this._linearGeom))return t;var e=t.getComponentIndex();if(e>=this._linearGeom.getNumGeometries()-1)return t;do{e++}while(e<this._linearGeom.getNumGeometries()-1&&0===this._linearGeom.getGeometryN(e).getLength());return new Xo(e,0,0)}},{key:"getLocation",value:function(){if(1===arguments.length){var t=arguments[0];return this.getLocation(t,!0)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=e;e<0&&(i=this._linearGeom.getLength()+e);var r=this.getLocationForward(i);return n?r:this.resolveHigher(r)}}},{key:"getLocationForward",value:function(t){if(t<=0)return new Xo;for(var e=0,n=new Uo(this._linearGeom);n.hasNext();){if(n.isEndOfLine()){if(e===t){var i=n.getComponentIndex(),r=n.getVertexIndex();return new Xo(i,r,0)}}else{var s=n.getSegmentStart(),o=n.getSegmentEnd().distance(s);if(e+o>t){var a=(t-e)/o,u=n.getComponentIndex(),l=n.getVertexIndex();return new Xo(u,l,a)}e+=o}n.next()}return Xo.getEndLocation(this._linearGeom)}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"getLength",value:function(e,n){return new t(e).getLength(n)}},{key:"getLocation",value:function(){if(2===arguments.length){var e=arguments[1];return new t(arguments[0]).getLocation(e)}if(3===arguments.length){var n=arguments[1],i=arguments[2];return new t(arguments[0]).getLocation(n,i)}}}]),t}();Qo.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t};var $o=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"clampIndex",value:function(t){var e=this.positiveIndex(t),n=this.getStartIndex();if(e<n)return n;var i=this.getEndIndex();return e>i?i:e}},{key:"locationOf",value:function(){if(1===arguments.length){var t=arguments[0];return Qo.getLocation(this._linearGeom,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return Qo.getLocation(this._linearGeom,e,n)}}},{key:"project",value:function(t){return Jo.indexOf(this._linearGeom,t)}},{key:"positiveIndex",value:function(t){return t>=0?t:this._linearGeom.getLength()+t}},{key:"extractPoint",value:function(){if(1===arguments.length){var t=arguments[0];return Qo.getLocation(this._linearGeom,t).getCoordinate(this._linearGeom)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=Qo.getLocation(this._linearGeom,e).toLowest(this._linearGeom);return i.getSegment(this._linearGeom).pointAlongOffset(i.getSegmentFraction(),n)}}},{key:"isValidIndex",value:function(t){return t>=this.getStartIndex()&&t<=this.getEndIndex()}},{key:"getEndIndex",value:function(){return this._linearGeom.getLength()}},{key:"getStartIndex",value:function(){return 0}},{key:"indexOfAfter",value:function(t,e){return Jo.indexOfAfter(this._linearGeom,t,e)}},{key:"extractLine",value:function(t,e){new Zo(this._linearGeom);var n=this.clampIndex(t),i=this.clampIndex(e),r=n===i,s=this.locationOf(n,r),o=this.locationOf(i);return Ko.extract(this._linearGeom,s,o)}},{key:"indexOf",value:function(t){return Jo.indexOf(this._linearGeom,t)}},{key:"indicesOf",value:function(t){var e=Ho.indicesOf(this._linearGeom,t);return[Qo.getLength(this._linearGeom,e[0]),Qo.getLength(this._linearGeom,e[1])]}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();$o.constructor_=function(){this._linearGeom=null;var t=arguments[0];this._linearGeom=t};var ta=Object.freeze({__proto__:null,LengthIndexedLine:$o,LengthLocationMap:Qo,LinearGeometryBuilder:jo,LinearIterator:Uo,LinearLocation:Xo,LocationIndexedLine:Zo}),ea=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"transform",value:function(t,e){for(var n=new N,i=t.iterator();i.hasNext();)n.add(e.execute(i.next()));return n}},{key:"select",value:function(t,e){for(var n=new N,i=t.iterator();i.hasNext();){var r=i.next();Boolean.TRUE.equals(e.execute(r))&&n.add(r)}return n}},{key:"apply",value:function(t,e){for(var n=t.iterator();n.hasNext();)e.execute(n.next())}}]),t}();ea.Function=function(){},ea.constructor_=function(){};var na=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){this.pts[this.n++]=t}},{key:"getCoordinates",value:function(){return this.pts}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[H]}}]),t}();na.constructor_=function(){this.pts=null,this.n=0;var t=arguments[0];this.pts=new Array(t).fill(null)};var ia=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"filter",value:function(t){this._n++}},{key:"getCount",value:function(){return this._n}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[H]}}]),t}();ia.constructor_=function(){this._n=0};var ra=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"count",value:function(t){var e=this._counts.get(t);return null===e?0:e.count()}},{key:"add",value:function(t){var e=this._counts.get(t);null===e?this._counts.put(t,new sa(1)):e.increment()}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}(),sa=function(){function t(){f(this,t),t.constructor_.apply(this,arguments)}return g(t,[{key:"count",value:function(){return this.count}},{key:"increment",value:function(){this.count++}},{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}]),t}();sa.constructor_=function(){if(this.count=0,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.count=t}},ra.Counter=sa,ra.constructor_=function(){this._counts=new Jt};var oa=Object.freeze({__proto__:null,CollectionUtil:ea,CoordinateArrayFilter:na,CoordinateCountFilter:ia,GeometricShapeFactory:Pe,NumberUtil:e,ObjectCounter:ra,PriorityQueue:Ci,StringUtil:Pt,UniqueCoordinateArrayFilter:vn}),aa=function(){function t(){f(this,t)}return g(t,[{key:"getClass",value:function(){return t}},{key:"interfaces_",get:function(){return[]}}],[{key:"union",value:function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return ys.createEmptyResult(ys.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),vs.overlayOp(t,e,ys.UNION)}}]),t}();W.prototype.equalsTopo=function(t){return!!this.getEnvelopeInternal().equals(t.getEnvelopeInternal())&&Us.relate(this,t).isEquals(this.getDimension(),t.getDimension())},W.prototype.union=function(){if(0===arguments.length)return Ks.union(this);if(1===arguments.length){var t=arguments[0];return aa.union(this,t)}},W.prototype.isValid=function(){return bs.isValid(this)},W.prototype.intersection=function(t){return ys.intersection(this,t)},W.prototype.covers=function(t){return Us.covers(this,t)},W.prototype.coveredBy=function(t){return Us.covers(t,this)},W.prototype.touches=function(t){return Us.touches(this,t)},W.prototype.intersects=function(t){return Us.intersects(this,t)},W.prototype.within=function(t){return Us.contains(t,this)},W.prototype.overlaps=function(t){return Us.overlaps(this,t)},W.prototype.disjoint=function(t){return Us.disjoint(this,t)},W.prototype.crosses=function(t){return Us.crosses(this,t)},W.prototype.buffer=function(){if(1===arguments.length){var t=arguments[0];return Pr.bufferOp(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return Pr.bufferOp(this,e,n)}if(3===arguments.length){var i=arguments[0],r=arguments[1],s=arguments[2];return Pr.bufferOp(this,i,r,s)}},W.prototype.convexHull=function(){return new _n(this).getConvexHull()},W.prototype.relate=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];if(1===arguments.length){var i=arguments[0];return Us.relate(this,i)}if(2===arguments.length){var r=arguments[0],s=arguments[1];return Us.relate(this,r).matches(s)}},W.prototype.getCentroid=function(){if(this.isEmpty())return this._factory.createPoint();var t=fn.getCentroid(this);return this.createPointFromInternalCoord(t,this)},W.prototype.getInteriorPoint=function(){if(this.isEmpty())return this._factory.createPoint();var t=this.getDimension(),e=(0===t?new xn(this):1===t?new kn(this):new pn(this)).getInteriorPoint();return this.createPointFromInternalCoord(e,this)},W.prototype.symDifference=function(t){return ys.symDifference(this,t)},W.prototype.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},W.prototype.toText=function(){return(new oe).write(this)},W.prototype.toString=function(){this.toText()},W.prototype.contains=function(t){return Us.contains(this,t)},W.prototype.difference=function(t){return ys.difference(this,t)},W.prototype.isSimple=function(){return new tr(this).isSimple()},W.prototype.isWithinDistance=function(t,e){return!(this.getEnvelopeInternal().distance(t.getEnvelopeInternal())>e)&&Dr.isWithinDistance(this,t,e)},W.prototype.distance=function(t){return Dr.distance(this,t)},W.prototype.isEquivalentClass=function(t){return this.getClass()===t.getClass()},t.algorithm=Sn,t.densify=Ln,t.dissolve=Dn,t.geom=De,t.geomgraph=oi,t.index=bi,t.io=Ai,t.linearref=ta,t.noding=$i,t.operation=Qs,t.precision=eo,t.simplify=mo,t.triangulate=Yo,t.util=oa,t.version="2.1.2 (83b5aee)",Object.defineProperty(t,"__esModule",{value:!0})}(e)},,,function(t,e){var n=null,i=null;function r(t,e,n){t.addEventListener(e,function(t){var r=new MouseEvent(n,t);r.pointerId=1,r.isPrimary=!0,r.pointerType="mouse",r.width=1,r.height=1,r.tiltX=0,r.tiltY=0,"buttons"in t&&0!==t.buttons?r.pressure=.5:r.pressure=0;var s=t.target;null!==i&&(s=i,"mouseup"===e&&(i=null)),s.dispatchEvent(r),r.defaultPrevented&&t.preventDefault()})}function s(t,e,i){t.addEventListener(e,function(t){for(var r=t.changedTouches,s=r.length,o=0;o<s;o++){var a=new CustomEvent(i,{bubbles:!0,cancelable:!0});a.ctrlKey=t.ctrlKey,a.shiftKey=t.shiftKey,a.altKey=t.altKey,a.metaKey=t.metaKey;var u=r.item(o);a.clientX=u.clientX,a.clientY=u.clientY,a.screenX=u.screenX,a.screenY=u.screenY,a.pageX=u.pageX,a.pageY=u.pageY;var l=u.target.getBoundingClientRect();a.offsetX=u.clientX-l.left,a.offsetY=u.clientY-l.top,a.pointerId=1+u.identifier,a.button=0,a.buttons=1,a.movementX=0,a.movementY=0,a.region=null,a.relatedTarget=null,a.x=a.clientX,a.y=a.clientY,a.pointerType="touch",a.width=1,a.height=1,a.tiltX=0,a.tiltY=0,a.pressure=1,"touchstart"===e&&null===n&&(n=u.identifier),a.isPrimary=u.identifier===n,"touchend"===e&&a.isPrimary&&(n=null),t.target.dispatchEvent(a),a.defaultPrevented&&t.preventDefault()}})}"PointerEvent"in window||(Element.prototype.setPointerCapture=Element.prototype.setCapture,Element.prototype.releasePointerCapture=Element.prototype.releaseCapture,"TouchEvent"in window||(r(document,"mousedown","pointerdown"),r(document,"mousemove","pointermove"),r(document,"mouseup","pointerup")),s(document,"touchstart","pointerdown"),s(document,"touchmove","pointermove"),s(document,"touchend","pointerup"))},,,,,,,function(e,n,r){"use strict";function o(){return function(){throw new Error("Unimplemented abstract method.")}()}r.r(n),r.d(n,"CustomMap",function(){return Co}),r.d(n,"MapWithActions",function(){return Eo}),r.d(n,"SnapInteraction",function(){return tu}),r.d(n,"BoxSelectAction",function(){return qo}),r.d(n,"DeleteAction",function(){return Yo}),r.d(n,"DrawAction",function(){return eu}),r.d(n,"DrawLijnstukAction",function(){return nu}),r.d(n,"DrawRectangleAction",function(){return iu}),r.d(n,"HighlightAction",function(){return ru}),r.d(n,"MapAction",function(){return Vo}),r.d(n,"MeasureAction",function(){return su}),r.d(n,"ModifyAction",function(){return vu}),r.d(n,"ModifyAndTranslateAction",function(){return pu}),r.d(n,"SelectAction",function(){return zo}),r.d(n,"SelectActions",function(){return mu}),r.d(n,"ShowInfoAction",function(){return xu}),r.d(n,"ShowInfoSelectAction",function(){return Eu}),r.d(n,"SplitAction",function(){return Iu}),r.d(n,"Tooltips",function(){return ku}),r.d(n,"TranslateAction",function(){return Su});var h=0;function d(t){return t.ol_uid||(t.ol_uid=String(++h))}var _=function(e){s(i,t(Error));var n=a(i);function i(t){var e;f(this,i);var r="Assertion failed. See https://openlayers.org/en/latest/doc/errors/#"+t+" for details.";return(e=n.call(this,r)).code=t,e.name="AssertionError",e.message=r,e}return i}();function y(t,e){if(!t)throw new _(e)}var p="function"==typeof Object.assign?Object.assign:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1,r=arguments.length;i<r;++i){var s=arguments[i];if(null!=s)for(var o in s)s.hasOwnProperty(o)&&(n[o]=s[o])}return n};function m(t){for(var e in t)delete t[e]}var k="function"==typeof Object.values?Object.values:function(t){var e=[];for(var n in t)e.push(t[n]);return e};function x(t){var e;for(e in t)return!1;return!e}function E(t,e,n,i,r){if(i&&i!==t&&(n=n.bind(i)),r){var s=n;n=function(){t.removeEventListener(e,n),s.apply(this,arguments)}}var o={target:t,type:e,listener:n};return t.addEventListener(e,n),o}function C(t,e,n,i){return E(t,e,n,i,!0)}function I(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),m(t))}var S="change",w="error",N="contextmenu",L="click",R="keydown",T="keypress",b="load",P="resize",M="touchmove",O="wheel",F="propertychange",D=function(){function t(){f(this,t),this.disposed_=!1}return g(t,[{key:"dispose",value:function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())}},{key:"disposeInternal",value:function(){}}]),t}();function A(t,e){return t>e?1:t<e?-1:0}function G(t,e){return t.indexOf(e)>=0}function B(t,e,n){var i,r=t.length;if(t[0]<=e)return 0;if(e<=t[r-1])return r-1;if(n>0){for(i=1;i<r;++i)if(t[i]<e)return i-1}else if(n<0){for(i=1;i<r;++i)if(t[i]<=e)return i}else for(i=1;i<r;++i){if(t[i]==e)return i;if(t[i]<e)return t[i-1]-e<e-t[i]?i-1:i}return r-1}function V(t,e,n){for(;e<n;){var i=t[e];t[e]=t[n],t[n]=i,++e,--n}}function z(t,e){for(var n=Array.isArray(e)?e:[e],i=n.length,r=0;r<i;r++)t[t.length]=n[r]}function q(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function Y(){return!0}function X(){return!1}function U(){}function W(t){t.stopPropagation()}var H=function(){function t(e){f(this,t),this.propagationStopped,this.type=e,this.target=null}return g(t,[{key:"preventDefault",value:function(){this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),t}(),j=function(t){s(n,D);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).eventTarget_=t,i.pendingRemovals_={},i.dispatching_={},i.listeners_={},i}return g(n,[{key:"addEventListener",value:function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=[],this.listeners_[t]=n),-1===n.indexOf(e)&&n.push(e)}}},{key:"dispatchEvent",value:function(t){var e="string"==typeof t?new H(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var s=0,o=r.length;s<o;++s)if(!1===(i="handleEvent"in r[s]?r[s].handleEvent(e):r[s].call(this,e))||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var a=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];a--;)this.removeEventListener(n,U);delete this.dispatching_[n]}return i}}},{key:"disposeInternal",value:function(){m(this.listeners_)}},{key:"getListeners",value:function(t){return this.listeners_[t]}},{key:"hasListener",value:function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0}},{key:"removeEventListener",value:function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);-1!==i&&(t in this.pendingRemovals_?(n[i]=U,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}}}]),n}();function K(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)I(t[e]);else I(t)}var Z=function(t){s(n,j);var e=a(n);function n(){var t;return f(this,n),(t=e.call(this)).revision_=0,t}return g(n,[{key:"changed",value:function(){++this.revision_,this.dispatchEvent(S)}},{key:"getRevision",value:function(){return this.revision_}},{key:"on",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=E(this,t[r],e);return i}return E(this,t,e)}},{key:"once",value:function(t,e){if(Array.isArray(t)){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=C(this,t[r],e);return i}return C(this,t,e)}},{key:"un",value:function(t,e){if(Array.isArray(t))for(var n=0,i=t.length;n<i;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}]),n}(),J=function(t){s(n,H);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t)).key=i,s.oldValue=r,s}return n}(),Q={};function $(t){return Q.hasOwnProperty(t)?Q[t]:Q[t]="change:"+t}var tt=function(t){s(n,Z);var e=a(n);function n(t){var i;return f(this,n),d(l(i=e.call(this))),i.values_={},void 0!==t&&i.setProperties(t),i}return g(n,[{key:"get",value:function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}},{key:"getKeys",value:function(){return Object.keys(this.values_)}},{key:"getProperties",value:function(){return p({},this.values_)}},{key:"notify",value:function(t,e){var n;n=$(t),this.dispatchEvent(new J(n,t,e)),n=F,this.dispatchEvent(new J(n,t,e))}},{key:"set",value:function(t,e,n){if(n)this.values_[t]=e;else{var i=this.values_[t];this.values_[t]=e,i!==e&&this.notify(t,i)}}},{key:"setProperties",value:function(t,e){for(var n in t)this.set(n,t[n],e)}},{key:"unset",value:function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}}}]),n}(),et=function(t){s(n,tt);var e=a(n);function n(t){var i;if(f(this,n),(i=e.call(this)).id_=void 0,i.geometryName_="geometry",i.style_=null,i.styleFunction_=void 0,i.geometryChangeKey_=null,i.addEventListener($(i.geometryName_),i.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var r=t;i.setGeometry(r)}else{var s=t;i.setProperties(s)}return u(i)}return g(n,[{key:"clone",value:function(){var t=new n(this.getProperties());t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var i=this.getStyle();return i&&t.setStyle(i),t}},{key:"getGeometry",value:function(){return this.get(this.geometryName_)}},{key:"getId",value:function(){return this.id_}},{key:"getGeometryName",value:function(){return this.geometryName_}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"handleGeometryChange_",value:function(){this.changed()}},{key:"handleGeometryChanged_",value:function(){this.geometryChangeKey_&&(I(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=E(t,S,this.handleGeometryChange_,this)),this.changed()}},{key:"setGeometry",value:function(t){this.set(this.geometryName_,t)}},{key:"setStyle",value:function(t){this.style_=t,this.styleFunction_=t?function(t){return"function"==typeof t?t:(Array.isArray(t)?e=t:(y("function"==typeof t.getZIndex,41),e=[t]),function(){return e});var e}(t):void 0,this.changed()}},{key:"setId",value:function(t){this.id_=t,this.changed()}},{key:"setGeometryName",value:function(t){this.removeEventListener($(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=t,this.addEventListener($(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()}}]),n}();function nt(t,e,n){return Math.min(Math.max(t,e),n)}var it="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2};function rt(t,e,n,i,r,s){var o=r-n,a=s-i;if(0!==o||0!==a){var u=((t-n)*o+(e-i)*a)/(o*o+a*a);u>1?(n=r,i=s):u>0&&(n+=o*u,i+=a*u)}return st(t,e,n,i)}function st(t,e,n,i){var r=n-t,s=i-e;return r*r+s*s}function ot(t){return t*Math.PI/180}function at(t,e){var n=t%e;return n*e<0?n+e:n}function ut(t,e,n){return t+n*(e-t)}var lt="Point",ht="LineString",ct="Polygon",ft="MultiPoint",dt="MultiLineString",gt="MultiPolygon",vt="GeometryCollection",_t="Circle";function yt(t,e,n){var i=n||6371008.8,r=ot(t[1]),s=ot(e[1]),o=(s-r)/2,a=ot(e[0]-t[0])/2,u=Math.sin(o)*Math.sin(o)+Math.sin(a)*Math.sin(a)*Math.cos(r)*Math.cos(s);return 2*i*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))}var pt=0,mt=1,kt=2,xt=4,Et=8,Ct=16;function It(t){for(var e=[1/0,1/0,-1/0,-1/0],n=0,i=t.length;n<i;++n)At(e,t[n]);return e}function St(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function wt(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function Nt(t,e,n){var i,r;return(i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*i+(r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0)*r}function Lt(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Rt(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]}function Tt(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],o=e[0],a=e[1],u=pt;return o<n?u|=Ct:o>r&&(u|=xt),a<i?u|=Et:a>s&&(u|=kt),u===pt&&(u=mt),u}function bt(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]}function Pt(t){return bt(1/0,1/0,-1/0,-1/0,t)}function Mt(t,e){var n=t[0],i=t[1];return bt(n,i,n,i,e)}function Ot(t,e,n,i,r){return Gt(Pt(r),t,e,n,i)}function Ft(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function Dt(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function At(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Gt(t,e,n,i,r){for(;n<i;n+=r)Bt(t,e[n],e[n+1]);return t}function Bt(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)}function Vt(t,e){return e(zt(t))||(e(qt(t))||(e(jt(t))||(e(Ht(t))||!1)))}function zt(t){return[t[0],t[1]]}function qt(t){return[t[2],t[1]]}function Yt(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Xt(t,e,n,i,r){var s=e*i[0]/2,o=e*i[1]/2,a=Math.cos(n),u=Math.sin(n),l=s*a,h=s*u,c=o*a,f=o*u,d=t[0],g=t[1],v=d-l+f,_=d-l-f,y=d+l-f,p=d+l+f,m=g-h-c,k=g-h+c,x=g+h+c,E=g+h-c;return bt(Math.min(v,_,y,p),Math.min(m,k,x,E),Math.max(v,_,y,p),Math.max(m,k,x,E),r)}function Ut(t){return t[3]-t[1]}function Wt(t,e,n){var i=n||[1/0,1/0,-1/0,-1/0];return Zt(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):Pt(i),i}function Ht(t){return[t[0],t[3]]}function jt(t){return[t[2],t[3]]}function Kt(t){return t[2]-t[0]}function Zt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Jt(t){return t[2]<t[0]||t[3]<t[1]}function Qt(t,e){var n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i}var $t={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},te={};te[$t.DEGREES]=2*Math.PI*6370997/360,te[$t.FEET]=.3048,te[$t.METERS]=1,te[$t.USFEET]=1200/3937;var ee=$t,ne=function(){function t(e){f(this,t),this.code_=e.code,this.units_=e.units,this.extent_=void 0!==e.extent?e.extent:null,this.worldExtent_=void 0!==e.worldExtent?e.worldExtent:null,this.axisOrientation_=void 0!==e.axisOrientation?e.axisOrientation:"enu",this.global_=void 0!==e.global&&e.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=e.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=e.metersPerUnit}return g(t,[{key:"canWrapX",value:function(){return this.canWrapX_}},{key:"getCode",value:function(){return this.code_}},{key:"getExtent",value:function(){return this.extent_}},{key:"getUnits",value:function(){return this.units_}},{key:"getMetersPerUnit",value:function(){return this.metersPerUnit_||te[this.units_]}},{key:"getWorldExtent",value:function(){return this.worldExtent_}},{key:"getAxisOrientation",value:function(){return this.axisOrientation_}},{key:"isGlobal",value:function(){return this.global_}},{key:"setGlobal",value:function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}},{key:"getDefaultTileGrid",value:function(){return this.defaultTileGrid_}},{key:"setDefaultTileGrid",value:function(t){this.defaultTileGrid_=t}},{key:"setExtent",value:function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}},{key:"setWorldExtent",value:function(t){this.worldExtent_=t}},{key:"setGetPointResolution",value:function(t){this.getPointResolutionFunc_=t}},{key:"getPointResolutionFunc",value:function(){return this.getPointResolutionFunc_}}]),t}(),ie=6378137*Math.PI,re=[-ie,-ie,ie,ie],se=[-180,-85,180,85],oe=function(t){s(n,ne);var e=a(n);function n(t){return f(this,n),e.call(this,{code:t,units:ee.METERS,extent:re,global:!0,worldExtent:se,getPointResolution:function(t,e){return t/it(e[1]/6378137)}})}return n}(),ae=[new oe("EPSG:3857"),new oe("EPSG:102100"),new oe("EPSG:102113"),new oe("EPSG:900913"),new oe("urn:ogc:def:crs:EPSG:6.18:3:3857"),new oe("urn:ogc:def:crs:EPSG::3857"),new oe("http://www.opengis.net/gml/srs/epsg.xml#3857")];var ue=[-180,-90,180,90],le=6378137*Math.PI/180,he=function(t){s(n,ne);var e=a(n);function n(t,i){return f(this,n),e.call(this,{code:t,units:ee.DEGREES,extent:ue,axisOrientation:i,global:!0,metersPerUnit:le,worldExtent:ue})}return n}(),ce=[new he("CRS:84"),new he("EPSG:4326","neu"),new he("urn:ogc:def:crs:EPSG::4326","neu"),new he("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new he("urn:ogc:def:crs:OGC:1.3:CRS84"),new he("urn:ogc:def:crs:OGC:2:84"),new he("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new he("urn:x-ogc:def:crs:EPSG:4326","neu")],fe={};function de(t,e,n){var i=t.getCode(),r=e.getCode();i in fe||(fe[i]={}),fe[i][r]=n}var ge={};function ve(t,e,n){var i;if(void 0!==e){for(var r=0,s=t.length;r<s;++r)e[r]=t[r];i=e}else i=t.slice();return i}function _e(t,e,n){if(void 0!==e&&t!==e){for(var i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t}function ye(t){!function(t,e){ge[t]=e}(t.getCode(),t),de(t,t,ve)}function pe(t){return"string"==typeof t?ge[t]||null:t||null}function me(t){!function(t){t.forEach(ye)}(t),t.forEach(function(e){t.forEach(function(t){e!==t&&de(e,t,ve)})})}function ke(t,e){return t?"string"==typeof t?pe(t):t:pe(e)}function xe(t,e){var n=function(t,e){var n;return t in fe&&e in fe[t]&&(n=fe[t][e]),n}(t.getCode(),e.getCode());return n||(n=_e),n}function Ee(t,e){return xe(pe(t),pe(e))}function Ce(t,e,n){return Ee(e,n)(t,void 0,t.length)}function Ie(t,e,n,i){return function(t,e,n,i){var r=[];if(i>1)for(var s=t[2]-t[0],o=t[3]-t[1],a=0;a<i;++a)r.push(t[0]+s*a/i,t[1],t[2],t[1]+o*a/i,t[2]-s*a/i,t[3],t[0],t[3]-o*a/i);else r=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(r,r,2);for(var u=[],l=[],h=0,c=r.length;h<c;h+=2)u.push(r[h]),l.push(r[h+1]);return function(t,e,n){return bt(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),n)}(u,l,n)}(t,Ee(e,n),void 0,i)}var Se,we,Ne,Le=null;function Re(){return Le}function Te(t,e){return Le?Ce(t,e,Le):t}function be(t,e){return Le?Ce(t,Le,e):t}function Pe(t,e){return Le?Ie(t,e,Le):t}function Me(t,e){return Le?Ie(t,Le,e):t}me(ae),me(ce),Se=ae,we=function(t,e,n){var i=t.length,r=n>1?n:2,s=e;void 0===s&&(s=r>2?t.slice():new Array(i));for(var o=ie,a=0;a<i;a+=r){s[a]=o*t[a]/180;var u=6378137*Math.log(Math.tan(Math.PI*(+t[a+1]+90)/360));u>o?u=o:u<-o&&(u=-o),s[a+1]=u}return s},Ne=function(t,e,n){var i=t.length,r=n>1?n:2,s=e;void 0===s&&(s=r>2?t.slice():new Array(i));for(var o=0;o<i;o+=r)s[o]=180*t[o]/ie,s[o+1]=360*Math.atan(Math.exp(t[o+1]/6378137))/Math.PI-90;return s},ce.forEach(function(t){Se.forEach(function(e){de(t,e,we),de(e,t,Ne)})});var Oe=function(){function t(){f(this,t),this.dataProjection=null,this.defaultFeatureProjection=null}return g(t,[{key:"getReadOptions",value:function(t,e){var n;if(e){var i=e.dataProjection?pe(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()===ee.TILE_PIXELS&&(i=pe(i)).setWorldExtent(e.extent),n={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(n)}},{key:"adaptOptions",value:function(t){return p({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)}},{key:"getType",value:function(){return o()}},{key:"readFeature",value:function(t,e){return o()}},{key:"readFeatures",value:function(t,e){return o()}},{key:"readGeometry",value:function(t,e){return o()}},{key:"readProjection",value:function(t){return o()}},{key:"writeFeature",value:function(t,e){return o()}},{key:"writeFeatures",value:function(t,e){return o()}},{key:"writeGeometry",value:function(t,e){return o()}}]),t}();function Fe(t,e,n){var i,r=n?pe(n.featureProjection):null,s=n?pe(n.dataProjection):null;if(i=r&&s&&!function(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:xe(t,e)===ve&&n}(r,s)?(e?t.clone():t).transform(e?r:s,e?s:r):t,e&&n&&void 0!==n.decimals){var o=Math.pow(10,n.decimals);i===t&&(i=t.clone()),i.applyTransform(function(t){for(var e=0,n=t.length;e<n;++e)t[e]=Math.round(t[e]*o)/o;return t})}return i}var De="arraybuffer",Ae="json",Ge="text",Be="xml";function Ve(t){return"string"==typeof t?JSON.parse(t)||null:null!==t?t:null}var ze=function(t){s(n,Oe);var e=a(n);function n(){return f(this,n),e.call(this)}return g(n,[{key:"getType",value:function(){return Ae}},{key:"readFeature",value:function(t,e){return this.readFeatureFromObject(Ve(t),this.getReadOptions(t,e))}},{key:"readFeatures",value:function(t,e){return this.readFeaturesFromObject(Ve(t),this.getReadOptions(t,e))}},{key:"readFeatureFromObject",value:function(t,e){return o()}},{key:"readFeaturesFromObject",value:function(t,e){return o()}},{key:"readGeometry",value:function(t,e){return this.readGeometryFromObject(Ve(t),this.getReadOptions(t,e))}},{key:"readGeometryFromObject",value:function(t,e){return o()}},{key:"readProjection",value:function(t){return this.readProjectionFromObject(Ve(t))}},{key:"readProjectionFromObject",value:function(t){return o()}},{key:"writeFeature",value:function(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}},{key:"writeFeatureObject",value:function(t,e){return o()}},{key:"writeFeatures",value:function(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}},{key:"writeFeaturesObject",value:function(t,e){return o()}},{key:"writeGeometry",value:function(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}},{key:"writeGeometryObject",value:function(t,e){return o()}}]),n}();function qe(t,e,n,i,r,s){for(var o=s||[],a=0,u=e;u<n;u+=i){var l=t[u],h=t[u+1];o[a++]=r[0]*l+r[2]*h+r[4],o[a++]=r[1]*l+r[3]*h+r[5]}return s&&o.length!=a&&(o.length=a),o}function Ye(t,e,n,i,r,s,o){for(var a=o||[],u=Math.cos(r),l=Math.sin(r),h=s[0],c=s[1],f=0,d=e;d<n;d+=i){var g=t[d]-h,v=t[d+1]-c;a[f++]=h+g*u-v*l,a[f++]=c+g*l+v*u;for(var _=d+2;_<d+i;++_)a[f++]=t[_]}return o&&a.length!=f&&(a.length=f),a}function Xe(t,e,n,i,r,s,o){for(var a=o||[],u=0,l=e;l<n;l+=i){a[u++]=t[l]+r,a[u++]=t[l+1]+s;for(var h=l+2;h<l+i;++h)a[u++]=t[h]}return o&&a.length!=u&&(a.length=u),a}function Ue(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e}function We(t,e,n,i,r,s,o,a){var u=Math.sin(s),l=Math.cos(s);return t[0]=i*l,t[1]=r*u,t[2]=-i*u,t[3]=r*l,t[4]=o*i*l-a*i*u+e,t[5]=o*r*u+a*r*l+n,t}function He(t,e){var n,i=(n=e)[0]*n[3]-n[1]*n[2];y(0!==i,32);var r=e[0],s=e[1],o=e[2],a=e[3],u=e[4],l=e[5];return t[0]=a/i,t[1]=-s/i,t[2]=-o/i,t[3]=r/i,t[4]=(o*l-a*u)/i,t[5]=-(r*l-s*u)/i,t}new Array(6);var je=[1,0,0,1,0,0],Ke=function(t){s(n,tt);var e=a(n);function n(){var t,i,r,s,o;return f(this,n),(t=e.call(this)).extent_=[1/0,1/0,-1/0,-1/0],t.extentRevision_=-1,t.simplifiedGeometryMaxMinSquaredTolerance=0,t.simplifiedGeometryRevision=0,t.simplifyTransformedInternal=(o=!1,function(){var t=Array.prototype.slice.call(arguments);return o&&this===s&&q(t,r)||(o=!0,s=this,r=t,i=function(t,e,n){if(!n)return this.getSimplifiedGeometry(e);var i=this.clone();return i.applyTransform(n),i.getSimplifiedGeometry(e)}.apply(this,arguments)),i}),t}return g(n,[{key:"simplifyTransformed",value:function(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}},{key:"clone",value:function(){return o()}},{key:"closestPointXY",value:function(t,e,n,i){return o()}},{key:"containsXY",value:function(t,e){var n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}},{key:"getClosestPoint",value:function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n}},{key:"intersectsCoordinate",value:function(t){return this.containsXY(t[0],t[1])}},{key:"computeExtent",value:function(t){return o()}},{key:"getExtent",value:function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}(this.extent_,t)}},{key:"rotate",value:function(t,e){o()}},{key:"scale",value:function(t,e,n){o()}},{key:"simplify",value:function(t){return this.getSimplifiedGeometry(t*t)}},{key:"getSimplifiedGeometry",value:function(t){return o()}},{key:"getType",value:function(){return o()}},{key:"applyTransform",value:function(t){o()}},{key:"intersectsExtent",value:function(t){return o()}},{key:"translate",value:function(t,e){o()}},{key:"transform",value:function(t,e){var n=pe(t),i=n.getUnits()==ee.TILE_PIXELS?function(t,i,r){var s=n.getExtent(),o=n.getWorldExtent(),a=Ut(o)/Ut(s);return We(je,o[0],o[3],a,-a,0,0,0),qe(t,0,t.length,r,je,i),Ee(n,e)(t,i,r)}:Ee(n,e);return this.applyTransform(i),this}}]),n}();function Ze(t){for(var e=[],n=0,i=t.length;n<i;++n)e.push(t[n].clone());return e}var Je=function(t){s(n,Ke);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).geometries_=t||null,i.changeEventsKeys_=[],i.listenGeometriesChange_(),i}return g(n,[{key:"unlistenGeometriesChange_",value:function(){this.changeEventsKeys_.forEach(I),this.changeEventsKeys_.length=0}},{key:"listenGeometriesChange_",value:function(){if(this.geometries_)for(var t=0,e=this.geometries_.length;t<e;++t)this.changeEventsKeys_.push(E(this.geometries_[t],S,this.changed,this))}},{key:"clone",value:function(){var t=new n(null);return t.setGeometries(this.geometries_),t}},{key:"closestPointXY",value:function(t,e,n,i){if(i<Nt(this.getExtent(),t,e))return i;for(var r=this.geometries_,s=0,o=r.length;s<o;++s)i=r[s].closestPointXY(t,e,n,i);return i}},{key:"containsXY",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)if(n[i].containsXY(t,e))return!0;return!1}},{key:"computeExtent",value:function(t){Pt(t);for(var e=this.geometries_,n=0,i=e.length;n<i;++n)Dt(t,e[n].getExtent());return t}},{key:"getGeometries",value:function(){return Ze(this.geometries_)}},{key:"getGeometriesArray",value:function(){return this.geometries_}},{key:"getGeometriesArrayRecursive",value:function(){for(var t=[],e=this.geometries_,n=0,i=e.length;n<i;++n)e[n].getType()===this.getType()?t=t.concat(e[n].getGeometriesArrayRecursive()):t.push(e[n]);return t}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var e=[],i=this.geometries_,r=!1,s=0,o=i.length;s<o;++s){var a=i[s],u=a.getSimplifiedGeometry(t);e.push(u),u!==a&&(r=!0)}if(r){var l=new n(null);return l.setGeometriesArray(e),l}return this.simplifiedGeometryMaxMinSquaredTolerance=t,this}},{key:"getType",value:function(){return vt}},{key:"intersectsExtent",value:function(t){for(var e=this.geometries_,n=0,i=e.length;n<i;++n)if(e[n].intersectsExtent(t))return!0;return!1}},{key:"isEmpty",value:function(){return 0===this.geometries_.length}},{key:"rotate",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)n[i].rotate(t,e);this.changed()}},{key:"scale",value:function(t,e,n){var i=n;i||(i=Yt(this.getExtent()));for(var r=this.geometries_,s=0,o=r.length;s<o;++s)r[s].scale(t,e,i);this.changed()}},{key:"setGeometries",value:function(t){this.setGeometriesArray(Ze(t))}},{key:"setGeometriesArray",value:function(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}},{key:"applyTransform",value:function(t){for(var e=this.geometries_,n=0,i=e.length;n<i;++n)e[n].applyTransform(t);this.changed()}},{key:"translate",value:function(t,e){for(var n=this.geometries_,i=0,r=n.length;i<r;++i)n[i].translate(t,e);this.changed()}},{key:"disposeInternal",value:function(){this.unlistenGeometriesChange_(),i(c(n.prototype),"disposeInternal",this).call(this)}}]),n}(),Qe="XY",$e="XYZ",tn="XYM",en="XYZM";function nn(t){var e;return t==Qe?e=2:t==$e||t==tn?e=3:t==en&&(e=4),e}var rn=function(t){s(n,Ke);var e=a(n);function n(){var t;return f(this,n),(t=e.call(this)).layout=Qe,t.stride=2,t.flatCoordinates=null,t}return g(n,[{key:"computeExtent",value:function(t){return Ot(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinates",value:function(){return o()}},{key:"getFirstCoordinate",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"getFlatCoordinates",value:function(){return this.flatCoordinates}},{key:"getLastCoordinate",value:function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}},{key:"getLayout",value:function(){return this.layout}},{key:"getSimplifiedGeometry",value:function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}},{key:"getSimplifiedGeometryInternal",value:function(t){return this}},{key:"getStride",value:function(){return this.stride}},{key:"setFlatCoordinates",value:function(t,e){this.stride=nn(t),this.layout=t,this.flatCoordinates=e}},{key:"setCoordinates",value:function(t,e){o()}},{key:"setLayout",value:function(t,e,n){var i;if(t)i=nn(t);else{for(var r=0;r<n;++r){if(0===e.length)return this.layout=Qe,void(this.stride=2);e=e[0]}i=e.length,t=function(t){var e;return 2==i?e=Qe:3==i?e=$e:4==i&&(e=en),e}()}this.layout=t,this.stride=i}},{key:"applyTransform",value:function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}},{key:"rotate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();Ye(n,0,n.length,i,t,e,n),this.changed()}}},{key:"scale",value:function(t,e,n){var i=e;void 0===i&&(i=t);var r=n;r||(r=Yt(this.getExtent()));var s=this.getFlatCoordinates();if(s){var o=this.getStride();!function(t,e,n,i,r,s,o,a){for(var u=a||[],l=o[0],h=o[1],c=0,f=0;f<n;f+=i){var d=t[f]-l,g=t[f+1]-h;u[c++]=l+r*d,u[c++]=h+s*g;for(var v=f+2;v<f+i;++v)u[c++]=t[v]}a&&u.length!=c&&(u.length=c)}(s,0,s.length,o,t,i,r,s),this.changed()}}},{key:"translate",value:function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();Xe(n,0,n.length,i,t,e,n),this.changed()}}}]),n}();function sn(t,e,n,i,r,s,o){var a,u=t[e],l=t[e+1],h=t[n]-u,c=t[n+1]-l;if(0===h&&0===c)a=e;else{var f=((r-u)*h+(s-l)*c)/(h*h+c*c);if(f>1)a=n;else{if(f>0){for(var d=0;d<i;++d)o[d]=ut(t[e+d],t[n+d],f);return void(o.length=i)}a=e}}for(var g=0;g<i;++g)o[g]=t[a+g];o.length=i}function on(t,e,n,i,r){var s=t[e],o=t[e+1];for(e+=i;e<n;e+=i){var a=t[e],u=t[e+1],l=st(s,o,a,u);l>r&&(r=l),s=a,o=u}return r}function an(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){var a=n[s];r=on(t,e,a,i,r),e=a}return r}function un(t,e,n,i,r,s,o,a,u,l,h){if(e==n)return l;var c,f;if(0===r){if((f=st(o,a,t[e],t[e+1]))<l){for(c=0;c<i;++c)u[c]=t[e+c];return u.length=i,f}return l}for(var d=h||[NaN,NaN],g=e+i;g<n;)if(sn(t,g-i,g,i,o,a,d),(f=st(o,a,d[0],d[1]))<l){for(l=f,c=0;c<i;++c)u[c]=d[c];u.length=i,g+=i}else g+=i*Math.max((Math.sqrt(f)-Math.sqrt(l))/r|0,1);if(s&&(sn(t,n-i,e,i,o,a,d),(f=st(o,a,d[0],d[1]))<l)){for(l=f,c=0;c<i;++c)u[c]=d[c];u.length=i}return l}function ln(t,e,n,i,r,s,o,a,u,l,h){for(var c=h||[NaN,NaN],f=0,d=n.length;f<d;++f){var g=n[f];l=un(t,e,g,i,r,s,o,a,u,l,c),e=g}return l}function hn(t,e,n,i){for(var r=0,s=n.length;r<s;++r)t[e++]=n[r];return e}function cn(t,e,n,i){for(var r=0,s=n.length;r<s;++r)for(var o=n[r],a=0;a<i;++a)t[e++]=o[a];return e}function fn(t,e,n,i,r){for(var s=r||[],o=0,a=0,u=n.length;a<u;++a){var l=cn(t,e,n[a],i);s[o++]=l,e=l}return s.length=o,s}function dn(t,e,n,i,r){for(var s=void 0!==r?r:[],o=0,a=e;a<n;a+=i)s[o++]=t.slice(a,a+i);return s.length=o,s}function gn(t,e,n,i,r){for(var s=void 0!==r?r:[],o=0,a=0,u=n.length;a<u;++a){var l=n[a];s[o++]=dn(t,e,l,i,s[o]),e=l}return s.length=o,s}function vn(t,e,n,i,r){for(var s=void 0!==r?r:[],o=0,a=0,u=n.length;a<u;++a){var l=n[a];s[o++]=gn(t,e,l,i,s[o]),e=l[l.length-1]}return s.length=o,s}function _n(t,e,n,i,r,s){var o=NaN,a=NaN,u=(n-e)/i;if(1===u)o=t[e],a=t[e+1];else if(2==u)o=(1-r)*t[e]+r*t[e+i],a=(1-r)*t[e+1]+r*t[e+i+1];else if(0!==u){for(var l=t[e],h=t[e+1],c=0,f=[0],d=e+i;d<n;d+=i){var g=t[d],v=t[d+1];c+=Math.sqrt((g-l)*(g-l)+(v-h)*(v-h)),f.push(c),l=g,h=v}var _=r*c,y=function(t,e,n){for(var i,r,s=A,o=0,a=t.length,u=!1;o<a;)(r=+s(t[i=o+(a-o>>1)],e))<0?o=i+1:(a=i,u=!r);return u?o:~o}(f,_);if(y<0){var p=(_-f[-y-2])/(f[-y-1]-f[-y-2]),m=e+(-y-2)*i;o=ut(t[m],t[m+i],p),a=ut(t[m+1],t[m+i+1],p)}else o=t[e+y*i],a=t[e+y*i+1]}return s?(s[0]=o,s[1]=a,s):[o,a]}function yn(t,e,n,i,r,s){if(n==e)return null;var o;if(r<t[e+i-1])return s?((o=t.slice(e,e+i))[i-1]=r,o):null;if(t[n-1]<r)return s?((o=t.slice(n-i,n))[i-1]=r,o):null;if(r==t[e+i-1])return t.slice(e,e+i);for(var a=e/i,u=n/i;a<u;){var l=a+u>>1;r<t[(l+1)*i-1]?u=l:a=l+1}var h=t[a*i-1];if(r==h)return t.slice((a-1)*i,(a-1)*i+i);var c=(r-h)/(t[(a+1)*i-1]-h);o=[];for(var f=0;f<i-1;++f)o.push(ut(t[(a-1)*i+f],t[a*i+f],c));return o.push(r),o}function pn(t,e,n,i,r){return!Vt(r,function(r){return!mn(t,e,n,i,r[0],r[1])})}function mn(t,e,n,i,r,s){for(var o=0,a=t[n-i],u=t[n-i+1];e<n;e+=i){var l=t[e],h=t[e+1];u<=s?h>s&&(l-a)*(s-u)-(r-a)*(h-u)>0&&o++:h<=s&&(l-a)*(s-u)-(r-a)*(h-u)<0&&o--,a=l,u=h}return 0!==o}function kn(t,e,n,i,r,s){if(0===n.length)return!1;if(!mn(t,e,n[0],i,r,s))return!1;for(var o=1,a=n.length;o<a;++o)if(mn(t,n[o-1],n[o],i,r,s))return!1;return!0}function xn(t,e,n,i,r){for(var s,o=[t[e],t[e+1]],a=[];e+i<n;e+=i){if(a[0]=t[e+i],a[1]=t[e+i+1],s=r(o,a))return s;o[0]=a[0],o[1]=a[1]}return!1}function En(t,e,n,i,r){var s=Gt([1/0,1/0,-1/0,-1/0],t,e,n,i);return!!Zt(r,s)&&(!!Lt(r,s)||s[0]>=r[0]&&s[2]<=r[2]||s[1]>=r[1]&&s[3]<=r[3]||xn(t,e,n,i,function(t,e){return function(t,e,n){var i=!1,r=Tt(t,e),s=Tt(t,n);if(r===mt||s===mt)i=!0;else{var o,a,u=t[0],l=t[1],h=t[2],c=t[3],f=e[0],d=e[1],g=n[0],v=n[1],_=(v-d)/(g-f);s&kt&&!(r&kt)&&(i=(o=g-(v-c)/_)>=u&&o<=h),i||!(s&xt)||r&xt||(i=(a=v-(g-h)*_)>=l&&a<=c),i||!(s&Et)||r&Et||(i=(o=g-(v-l)/_)>=u&&o<=h),i||!(s&Ct)||r&Ct||(i=(a=v-(g-u)*_)>=l&&a<=c)}return i}(r,t,e)}))}function Cn(t,e,n,i,r){if(!function(t,e,n,i,r){return!!(En(t,e,n,i,r)||mn(t,e,n,i,r[0],r[1])||mn(t,e,n,i,r[0],r[3])||mn(t,e,n,i,r[2],r[1])||mn(t,e,n,i,r[2],r[3]))}(t,e,n[0],i,r))return!1;if(1===n.length)return!0;for(var s=1,o=n.length;s<o;++s)if(pn(t,n[s-1],n[s],i,r)&&!En(t,n[s-1],n[s],i,r))return!1;return!0}function In(t,e,n,i){for(var r=t[e],s=t[e+1],o=0,a=e+i;a<n;a+=i){var u=t[a],l=t[a+1];o+=Math.sqrt((u-r)*(u-r)+(l-s)*(l-s)),r=u,s=l}return o}function Sn(t,e,n,i,r,s,o){var a=(n-e)/i;if(a<3){for(;e<n;e+=i)s[o++]=t[e],s[o++]=t[e+1];return o}var u=new Array(a);u[0]=1,u[a-1]=1;for(var l=[e,n-i],h=0;l.length>0;){for(var c=l.pop(),f=l.pop(),d=0,g=t[f],v=t[f+1],_=t[c],y=t[c+1],p=f+i;p<c;p+=i){var m=rt(t[p],t[p+1],g,v,_,y);m>d&&(h=p,d=m)}d>r&&(u[(h-e)/i]=1,f+i<h&&l.push(f,h),h+i<c&&l.push(h,c))}for(var k=0;k<a;++k)u[k]&&(s[o++]=t[e+k*i],s[o++]=t[e+k*i+1]);return o}function wn(t,e){return e*Math.round(t/e)}function Nn(t,e,n,i,r,s,o){if(e==n)return o;var a,u,l=wn(t[e],r),h=wn(t[e+1],r);e+=i,s[o++]=l,s[o++]=h;do{if(a=wn(t[e],r),u=wn(t[e+1],r),(e+=i)==n)return s[o++]=a,s[o++]=u,o}while(a==l&&u==h);for(;e<n;){var c=wn(t[e],r),f=wn(t[e+1],r);if(e+=i,c!=a||f!=u){var d=a-l,g=u-h,v=c-l,_=f-h;d*_==g*v&&(d<0&&v<d||d==v||d>0&&v>d)&&(g<0&&_<g||g==_||g>0&&_>g)?(a=c,u=f):(s[o++]=a,s[o++]=u,l=a,h=u,a=c,u=f)}}return s[o++]=a,s[o++]=u,o}function Ln(t,e,n,i,r,s,o,a){for(var u=0,l=n.length;u<l;++u){var h=n[u];o=Nn(t,e,h,i,r,s,o),a.push(o),e=h}return o}var Rn=function(t){s(n,rn);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).flatMidpoint_=null,r.flatMidpointRevision_=-1,r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return g(n,[{key:"appendCoordinate",value:function(t){this.flatCoordinates?z(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()}},{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){return i<Nt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(on(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,n,i))}},{key:"forEachSegment",value:function(t){return xn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"getCoordinateAtM",value:function(t,e){if(this.layout!=tn&&this.layout!=en)return null;var n=void 0!==e&&e;return yn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,n)}},{key:"getCoordinates",value:function(){return dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinateAt",value:function(t,e){return _n(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)}},{key:"getLength",value:function(){return In(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getFlatMidpoint",value:function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=Sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new n(e,Qe)}},{key:"getType",value:function(){return ht}},{key:"intersectsExtent",value:function(t){return En(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}]),n}(),Tn=function(t){s(n,rn);var e=a(n);function n(t,i,r){var s;if(f(this,n),(s=e.call(this)).ends_=[],s.maxDelta_=-1,s.maxDeltaRevision_=-1,Array.isArray(t[0]))s.setCoordinates(t,i);else if(void 0!==i&&r)s.setFlatCoordinates(i,t),s.ends_=r;else{for(var o=s.getLayout(),a=t,l=[],h=[],c=0,d=a.length;c<d;++c){var g=a[c];0===c&&(o=g.getLayout()),z(l,g.getFlatCoordinates()),h.push(l.length)}s.setFlatCoordinates(o,l),s.ends_=h}return u(s)}return g(n,[{key:"appendLineString",value:function(t){this.flatCoordinates?z(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice())}},{key:"closestPointXY",value:function(t,e,n,i){return i<Nt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(an(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ln(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,n,i))}},{key:"getCoordinateAtM",value:function(t,e,n){if(this.layout!=tn&&this.layout!=en||0===this.flatCoordinates.length)return null;var i=void 0!==e&&e,r=void 0!==n&&n;return function(t,e,n,i,r,s,o){if(o)return yn(t,e,n[n.length-1],i,r,s);var a;if(r<t[i-1])return s?((a=t.slice(0,i))[i-1]=r,a):null;if(t[t.length-1]<r)return s?((a=t.slice(t.length-i))[i-1]=r,a):null;for(var u=0,l=n.length;u<l;++u){var h=n[u];if(e!=h){if(r<t[e+i-1])return null;if(r<=t[h-1])return yn(t,e,h,i,r,!1);e=h}}return null}(this.flatCoordinates,0,this.ends_,this.stride,t,i,r)}},{key:"getCoordinates",value:function(){return gn(this.flatCoordinates,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getLineString",value:function(t){return t<0||this.ends_.length<=t?null:new Rn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLineStrings",value:function(){for(var t=this.flatCoordinates,e=this.ends_,n=this.layout,i=[],r=0,s=0,o=e.length;s<o;++s){var a=e[s],u=new Rn(t.slice(r,a),n);i.push(u),r=a}return i}},{key:"getFlatMidpoints",value:function(){for(var t=[],e=this.flatCoordinates,n=0,i=this.ends_,r=this.stride,s=0,o=i.length;s<o;++s){var a=i[s];z(t,_n(e,n,a,r,.5)),n=a}return t}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],i=[];return e.length=function(t,e,n,i,r,s,o,a){for(var u=0,l=n.length;u<l;++u){var h=n[u];o=Sn(t,e,h,i,r,s,o),a.push(o),e=h}return o}(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new n(e,Qe,i)}},{key:"getType",value:function(){return dt}},{key:"intersectsExtent",value:function(t){return function(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){if(En(t,e,n[s],i,r))return!0;e=n[s]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=fn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}]),n}(),bn=function(t){s(n,rn);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).setCoordinates(t,i),r}return g(n,[{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){var r=this.flatCoordinates,s=st(t,e,r[0],r[1]);if(s<i){for(var o=this.stride,a=0;a<o;++a)n[a]=r[a];return n.length=o,s}return i}},{key:"getCoordinates",value:function(){return this.flatCoordinates?this.flatCoordinates.slice():[]}},{key:"computeExtent",value:function(t){return Mt(this.flatCoordinates,t)}},{key:"getType",value:function(){return lt}},{key:"intersectsExtent",value:function(t){return Rt(t,this.flatCoordinates[0],this.flatCoordinates[1])}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=hn(this.flatCoordinates,0,t,this.stride),this.changed()}}]),n}(),Pn=function(t){s(n,rn);var e=a(n);function n(t,i){var r;return f(this,n),r=e.call(this),i&&!Array.isArray(t[0])?r.setFlatCoordinates(i,t):r.setCoordinates(t,i),r}return g(n,[{key:"appendPoint",value:function(t){this.flatCoordinates?z(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()}},{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){if(i<Nt(this.getExtent(),t,e))return i;for(var r=this.flatCoordinates,s=this.stride,o=0,a=r.length;o<a;o+=s){var u=st(t,e,r[o],r[o+1]);if(u<i){i=u;for(var l=0;l<s;++l)n[l]=r[o+l];n.length=s}}return i}},{key:"getCoordinates",value:function(){return dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getPoint",value:function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new bn(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}},{key:"getPoints",value:function(){for(var t=this.flatCoordinates,e=this.layout,n=this.stride,i=[],r=0,s=t.length;r<s;r+=n){var o=new bn(t.slice(r,r+n),e);i.push(o)}return i}},{key:"getType",value:function(){return ft}},{key:"intersectsExtent",value:function(t){for(var e=this.flatCoordinates,n=this.stride,i=0,r=e.length;i<r;i+=n)if(Rt(t,e[i],e[i+1]))return!0;return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}]),n}();function Mn(t,e,n,i){for(var r=0,s=t[n-i],o=t[n-i+1];e<n;e+=i){var a=t[e],u=t[e+1];r+=o*a-s*u,s=a,o=u}return r/2}function On(t,e,n,i){for(var r=0,s=0,o=n.length;s<o;++s){var a=n[s];r+=Mn(t,e,a,i),e=a}return r}var Fn=function(t){s(n,rn);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this)).maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===i||Array.isArray(t[0])?r.setCoordinates(t,i):r.setFlatCoordinates(i,t),r}return g(n,[{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){return i<Nt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(on(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"getArea",value:function(){return Mn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getCoordinates",value:function(){return dn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[];return e.length=Sn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new n(e,Qe)}},{key:"getType",value:function(){return"LinearRing"}},{key:"intersectsExtent",value:function(t){return!1}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=cn(this.flatCoordinates,0,t,this.stride),this.changed()}}]),n}();function Dn(t,e,n,i,r,s,o){for(var a,u,l,h,c,f,d,g=r[s+1],v=[],_=0,y=n.length;_<y;++_){var p=n[_];for(h=t[p-i],f=t[p-i+1],a=e;a<p;a+=i)c=t[a],d=t[a+1],(g<=f&&d<=g||f<=g&&g<=d)&&(l=(g-f)/(d-f)*(c-h)+h,v.push(l)),h=c,f=d}var m=NaN,k=-1/0;for(v.sort(A),h=v[0],a=1,u=v.length;a<u;++a){c=v[a];var x=Math.abs(c-h);x>k&&(kn(t,e,n,i,l=(h+c)/2,g)&&(m=l,k=x)),h=c}return isNaN(m)&&(m=r[s]),o?(o.push(m,g,k),o):[m,g,k]}function An(t,e,n,i){for(;e<n-i;){for(var r=0;r<i;++r){var s=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=s}e+=i,n-=i}}function Gn(t,e,n,i){for(var r=0,s=t[n-i],o=t[n-i+1];e<n;e+=i){var a=t[e],u=t[e+1];r+=(a-s)*(u+o),s=a,o=u}return r>0}function Bn(t,e,n,i,r){for(var s=void 0!==r&&r,o=0,a=n.length;o<a;++o){var u=n[o],l=Gn(t,e,u,i);if(0===o){if(s&&l||!s&&!l)return!1}else if(s&&!l||!s&&l)return!1;e=u}return!0}function Vn(t,e,n,i,r){for(var s=void 0!==r&&r,o=0,a=n.length;o<a;++o){var u=n[o],l=Gn(t,e,u,i);(0===o?s&&l||!s&&!l:s&&!l||!s&&l)&&An(t,e,u,i),e=u}return e}function zn(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s)e=Vn(t,e,n[s],i,r);return e}var qn=function(t){s(n,rn);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this)).ends_=[],s.flatInteriorPointRevision_=-1,s.flatInteriorPoint_=null,s.maxDelta_=-1,s.maxDeltaRevision_=-1,s.orientedRevision_=-1,s.orientedFlatCoordinates_=null,void 0!==i&&r?(s.setFlatCoordinates(i,t),s.ends_=r):s.setCoordinates(t,i),s}return g(n,[{key:"appendLinearRing",value:function(t){this.flatCoordinates?z(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}},{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),this.layout,this.ends_.slice())}},{key:"closestPointXY",value:function(t,e,n,i){return i<Nt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(an(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ln(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))}},{key:"containsXY",value:function(t,e){return kn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}},{key:"getArea",value:function(){return On(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?Vn(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates,gn(e,0,this.ends_,this.stride)}},{key:"getEnds",value:function(){return this.ends_}},{key:"getFlatInteriorPoint",value:function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=Yt(this.getExtent());this.flatInteriorPoint_=Dn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}},{key:"getInteriorPoint",value:function(){return new bn(this.getFlatInteriorPoint(),tn)}},{key:"getLinearRingCount",value:function(){return this.ends_.length}},{key:"getLinearRing",value:function(t){return t<0||this.ends_.length<=t?null:new Fn(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}},{key:"getLinearRings",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.ends_,i=[],r=0,s=0,o=n.length;s<o;++s){var a=n[s],u=new Fn(e.slice(r,a),t);i.push(u),r=a}return i}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Bn(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Vn(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],i=[];return e.length=Ln(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new n(e,Qe,i)}},{key:"getType",value:function(){return ct}},{key:"intersectsExtent",value:function(t){return Cn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=fn(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}}]),n}(),Yn=qn;function Xn(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=[e,n,e,r,i,r,i,n,e,n];return new qn(s,Qe,[s.length])}function Un(t,e,n){for(var i=e||32,r=t.getStride(),s=t.getLayout(),o=t.getCenter(),a=r*(i+1),u=new Array(a),l=0;l<a;l+=r){u[l]=0,u[l+1]=0;for(var h=2;h<r;h++)u[l+h]=o[h]}var c=[u.length],f=new qn(u,s,c);return function(t,e,n,i){for(var r=t.getFlatCoordinates(),s=t.getStride(),o=r.length/s-1,a=i||0,u=0;u<=o;++u){var l=u*s,h=a+2*at(u,o)*Math.PI/o;r[l]=e[0]+n*Math.cos(h),r[l+1]=e[1]+n*Math.sin(h)}t.changed()}(f,o,t.getRadius(),n),f}var Wn=function(t){s(n,rn);var e=a(n);function n(t,i,r){var s;if(f(this,n),(s=e.call(this)).endss_=[],s.flatInteriorPointsRevision_=-1,s.flatInteriorPoints_=null,s.maxDelta_=-1,s.maxDeltaRevision_=-1,s.orientedRevision_=-1,s.orientedFlatCoordinates_=null,!r&&!Array.isArray(t[0])){for(var o=s.getLayout(),a=t,l=[],h=[],c=0,d=a.length;c<d;++c){var g=a[c];0===c&&(o=g.getLayout());for(var v=l.length,_=g.getEnds(),y=0,p=_.length;y<p;++y)_[y]+=v;z(l,g.getFlatCoordinates()),h.push(_)}i=o,t=l,r=h}return void 0!==i&&r?(s.setFlatCoordinates(i,t),s.endss_=r):s.setCoordinates(t,i),u(s)}return g(n,[{key:"appendPolygon",value:function(t){var e;if(this.flatCoordinates){var n=this.flatCoordinates.length;z(this.flatCoordinates,t.getFlatCoordinates());for(var i=0,r=(e=t.getEnds().slice()).length;i<r;++i)e[i]+=n}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()}},{key:"clone",value:function(){for(var t=this.endss_.length,e=new Array(t),i=0;i<t;++i)e[i]=this.endss_[i].slice();return new n(this.flatCoordinates.slice(),this.layout,e)}},{key:"closestPointXY",value:function(t,e,n,i){return i<Nt(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){var a=n[s];r=an(t,e,a,i,r),e=a[a.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(t,e,n,i,r,s,o,a,u,l,h){for(var c=[NaN,NaN],f=0,d=n.length;f<d;++f){var g=n[f];l=ln(t,e,g,i,r,!0,o,a,u,l,c),e=g[g.length-1]}return l}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,t,e,n,i))}},{key:"containsXY",value:function(t,e){return function(t,e,n,i,r,s){if(0===n.length)return!1;for(var o=0,a=n.length;o<a;++o){var u=n[o];if(kn(t,e,u,i,r,s))return!0;e=u[u.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}},{key:"getArea",value:function(){return function(t,e,n,i){for(var r=0,s=0,o=n.length;s<o;++s){var a=n[s];r+=On(t,e,a,i),e=a[a.length-1]}return r}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}},{key:"getCoordinates",value:function(t){var e;return void 0!==t?zn(e=this.getOrientedFlatCoordinates().slice(),0,this.endss_,this.stride,t):e=this.flatCoordinates,vn(e,0,this.endss_,this.stride)}},{key:"getEndss",value:function(){return this.endss_}},{key:"getFlatInteriorPoints",value:function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=function(t,e,n,i){for(var r=[],s=[1/0,1/0,-1/0,-1/0],o=0,a=n.length;o<a;++o){var u=n[o];s=Ot(t,e,u[0],i),r.push((s[0]+s[2])/2,(s[1]+s[3])/2),e=u[u.length-1]}return r}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(t,e,n,i,r){for(var s=[],o=0,a=n.length;o<a;++o){var u=n[o];s=Dn(t,e,u,i,r,2*o,s),e=u[u.length-1]}return s}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}},{key:"getInteriorPoints",value:function(){return new Pn(this.getFlatInteriorPoints().slice(),tn)}},{key:"getOrientedFlatCoordinates",value:function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;!function(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){var a=n[s];if(!Bn(t,e,a,i,void 0))return!1;a.length&&(e=a[a.length-1])}return!0}(t,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=zn(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}},{key:"getSimplifiedGeometryInternal",value:function(t){var e=[],i=[];return e.length=function(t,e,n,i,r,s,o,a){for(var u=0,l=n.length;u<l;++u){var h=n[u],c=[];o=Ln(t,e,h,i,r,s,o,c),a.push(c),e=h[h.length-1]}return o}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new n(e,Qe,i)}},{key:"getPolygon",value:function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var n=this.endss_[t-1];e=n[n.length-1]}var i=this.endss_[t].slice(),r=i[i.length-1];if(0!==e)for(var s=0,o=i.length;s<o;++s)i[s]-=e;return new Yn(this.flatCoordinates.slice(e,r),this.layout,i)}},{key:"getPolygons",value:function(){for(var t=this.layout,e=this.flatCoordinates,n=this.endss_,i=[],r=0,s=0,o=n.length;s<o;++s){var a=n[s].slice(),u=a[a.length-1];if(0!==r)for(var l=0,h=a.length;l<h;++l)a[l]-=r;var c=new Yn(e.slice(r,u),t,a);i.push(c),r=u}return i}},{key:"getType",value:function(){return gt}},{key:"intersectsExtent",value:function(t){return function(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){var a=n[s];if(Cn(t,e,a,i,r))return!0;e=a[a.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}},{key:"setCoordinates",value:function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var n=function(t,e,n,i,r){for(var s=r||[],o=0,a=0,u=n.length;a<u;++a){var l=fn(t,e,n[a],i,s[o]);s[o++]=l,e=l[l.length-1]}return s.length=o,s}(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===n.length)this.flatCoordinates.length=0;else{var i=n[n.length-1];this.flatCoordinates.length=0===i.length?0:i[i.length-1]}this.changed()}}]),n}();function Hn(t,e){if(!t)return null;var n;switch(t.type){case lt:n=function(t){return new bn(t.coordinates)}(t);break;case ht:n=function(t){return new Rn(t.coordinates)}(t);break;case ct:n=function(t){return new Yn(t.coordinates)}(t);break;case ft:n=function(t){return new Pn(t.coordinates)}(t);break;case dt:n=function(t){return new Tn(t.coordinates)}(t);break;case gt:n=function(t){return new Wn(t.coordinates)}(t);break;case vt:n=function(t,e){var n=t.geometries.map(function(t){return Hn(t,void 0)});return new Je(n)}(t);break;default:throw new Error("Unsupported GeoJSON type: "+t.type)}return Fe(n,!1,e)}function jn(t,e){var n,i=(t=Fe(t,!0,e)).getType();switch(i){case lt:n=function(t,e){return{type:"Point",coordinates:t.getCoordinates()}}(t);break;case ht:n=function(t,e){return{type:"LineString",coordinates:t.getCoordinates()}}(t);break;case ct:n=function(t,e){var n;return e&&(n=e.rightHanded),{type:"Polygon",coordinates:t.getCoordinates(n)}}(t,e);break;case ft:n=function(t,e){return{type:"MultiPoint",coordinates:t.getCoordinates()}}(t);break;case dt:n=function(t,e){return{type:"MultiLineString",coordinates:t.getCoordinates()}}(t);break;case gt:n=function(t,e){var n;return e&&(n=e.rightHanded),{type:"MultiPolygon",coordinates:t.getCoordinates(n)}}(t,e);break;case vt:n=function(t,e){return{type:"GeometryCollection",geometries:t.getGeometriesArray().map(function(t){var n=p({},e);return delete n.featureProjection,jn(t,n)})}}(t,e);break;case _t:n={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+i)}return n}var Kn=function(t){s(n,ze);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this)).dataProjection=pe(r.dataProjection?r.dataProjection:"EPSG:4326"),r.featureProjection&&(i.defaultFeatureProjection=pe(r.featureProjection)),i.geometryName_=r.geometryName,i.extractGeometryName_=r.extractGeometryName,i}return g(n,[{key:"readFeatureFromObject",value:function(t,e){var n,i=Hn((n="Feature"===t.type?t:{type:"Feature",geometry:t,properties:null}).geometry,e),r=new et;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in n!==void 0&&r.setGeometryName(n.geometry_name),r.setGeometry(i),"id"in n&&r.setId(n.id),n.properties&&r.setProperties(n.properties,!0),r}},{key:"readFeaturesFromObject",value:function(t,e){var n=null;if("FeatureCollection"===t.type){n=[];for(var i=t.features,r=0,s=i.length;r<s;++r)n.push(this.readFeatureFromObject(i[r],e))}else n=[this.readFeatureFromObject(t,e)];return n}},{key:"readGeometryFromObject",value:function(t,e){return Hn(t,e)}},{key:"readProjectionFromObject",value:function(t){var e,n=t.crs;return n?"name"==n.type?e=pe(n.properties.name):"EPSG"===n.type?e=pe("EPSG:"+n.properties.code):y(!1,36):e=this.dataProjection,e}},{key:"writeFeatureObject",value:function(t,e){e=this.adaptOptions(e);var n={type:"Feature",geometry:null,properties:null},i=t.getId();void 0!==i&&(n.id=i);var r=t.getGeometry();r&&(n.geometry=jn(r,e));var s=t.getProperties();return delete s[t.getGeometryName()],x(s)||(n.properties=s),n}},{key:"writeFeaturesObject",value:function(t,e){e=this.adaptOptions(e);for(var n=[],i=0,r=t.length;i<r;++i)n.push(this.writeFeatureObject(t[i],e));return{type:"FeatureCollection",features:n}}},{key:"writeGeometryObject",value:function(t,e){return jn(t,this.adaptOptions(e))}}]),n}();function Zn(t,e,n){return function(i,r,s,o){if(i){var a=e?0:s[0]*r,u=e?0:s[1]*r,l=t[0]+a/2,h=t[2]-a/2,c=t[1]+u/2,f=t[3]-u/2;l>h&&(h=l=(h+l)/2),c>f&&(f=c=(f+c)/2);var d=nt(i[0],l,h),g=nt(i[1],c,f),v=30*r;return o&&n&&(d+=-v*Math.log(1+Math.max(0,l-i[0])/v)+v*Math.log(1+Math.max(0,i[0]-h)/v),g+=-v*Math.log(1+Math.max(0,c-i[1])/v)+v*Math.log(1+Math.max(0,i[1]-f)/v)),[d,g]}}}function Jn(t){return t}function Qn(t,e,n,i){var r=Kt(e)/n[0],s=Ut(e)/n[1];return i?Math.min(t,Math.max(r,s)):Math.min(t,Math.min(r,s))}function $n(t,e,n){var i=Math.min(t,e);return i*=Math.log(1+50*Math.max(0,t/e-1))/50+1,n&&(i=Math.max(i,n),i/=Math.log(1+50*Math.max(0,n/t-1))/50+1),nt(i,n/2,2*e)}function ti(t,e,n,i,r){return function(s,o,a,u){if(void 0!==s){var l=i?Qn(t,i,a,r):t;return(void 0===n||n)&&u?$n(s,l,e):nt(s,e,l)}}}function ei(t){return void 0!==t?0:void 0}function ni(t){return void 0!==t?t:void 0}var ii="center",ri="resolution",si="rotation";function oi(t,e){var n,i,r=t[0],s=t[1],o=e[0],a=e[1],u=o[0],l=o[1],h=a[0],c=a[1],f=h-u,d=c-l,g=0===f&&0===d?0:(f*(r-u)+d*(s-l))/(f*f+d*d||0);return g<=0?(n=u,i=l):g>=1?(n=h,i=c):(n=u+g*f,i=l+g*d),[n,i]}function ai(t,e){for(var n=!0,i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n}function ui(t,e){var n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,s=t[1]*n+t[0]*i;return t[0]=r,t[1]=s,t}function li(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function hi(t,e){return Math.sqrt(li(t,e))}function ci(t,e){return li(t,oi(t,e))}function fi(t,e){var n=e.getExtent();if(e.canWrapX()&&(t[0]<n[0]||t[0]>=n[2])){var i=Kt(n),r=Math.floor((t[0]-n[0])/i);t[0]-=r*i}return t}function di(t){return 1-function(t){return Math.pow(t,3)}(1-t)}function gi(t){return 3*t*t-2*t*t*t}function vi(t){return t}function _i(t,e){setTimeout(function(){t(e)},0)}function yi(t){return!(t.sourceCenter&&t.targetCenter&&!ai(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}var pi=function(t){s(n,tt);var e=a(n);function n(t){var i;f(this,n),i=e.call(this);var r=p({},t);return i.hints_=[0,0],i.animations_=[],i.updateAnimationKey_,i.projection_=ke(r.projection,"EPSG:3857"),i.viewportSize_=[100,100],i.targetCenter_=null,i.targetResolution_,i.targetRotation_,i.cancelAnchor_=void 0,r.center&&(r.center=be(r.center,i.projection_)),r.extent&&(r.extent=Me(r.extent,i.projection_)),i.applyOptions_(r),i}return g(n,[{key:"applyOptions_",value:function(t){var e=function(t){var e,n,i,r=void 0!==t.minZoom?t.minZoom:0,s=void 0!==t.maxZoom?t.maxZoom:28,o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,u=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,l=void 0!==t.showFullExtent&&t.showFullExtent,h=ke(t.projection,"EPSG:3857"),c=h.getExtent(),f=t.constrainOnlyCenter,d=t.extent;if(a||d||!h.isGlobal()||(f=!1,d=c),void 0!==t.resolutions){var g=t.resolutions;n=g[r],i=void 0!==g[s]?g[s]:g[g.length-1],e=t.constrainResolution?function(t,e,n,i){return function(r,s,o,a){if(void 0!==r){var u=t[0],l=t[t.length-1],h=n?Qn(u,n,o,i):u;if(a)return void 0===e||e?$n(r,h,l):nt(r,l,h);var c=Math.min(h,r),f=Math.floor(B(t,c,s));return t[f]>h&&f<t.length-1?t[f+1]:t[f]}}}(g,u,!f&&d,l):ti(n,i,u,!f&&d,l)}else{var v=(c?Math.max(Kt(c),Ut(c)):360*te[ee.DEGREES]/h.getMetersPerUnit())/256/Math.pow(2,0),_=v/Math.pow(2,28);void 0!==(n=t.maxResolution)?r=0:n=v/Math.pow(o,r),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(o,s):v/Math.pow(o,s):_),s=r+Math.floor(Math.log(n/i)/Math.log(o)),i=n/Math.pow(o,s-r),e=t.constrainResolution?function(t,e,n,i,r,s){return function(o,a,u,l){if(void 0!==o){var h=r?Qn(e,r,u,s):e,c=void 0!==n?n:0;if(l)return void 0===i||i?$n(o,h,c):nt(o,c,h);var f=Math.ceil(Math.log(e/h)/Math.log(t)-1e-9),d=-a*(.5-1e-9)+.5,g=Math.min(h,o),v=Math.floor(Math.log(e/g)/Math.log(t)+d),_=Math.max(f,v);return nt(e/Math.pow(t,_),c,h)}}}(o,n,i,u,!f&&d,l):ti(n,i,u,!f&&d,l)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:r,zoomFactor:o}}(t);this.maxResolution_=e.maxResolution,this.minResolution_=e.minResolution,this.zoomFactor_=e.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=e.minZoom;var n=function(t){if(void 0!==t.extent){var e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return Zn(t.extent,t.constrainOnlyCenter,e)}var n=ke(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&n.isGlobal()){var i=n.getExtent().slice();return i[0]=-1/0,i[2]=1/0,Zn(i,!1,!1)}return Jn}(t),i=e.constraint,r=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?(n=ot(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=n?0:t:void 0}):!1===e?ni:"number"==typeof e?function(t){var e=2*Math.PI/t;return function(t,n){return n?t:void 0!==t?t=Math.floor(t/e+.5)*e:void 0}}(e):ni}var n;return ei}(t);this.constraints_={center:n,resolution:i,rotation:r},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t}},{key:"getUpdatedOptions_",value:function(t){var e=p({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),p({},e,t)}},{key:"animate",value:function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var e=new Array(arguments.length),n=0;n<e.length;++n){var i=arguments[n];i.center&&((i=p({},i)).center=be(i.center,this.getProjection())),i.anchor&&((i=p({},i)).anchor=be(i.anchor,this.getProjection())),e[n]=i}this.animateInternal.apply(this,e)}},{key:"animateInternal",value:function(t){var e,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var i=arguments[n-1];return i.center&&this.setCenterInternal(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(e&&_i(e,!0))}for(var r=Date.now(),s=this.targetCenter_.slice(),o=this.targetResolution_,a=this.targetRotation_,u=[],l=0;l<n;++l){var h=arguments[l],c={start:r,complete:!1,anchor:h.anchor,duration:void 0!==h.duration?h.duration:1e3,easing:h.easing||gi,callback:e};if(h.center&&(c.sourceCenter=s,c.targetCenter=h.center.slice(),s=c.targetCenter),void 0!==h.zoom?(c.sourceResolution=o,c.targetResolution=this.getResolutionForZoom(h.zoom),o=c.targetResolution):h.resolution&&(c.sourceResolution=o,c.targetResolution=h.resolution,o=c.targetResolution),void 0!==h.rotation){c.sourceRotation=a;var f=at(h.rotation-a+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=a+f,a=c.targetRotation}yi(c)?c.complete=!0:r+=c.duration,u.push(c)}this.animations_.push(u),this.setHint(0,1),this.updateAnimations_()}},{key:"getAnimating",value:function(){return this.hints_[0]>0}},{key:"getInteracting",value:function(){return this.hints_[1]>0}},{key:"cancelAnimations",value:function(){var t;this.setHint(0,-this.hints_[0]);for(var e=0,n=this.animations_.length;e<n;++e){var i=this.animations_[e];if(i[0].callback&&_i(i[0].callback,!1),!t)for(var r=0,s=i.length;r<s;++r){var o=i[r];if(!o.complete){t=o.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t}},{key:"updateAnimations_",value:function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var i=this.animations_[n],r=!0,s=0,o=i.length;s<o;++s){var a=i[s];if(!a.complete){var u=t-a.start,l=a.duration>0?u/a.duration:1;l>=1?(a.complete=!0,l=1):r=!1;var h=a.easing(l);if(a.sourceCenter){var c=a.sourceCenter[0],f=a.sourceCenter[1],d=c+h*(a.targetCenter[0]-c),g=f+h*(a.targetCenter[1]-f);this.targetCenter_=[d,g]}if(a.sourceResolution&&a.targetResolution){var v=1===h?a.targetResolution:a.sourceResolution+h*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getViewportSize_(this.getRotation()),y=this.constraints_.resolution(v,0,_,!0);this.targetCenter_=this.calculateCenterZoom(y,a.anchor)}this.targetResolution_=v,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var p=1===h?at(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+h*(a.targetRotation-a.sourceRotation);if(a.anchor){var m=this.constraints_.rotation(p,!0);this.targetCenter_=this.calculateCenterRotate(m,a.anchor)}this.targetRotation_=p}if(this.applyTargetState_(!0),e=!0,!a.complete)break}}if(r){this.animations_[n]=null,this.setHint(0,-1);var k=i[0].callback;k&&_i(k,!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}},{key:"calculateCenterRotate",value:function(t,e){var n,i,r,s=this.getCenterInternal();return void 0!==s&&(ui(n=[s[0]-e[0],s[1]-e[1]],t-this.getRotation()),r=e,(i=n)[0]+=+r[0],i[1]+=+r[1]),n}},{key:"calculateCenterZoom",value:function(t,e){var n,i=this.getCenterInternal(),r=this.getResolution();return void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]),n}},{key:"getViewportSize_",value:function(t){var e=this.viewportSize_;if(t){var n=e[0],i=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(i*Math.cos(t))]}return e}},{key:"setViewportSize",value:function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.resolveConstraints(0)}},{key:"getCenter",value:function(){var t=this.getCenterInternal();return t?Te(t,this.getProjection()):t}},{key:"getCenterInternal",value:function(){return this.get(ii)}},{key:"getConstraints",value:function(){return this.constraints_}},{key:"getConstrainResolution",value:function(){return this.options_.constrainResolution}},{key:"getHints",value:function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}},{key:"calculateExtent",value:function(t){return Pe(this.calculateExtentInternal(t),this.getProjection())}},{key:"calculateExtentInternal",value:function(t){var e=t||this.getViewportSize_(),n=this.getCenterInternal();y(n,1);var i=this.getResolution();y(void 0!==i,2);var r=this.getRotation();return y(void 0!==r,3),Xt(n,i,r,e)}},{key:"getMaxResolution",value:function(){return this.maxResolution_}},{key:"getMinResolution",value:function(){return this.minResolution_}},{key:"getMaxZoom",value:function(){return this.getZoomForResolution(this.minResolution_)}},{key:"setMaxZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}},{key:"getMinZoom",value:function(){return this.getZoomForResolution(this.maxResolution_)}},{key:"setMinZoom",value:function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}},{key:"setConstrainResolution",value:function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolution",value:function(){return this.get(ri)}},{key:"getResolutions",value:function(){return this.resolutions_}},{key:"getResolutionForExtent",value:function(t,e){return this.getResolutionForExtentInternal(Me(t,this.getProjection()),e)}},{key:"getResolutionForExtentInternal",value:function(t,e){var n=e||this.getViewportSize_(),i=Kt(t)/n[0],r=Ut(t)/n[1];return Math.max(i,r)}},{key:"getResolutionForValueFunction",value:function(t){var e=t||2,n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return n/Math.pow(e,t*r)}}},{key:"getRotation",value:function(){return this.get(si)}},{key:"getValueForResolutionFunction",value:function(t){var e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,r=Math.log(n/i)/e;return function(t){return Math.log(n/t)/e/r}}},{key:"getState",value:function(){var t=this.getCenterInternal(),e=this.getProjection(),n=this.getResolution(),i=this.getRotation();return{center:t.slice(0),projection:void 0!==e?e:null,resolution:n,rotation:i,zoom:this.getZoom()}}},{key:"getZoom",value:function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t}},{key:"getZoomForResolution",value:function(t){var e,n,i=this.minZoom_||0;if(this.resolutions_){var r=B(this.resolutions_,t,1);i=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)}},{key:"getResolutionForZoom",value:function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var e=nt(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,nt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}},{key:"fit",value:function(t,e){var n,i=p({size:this.getViewportSize_()},e||{});if(y(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))y(!Jt(t),25),n=Xn(Me(t,this.getProjection()));else if(t.getType()===_t){var r=Me(t.getExtent(),this.getProjection());(n=Xn(r)).rotate(this.getRotation(),Yt(r))}else{var s=Re();n=s?t.clone().transform(s,this.getProjection()):t}this.fitInternal(n,i)}},{key:"fitInternal",value:function(t,e){var n=e||{},i=n.size;i||(i=this.getViewportSize_());var r,s=void 0!==n.padding?n.padding:[0,0,0,0],o=void 0!==n.nearest&&n.nearest;r=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.getResolutionForZoom(n.maxZoom):0;for(var a=t.getFlatCoordinates(),u=this.getRotation(),l=Math.cos(-u),h=Math.sin(-u),c=1/0,f=1/0,d=-1/0,g=-1/0,v=t.getStride(),_=0,y=a.length;_<y;_+=v){var p=a[_]*l-a[_+1]*h,m=a[_]*h+a[_+1]*l;c=Math.min(c,p),f=Math.min(f,m),d=Math.max(d,p),g=Math.max(g,m)}var k=this.getResolutionForExtentInternal([c,f,d,g],[i[0]-s[1]-s[3],i[1]-s[0]-s[2]]);k=isNaN(k)?r:Math.max(k,r),k=this.getConstrainedResolution(k,o?0:1),h=-h;var x=(c+d)/2,E=(f+g)/2,C=[(x+=(s[1]-s[3])/2*k)*l-(E+=(s[0]-s[2])/2*k)*h,E*l+x*h],I=n.callback?n.callback:U;void 0!==n.duration?this.animateInternal({resolution:k,center:this.getConstrainedCenter(C,k),duration:n.duration,easing:n.easing},I):(this.targetResolution_=k,this.targetCenter_=C,this.applyTargetState_(!1,!0),_i(I,!0))}},{key:"centerOn",value:function(t,e,n){this.centerOnInternal(be(t,this.getProjection()),e,n)}},{key:"centerOnInternal",value:function(t,e,n){var i=this.getRotation(),r=Math.cos(-i),s=Math.sin(-i),o=t[0]*r-t[1]*s,a=t[1]*r+t[0]*s,u=this.getResolution(),l=(o+=(e[0]/2-n[0])*u)*r-(a+=(n[1]-e[1]/2)*u)*(s=-s),h=a*r+o*s;this.setCenterInternal([l,h])}},{key:"isDef",value:function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}},{key:"adjustCenter",value:function(t){var e=Te(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}},{key:"adjustCenterInternal",value:function(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}},{key:"adjustResolution",value:function(t,e){var n=e&&be(e,this.getProjection());this.adjustResolutionInternal(t,n)}},{key:"adjustResolutionInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,i,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}},{key:"adjustZoom",value:function(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}},{key:"adjustRotation",value:function(t,e){e&&(e=be(e,this.getProjection())),this.adjustRotationInternal(t,e)}},{key:"adjustRotationInternal",value:function(t,e){var n=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}},{key:"setCenter",value:function(t){this.setCenterInternal(be(t,this.getProjection()))}},{key:"setCenterInternal",value:function(t){this.targetCenter_=t,this.applyTargetState_()}},{key:"setHint",value:function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}},{key:"setResolution",value:function(t){this.targetResolution_=t,this.applyTargetState_()}},{key:"setRotation",value:function(t){this.targetRotation_=t,this.applyTargetState_()}},{key:"setZoom",value:function(t){this.setResolution(this.getResolutionForZoom(t))}},{key:"applyTargetState_",value:function(t,e){var n=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,r,n),o=this.constraints_.center(this.targetCenter_,s,r,n);this.get(si)!==i&&this.set(si,i),this.get(ri)!==s&&this.set(ri,s),this.get(ii)&&ai(this.get(ii),o)||this.set(ii,o),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}},{key:"resolveConstraints",value:function(t,e,n){var i=void 0!==t?t:200,r=e||0,s=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(s),a=this.constraints_.resolution(this.targetResolution_,r,o),u=this.constraints_.center(this.targetCenter_,a,o);if(0===i&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=s,this.targetCenter_=u,void this.applyTargetState_();var l=n||(0===i?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===s&&this.getCenterInternal()&&ai(this.getCenterInternal(),u)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:s,center:u,resolution:a,duration:i,easing:di,anchor:l}))}},{key:"beginInteraction",value:function(){this.resolveConstraints(0),this.setHint(1,1)}},{key:"endInteraction",value:function(t,e,n){var i=n&&be(n,this.getProjection());this.endInteractionInternal(t,e,i)}},{key:"endInteractionInternal",value:function(t,e,n){this.setHint(1,-1),this.resolveConstraints(t,e,n)}},{key:"getConstrainedCenter",value:function(t,e){var n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}},{key:"getConstrainedZoom",value:function(t,e){var n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}},{key:"getConstrainedResolution",value:function(t,e){var n=e||0,i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,n,i)}}]),n}(),mi="postrender",ki="bottom-center",xi="bottom-right",Ei="center-center",Ci="center-right",Ii="top-left",Si=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),wi=["style","variant","weight","size","lineHeight","family"],Ni=function(t){var e=t.match(Si);if(!e)return null;for(var n={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"},i=0,r=wi.length;i<r;++i){var s=e[i+1];void 0!==s&&(n[wi[i]]=s)}return n.families=n.family.split(/,\s?/),n},Li="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Ri=-1!==Li.indexOf("firefox"),Ti=(-1!==Li.indexOf("safari")&&Li.indexOf("chrom"),-1!==Li.indexOf("webkit")&&-1==Li.indexOf("edge")),bi=-1!==Li.indexOf("macintosh"),Pi="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,Mi="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,Oi="undefined"!=typeof Image&&Image.prototype.decode,Fi=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function Di(t,e,n){var i=n&&n.length?n.shift():Mi?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d")}function Ai(t){var e=t.offsetWidth,n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10)}function Gi(t){var e=t.offsetHeight,n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10)}function Bi(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function Vi(t){return t&&t.parentNode?t.parentNode.removeChild(t):null}function zi(t){for(;t.lastChild;)t.removeChild(t.lastChild)}var qi="element",Yi="map",Xi="offset",Ui="position",Wi="positioning",Hi=function(t){s(n,tt);var e=a(n);function n(t){var i;f(this,n),(i=e.call(this)).options=t,i.id=t.id,i.insertFirst=void 0===t.insertFirst||t.insertFirst,i.stopEvent=void 0===t.stopEvent||t.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==t.className?t.className:"ol-overlay-container ol-selectable",i.element.style.position="absolute";var r=t.autoPan;return r&&"object"!=v(r)&&(r={animation:t.autoPanAnimation,margin:t.autoPanMargin}),i.autoPan=r||!1,i.rendered={transform_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener($(qi),i.handleElementChanged),i.addEventListener($(Yi),i.handleMapChanged),i.addEventListener($(Xi),i.handleOffsetChanged),i.addEventListener($(Ui),i.handlePositionChanged),i.addEventListener($(Wi),i.handlePositioningChanged),void 0!==t.element&&i.setElement(t.element),i.setOffset(void 0!==t.offset?t.offset:[0,0]),i.setPositioning(void 0!==t.positioning?t.positioning:Ii),void 0!==t.position&&i.setPosition(t.position),i}return g(n,[{key:"getElement",value:function(){return this.get(qi)}},{key:"getId",value:function(){return this.id}},{key:"getMap",value:function(){return this.get(Yi)}},{key:"getOffset",value:function(){return this.get(Xi)}},{key:"getPosition",value:function(){return this.get(Ui)}},{key:"getPositioning",value:function(){return this.get(Wi)}},{key:"handleElementChanged",value:function(){zi(this.element);var t=this.getElement();t&&this.element.appendChild(t)}},{key:"handleMapChanged",value:function(){this.mapPostrenderListenerKey&&(Vi(this.element),I(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=E(t,mi,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}},{key:"render",value:function(){this.updatePixelPosition()}},{key:"handleOffsetChanged",value:function(){this.updatePixelPosition()}},{key:"handlePositionChanged",value:function(){this.updatePixelPosition(),this.performAutoPan()}},{key:"handlePositioningChanged",value:function(){this.updatePixelPosition()}},{key:"setElement",value:function(t){this.set(qi,t)}},{key:"setMap",value:function(t){this.set(Yi,t)}},{key:"setOffset",value:function(t){this.set(Xi,t)}},{key:"setPosition",value:function(t){this.set(Ui,t)}},{key:"performAutoPan",value:function(){this.autoPan&&this.panIntoView(this.autoPan)}},{key:"panIntoView",value:function(t){var e=this.getMap();if(e&&e.getTargetElement()&&this.get(Ui)){var n=this.getRect(e.getTargetElement(),e.getSize()),i=this.getElement(),r=this.getRect(i,[Ai(i),Gi(i)]),s=void 0===t.margin?20:t.margin;if(!Lt(n,r)){var o=r[0]-n[0],a=n[2]-r[2],u=r[1]-n[1],l=n[3]-r[3],h=[0,0];if(o<0?h[0]=o-s:a<0&&(h[0]=Math.abs(a)+s),u<0?h[1]=u-s:l<0&&(h[1]=Math.abs(l)+s),0!==h[0]||0!==h[1]){var c=e.getView().getCenterInternal(),f=e.getPixelFromCoordinateInternal(c),d=[f[0]+h[0],f[1]+h[1]],g=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(d),duration:g.duration,easing:g.easing})}}}}},{key:"getRect",value:function(t,e){var n=t.getBoundingClientRect(),i=n.left+window.pageXOffset,r=n.top+window.pageYOffset;return[i,r,i+e[0],r+e[1]]}},{key:"setPositioning",value:function(t){this.set(Wi,t)}},{key:"setVisible",value:function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}},{key:"updatePixelPosition",value:function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var n=t.getPixelFromCoordinate(e),i=t.getSize();this.updateRenderedPosition(n,i)}else this.setVisible(!1)}},{key:"updateRenderedPosition",value:function(t,e){var n=this.element.style,i=this.getOffset(),r=this.getPositioning();this.setVisible(!0);var s=Math.round(t[0]+i[0])+"px",o=Math.round(t[1]+i[1])+"px",a="0%",u="0%";r==xi||r==Ci||"top-right"==r?a="-100%":r!=ki&&r!=Ei&&"top-center"!=r||(a="-50%"),"bottom-left"==r||r==ki||r==xi?u="-100%":"center-left"!=r&&r!=Ei&&r!=Ci||(u="-50%");var l="translate(".concat(a,", ").concat(u,") translate(").concat(s,", ").concat(o,")");this.rendered.transform_!=l&&(this.rendered.transform_=l,n.transform=l,n.msTransform=l)}},{key:"getOptions",value:function(){return this.options}}]),n}(),ji=function(t){s(n,tt);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).element=t.element?t.element:null,i.target_=null,i.map_=null,i.listenerKeys=[],i.render_=t.render?t.render:U,t.target&&i.setTarget(t.target),i}return g(n,[{key:"disposeInternal",value:function(){Vi(this.element),i(c(n.prototype),"disposeInternal",this).call(this)}},{key:"getMap",value:function(){return this.map_}},{key:"setMap",value:function(t){this.map_&&Vi(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)I(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==U&&this.listenerKeys.push(E(t,mi,this.render,this)),t.render())}},{key:"render",value:function(t){this.render_.call(this,t)}},{key:"setTarget",value:function(t){this.target_="string"==typeof t?document.getElementById(t):t}}]),n}(),Ki=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{};i=e.call(this,{element:document.createElement("div"),target:r.target});var s=void 0!==r.className?r.className:"ol-zoom",o=void 0!==r.delta?r.delta:1,a=void 0!==r.zoomInLabel?r.zoomInLabel:"+",u=void 0!==r.zoomOutLabel?r.zoomOutLabel:"−",h=void 0!==r.zoomInTipLabel?r.zoomInTipLabel:"Zoom in",c=void 0!==r.zoomOutTipLabel?r.zoomOutTipLabel:"Zoom out",d=document.createElement("button");d.className=s+"-in",d.setAttribute("type","button"),d.title=h,d.appendChild("string"==typeof a?document.createTextNode(a):a),d.addEventListener(L,i.handleClick_.bind(l(i),o),!1);var g=document.createElement("button");g.className=s+"-out",g.setAttribute("type","button"),g.title=c,g.appendChild("string"==typeof u?document.createTextNode(u):u),g.addEventListener(L,i.handleClick_.bind(l(i),-o),!1);var v=s+" ol-unselectable ol-control",_=i.element;return _.className=v,_.appendChild(d),_.appendChild(g),i.duration_=void 0!==r.duration?r.duration:250,i}return g(n,[{key:"handleClick_",value:function(t,e){e.preventDefault(),this.zoomByDelta_(t)}},{key:"zoomByDelta_",value:function(t){var e=this.getMap().getView();if(e){var n=e.getZoom();if(void 0!==n){var i=e.getConstrainedZoom(n+t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({zoom:i,duration:this.duration_,easing:di})):e.setZoom(i)}}}}]),n}();function Zi(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var i="rotate("+n+"rad)";if(this.autoHide_){var r=this.element.classList.contains("ol-hidden");r||0!==n?r&&0!==n&&this.element.classList.remove("ol-hidden"):this.element.classList.add("ol-hidden")}this.label_.style.transform=i}this.rotation_=n}}var Ji=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{};i=e.call(this,{element:document.createElement("div"),render:r.render||Zi,target:r.target});var s=void 0!==r.className?r.className:"ol-rotate",o=void 0!==r.label?r.label:"⇧";i.label_=null,"string"==typeof o?(i.label_=document.createElement("span"),i.label_.className="ol-compass",i.label_.textContent=o):(i.label_=o,i.label_.classList.add("ol-compass"));var a=r.tipLabel?r.tipLabel:"Reset rotation",u=document.createElement("button");u.className=s+"-reset",u.setAttribute("type","button"),u.title=a,u.appendChild(i.label_),u.addEventListener(L,i.handleClick_.bind(l(i)),!1);var h=s+" ol-unselectable ol-control",c=i.element;return c.className=h,c.appendChild(u),i.callResetNorth_=r.resetNorth?r.resetNorth:void 0,i.duration_=void 0!==r.duration?r.duration:250,i.autoHide_=void 0===r.autoHide||r.autoHide,i.rotation_=void 0,i.autoHide_&&i.element.classList.add("ol-hidden"),i}return g(n,[{key:"handleClick_",value:function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}},{key:"resetNorth_",value:function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:di}):t.setRotation(0))}}}]),n}(),Qi=(r(4),"pointermove"),$i="pointerdown",tr="pointerup",er=0;function nr(t){if(t.frameState){this.sliderInitialized_||this.initSlider_();var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}}var ir=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{};(i=e.call(this,{element:document.createElement("div"),render:r.render||nr})).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=er,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==r.duration?r.duration:200;var s=void 0!==r.className?r.className:"ol-zoomslider",o=document.createElement("button");o.setAttribute("type","button"),o.className=s+"-thumb ol-unselectable";var a=i.element;return a.className=s+" ol-unselectable ol-control",a.appendChild(o),a.addEventListener($i,i.handleDraggerStart_.bind(l(i)),!1),a.addEventListener(Qi,i.handleDraggerDrag_.bind(l(i)),!1),a.addEventListener(tr,i.handleDraggerEnd_.bind(l(i)),!1),a.addEventListener(L,i.handleContainerClick_.bind(l(i)),!1),o.addEventListener(L,W,!1),i}return g(n,[{key:"setMap",value:function(t){i(c(n.prototype),"setMap",this).call(this,t),t&&t.render()}},{key:"initSlider_",value:function(){var t=this.element,e=t.offsetWidth,n=t.offsetHeight,i=t.firstElementChild,r=getComputedStyle(i),s=i.offsetWidth+parseFloat(r.marginRight)+parseFloat(r.marginLeft),o=i.offsetHeight+parseFloat(r.marginTop)+parseFloat(r.marginBottom);this.thumbSize_=[s,o],e>n?(this.direction_=1,this.widthLimit_=e-s):(this.direction_=er,this.heightLimit_=n-o),this.sliderInitialized_=!0}},{key:"handleContainerClick_",value:function(t){var e=this.getMap().getView(),n=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),i=this.getResolutionForPosition_(n),r=e.getConstrainedZoom(e.getZoomForResolution(i));e.animateInternal({zoom:r,duration:this.duration_,easing:di})}},{key:"handleDraggerStart_",value:function(t){if(!this.dragging_&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var n=this.handleDraggerDrag_,i=this.handleDraggerEnd_;this.dragListenerKeys_.push(E(document,Qi,n,this),E(document,tr,i,this))}}}},{key:"handleDraggerDrag_",value:function(t){if(this.dragging_){var e=t.clientX-this.startX_,n=t.clientY-this.startY_,i=this.getRelativePosition_(e,n);this.currentResolution_=this.getResolutionForPosition_(i),this.getMap().getView().setResolution(this.currentResolution_)}}},{key:"handleDraggerEnd_",value:function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(I),this.dragListenerKeys_.length=0)}},{key:"setThumbPosition_",value:function(t){var e=this.getPositionForResolution_(t),n=this.element.firstElementChild;1==this.direction_?n.style.left=this.widthLimit_*e+"px":n.style.top=this.heightLimit_*e+"px"}},{key:"getRelativePosition_",value:function(t,e){return nt(1===this.direction_?t/this.widthLimit_:e/this.heightLimit_,0,1)}},{key:"getResolutionForPosition_",value:function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)}},{key:"getPositionForResolution_",value:function(t){return nt(1-this.getMap().getView().getValueForResolutionFunction()(t),0,1)}}]),n}(),rr="degrees",sr="metric",or=[1,2,5];function ar(t){var e=t.frameState;this.viewState_=e?e.viewState:null,this.updateElement_()}var ur=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=void 0!==r.className?r.className:r.bar?"ol-scale-bar":"ol-scale-line";return(i=e.call(this,{element:document.createElement("div"),render:r.render||ar,target:r.target})).innerElement_=document.createElement("div"),i.innerElement_.className=s+"-inner",i.element.className=s+" ol-unselectable",i.element.appendChild(i.innerElement_),i.viewState_=null,i.minWidth_=void 0!==r.minWidth?r.minWidth:64,i.renderedVisible_=!1,i.renderedWidth_=void 0,i.renderedHTML_="",i.addEventListener($("units"),i.handleUnitsChanged_),i.setUnits(r.units||sr),i.scaleBar_=r.bar||!1,i.scaleBarSteps_=r.steps||4,i.scaleBarText_=r.text||!1,i}return g(n,[{key:"getUnits",value:function(){return this.get("units")}},{key:"handleUnitsChanged_",value:function(){this.updateElement_()}},{key:"setUnits",value:function(t){this.set("units",t)}},{key:"updateElement_",value:function(){var t=this.viewState_;if(t){var e=t.center,n=t.projection,i=this.getUnits(),r=i==rr?ee.DEGREES:ee.METERS,s=function(t,e,n,i){var r,s=(t=pe(t)).getPointResolutionFunc();if(s){if(r=s(e,n),i&&i!==t.getUnits()){var o=t.getMetersPerUnit();o&&(r=r*o/te[i])}}else if(t.getUnits()==ee.DEGREES&&!i||i==ee.DEGREES)r=e;else{var a=xe(t,pe("EPSG:4326")),u=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];r=(yt((u=a(u,u,2)).slice(0,2),u.slice(2,4))+yt(u.slice(4,6),u.slice(6,8)))/2;var l=i?te[i]:t.getMetersPerUnit();void 0!==l&&(r/=l)}return r}(n,t.resolution,e,r),o=this.minWidth_*s,a="";if(i==rr){var u=te[ee.DEGREES];(o*=u)<u/60?(a="″",s*=3600):o<u?(a="′",s*=60):a="°"}else"imperial"==i?o<.9144?(a="in",s/=.0254):o<1609.344?(a="ft",s/=.3048):(a="mi",s/=1609.344):"nautical"==i?(s/=1852,a="nm"):i==sr?o<.001?(a="μm",s*=1e6):o<1?(a="mm",s*=1e3):o<1e3?a="m":(a="km",s/=1e3):"us"==i?o<.9144?(a="in",s*=39.37):o<1609.344?(a="ft",s/=.30480061):(a="mi",s/=1609.3472):y(!1,33);for(var l,h,c,f,d=3*Math.floor(Math.log(this.minWidth_*s)/Math.log(10));;){c=Math.floor(d/3);var g=Math.pow(10,c);if(l=or[(d%3+3)%3]*g,h=Math.round(l/s),isNaN(h))return this.element.style.display="none",void(this.renderedVisible_=!1);if(h>=this.minWidth_)break;++d}f=this.scaleBar_?this.createScaleBar(h,l,a):l.toFixed(c<0?-c:0)+" "+a,this.renderedHTML_!=f&&(this.innerElement_.innerHTML=f,this.renderedHTML_=f),this.renderedWidth_!=h&&(this.innerElement_.style.width=h+"px",this.renderedWidth_=h),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"createScaleBar",value:function(t,e,n){for(var i="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),r=[],s=t/this.scaleBarSteps_,o="#ffffff",a=0;a<this.scaleBarSteps_;a++)0===a&&r.push(this.createMarker("absolute",a)),r.push('<div><div class="ol-scale-singlebar" style="width: '+s+"px;background-color: "+o+';"></div>'+this.createMarker("relative",a)+(a%2==0||2===this.scaleBarSteps_?this.createStepText(a,t,!1,e,n):"")+"</div>"),a===this.scaleBarSteps_-1&&r.push(this.createStepText(a+1,t,!0,e,n)),o="#ffffff"===o?"#000000":"#ffffff";return'<div style="display: flex;">'+(this.scaleBarText_?'<div class="ol-scale-text" style="width: '+t+'px;">'+i+"</div>":"")+r.join("")+"</div>"}},{key:"createMarker",value:function(t,e){return'<div class="ol-scale-step-marker" style="position: '+t+";top: "+("absolute"===t?3:-10)+'px;"></div>'}},{key:"createStepText",value:function(t,e,n,i,r){var s=(0===t?0:Math.round(i/this.scaleBarSteps_*t*100)/100)+(0===t?"":" "+r);return'<div class="ol-scale-step-text" style="margin-left: '+(0===t?-3:e/this.scaleBarSteps_*-1)+"px;text-align: "+(0===t?"left":"center")+"; min-width: "+(0===t?0:e/this.scaleBarSteps_*2)+"px;left: "+(n?e+"px":"unset")+';">'+s+"</div>"}},{key:"getScaleForResolution",value:function(){var t=this.getMap().getView().getResolution(),e=this.viewState_.projection.getMetersPerUnit();return parseFloat(t.toString())*e*39.37*(25.4/.28)}}]),n}(),lr="add",hr="remove",cr=function(t){s(n,H);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t)).element=i,s.index=r,s}return n}(),fr=function(t){s(n,tt);var e=a(n);function n(t,i){var r;f(this,n);var s=i||{};if((r=e.call(this)).unique_=!!s.unique,r.array_=t||[],r.unique_)for(var o=0,a=r.array_.length;o<a;++o)r.assertUnique_(r.array_[o],o);return r.updateLength_(),r}return g(n,[{key:"clear",value:function(){for(;this.getLength()>0;)this.pop()}},{key:"extend",value:function(t){for(var e=0,n=t.length;e<n;++e)this.push(t[e]);return this}},{key:"forEach",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)t(e[n],n,e)}},{key:"getArray",value:function(){return this.array_}},{key:"item",value:function(t){return this.array_[t]}},{key:"getLength",value:function(){return this.get("length")}},{key:"insertAt",value:function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new cr(lr,e,t))}},{key:"pop",value:function(){return this.removeAt(this.getLength()-1)}},{key:"push",value:function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}},{key:"remove",value:function(t){for(var e=this.array_,n=0,i=e.length;n<i;++n)if(e[n]===t)return this.removeAt(n)}},{key:"removeAt",value:function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new cr(hr,e,t)),e}},{key:"setAt",value:function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new cr(hr,i,t)),this.dispatchEvent(new cr(lr,e,t))}else{for(var r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}}},{key:"updateLength_",value:function(){this.set("length",this.array_.length)}},{key:"assertUnique_",value:function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new _(58)}}]),n}(),dr=function(t){s(n,H);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t)).map=i,s.frameState=void 0!==r?r:null,s}return n}(),gr=function(t){s(n,dr);var e=a(n);function n(t,i,r,s,o){var a;return f(this,n),(a=e.call(this,t,i,o)).originalEvent=r,a.pixel_=null,a.coordinate_=null,a.dragging=void 0!==s&&s,a}return g(n,[{key:"preventDefault",value:function(){i(c(n.prototype),"preventDefault",this).call(this),this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){i(c(n.prototype),"stopPropagation",this).call(this),this.originalEvent.stopPropagation()}},{key:"pixel",get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t}},{key:"coordinate",get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t}}]),n}(),vr={SINGLECLICK:"singleclick",CLICK:L,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},_r=function(t){s(n,gr);var e=a(n);function n(t,i,r,s,o){var a;return f(this,n),(a=e.call(this,t,i,r,s,o)).pointerEvent=r,a}return n}(),yr=function(t){s(n,j);var e=a(n);function n(t,i){var r;f(this,n),(r=e.call(this,t)).map_=t,r.clickTimeoutId_,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=i?i*Pi:Pi,r.down_=null;var s=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=s,r.pointerdownListenerKey_=E(s,$i,r.handlePointerDown_,l(r)),r.originalPointerMoveEvent_,r.relayedListenerKey_=E(s,Qi,r.relayEvent_,l(r)),r.boundHandleTouchMove_=r.handleTouchMove_.bind(l(r)),r.element_.addEventListener(M,r.boundHandleTouchMove_,!!Fi&&{passive:!1}),r}return g(n,[{key:"emulateClick_",value:function(t){var e=new _r(vr.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new _r(vr.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new _r(vr.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)}},{key:"updateActivePointers_",value:function(t){var e=t;e.type==vr.POINTERUP||e.type==vr.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==vr.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length}},{key:"handlePointerUp_",value:function(t){this.updateActivePointers_(t);var e=new _r(vr.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(I),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}},{key:"isMouseActionButton_",value:function(t){return 0===t.button}},{key:"handlePointerDown_",value:function(t){this.updateActivePointers_(t);var e=new _r(vr.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(E(document,vr.POINTERMOVE,this.handlePointerMove_,this),E(document,vr.POINTERUP,this.handlePointerUp_,this),E(this.element_,vr.POINTERCANCEL,this.handlePointerUp_,this))}},{key:"handlePointerMove_",value:function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new _r(vr.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}}},{key:"relayEvent_",value:function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new _r(t.type,this.map_,t,e))}},{key:"handleTouchMove_",value:function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()}},{key:"isMoving_",value:function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}},{key:"disposeInternal",value:function(){this.relayedListenerKey_&&(I(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(M,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(I(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(I),this.dragListenerKeys_.length=0,this.element_=null,i(c(n.prototype),"disposeInternal",this).call(this)}}]),n}(),pr="layergroup",mr="size",kr="target",xr="view",Er="precompose",Cr="rendercomplete",Ir=function(){function t(e,n){f(this,t),this.priorityFunction_=e,this.keyFunction_=n,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return g(t,[{key:"clear",value:function(){this.elements_.length=0,this.priorities_.length=0,m(this.queuedElements_)}},{key:"dequeue",value:function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n}},{key:"enqueue",value:function(t){y(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}},{key:"getCount",value:function(){return this.elements_.length}},{key:"getLeftChildIndex_",value:function(t){return 2*t+1}},{key:"getRightChildIndex_",value:function(t){return 2*t+2}},{key:"getParentIndex_",value:function(t){return t-1>>1}},{key:"heapify_",value:function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}},{key:"isEmpty",value:function(){return 0===this.elements_.length}},{key:"isKeyQueued",value:function(t){return t in this.queuedElements_}},{key:"isQueued",value:function(t){return this.isKeyQueued(this.keyFunction_(t))}},{key:"siftUp_",value:function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,r=e[t],s=n[t],o=t;t<i>>1;){var a=this.getLeftChildIndex_(t),u=this.getRightChildIndex_(t),l=u<i&&n[u]<n[a]?u:a;e[t]=e[l],n[t]=n[l],t=l}e[t]=r,n[t]=s,this.siftDown_(o,t)}},{key:"siftDown_",value:function(t,e){for(var n=this.elements_,i=this.priorities_,r=n[e],s=i[e];e>t;){var o=this.getParentIndex_(e);if(!(i[o]>s))break;n[e]=n[o],i[e]=i[o],e=o}n[e]=r,i[e]=s}},{key:"reprioritize",value:function(){var t,e,n,i=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,a=r.length;for(e=0;e<a;++e)(n=i(t=r[e]))==1/0?delete this.queuedElements_[this.keyFunction_(t)]:(s[o]=n,r[o++]=t);r.length=o,s.length=o,this.heapify_()}}]),t}(),Sr=function(t){s(n,Ir);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this,function(e){return t.apply(null,e)},function(t){return t[0].getKey()})).boundHandleTileChange_=r.handleTileChange.bind(l(r)),r.tileChangeCallback_=i,r.tilesLoading_=0,r.tilesLoadingKeys_={},r}return g(n,[{key:"enqueue",value:function(t){var e=i(c(n.prototype),"enqueue",this).call(this,t);return e&&t[0].addEventListener(S,this.boundHandleTileChange_),e}},{key:"getTilesLoading",value:function(){return this.tilesLoading_}},{key:"handleTileChange",value:function(t){var e=t.target,n=e.getState();if(e.hifi&&2===n||3===n||4===n){e.removeEventListener(S,this.boundHandleTileChange_);var i=e.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}}},{key:"loadMoreTiles",value:function(t,e){for(var n,i,r=0;this.tilesLoading_<t&&r<e&&this.getCount()>0;)i=(n=this.dequeue()[0]).getKey(),0!==n.getState()||i in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[i]=!0,++this.tilesLoading_,++r,n.load())}}]),n}(),wr="opacity",Nr="visible",Lr="zIndex",Rr="maxResolution",Tr="minResolution",br="maxZoom",Pr="minZoom",Mr="source",Or=function(t){s(n,tt);var e=a(n);function n(t){var i;f(this,n),i=e.call(this);var r=p({},t);return r[wr]=void 0!==t.opacity?t.opacity:1,y("number"==typeof r[wr],64),r[Nr]=void 0===t.visible||t.visible,r[Lr]=t.zIndex,r[Rr]=void 0!==t.maxResolution?t.maxResolution:1/0,r[Tr]=void 0!==t.minResolution?t.minResolution:0,r[Pr]=void 0!==t.minZoom?t.minZoom:-1/0,r[br]=void 0!==t.maxZoom?t.maxZoom:1/0,i.className_=void 0!==r.className?t.className:"ol-layer",delete r.className,i.setProperties(r),i.state_=null,i}return g(n,[{key:"getClassName",value:function(){return this.className_}},{key:"getLayerState",value:function(t){var e=this.state_||{layer:this,managed:void 0===t||t},n=this.getZIndex();return e.opacity=nt(Math.round(100*this.getOpacity())/100,0,1),e.sourceState=this.getSourceState(),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=void 0!==n?n:!1===e.managed?1/0:0,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}},{key:"getLayersArray",value:function(t){return o()}},{key:"getLayerStatesArray",value:function(t){return o()}},{key:"getExtent",value:function(){return this.get("extent")}},{key:"getMaxResolution",value:function(){return this.get(Rr)}},{key:"getMinResolution",value:function(){return this.get(Tr)}},{key:"getMinZoom",value:function(){return this.get(Pr)}},{key:"getMaxZoom",value:function(){return this.get(br)}},{key:"getOpacity",value:function(){return this.get(wr)}},{key:"getSourceState",value:function(){return o()}},{key:"getVisible",value:function(){return this.get(Nr)}},{key:"getZIndex",value:function(){return this.get(Lr)}},{key:"setExtent",value:function(t){this.set("extent",t)}},{key:"setMaxResolution",value:function(t){this.set(Rr,t)}},{key:"setMinResolution",value:function(t){this.set(Tr,t)}},{key:"setMaxZoom",value:function(t){this.set(br,t)}},{key:"setMinZoom",value:function(t){this.set(Pr,t)}},{key:"setOpacity",value:function(t){y("number"==typeof t,64),this.set(wr,t)}},{key:"setVisible",value:function(t){this.set(Nr,t)}},{key:"setZIndex",value:function(t){this.set(Lr,t)}},{key:"disposeInternal",value:function(){this.state_&&(this.state_.layer=null,this.state_=null),i(c(n.prototype),"disposeInternal",this).call(this)}}]),n}(),Fr="undefined",Dr="ready",Ar="layers",Gr=function(t){s(n,Or);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=p({},r);delete s.layers;var o=r.layers;return(i=e.call(this,s)).layersListenerKeys_=[],i.listenerKeys_={},i.addEventListener($(Ar),i.handleLayersChanged_),o?Array.isArray(o)?o=new fr(o.slice(),{unique:!0}):y("function"==typeof o.getArray,43):o=new fr(void 0,{unique:!0}),i.setLayers(o),i}return g(n,[{key:"handleLayerChange_",value:function(){this.changed()}},{key:"handleLayersChanged_",value:function(){this.layersListenerKeys_.forEach(I),this.layersListenerKeys_.length=0;var t=this.getLayers();for(var e in this.layersListenerKeys_.push(E(t,lr,this.handleLayersAdd_,this),E(t,hr,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[e].forEach(I);m(this.listenerKeys_);for(var n=t.getArray(),i=0,r=n.length;i<r;i++){var s=n[i];this.listenerKeys_[d(s)]=[E(s,F,this.handleLayerChange_,this),E(s,S,this.handleLayerChange_,this)]}this.changed()}},{key:"handleLayersAdd_",value:function(t){var e=t.element;this.listenerKeys_[d(e)]=[E(e,F,this.handleLayerChange_,this),E(e,S,this.handleLayerChange_,this)],this.changed()}},{key:"handleLayersRemove_",value:function(t){var e=d(t.element);this.listenerKeys_[e].forEach(I),delete this.listenerKeys_[e],this.changed()}},{key:"getLayers",value:function(){return this.get(Ar)}},{key:"setLayers",value:function(t){this.set(Ar,t)}},{key:"getLayersArray",value:function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}},{key:"getLayerStatesArray",value:function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});for(var i=this.getLayerState(),r=n,s=e.length;r<s;r++){var o=e[r];o.opacity*=i.opacity,o.visible=o.visible&&i.visible,o.maxResolution=Math.min(o.maxResolution,i.maxResolution),o.minResolution=Math.max(o.minResolution,i.minResolution),o.minZoom=Math.max(o.minZoom,i.minZoom),o.maxZoom=Math.min(o.maxZoom,i.maxZoom),void 0!==i.extent&&(void 0!==o.extent?o.extent=Wt(o.extent,i.extent):o.extent=i.extent)}return e}},{key:"getSourceState",value:function(){return Dr}}]),n}(),Br=function(t){s(n,tt);var e=a(n);function n(t){var i;f(this,n),i=e.call(this);var r=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n,i,r,s={},o=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new Gr({layers:t.layers});return s[pr]=o,s[kr]=t.target,s[xr]=void 0!==t.view?t.view:new pi,void 0!==t.controls&&(Array.isArray(t.controls)?n=new fr(t.controls.slice()):(y("function"==typeof t.controls.getArray,47),n=t.controls)),void 0!==t.interactions&&(Array.isArray(t.interactions)?i=new fr(t.interactions.slice()):(y("function"==typeof t.interactions.getArray,48),i=t.interactions)),void 0!==t.overlays?Array.isArray(t.overlays)?r=new fr(t.overlays.slice()):(y("function"==typeof t.overlays.getArray,49),r=t.overlays):r=new fr,{controls:n,interactions:i,keyboardEventTarget:e,overlays:r,values:s}}(t);i.boundHandleBrowserEvent_=i.handleBrowserEvent.bind(l(i)),i.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,i.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Pi,i.postRenderTimeoutHandle_,i.animationDelayKey_,i.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(l(i)),i.coordinateToPixelTransform_=[1,0,0,1,0,0],i.pixelToCoordinateTransform_=[1,0,0,1,0,0],i.frameIndex_=0,i.frameState_=null,i.previousExtent_=null,i.viewPropertyListenerKey_=null,i.viewChangeListenerKey_=null,i.layerGroupPropertyListenerKeys_=null,i.viewport_=document.createElement("div"),i.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),i.viewport_.style.position="relative",i.viewport_.style.overflow="hidden",i.viewport_.style.width="100%",i.viewport_.style.height="100%",i.overlayContainer_=document.createElement("div"),i.overlayContainer_.style.position="absolute",i.overlayContainer_.style.zIndex="0",i.overlayContainer_.style.width="100%",i.overlayContainer_.style.height="100%",i.overlayContainer_.className="ol-overlaycontainer",i.viewport_.appendChild(i.overlayContainer_),i.overlayContainerStopEvent_=document.createElement("div"),i.overlayContainerStopEvent_.style.position="absolute",i.overlayContainerStopEvent_.style.zIndex="0",i.overlayContainerStopEvent_.style.width="100%",i.overlayContainerStopEvent_.style.height="100%",i.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",i.viewport_.appendChild(i.overlayContainerStopEvent_),i.mapBrowserEventHandler_=new yr(l(i),t.moveTolerance);var s=i.handleMapBrowserEvent.bind(l(i));for(var o in vr)i.mapBrowserEventHandler_.addEventListener(vr[o],s);i.keyboardEventTarget_=r.keyboardEventTarget,i.keyHandlerKeys_=null;var a=i.handleBrowserEvent.bind(l(i));return i.viewport_.addEventListener(N,a,!1),i.viewport_.addEventListener(O,a,!!Fi&&{passive:!1}),i.controls=r.controls||new fr,i.interactions=r.interactions||new fr,i.overlays_=r.overlays,i.overlayIdIndex_={},i.renderer_=null,i.handleResize_,i.postRenderFunctions_=[],i.tileQueue_=new Sr(i.getTilePriority.bind(l(i)),i.handleTileChange_.bind(l(i))),i.addEventListener($(pr),i.handleLayerGroupChanged_),i.addEventListener($(xr),i.handleViewChanged_),i.addEventListener($(mr),i.handleSizeChanged_),i.addEventListener($(kr),i.handleTargetChanged_),i.setProperties(r.values),i.controls.forEach(function(t){t.setMap(this)}.bind(l(i))),i.controls.addEventListener(lr,function(t){t.element.setMap(this)}.bind(l(i))),i.controls.addEventListener(hr,function(t){t.element.setMap(null)}.bind(l(i))),i.interactions.forEach(function(t){t.setMap(this)}.bind(l(i))),i.interactions.addEventListener(lr,function(t){t.element.setMap(this)}.bind(l(i))),i.interactions.addEventListener(hr,function(t){t.element.setMap(null)}.bind(l(i))),i.overlays_.forEach(i.addOverlayInternal_.bind(l(i))),i.overlays_.addEventListener(lr,function(t){this.addOverlayInternal_(t.element)}.bind(l(i))),i.overlays_.addEventListener(hr,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(l(i))),i}return g(n,[{key:"createRenderer",value:function(){throw new Error("Use a map type that has a createRenderer method")}},{key:"addControl",value:function(t){this.getControls().push(t)}},{key:"addInteraction",value:function(t){this.getInteractions().push(t)}},{key:"addLayer",value:function(t){this.getLayerGroup().getLayers().push(t)}},{key:"addOverlay",value:function(t){this.getOverlays().push(t)}},{key:"addOverlayInternal_",value:function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}},{key:"disposeInternal",value:function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(N,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(O,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(P,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),i(c(n.prototype),"disposeInternal",this).call(this)}},{key:"forEachFeatureAtPixel",value:function(t,e,n){if(this.frameState_){var i=this.getCoordinateFromPixelInternal(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,s=void 0!==n.layerFilter?n.layerFilter:Y,o=!1!==n.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,o,e,null,s,null)}}},{key:"getFeaturesAtPixel",value:function(t,e){var n=[];return this.forEachFeatureAtPixel(t,function(t){n.push(t)},e),n}},{key:"forEachLayerAtPixel",value:function(t,e,n){if(this.frameState_){var i=n||{},r=void 0!==i.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,s=i.layerFilter||Y;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,r,e,s)}}},{key:"hasFeatureAtPixel",value:function(t,e){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:Y,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0,s=!1!==e.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,s,i,null)}},{key:"getEventCoordinate",value:function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}},{key:"getEventCoordinateInternal",value:function(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}},{key:"getEventPixel",value:function(t){var e=this.viewport_.getBoundingClientRect(),n="changedTouches"in t?t.changedTouches[0]:t;return[n.clientX-e.left,n.clientY-e.top]}},{key:"getTarget",value:function(){return this.get(kr)}},{key:"getTargetElement",value:function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null}},{key:"getCoordinateFromPixel",value:function(t){return Te(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}},{key:"getCoordinateFromPixelInternal",value:function(t){var e=this.frameState_;return e?Ue(e.pixelToCoordinateTransform,t.slice()):null}},{key:"getControls",value:function(){return this.controls}},{key:"getOverlays",value:function(){return this.overlays_}},{key:"getOverlayById",value:function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null}},{key:"getInteractions",value:function(){return this.interactions}},{key:"getLayerGroup",value:function(){return this.get(pr)}},{key:"getLayers",value:function(){return this.getLayerGroup().getLayers()}},{key:"getLoading",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer.getSource();if(i&&i.loading)return!0}return!1}},{key:"getPixelFromCoordinate",value:function(t){var e=be(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}},{key:"getPixelFromCoordinateInternal",value:function(t){var e=this.frameState_;return e?Ue(e.coordinateToPixelTransform,t.slice(0,2)):null}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"getSize",value:function(){return this.get(mr)}},{key:"getView",value:function(){return this.get(xr)}},{key:"getViewport",value:function(){return this.viewport_}},{key:"getOverlayContainer",value:function(){return this.overlayContainer_}},{key:"getOverlayContainerStopEvent",value:function(){return this.overlayContainerStopEvent_}},{key:"getTilePriority",value:function(t,e,n,i){return function(t,e,n,i,r){if(!(t&&n in t.wantedTiles))return 1/0;if(!t.wantedTiles[n][e.getKey()])return 1/0;var s=t.viewState.center,o=i[0]-s[0],a=i[1]-s[1];return 65536*Math.log(r)+Math.sqrt(o*o+a*a)/r}(this.frameState_,t,e,n,i)}},{key:"handleBrowserEvent",value:function(t,e){var n=e||t.type,i=new gr(n,this,t);this.handleMapBrowserEvent(i)}},{key:"handleMapBrowserEvent",value:function(t){if(this.frameState_){var e=t.originalEvent.target;if(t.dragging||!this.overlayContainerStopEvent_.contains(e)&&(document.body.contains(e)||this.viewport_.getRootNode&&this.viewport_.getRootNode().contains(e))){t.frameState=this.frameState_;var n=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(var i=n.length-1;i>=0;i--){var r=n[i];if(r.getActive()&&!r.handleEvent(t))break}}}}},{key:"handlePostRender",value:function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=this.maxTilesLoading_,i=n;if(t){var r=t.viewHints;if(r[0]||r[1]){var s=!Oi&&Date.now()-t.time>8;n=s?0:8,i=s?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}!t||!this.hasListener(Cr)||t.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(Cr,t);for(var o=this.postRenderFunctions_,a=0,u=o.length;a<u;++a)o[a](this,t);o.length=0}},{key:"handleSizeChanged_",value:function(){this.getView()&&this.getView().resolveConstraints(0),this.render()}},{key:"handleTargetChanged_",value:function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,n=this.keyHandlerKeys_.length;e<n;++e)I(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[E(i,R,this.handleBrowserEvent,this),E(i,T,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(P,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),Vi(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(P,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()}},{key:"handleTileChange_",value:function(){this.render()}},{key:"handleViewPropertyChanged_",value:function(){this.render()}},{key:"handleViewChanged_",value:function(){this.viewPropertyListenerKey_&&(I(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(I(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=E(t,F,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=E(t,S,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}},{key:"handleLayerGroupChanged_",value:function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(I),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[E(t,F,this.render,this),E(t,S,this.render,this)]),this.render()}},{key:"isRendered",value:function(){return!!this.frameState_}},{key:"renderSync",value:function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}},{key:"redrawText",value:function(){for(var t=this.getLayerGroup().getLayerStatesArray(),e=0,n=t.length;e<n;++e){var i=t[e].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}}},{key:"render",value:function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}},{key:"removeControl",value:function(t){return this.getControls().remove(t)}},{key:"removeInteraction",value:function(t){return this.getInteractions().remove(t)}},{key:"removeLayer",value:function(t){return this.getLayerGroup().getLayers().remove(t)}},{key:"removeOverlay",value:function(t){return this.getOverlays().remove(t)}},{key:"renderFrame_",value:function(t){var e=this.getSize(),n=this.getView(),i=this.frameState_,r=null;if(void 0!==e&&function(t){return t[0]>0&&t[1]>0}(e)&&n&&n.isDef()){var s=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),o=n.getState();r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:i?i.declutterItems:[],extent:Xt(o.center,o.resolution,o.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:o,viewHints:s,wantedTiles:{}}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),i&&(!this.previousExtent_||!Jt(this.previousExtent_)&&!Ft(r.extent,this.previousExtent_))&&(this.dispatchEvent(new dr("movestart",this,i)),this.previousExtent_=Pt(this.previousExtent_)),this.previousExtent_&&!r.viewHints[0]&&!r.viewHints[1]&&!Ft(r.extent,this.previousExtent_)&&(this.dispatchEvent(new dr("moveend",this,r)),wt(r.extent,this.previousExtent_))),this.dispatchEvent(new dr(mi,this,r)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)}},{key:"setLayerGroup",value:function(t){this.set(pr,t)}},{key:"setSize",value:function(t){this.set(mr,t)}},{key:"setTarget",value:function(t){this.set(kr,t)}},{key:"setView",value:function(t){this.set(xr,t)}},{key:"updateSize",value:function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()}},{key:"updateViewportSize_",value:function(){var t=this.getView();if(t){var e=void 0,n=getComputedStyle(this.viewport_);n.width&&n.height&&(e=[parseInt(n.width,10),parseInt(n.height,10)]),t.setViewportSize(e)}}}]),n}();function Vr(t,e){if(!t.visible)return!1;var n=e.resolution;if(n<t.minResolution||n>=t.maxResolution)return!1;var i=e.zoom;return i>t.minZoom&&i<=t.maxZoom}var zr=function(t){s(n,Or);var e=a(n);function n(t){var i;f(this,n);var r=p({},t);delete r.source,(i=e.call(this,r)).mapPrecomposeKey_=null,i.mapRenderKey_=null,i.sourceChangeKey_=null,i.renderer_=null,t.render&&(i.render=t.render),t.map&&i.setMap(t.map),i.addEventListener($(Mr),i.handleSourcePropertyChange_);var s=t.source?t.source:null;return i.setSource(s),i}return g(n,[{key:"getLayersArray",value:function(t){var e=t||[];return e.push(this),e}},{key:"getLayerStatesArray",value:function(t){var e=t||[];return e.push(this.getLayerState()),e}},{key:"getSource",value:function(){return this.get(Mr)||null}},{key:"getSourceState",value:function(){var t=this.getSource();return t?t.getState():Fr}},{key:"handleSourceChange_",value:function(){this.changed()}},{key:"handleSourcePropertyChange_",value:function(){this.sourceChangeKey_&&(I(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=E(t,S,this.handleSourceChange_,this)),this.changed()}},{key:"getFeatures",value:function(t){return this.renderer_.getFeatures(t)}},{key:"render",value:function(t,e){var n=this.getRenderer();if(n.prepareFrame(t))return n.renderFrame(t,e)}},{key:"setMap",value:function(t){this.mapPrecomposeKey_&&(I(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(I(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=E(t,Er,function(t){var e=t.frameState.layerStatesArray,n=this.getLayerState(!1);y(!e.some(function(t){return t.layer===n.layer}),67),e.push(n)},this),this.mapRenderKey_=E(this,S,t.render,t),this.changed())}},{key:"setSource",value:function(t){this.set(Mr,t)}},{key:"getRenderer",value:function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}},{key:"hasRenderer",value:function(){return!!this.renderer_}},{key:"createRenderer",value:function(){return null}},{key:"disposeInternal",value:function(){this.setSource(null),i(c(n.prototype),"disposeInternal",this).call(this)}}]),n}(),qr=function(t){s(n,H);var e=a(n);function n(t,i,r,s){var o;return f(this,n),(o=e.call(this,t)).inversePixelTransform=i,o.frameState=r,o.context=s,o}return n}(),Yr=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Xr=/^([a-z]*)$|^hsla?\(.*\)$/i;var Ur=function(){var t={},e=0;return function(n){var i;if(t.hasOwnProperty(n))i=t[n];else{if(e>=1024){var r=0;for(var s in t)0==(3&r++)&&(delete t[s],--e)}i=function(t){var e,n,i,r,s;if(Xr.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""!==e.style.color){document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n}return""}(t)),Yr.exec(t)){var o,a=t.length-1;o=a<=4?1:2;var u=4===a||8===a;e=parseInt(t.substr(1+0*o,o),16),n=parseInt(t.substr(1+1*o,o),16),i=parseInt(t.substr(1+2*o,o),16),r=u?parseInt(t.substr(1+3*o,o),16):255,1==o&&(e=(e<<4)+e,n=(n<<4)+n,i=(i<<4)+i,u&&(r=(r<<4)+r)),s=[e,n,i,r/255]}else 0==t.indexOf("rgba(")?Hr(s=t.slice(5,-1).split(",").map(Number)):0==t.indexOf("rgb(")?((s=t.slice(4,-1).split(",").map(Number)).push(1),Hr(s)):y(!1,14);return s}(n),t[n]=i,++e}return i}}();function Wr(t){return Array.isArray(t)?t:Ur(t)}function Hr(t){return t[0]=nt(t[0]+.5|0,0,255),t[1]=nt(t[1]+.5|0,0,255),t[2]=nt(t[2]+.5|0,0,255),t[3]=nt(t[3],0,1),t}function jr(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:t[3])+")"}function Kr(t,e,n){return e+":"+t+":"+(n?"string"==typeof n?n:jr(n):"null")}var Zr=new(function(){function t(){f(this,t),this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return g(t,[{key:"clear",value:function(){this.cache_={},this.cacheSize_=0}},{key:"canExpireCache",value:function(){return this.cacheSize_>this.maxCacheSize_}},{key:"expire",value:function(){if(this.canExpireCache()){var t=0;for(var e in this.cache_){var n=this.cache_[e];0!=(3&t++)||n.hasListener()||(delete this.cache_[e],--this.cacheSize_)}}}},{key:"get",value:function(t,e,n){var i=Kr(t,e,n);return i in this.cache_?this.cache_[i]:null}},{key:"set",value:function(t,e,n,i){var r=Kr(t,e,n);this.cache_[r]=i,++this.cacheSize_}},{key:"setSize",value:function(t){this.maxCacheSize_=t,this.expire()}}]),t}());function Jr(t){return Array.isArray(t)?jr(t):t}var Qr=function(){function t(){f(this,t)}return g(t,[{key:"drawCustom",value:function(t,e,n){}},{key:"drawGeometry",value:function(t){}},{key:"setStyle",value:function(t){}},{key:"drawCircle",value:function(t,e){}},{key:"drawFeature",value:function(t,e){}},{key:"drawGeometryCollection",value:function(t,e){}},{key:"drawLineString",value:function(t,e){}},{key:"drawMultiLineString",value:function(t,e){}},{key:"drawMultiPoint",value:function(t,e){}},{key:"drawMultiPolygon",value:function(t,e){}},{key:"drawPoint",value:function(t,e){}},{key:"drawPolygon",value:function(t,e){}},{key:"drawText",value:function(t,e){}},{key:"setFillStrokeStyle",value:function(t,e){}},{key:"setImageStyle",value:function(t,e){}},{key:"setTextStyle",value:function(t,e){}}]),t}(),$r=[],ts=[0,0,0,0],es=new tt;(new j).setSize=function(){console.warn("labelCache is deprecated.")};var ns,is=null,rs={},ss=function(){var t,e,n=["monospace","serif"],i=n.length,r="wmytzilWMYTZIL@#/&?$%10";function s(t,s,o){for(var a=!0,u=0;u<i;++u){var l=n[u];if(e=us(t+" "+s+" 32px "+l,r),o!=l){var h=us(t+" "+s+" 32px "+o+","+l,r);a=a&&h!=e}}return!!a}function o(){for(var e=!0,n=es.getKeys(),i=0,r=n.length;i<r;++i){var o=n[i];es.get(o)<100&&(s.apply(this,o.split("\n"))?(m(rs),is=null,ns=void 0,es.set(o,100)):(es.set(o,es.get(o)+1,!0),e=!1))}e&&(clearInterval(t),t=void 0)}return function(e){var n=Ni(e);if(n)for(var i=n.families,r=0,a=i.length;r<a;++r){var u=i[r],l=n.style+"\n"+n.weight+"\n"+u;void 0===es.get(l)&&(es.set(l,100,!0),s(n.style,n.weight,u)||(es.set(l,0,!0),void 0===t&&(t=setInterval(o,32))))}}}(),os=function(){var t,e=rs;return function(n){var i=e[n];if(null==i)if(Mi){var r=Ni(n),s=as(n,"Žg"),o=isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight);rs[n]=o*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else t||((t=document.createElement("div")).innerHTML="M",t.style.margin="0 !important",t.style.padding="0 !important",t.style.position="absolute !important",t.style.left="-99999px !important"),t.style.font=n,document.body.appendChild(t),i=t.offsetHeight,e[n]=i,document.body.removeChild(t);return i}}();function as(t,e){return is||(is=Di(1,1)),t!=ns&&(is.font=t,ns=is.font),is.measureText(e)}function us(t,e){return as(t,e).width}function ls(t,e,n){if(e in n)return n[e];var i=us(t,e);return n[e]=i,i}function hs(t,e,n,i){0!==e&&(t.translate(n,i),t.rotate(e),t.translate(-n,-i))}function cs(t,e,n,i,r,s,o,a,u,l,h){t.save(),1!==n&&(t.globalAlpha*=n),e&&t.setTransform.apply(t,e),i.contextInstructions?(t.translate(u,l),t.scale(h,h),function(t,e){for(var n=i.contextInstructions,r=0,s=n.length;r<s;r+=2)Array.isArray(n[r+1])?e[n[r]].apply(e,n[r+1]):e[n[r]]=n[r+1]}(0,t)):t.drawImage(i,r,s,o,a,u,l,o*h,a*h),t.restore()}var fs=function(t){s(n,Qr);var e=a(n);function n(t,i,r,s,o,a,u){var l;return f(this,n),(l=e.call(this)).context_=t,l.pixelRatio_=i,l.extent_=r,l.transform_=s,l.viewRotation_=o,l.squaredTolerance_=a,l.userTransform_=u,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=0,l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=0,l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=[1,0,0,1,0,0],l}return g(n,[{key:"drawImages_",value:function(t,e,n,i){if(this.image_){var r=qe(t,e,n,2,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.tmpLocalTransform_,a=s.globalAlpha;1!=this.imageOpacity_&&(s.globalAlpha=a*this.imageOpacity_);var u=this.imageRotation_;this.imageRotateWithView_&&(u+=this.viewRotation_);for(var l=0,h=r.length;l<h;l+=2){var c=r[l]-this.imageAnchorX_,f=r[l+1]-this.imageAnchorY_;if(0!==u||1!=this.imageScale_){var d=c+this.imageAnchorX_,g=f+this.imageAnchorY_;We(o,d,g,this.imageScale_,this.imageScale_,u,-d,-g),s.setTransform.apply(s,o)}s.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,c,f,this.imageWidth_,this.imageHeight_)}0===u&&1==this.imageScale_||s.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(s.globalAlpha=a)}}},{key:"drawText_",value:function(t,e,n,i){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=qe(t,e,n,i,this.transform_,this.pixelCoordinates_),s=this.context_,o=this.textRotation_;for(this.textRotateWithView_&&(o+=this.viewRotation_);e<n;e+=i){var a=r[e]+this.textOffsetX_,u=r[e+1]+this.textOffsetY_;if(0!==o||1!=this.textScale_){var l=We(this.tmpLocalTransform_,a,u,this.textScale_,this.textScale_,o,-a,-u);s.setTransform.apply(s,l)}this.textStrokeState_&&s.strokeText(this.text_,a,u),this.textFillState_&&s.fillText(this.text_,a,u)}0===o&&1==this.textScale_||s.setTransform(1,0,0,1,0,0)}}},{key:"moveToLineTo_",value:function(t,e,n,i,r){var s=this.context_,o=qe(t,e,n,i,this.transform_,this.pixelCoordinates_);s.moveTo(o[0],o[1]);var a=o.length;r&&(a-=2);for(var u=2;u<a;u+=2)s.lineTo(o[u],o[u+1]);return r&&s.closePath(),n}},{key:"drawRings_",value:function(t,e,n,i){for(var r=0,s=n.length;r<s;++r)e=this.moveToLineTo_(t,e,n[r],i,!0);return e}},{key:"drawCircle",value:function(t){if(Zt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=function(t,e,n){var i=t.getFlatCoordinates();if(i){var r=t.getStride();return qe(i,0,i.length,r,e,n)}return null}(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],i=e[3]-e[1],r=Math.sqrt(n*n+i*i),s=this.context_;s.beginPath(),s.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&s.fill(),this.strokeState_&&s.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}}},{key:"setStyle",value:function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}},{key:"setTransform",value:function(t){this.transform_=t}},{key:"drawGeometry",value:function(t){switch(t.getType()){case lt:this.drawPoint(t);break;case ht:this.drawLineString(t);break;case ct:this.drawPolygon(t);break;case ft:this.drawMultiPoint(t);break;case dt:this.drawMultiLineString(t);break;case gt:this.drawMultiPolygon(t);break;case vt:this.drawGeometryCollection(t);break;case _t:this.drawCircle(t)}}},{key:"drawFeature",value:function(t,e){var n=e.getGeometryFunction()(t);n&&Zt(this.extent_,n.getExtent())&&(this.setStyle(e),this.drawGeometry(n))}},{key:"drawGeometryCollection",value:function(t){for(var e=t.getGeometriesArray(),n=0,i=e.length;n<i;++n)this.drawGeometry(e[n])}},{key:"drawPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawMultiPoint",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)}},{key:"drawLineString",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var i=t.getFlatMidpoint();this.drawText_(i,0,2,2)}}}},{key:"drawMultiLineString",value:function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(Zt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getFlatCoordinates(),r=0,s=t.getEnds(),o=t.getStride();n.beginPath();for(var a=0,u=s.length;a<u;++a)r=this.moveToLineTo_(i,r,s[a],o,!1);n.stroke()}if(""!==this.text_){var l=t.getFlatMidpoints();this.drawText_(l,0,l.length,2)}}}},{key:"drawPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}}},{key:"drawMultiPolygon",value:function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),Zt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getOrientedFlatCoordinates(),i=0,r=t.getEndss(),s=t.getStride();e.beginPath();for(var o=0,a=r.length;o<a;++o){var u=r[o];i=this.drawRings_(n,i,u,s)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var l=t.getFlatInteriorPoints();this.drawText_(l,0,l.length,2)}}}},{key:"setContextFillState_",value:function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}},{key:"setContextStrokeState_",value:function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&(q(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}},{key:"setContextTextState_",value:function(t){var e=this.context_,n=this.contextTextState_,i=t.textAlign?t.textAlign:"center";n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=i&&(n.textAlign=i,e.textAlign=i),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=i,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:i,textBaseline:t.textBaseline})}},{key:"setFillStrokeStyle",value:function(t,e){if(t){var n=t.getColor();this.fillState_={fillStyle:Jr(n||"#000")}}else this.fillState_=null;if(e){var i=e.getColor(),r=e.getLineCap(),s=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),u=e.getWidth(),l=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:"round",lineDash:s||$r,lineDashOffset:o||0,lineJoin:void 0!==a?a:"round",lineWidth:this.pixelRatio_*(void 0!==u?u:1),miterLimit:void 0!==l?l:10,strokeStyle:Jr(i||"#000")}}else this.strokeState_=null}},{key:"setImageStyle",value:function(t){if(t){var e=t.getAnchor(),n=t.getImage(1),i=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=r[0]}else this.image_=null}},{key:"setTextStyle",value:function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:Jr(n||"#000")}}else this.textFillState_=null;var i=t.getStroke();if(i){var r=i.getColor(),s=i.getLineCap(),o=i.getLineDash(),a=i.getLineDashOffset(),u=i.getLineJoin(),l=i.getWidth(),h=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==s?s:"round",lineDash:o||$r,lineDashOffset:a||0,lineJoin:void 0!==u?u:"round",lineWidth:void 0!==l?l:1,miterLimit:void 0!==h?h:10,strokeStyle:Jr(r||"#000")}}else this.textStrokeState_=null;var c=t.getFont(),f=t.getOffsetX(),d=t.getOffsetY(),g=t.getRotateWithView(),v=t.getRotation(),_=t.getScale(),y=t.getText(),p=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==c?c:"10px sans-serif",textAlign:void 0!==p?p:"center",textBaseline:void 0!==m?m:"middle"},this.text_=void 0!==y?y:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==d?this.pixelRatio_*d:0,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0!==v?v:0,this.textScale_=this.pixelRatio_*(void 0!==_?_:1)}else this.text_=""}}]),n}(),ds=0,gs=2,vs=3,_s="Default",ys="Image",ps="LineString",ms="Polygon",ks="Text",xs={Point:function(t,e,n,i){var r=n.getImage();if(r){if(r.getImageState()!=gs)return;var s=t.getBuilder(n.getZIndex(),ys);s.setImageStyle(r,t.addDeclutter(!1)),s.drawPoint(e,i)}var o=n.getText();if(o){var a=t.getBuilder(n.getZIndex(),ks);a.setTextStyle(o,t.addDeclutter(!!r)),a.drawText(e,i)}},LineString:function(t,e,n,i){var r=n.getStroke();if(r){var s=t.getBuilder(n.getZIndex(),ps);s.setFillStrokeStyle(null,r),s.drawLineString(e,i)}var o=n.getText();if(o){var a=t.getBuilder(n.getZIndex(),ks);a.setTextStyle(o,t.addDeclutter(!1)),a.drawText(e,i)}},Polygon:function(t,e,n,i){var r=n.getFill(),s=n.getStroke();if(r||s){var o=t.getBuilder(n.getZIndex(),ms);o.setFillStrokeStyle(r,s),o.drawPolygon(e,i)}var a=n.getText();if(a){var u=t.getBuilder(n.getZIndex(),ks);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,i)}},MultiPoint:function(t,e,n,i){var r=n.getImage();if(r){if(r.getImageState()!=gs)return;var s=t.getBuilder(n.getZIndex(),ys);s.setImageStyle(r,t.addDeclutter(!1)),s.drawMultiPoint(e,i)}var o=n.getText();if(o){var a=t.getBuilder(n.getZIndex(),ks);a.setTextStyle(o,t.addDeclutter(!!r)),a.drawText(e,i)}},MultiLineString:function(t,e,n,i){var r=n.getStroke();if(r){var s=t.getBuilder(n.getZIndex(),ps);s.setFillStrokeStyle(null,r),s.drawMultiLineString(e,i)}var o=n.getText();if(o){var a=t.getBuilder(n.getZIndex(),ks);a.setTextStyle(o,t.addDeclutter(!1)),a.drawText(e,i)}},MultiPolygon:function(t,e,n,i){var r=n.getFill(),s=n.getStroke();if(s||r){var o=t.getBuilder(n.getZIndex(),ms);o.setFillStrokeStyle(r,s),o.drawMultiPolygon(e,i)}var a=n.getText();if(a){var u=t.getBuilder(n.getZIndex(),ks);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,i)}},GeometryCollection:function(t,e,n,i){var r,s,o=e.getGeometriesArray();for(r=0,s=o.length;r<s;++r)(0,xs[o[r].getType()])(t,o[r],n,i)},Circle:function(t,e,n,i){var r=n.getFill(),s=n.getStroke();if(r||s){var o=t.getBuilder(n.getZIndex(),"Circle");o.setFillStrokeStyle(r,s),o.drawCircle(e,i)}var a=n.getText();if(a){var u=t.getBuilder(n.getZIndex(),ks);u.setTextStyle(a,t.addDeclutter(!1)),u.drawText(e,i)}}};function Es(t,e){return parseInt(d(t),10)-parseInt(d(e),10)}function Cs(t,e){return.5*t/e}function Is(t,e,n,i,r,s){var o=!1,a=n.getImage();if(a){var u=a.getImageState();u==gs||u==vs?a.unlistenImageChange(r):(u==ds&&a.load(),u=a.getImageState(),a.listenImageChange(r),o=!0)}return function(t,e,n,i,r){var s=n.getGeometryFunction()(e);if(s){var o=s.simplifyTransformed(i,r);n.getRenderer()?function t(e,n,i,r){if(n.getType()!=vt)e.getBuilder(i.getZIndex(),_s).drawCustom(n,r,i.getRenderer());else for(var s=n.getGeometries(),o=0,a=s.length;o<a;++o)t(e,s[o],i,r)}(t,o,n,e):(0,xs[o.getType()])(t,o,n,e)}}(t,e,n,i,s),o}function Ss(t,e){Zr.expire()}var ws=function(t){s(n,D);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).map_=t,i.declutterTree_=null,i}return g(n,[{key:"dispatchRenderEvent",value:function(t,e){o()}},{key:"calculateMatrices2D",value:function(t){var e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;We(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),He(i,n)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r,s,o,a){var u,l=e.viewState;function h(t,e,n){return r.call(s,e,t?n:null)}var c=l.projection,f=fi(t.slice(),c),d=[[0,0]];if(c.canWrapX()&&i){var g=Kt(c.getExtent());d.push([-g,0],[g,0])}var v,_=e.layerStatesArray,y=_.length;this.declutterTree_&&(v=this.declutterTree_.all().map(function(t){return t.value}));for(var p=[],m=0;m<d.length;m++)for(var k=y-1;k>=0;--k){var x=_[k],E=x.layer;if(E.hasRenderer()&&Vr(x,l)&&o.call(a,E)){var C=E.getRenderer(),I=E.getSource();if(C&&I){var S=I.getWrapX()?f:t,w=h.bind(null,x.managed);p[0]=S[0]+d[m][0],p[1]=S[1]+d[m][1],u=C.forEachFeatureAtCoordinate(p,e,n,w,v)}if(u)return u}}}},{key:"forEachLayerAtPixel",value:function(t,e,n,i,r){return o()}},{key:"hasFeatureAtCoordinate",value:function(t,e,n,i,r,s){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,i,Y,this,r,s)}},{key:"getMap",value:function(){return this.map_}},{key:"renderFrame",value:function(t){this.declutterTree_=function(t,e){e&&e.clear();for(var n=t.declutterItems,i=n.length-1;i>=0;--i)for(var r=n[i],s=r.items,o=0,a=s.length;o<a;o+=3)e=s[o].renderDeclutter(s[o+1],s[o+2],r.opacity,e);return n.length=0,e}(t,this.declutterTree_)}},{key:"scheduleExpireIconCache",value:function(t){Zr.canExpireCache()&&t.postRenderFunctions.push(Ss)}}]),n}(),Ns=function(t){s(n,ws);var e=a(n);function n(t){var i;f(this,n),(i=e.call(this,t)).fontChangeListenerKey_=E(es,F,t.redrawText.bind(t)),i.element_=document.createElement("div");var r=i.element_.style;r.position="absolute",r.width="100%",r.height="100%",r.zIndex="0",i.element_.className="ol-unselectable ol-layers";var s=t.getViewport();return s.insertBefore(i.element_,s.firstChild||null),i.children_=[],i.renderedVisible_=!0,i}return g(n,[{key:"dispatchRenderEvent",value:function(t,e){var n=this.getMap();if(n.hasListener(t)){var i=new qr(t,void 0,e);n.dispatchEvent(i)}}},{key:"disposeInternal",value:function(){I(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),i(c(n.prototype),"disposeInternal",this).call(this)}},{key:"renderFrame",value:function(t){if(t){this.calculateMatrices2D(t),this.dispatchRenderEvent(Er,t);var e=t.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),r=t.viewState;this.children_.length=0;for(var s=null,o=0,a=e.length;o<a;++o){var u=e[o];if(t.layerIndex=o,Vr(u,r)&&(u.sourceState==Dr||u.sourceState==Fr)){var l=u.layer.render(t,s);l&&l!==s&&(this.children_.push(l),s=l)}}i(c(n.prototype),"renderFrame",this).call(this,t),function(t,e){for(var n=t.childNodes,i=0;;++i){var r=n[i],s=e[i];if(!r&&!s)break;r!==s&&(r?s?t.insertBefore(s,r):(t.removeChild(r),--i):t.appendChild(s))}}(this.element_,this.children_),this.dispatchRenderEvent("postcompose",t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}},{key:"forEachLayerAtPixel",value:function(t,e,n,i,r){for(var s=e.viewState,o=e.layerStatesArray,a=o.length-1;a>=0;--a){var u=o[a],l=u.layer;if(l.hasRenderer()&&Vr(u,s)&&r(l)){var h=l.getRenderer().getDataAtPixel(t,e,n);if(h){var c=i(l,h);if(c)return c}}}}}]),n}(),Ls=function(t){s(n,Br);var e=a(n);function n(){return f(this,n),e.apply(this,arguments)}return g(n,[{key:"createRenderer",value:function(){return new Ns(this)}}]),n}();function Rs(t){this.validateExtent_(),this.updateBox_()}var Ts=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{};(i=e.call(this,{element:document.createElement("div"),render:r.render||Rs,target:r.target})).boundHandleRotationChanged_=i.handleRotationChanged_.bind(l(i)),i.collapsed_=void 0===r.collapsed||r.collapsed,i.collapsible_=void 0===r.collapsible||r.collapsible,i.collapsible_||(i.collapsed_=!1),i.rotateWithView_=void 0!==r.rotateWithView&&r.rotateWithView,i.viewExtent_=void 0;var s=void 0!==r.className?r.className:"ol-overviewmap",o=void 0!==r.tipLabel?r.tipLabel:"Overview map",a=void 0!==r.collapseLabel?r.collapseLabel:"«";"string"==typeof a?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=a):i.collapseLabel_=a;var u=void 0!==r.label?r.label:"»";"string"==typeof u?(i.label_=document.createElement("span"),i.label_.textContent=u):i.label_=u;var h=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,c=document.createElement("button");c.setAttribute("type","button"),c.title=o,c.appendChild(h),c.addEventListener(L,i.handleClick_.bind(l(i)),!1),i.ovmapDiv_=document.createElement("div"),i.ovmapDiv_.className="ol-overviewmap-map",i.view_=r.view,i.ovmap_=new Ls({view:r.view});var d=i.ovmap_;r.layers&&r.layers.forEach(function(t){d.addLayer(t)});var g=document.createElement("div");g.className="ol-overviewmap-box",g.style.boxSizing="border-box",i.boxOverlay_=new Hi({position:[0,0],positioning:Ei,element:g}),i.ovmap_.addOverlay(i.boxOverlay_);var v=s+" ol-unselectable ol-control"+(i.collapsed_&&i.collapsible_?" ol-collapsed":"")+(i.collapsible_?"":" ol-uncollapsible"),_=i.element;_.className=v,_.appendChild(i.ovmapDiv_),_.appendChild(c);var y=l(i),p=i.boxOverlay_,m=i.boxOverlay_.getElement(),k=function(t){var e,n={clientX:(e=t).clientX,clientY:e.clientY},i=d.getEventCoordinateInternal(n);p.setPosition(i)},x=function t(e){var n=d.getEventCoordinateInternal(e);y.getMap().getView().setCenterInternal(n),window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",t)};return m.addEventListener("mousedown",function(){window.addEventListener("mousemove",k),window.addEventListener("mouseup",x)}),i}return g(n,[{key:"setMap",value:function(t){var e=this.getMap();if(t!==e){if(e){var r=e.getView();r&&this.unbindView_(r),this.ovmap_.setTarget(null)}if(i(c(n.prototype),"setMap",this).call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(E(t,F,this.handleMapPropertyChange_,this));var s=t.getView();s&&(this.bindView_(s),s.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}}},{key:"handleMapPropertyChange_",value:function(t){if(t.key===xr){var e=t.oldValue;e&&this.unbindView_(e);var n=this.getMap().getView();this.bindView_(n)}}},{key:"bindView_",value:function(t){if(!this.view_){var e=new pi({projection:t.getProjection()});this.ovmap_.setView(e)}t.addEventListener($(si),this.boundHandleRotationChanged_),this.handleRotationChanged_()}},{key:"unbindView_",value:function(t){t.removeEventListener($(si),this.boundHandleRotationChanged_)}},{key:"handleRotationChanged_",value:function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}},{key:"validateExtent_",value:function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var n=t.getSize(),i=t.getView().calculateExtentInternal(n);if(!this.viewExtent_||!Ft(i,this.viewExtent_)){this.viewExtent_=i;var r=e.getSize(),s=e.getView().calculateExtentInternal(r),o=e.getPixelFromCoordinateInternal(Ht(i)),a=e.getPixelFromCoordinateInternal(qt(i)),u=Math.abs(o[0]-a[0]),l=Math.abs(o[1]-a[1]),h=r[0],c=r[1];u<.1*h||l<.1*c||u>.75*h||l>.75*c?this.resetExtent_():Lt(s,i)||this.recenter_()}}}},{key:"resetExtent_",value:function(){var t=this.getMap(),e=this.ovmap_,n=t.getSize(),i=t.getView().calculateExtentInternal(n),r=e.getView(),s=Math.log(7.5)/Math.LN2;Qt(i,1/(.1*Math.pow(2,s/2))),r.fitInternal(Xn(i))}},{key:"recenter_",value:function(){var t=this.getMap(),e=this.ovmap_,n=t.getView();e.getView().setCenterInternal(n.getCenterInternal())}},{key:"updateBox_",value:function(){var t=this.getMap(),e=this.ovmap_;if(t.isRendered()&&e.isRendered()){var n=t.getSize(),i=t.getView(),r=e.getView(),s=this.rotateWithView_?0:-i.getRotation(),o=this.boxOverlay_,a=this.boxOverlay_.getElement(),u=i.getCenterInternal(),l=i.getResolution(),h=r.getResolution(),c=n[0]*l/h,f=n[1]*l/h;if(o.setPosition(u),a){a.style.width=c+"px",a.style.height=f+"px";var d="rotate("+s+"rad)";a.style.transform=d}}}},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_()}},{key:"handleToggle_",value:function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Bi(this.collapseLabel_,this.label_):Bi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var t=this.ovmap_;if(!this.collapsed_){if(t.isRendered())return this.viewExtent_=void 0,void t.render();t.updateSize(),this.resetExtent_(),C(t,mi,function(t){this.updateBox_()},this)}}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"setRotateWithView",value:function(t){this.rotateWithView_!==t&&(this.rotateWithView_=t,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}},{key:"getOverviewMap",value:function(){return this.ovmap_}}]),n}(),bs=function(){function t(e,n,i){f(this,t),this.decay_=e,this.minVelocity_=n,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}return g(t,[{key:"begin",value:function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}},{key:"update",value:function(t,e){this.points_.push(t,e,Date.now())}},{key:"end",value:function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;var r=this.points_[e]-this.points_[n],s=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(s,r),this.initialVelocity_=Math.sqrt(r*r+s*s)/i,this.initialVelocity_>this.minVelocity_}},{key:"getDistance",value:function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}},{key:"getAngle",value:function(){return this.angle_}}]),t}(),Ps="active";function Ms(t,e,n,i){var r=t.getZoom();if(void 0!==r){var s=t.getConstrainedZoom(r+e),o=t.getResolutionForZoom(s);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:o,anchor:n,duration:void 0!==i?i:250,easing:di})}}var Os=function(t){s(n,tt);var e=a(n);function n(t){var i;return f(this,n),i=e.call(this),t.handleEvent&&(i.handleEvent=t.handleEvent),i.map_=null,i.setActive(!0),i}return g(n,[{key:"getActive",value:function(){return this.get(Ps)}},{key:"getMap",value:function(){return this.map_}},{key:"handleEvent",value:function(t){return!0}},{key:"setActive",value:function(t){this.set(Ps,t)}},{key:"setMap",value:function(t){this.map_=t}}]),n}();function Fs(t){var e=!1;if(t.type==vr.DBLCLICK){var n=t.originalEvent,i=t.map,r=t.coordinate,s=n.shiftKey?-this.delta_:this.delta_;Ms(i.getView(),s,r,this.duration_),t.preventDefault(),e=!0}return!e}var Ds=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{handleEvent:Fs})).delta_=r.delta?r.delta:1,i.duration_=void 0!==r.duration?r.duration:250,i}return n}(),As=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Gs=function(t){return t.target.getTargetElement()===document.activeElement},Bs=Y,Vs=function(t){var e=t.originalEvent;return 0==e.button&&!(Ti&&bi&&e.ctrlKey)},zs=X,qs=function(t){return"pointermove"==t.type},Ys=function(t){return t.type==vr.SINGLECLICK},Xs=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},Us=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},Ws=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},Hs=function(t){var e=t.pointerEvent;return y(void 0!==e,56),"mouse"==e.pointerType},js=function(t){var e=t.pointerEvent;return y(void 0!==e,56),e.isPrimary&&0===e.button};function Ks(t){for(var e=t.length,n=0,i=0,r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return[n/e,i/e]}var Zs=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return i=e.call(this,r),r.handleDownEvent&&(i.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(i.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(i.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(i.handleUpEvent=r.handleUpEvent),r.stopDown&&(i.stopDown=r.stopDown),i.handlingDownUpSequence=!1,i.trackedPointers_={},i.targetPointers=[],i}return g(n,[{key:"getPointerCount",value:function(){return this.targetPointers.length}},{key:"handleDownEvent",value:function(t){return!1}},{key:"handleDragEvent",value:function(t){}},{key:"handleEvent",value:function(t){if(!t.pointerEvent)return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==vr.POINTERDRAG)this.handleDragEvent(t);else if(t.type==vr.POINTERUP){var n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==vr.POINTERDOWN){var i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==vr.POINTERMOVE&&this.handleMoveEvent(t);return!e}},{key:"handleMoveEvent",value:function(t){}},{key:"handleUpEvent",value:function(t){return!1}},{key:"stopDown",value:function(t){return t}},{key:"updateTrackedPointers_",value:function(t){if(function(t){var e=t.type;return e===vr.POINTERDOWN||e===vr.POINTERDRAG||e===vr.POINTERUP}(t)){var e=t.pointerEvent,n=e.pointerId.toString();t.type==vr.POINTERUP?delete this.trackedPointers_[n]:(t.type==vr.POINTERDOWN||n in this.trackedPointers_)&&(this.trackedPointers_[n]=e),this.targetPointers=k(this.trackedPointers_)}}}]),n}();function Js(t){return Xs(t)&&js(t)}var Qs=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{stopDown:X})).kinetic_=r.kinetic,i.lastCentroid=null,i.lastPointersCount_,i.panning_=!1,i.condition_=r.condition?r.condition:Js,i.noKinetic_=!1,i}return g(n,[{key:"conditionInternal_",value:function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=Gs(t)),e&&this.condition_(t)}},{key:"handleDragEvent",value:function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var e,n,i=this.targetPointers,r=Ks(i);if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(r[0],r[1]),this.lastCentroid){var s=[this.lastCentroid[0]-r[0],r[1]-this.lastCentroid[1]],o=t.map.getView();e=s,n=o.getResolution(),e[0]*=n,e[1]*=n,ui(s,o.getRotation()),o.adjustCenterInternal(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=r,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}},{key:"handleUpEvent",value:function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),s=n.getCenterInternal(),o=e.getPixelFromCoordinateInternal(s),a=e.getCoordinateFromPixelInternal([o[0]-i*Math.cos(r),o[1]-i*Math.sin(r)]);n.animateInternal({center:n.getConstrainedCenter(a),duration:500,easing:di})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>0&&this.conditionInternal_(t)){var e=t.map.getView();return this.lastCentroid=null,e.getAnimating()&&e.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}]),n}(),$s=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{stopDown:X})).condition_=r.condition?r.condition:As,i.lastAngle_=void 0,i.duration_=void 0!==r.duration?r.duration:250,i}return g(n,[{key:"handleDragEvent",value:function(t){if(Hs(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==ei){var i=e.getSize(),r=t.pixel,s=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){var o=s-this.lastAngle_;n.adjustRotationInternal(-o)}this.lastAngle_=s}}}},{key:"handleUpEvent",value:function(t){return!Hs(t)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){return!!Hs(t)&&(!(!Vs(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0))}}]),n}(),to=function(t){s(n,D);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).geometry_=null,i.element_=document.createElement("div"),i.element_.style.position="absolute",i.element_.className="ol-box "+t,i.map_=null,i.startPixel_=null,i.endPixel_=null,i}return g(n,[{key:"disposeInternal",value:function(){this.setMap(null)}},{key:"render_",value:function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"}},{key:"setMap",value:function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}},{key:"setPixels",value:function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}},{key:"createOrUpdateGeometry",value:function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Yn([n])}},{key:"getGeometry",value:function(){return this.geometry_}}]),n}(),eo=function(t){s(n,H);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t)).coordinate=i,s.mapBrowserEvent=r,s}return n}(),no=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this)).box_=new to(r.className||"ol-dragbox"),i.minArea_=void 0!==r.minArea?r.minArea:64,i.onBoxEnd_=r.onBoxEnd?r.onBoxEnd:U,i.startPixel_=null,i.condition_=r.condition?r.condition:Vs,i.boxEndCondition_=r.boxEndCondition?r.boxEndCondition:i.defaultBoxEndCondition,i}return g(n,[{key:"defaultBoxEndCondition",value:function(t,e,n){var i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_}},{key:"getGeometry",value:function(){return this.box_.getGeometry()}},{key:"handleDragEvent",value:function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new eo("boxdrag",t.coordinate,t))}},{key:"handleUpEvent",value:function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new eo("boxend",t.coordinate,t))),!1}},{key:"handleDownEvent",value:function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new eo("boxstart",t.coordinate,t)),!0)}}]),n}();function io(){var t,e=this.getMap(),n=e.getView(),i=e.getSize(),r=this.getGeometry().getExtent();if(this.out_){var s=n.calculateExtentInternal(i),o=(t=[e.getPixelFromCoordinateInternal(zt(r)),e.getPixelFromCoordinateInternal(jt(r))],function(t,e){for(var n=0,i=e.length;n<i;++n)At(t,e[n]);return t}(Pt(void 0),t));Qt(s,1/n.getResolutionForExtentInternal(o,i)),r=s}var a=n.getConstrainedResolution(n.getResolutionForExtentInternal(r,i)),u=n.getConstrainedCenter(Yt(r),a);n.animateInternal({resolution:a,center:u,duration:this.duration_,easing:di})}var ro=function(t){s(n,no);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{condition:r.condition?r.condition:Us,className:r.className||"ol-dragzoom",minArea:r.minArea,onBoxEnd:io})).duration_=void 0!==r.duration?r.duration:200,i.out_=void 0!==r.out&&r.out,i}return n}(),so=37,oo=38,ao=39,uo=40;function lo(t){var e=!1;if(t.type==R){var n=t.originalEvent.keyCode;if(this.condition_(t)&&(n==uo||n==so||n==ao||n==oo)){var i=t.map.getView(),r=i.getResolution()*this.pixelDelta_,s=0,o=0;n==uo?o=-r:n==so?s=-r:n==ao?s=r:o=r;var a=[s,o];ui(a,i.getRotation()),function(t,e,n){var i=t.getCenterInternal();if(i){var r=[i[0]+e[0],i[1]+e[1]];t.animateInternal({duration:void 0!==n?n:250,easing:vi,center:t.getConstrainedCenter(r)})}}(i,a,this.duration_),t.preventDefault(),e=!0}}return!e}var ho=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{handleEvent:lo})).defaultCondition_=function(t){return Xs(t)&&Ws(t)},i.condition_=void 0!==r.condition?r.condition:i.defaultCondition_,i.duration_=void 0!==r.duration?r.duration:100,i.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,i}return n}();function co(t){var e=!1;if(t.type==R||t.type==T){var n=t.originalEvent.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map,r=n=="+".charCodeAt(0)?this.delta_:-this.delta_;Ms(i.getView(),r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}var fo=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,{handleEvent:co})).condition_=r.condition?r.condition:Ws,i.delta_=r.delta?r.delta:1,i.duration_=void 0!==r.duration?r.duration:100,i}return n}(),go="trackpad",vo=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r=t||{};return(i=e.call(this,r)).totalDelta_=0,i.lastDelta_=0,i.maxDelta_=void 0!==r.maxDelta?r.maxDelta:1,i.duration_=void 0!==r.duration?r.duration:250,i.timeout_=void 0!==r.timeout?r.timeout:80,i.useAnchor_=void 0===r.useAnchor||r.useAnchor,i.condition_=r.condition?r.condition:Bs,i.lastAnchor_=null,i.startTime_=void 0,i.timeoutId_,i.mode_=void 0,i.trackpadEventGap_=400,i.trackpadTimeoutId_,i.deltaPerZoom_=300,i}return g(n,[{key:"conditionInternal_",value:function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=Gs(t)),e&&this.condition_(t)}},{key:"endInteraction_",value:function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}},{key:"handleEvent",value:function(t){if(!this.conditionInternal_(t))return!0;if(t.type!==O)return!0;t.preventDefault();var e,n=t.map,i=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==O&&(e=i.deltaY,Ri&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Pi),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?go:"wheel");var s=n.getView();if(this.mode_===go&&!s.getConstrainResolution())return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(s.getAnimating()&&s.cancelAnimations(),s.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),s.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=e;var o=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),o),!1}},{key:"handleWheelZoom_",value:function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=-nt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;e.getConstrainResolution()&&(n=n?n>0?1:-1:0),Ms(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}},{key:"setMouseAnchor",value:function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}]),n}(),_o=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=r;return s.stopDown||(s.stopDown=X),(i=e.call(this,s)).anchor_=null,i.lastAngle_=void 0,i.rotating_=!1,i.rotationDelta_=0,i.threshold_=void 0!==r.threshold?r.threshold:.3,i.duration_=void 0!==r.duration?r.duration:250,i}return g(n,[{key:"handleDragEvent",value:function(t){var e=0,n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){var s=r-this.lastAngle_;this.rotationDelta_+=s,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=s}this.lastAngle_=r;var o=t.map,a=o.getView();if(a.getConstraints().rotation!==ei){var u=o.getViewport().getBoundingClientRect(),l=Ks(this.targetPointers);l[0]-=u.left,l[1]-=u.top,this.anchor_=o.getCoordinateFromPixelInternal(l),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_))}}},{key:"handleUpEvent",value:function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}]),n}(),yo=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=r;return s.stopDown||(s.stopDown=X),(i=e.call(this,s)).anchor_=null,i.duration_=void 0!==r.duration?r.duration:400,i.lastDistance_=void 0,i.lastScaleDelta_=1,i}return g(n,[{key:"handleDragEvent",value:function(t){var e=1,n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,s=n.clientY-i.clientY,o=Math.sqrt(r*r+s*s);void 0!==this.lastDistance_&&(e=this.lastDistance_/o),this.lastDistance_=o;var a=t.map,u=a.getView();1!=e&&(this.lastScaleDelta_=e);var l=a.getViewport().getBoundingClientRect(),h=Ks(this.targetPointers);h[0]-=l.left,h[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(h),a.render(),u.adjustResolutionInternal(e,this.anchor_)}},{key:"handleUpEvent",value:function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0}},{key:"handleDownEvent",value:function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}]),n}();function po(t){var e=t||{},n=new fr,i=new bs(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&n.push(new $s),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&n.push(new Ds({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&n.push(new Qs({condition:e.onFocusOnly?Gs:void 0,kinetic:i})),(void 0===e.pinchRotate||e.pinchRotate)&&n.push(new _o),(void 0===e.pinchZoom||e.pinchZoom)&&n.push(new yo({duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(n.push(new ho),n.push(new fo({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&n.push(new vo({condition:e.onFocusOnly?Gs:void 0,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&n.push(new ro({duration:e.zoomDuration})),n}function mo(t){this.updateElement_(t.frameState)}var ko=function(t){s(n,ji);var e=a(n);function n(t){var i;f(this,n);var r=t||{};(i=e.call(this,{element:document.createElement("div"),render:r.render||mo,target:r.target})).ulElement_=document.createElement("ul"),i.collapsed_=void 0===r.collapsed||r.collapsed,i.overrideCollapsible_=void 0!==r.collapsible,i.collapsible_=void 0===r.collapsible||r.collapsible,i.collapsible_||(i.collapsed_=!1);var s=void 0!==r.className?r.className:"ol-attribution",o=void 0!==r.tipLabel?r.tipLabel:"Attributions",a=void 0!==r.collapseLabel?r.collapseLabel:"»";"string"==typeof a?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=a):i.collapseLabel_=a;var u=void 0!==r.label?r.label:"i";"string"==typeof u?(i.label_=document.createElement("span"),i.label_.textContent=u):i.label_=u;var h=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,c=document.createElement("button");c.setAttribute("type","button"),c.title=o,c.appendChild(h),c.addEventListener(L,i.handleClick_.bind(l(i)),!1);var d=s+" ol-unselectable ol-control"+(i.collapsed_&&i.collapsible_?" ol-collapsed":"")+(i.collapsible_?"":" ol-uncollapsible"),g=i.element;return g.className=d,g.appendChild(i.ulElement_),g.appendChild(c),i.renderedAttributions_=[],i.renderedVisible_=!0,i}return g(n,[{key:"collectSourceAttributions_",value:function(t){for(var e={},n=[],i=t.layerStatesArray,r=0,s=i.length;r<s;++r){var o=i[r];if(Vr(o,t.viewState)){var a=o.layer.getSource();if(a){var u=a.getAttributions();if(u){var l=u(t);if(l)if(this.overrideCollapsible_||!1!==a.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(l))for(var h=0,c=l.length;h<c;++h)l[h]in e||(n.push(l[h]),e[l[h]]=!0);else l in e||(n.push(l),e[l]=!0)}}}}return n}},{key:"updateElement_",value:function(t){if(t){var e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!q(e,this.renderedAttributions_)){zi(this.ulElement_);for(var i=0,r=e.length;i<r;++i){var s=document.createElement("li");s.innerHTML=e[i],this.ulElement_.appendChild(s)}this.renderedAttributions_=e}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}},{key:"handleClick_",value:function(t){t.preventDefault(),this.handleToggle_()}},{key:"handleToggle_",value:function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Bi(this.collapseLabel_,this.label_):Bi(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_}},{key:"getCollapsible",value:function(){return this.collapsible_}},{key:"setCollapsible",value:function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())}},{key:"setCollapsed",value:function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}},{key:"getCollapsed",value:function(){return this.collapsed_}}]),n}(),xo=function(t){s(n,Br);var e=a(n);function n(t){var i,r;return f(this,n),(t=p({},t)).controls||(t.controls=(i={},r=new fr,(void 0===i.zoom||i.zoom)&&r.push(new Ki(i.zoomOptions)),(void 0===i.rotate||i.rotate)&&r.push(new Ji(i.rotateOptions)),(void 0===i.attribution||i.attribution)&&r.push(new ko(i.attributionOptions)),r)),t.interactions||(t.interactions=po()),e.call(this,t)}return g(n,[{key:"createRenderer",value:function(){return new Ns(this)}}]),n}(),Eo=function(t){s(n,xo);var e=a(n);function n(t){var i;f(this,n);var r=!(t=t||{}).disableRotation,s=po({altShiftDragRotate:r,pinchRotate:r,mouseWheelZoom:!t.disableMouseWheelZoom});if(t&&t.interactions&&t.interactions.forEach(function(t){return s.push(t)}),t.interactions=s,(i=e.call(this,t)).actions=[],t.actions.forEach(function(t){i.addAction(t)}),setTimeout(function(){i.activateDefaultAction()}),!t.disableEscapeKey){var o=function(t){t&&t.keyCode&&27==t.keyCode&&i.activateDefaultAction()};document.body.removeEventListener("keydown",o),document.body.addEventListener("keydown",o)}return u(i)}return g(n,null,[{key:"CLICK_COUNT_TIMEOUT",get:function(){return 300}}]),g(n,[{key:"activateAction",value:function(t){if(this.currentAction){if(this.currentAction==t)return!1;this.currentAction.deactivate(),clearTimeout(this.timeout)}this.currentAction=t,this.timeout=setTimeout(function(){t.activate()},n.CLICK_COUNT_TIMEOUT)}},{key:"addAction",value:function(t){var e=this;this.actions.push(t),t.map=this,t.interactions.forEach(function(t){e.addInteraction(t)})}},{key:"removeAction",value:function(t){var e=this;this.currentAction==t&&this.activateDefaultAction(),t.interactions.forEach(function(t){e.removeInteraction(t)}),this.actions.splice(this.actions.indexOf(t),1)}},{key:"activateDefaultAction",value:function(){this.actions.length>0&&this.actions[0]&&(this.currentAction==this.actions[0]&&(this.currentAction.deactivate(),this.currentAction=void 0),this.activateAction(this.actions[0]))}}]),n}(),Co=function(t){s(n,Eo);var e=a(n);function n(t){var i;return f(this,n),t.layers=[t.customLayers.baseLayerGroup,t.customLayers.overlayGroup],t.controls=t.controls||[new Ki,new Ji,new ir,new ur({minWidth:128})],(i=e.call(this,t)).projection=t.projection,i.geoJSONFormat=new Kn({dataProjection:t.projection}),i.custom=t.custom||{},t.customLayers.overviewMapLayers&&t.customLayers.overviewMapLayers.length>0&&i.createOverviewMapControl(t),i.baseLayers=t.customLayers.baseLayerGroup.getLayers().getArray(),i.maxZoomViewToExtent=t.maxZoomViewToExtent||16,i}return g(n,[{key:"createOverviewMapControl",value:function(t){var e=this,n=function(t){var n=function(t){var n=0;return e.baseLayers.forEach(function(t,e){t.getVisible()&&(n=e)}),t[n+1>=t.length?0:n+1]};t||(t=n(e.baseLayers)),e.baseLayers.forEach(function(e){return e.setVisible(e==t)});var i=e.overviewMapControl.getOverviewMap().getLayers().getArray(),r=n(i);i.forEach(function(t){return t.setVisible(t==r)}),e.render(),e.overviewMapControl.getOverviewMap().render()};this.overviewMapLayers=t.customLayers.overviewMapLayers,this.overviewMapControl=new Ts({layers:this.overviewMapLayers,collapsed:!1,view:new pi({projection:this.projection})}),this.overviewMapControl.element.addEventListener("click",function(){return n()},!1),t.view&&t.controls.push(this.overviewMapControl),this.custom.toggleBaseLayer=n}},{key:"addBaseLayerAndOverlayMapLayer",value:function(t,e){t.setVisible(0===this.baseLayers.length),this.baseLayers.push(t),this.overviewMapControl?this.overviewMapControl.getOverviewMap().getLayers().getArray().push(e):this.createOverviewMapControl({customLayers:{overviewMapLayers:[e]}}),e.setVisible(2===this.overviewMapControl.getOverviewMap().getLayers().getArray().length)}},{key:"getBaseLayers",value:function(){return this.getLayerGroup().getLayers().getArray()[0].getLayers().getArray()}},{key:"getOverlayLayers",value:function(){return this.getLayerGroup().getLayers().getArray()[1].getLayers().getArray()}},{key:"initializeView",value:function(t,e){if(!this.getView().getZoom()){var n=new pi({extent:this.projection.getExtent(),projection:this.projection,maxZoom:16,minZoom:2,center:[140860.69299028325,190532.7165957574],zoom:2});this.zoomViewToExtent(n,t,e),this.setView(n),this.overviewMapControl&&this.addControl(this.overviewMapControl)}}},{key:"zoomToExtent",value:function(t,e){this.zoomViewToExtent(this.getView(),t,e)}},{key:"zoomViewToExtent",value:function(t,e,n){e&&t.fit(e,{size:this.getSize()}),(n||this.maxZoomViewToExtent)&&t.getZoom()>(n||this.maxZoomViewToExtent)&&t.setZoom(n||this.maxZoomViewToExtent)}},{key:"zoomToGeometry",value:function(t,e){var n={type:"FeatureCollection",features:[{type:"Feature",geometry:t}]};this.zoomToExtent(this.geoJSONFormat.readFeatures(n)[0].getGeometry().getExtent(),e)}},{key:"showInfo",value:function(t,e){var n=document.createElement("div");n.setAttribute("class","close"),n.onclick=function(){return event.currentTarget.parentNode.remove()};var i=document.createElement("div");i.innerHTML="<span class='content'>"+t+"</span><div class='arrow'></div>",i.setAttribute("class","info-tooltip"),i.appendChild(n);var r=new Hi({offset:[0,-5],positioning:"bottom-center",element:i});this.addOverlay(r),r.setPosition(e),i.parentNode.style.position="fixed"}}]),n}(),Io=function(){function t(e){f(this,t),this.opacity_=e.opacity,this.rotateWithView_=e.rotateWithView,this.rotation_=e.rotation,this.scale_=e.scale,this.displacement_=e.displacement}return g(t,[{key:"clone",value:function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})}},{key:"getOpacity",value:function(){return this.opacity_}},{key:"getRotateWithView",value:function(){return this.rotateWithView_}},{key:"getRotation",value:function(){return this.rotation_}},{key:"getScale",value:function(){return this.scale_}},{key:"getDisplacement",value:function(){return this.displacement_}},{key:"getAnchor",value:function(){return o()}},{key:"getImage",value:function(t){return o()}},{key:"getHitDetectionImage",value:function(t){return o()}},{key:"getImageState",value:function(){return o()}},{key:"getImageSize",value:function(){return o()}},{key:"getHitDetectionImageSize",value:function(){return o()}},{key:"getOrigin",value:function(){return o()}},{key:"getSize",value:function(){return o()}},{key:"setOpacity",value:function(t){this.opacity_=t}},{key:"setRotateWithView",value:function(t){this.rotateWithView_=t}},{key:"setRotation",value:function(t){this.rotation_=t}},{key:"setScale",value:function(t){this.scale_=t}},{key:"listenImageChange",value:function(t){o()}},{key:"load",value:function(){o()}},{key:"unlistenImageChange",value:function(t){o()}}]),t}(),So=function(t){s(n,Io);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this,{opacity:1,rotateWithView:void 0!==t.rotateWithView&&t.rotateWithView,rotation:void 0!==t.rotation?t.rotation:0,scale:1,displacement:void 0!==t.displacement?t.displacement:[0,0]})).canvas_=null,i.hitDetectionCanvas_=null,i.fill_=void 0!==t.fill?t.fill:null,i.origin_=[0,0],i.points_=t.points,i.radius_=void 0!==t.radius?t.radius:t.radius1,i.radius2_=t.radius2,i.angle_=void 0!==t.angle?t.angle:0,i.stroke_=void 0!==t.stroke?t.stroke:null,i.anchor_=null,i.size_=null,i.imageSize_=null,i.hitDetectionImageSize_=null,i.render(),i}return g(n,[{key:"clone",value:function(){var t=new n({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t}},{key:"getAnchor",value:function(){return this.anchor_}},{key:"getAngle",value:function(){return this.angle_}},{key:"getFill",value:function(){return this.fill_}},{key:"getHitDetectionImage",value:function(t){return this.hitDetectionCanvas_}},{key:"getImage",value:function(t){return this.canvas_}},{key:"getImageSize",value:function(){return this.imageSize_}},{key:"getHitDetectionImageSize",value:function(){return this.hitDetectionImageSize_}},{key:"getImageState",value:function(){return gs}},{key:"getOrigin",value:function(){return this.origin_}},{key:"getPoints",value:function(){return this.points_}},{key:"getRadius",value:function(){return this.radius_}},{key:"getRadius2",value:function(){return this.radius2_}},{key:"getSize",value:function(){return this.size_}},{key:"getStroke",value:function(){return this.stroke_}},{key:"listenImageChange",value:function(t){}},{key:"load",value:function(){}},{key:"unlistenImageChange",value:function(t){}},{key:"render",value:function(){var t,e="round",n="round",i=0,r=null,s=0,o=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t="#000"),t=Jr(t),void 0===(o=this.stroke_.getWidth())&&(o=1),r=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset(),void 0===(n=this.stroke_.getLineJoin())&&(n="round"),void 0===(e=this.stroke_.getLineCap())&&(e="round"),void 0===(i=this.stroke_.getMiterLimit())&&(i=10));var a=2*(this.radius_+o)+1,u={strokeStyle:t,strokeWidth:o,size:a,lineCap:e,lineDash:r,lineDashOffset:s,lineJoin:n,miterLimit:i},l=Di(a,a);this.canvas_=l.canvas;var h=a=this.canvas_.width,c=this.getDisplacement();this.draw_(u,l,0,0),this.createHitDetectionCanvas_(u),this.anchor_=[a/2-c[0],a/2+c[1]],this.size_=[a,a],this.imageSize_=[h,h]}},{key:"draw_",value:function(t,e,n,i){var r,s,o;e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var a=this.points_;if(a===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var u=void 0!==this.radius2_?this.radius2_:this.radius_;for(u!==this.radius_&&(a*=2),r=0;r<=a;r++)s=2*r*Math.PI/a-Math.PI/2+this.angle_,o=r%2==0?this.radius_:u,e.lineTo(t.size/2+o*Math.cos(s),t.size/2+o*Math.sin(s))}if(this.fill_){var l=this.fill_.getColor();null===l&&(l="#000"),e.fillStyle=Jr(l),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,e.setLineDash&&t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()}},{key:"createHitDetectionCanvas_",value:function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var e=this.fill_.getColor(),n=0;if("string"==typeof e&&(e=Wr(e)),null===e?n=1:Array.isArray(e)&&(n=4===e.length?e[3]:1),0===n){var i=Di(t.size,t.size);this.hitDetectionCanvas_=i.canvas,this.drawHitDetectionCanvas_(t,i,0,0)}}}},{key:"drawHitDetectionCanvas_",value:function(t,e,n,i){e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var s,o,a,u=void 0!==this.radius2_?this.radius2_:this.radius_;for(u!==this.radius_&&(r*=2),s=0;s<=r;s++)a=2*s*Math.PI/r-Math.PI/2+this.angle_,o=s%2==0?this.radius_:u,e.lineTo(t.size/2+o*Math.cos(a),t.size/2+o*Math.sin(a))}e.fillStyle="#000",e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()}}]),n}(),wo=function(t){s(n,So);var e=a(n);function n(t){f(this,n);var i=t||{};return e.call(this,{points:1/0,fill:i.fill,radius:i.radius,stroke:i.stroke,displacement:void 0!==i.displacement?i.displacement:[0,0]})}return g(n,[{key:"clone",value:function(){var t=new n({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t}},{key:"setRadius",value:function(t){this.radius_=t,this.render()}}]),n}(),No=function(){function t(e){f(this,t);var n=e||{};this.color_=void 0!==n.color?n.color:null}return g(t,[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0})}},{key:"getColor",value:function(){return this.color_}},{key:"setColor",value:function(t){this.color_=t}}]),t}(),Lo=function(){function t(e){f(this,t);var n=e||{};this.color_=void 0!==n.color?n.color:null,this.lineCap_=n.lineCap,this.lineDash_=void 0!==n.lineDash?n.lineDash:null,this.lineDashOffset_=n.lineDashOffset,this.lineJoin_=n.lineJoin,this.miterLimit_=n.miterLimit,this.width_=n.width}return g(t,[{key:"clone",value:function(){var e=this.getColor();return new t({color:Array.isArray(e)?e.slice():e||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}},{key:"getColor",value:function(){return this.color_}},{key:"getLineCap",value:function(){return this.lineCap_}},{key:"getLineDash",value:function(){return this.lineDash_}},{key:"getLineDashOffset",value:function(){return this.lineDashOffset_}},{key:"getLineJoin",value:function(){return this.lineJoin_}},{key:"getMiterLimit",value:function(){return this.miterLimit_}},{key:"getWidth",value:function(){return this.width_}},{key:"setColor",value:function(t){this.color_=t}},{key:"setLineCap",value:function(t){this.lineCap_=t}},{key:"setLineDash",value:function(t){this.lineDash_=t}},{key:"setLineDashOffset",value:function(t){this.lineDashOffset_=t}},{key:"setLineJoin",value:function(t){this.lineJoin_=t}},{key:"setMiterLimit",value:function(t){this.miterLimit_=t}},{key:"setWidth",value:function(t){this.width_=t}}]),t}(),Ro=function(){function t(e){f(this,t);var n=e||{};this.geometry_=null,this.geometryFunction_=Mo,void 0!==n.geometry&&this.setGeometry(n.geometry),this.fill_=void 0!==n.fill?n.fill:null,this.image_=void 0!==n.image?n.image:null,this.renderer_=void 0!==n.renderer?n.renderer:null,this.stroke_=void 0!==n.stroke?n.stroke:null,this.text_=void 0!==n.text?n.text:null,this.zIndex_=n.zIndex}return g(t,[{key:"clone",value:function(){var e=this.getGeometry();return e&&"object"==v(e)&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}},{key:"getRenderer",value:function(){return this.renderer_}},{key:"setRenderer",value:function(t){this.renderer_=t}},{key:"getGeometry",value:function(){return this.geometry_}},{key:"getGeometryFunction",value:function(){return this.geometryFunction_}},{key:"getFill",value:function(){return this.fill_}},{key:"setFill",value:function(t){this.fill_=t}},{key:"getImage",value:function(){return this.image_}},{key:"setImage",value:function(t){this.image_=t}},{key:"getStroke",value:function(){return this.stroke_}},{key:"setStroke",value:function(t){this.stroke_=t}},{key:"getText",value:function(){return this.text_}},{key:"setText",value:function(t){this.text_=t}},{key:"getZIndex",value:function(){return this.zIndex_}},{key:"setGeometry",value:function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Mo,this.geometry_=t}},{key:"setZIndex",value:function(t){this.zIndex_=t}}]),t}(),To=null;function bo(t,e){if(!To){var n=new No({color:"rgba(255,255,255,0.4)"}),i=new Lo({color:"#3399CC",width:1.25});To=[new Ro({image:new wo({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return To}function Po(){var t={},e=[255,255,255,1],n=[0,153,255,1];return t[ct]=[new Ro({fill:new No({color:[255,255,255,.5]})})],t[gt]=t[ct],t[ht]=[new Ro({stroke:new Lo({color:e,width:5})}),new Ro({stroke:new Lo({color:n,width:3})})],t[dt]=t[ht],t[_t]=t[ct].concat(t[ht]),t[lt]=[new Ro({image:new wo({radius:6,fill:new No({color:n}),stroke:new Lo({color:e,width:1.5})}),zIndex:1/0})],t[ft]=t[lt],t[vt]=t[ct].concat(t[ht],t[lt]),t}function Mo(t){return t.getGeometry()}var Oo=Ro,Fo="select",Do=function(t){s(n,H);var e=a(n);function n(t,i,r,s){var o;return f(this,n),(o=e.call(this,t)).selected=i,o.deselected=r,o.mapBrowserEvent=s,o}return n}(),Ao={};function Go(t){if(!this.condition_(t))return!0;var e=this.addCondition_(t),n=this.removeCondition_(t),i=this.toggleCondition_(t),r=!e&&!n&&!i,s=t.map,o=this.getFeatures(),a=[],u=[];if(r){m(this.featureLayerAssociation_),s.forEachFeatureAtPixel(t.pixel,function(t,e){if(this.filter_(t,e))return u.push(t),this.addFeatureLayerAssociation_(t,e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=o.getLength()-1;l>=0;--l){var h=o.item(l),c=u.indexOf(h);c>-1?u.splice(c,1):(o.remove(h),a.push(h))}0!==u.length&&o.extend(u)}else{s.forEachFeatureAtPixel(t.pixel,function(t,r){if(this.filter_(t,r))return!e&&!i||G(o.getArray(),t)?(n||i)&&G(o.getArray(),t)&&(a.push(t),this.removeFeatureLayerAssociation_(t)):(u.push(t),this.addFeatureLayerAssociation_(t,r)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var f=a.length-1;f>=0;--f)o.remove(a[f]);o.extend(u)}return(u.length>0||a.length>0)&&this.dispatchEvent(new Do(Fo,u,a,t)),!0}var Bo=function(t){s(n,Os);var e=a(n);function n(t){var i;f(this,n);var r,s=t||{};if((i=e.call(this,{handleEvent:Go})).boundAddFeature_=i.addFeature_.bind(l(i)),i.boundRemoveFeature_=i.removeFeature_.bind(l(i)),i.condition_=s.condition?s.condition:Ys,i.addCondition_=s.addCondition?s.addCondition:zs,i.removeCondition_=s.removeCondition?s.removeCondition:zs,i.toggleCondition_=s.toggleCondition?s.toggleCondition:Us,i.multi_=!!s.multi&&s.multi,i.filter_=s.filter?s.filter:Y,i.hitTolerance_=s.hitTolerance?s.hitTolerance:0,i.style_=void 0!==s.style?s.style:function(){var t=Po();return z(t[ct],t[ht]),z(t[vt],t[ht]),function(e){return e.getGeometry()?t[e.getGeometry().getType()]:null}}(),i.features_=s.features||new fr,s.layers)if("function"==typeof s.layers)r=s.layers;else{var o=s.layers;r=function(t){return G(o,t)}}else r=Y;return i.layerFilter_=r,i.featureLayerAssociation_={},i}return g(n,[{key:"addFeatureLayerAssociation_",value:function(t,e){this.featureLayerAssociation_[d(t)]=e}},{key:"getFeatures",value:function(){return this.features_}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"getLayer",value:function(t){return this.featureLayerAssociation_[d(t)]}},{key:"setHitTolerance",value:function(t){this.hitTolerance_=t}},{key:"setMap",value:function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),i(c(n.prototype),"setMap",this).call(this,t),t?(this.features_.addEventListener(lr,this.boundAddFeature_),this.features_.addEventListener(hr,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(lr,this.boundAddFeature_),this.features_.removeEventListener(hr,this.boundRemoveFeature_))}},{key:"addFeature_",value:function(t){var e=t.element;this.style_&&this.applySelectedStyle_(e)}},{key:"removeFeature_",value:function(t){var e=t.element;this.style_&&this.restorePreviousStyle_(e)}},{key:"getStyle",value:function(){return this.style_}},{key:"applySelectedStyle_",value:function(t){var e=d(t);e in Ao||(Ao[e]=t.getStyle()),t.setStyle(this.style_)}},{key:"restorePreviousStyle_",value:function(t){var e=d(t),i=this.getMap().getInteractions().getArray().filter(function(e){return e instanceof n&&e.getStyle()&&-1!==e.getFeatures().getArray().indexOf(t)});i.length>0?t.setStyle(i[i.length-1].getStyle()):(t.setStyle(Ao[e]),delete Ao[e])}},{key:"removeFeatureLayerAssociation_",value:function(t){delete this.featureLayerAssociation_[d(t)]}}]),n}(),Vo=function(){function t(e){var n=this;f(this,t),Array.isArray(e)||(e=[e]),this.interactions=[],e.forEach(function(t){n.addInteraction(t)})}return g(t,[{key:"addInteraction",value:function(t){t.setActive(!1),this.interactions.push(t)}},{key:"activate",value:function(){this.interactions.forEach(function(t){t.setActive(!0)})}},{key:"deactivate",value:function(){this.interactions.forEach(function(t){t.setActive(!1)})}}]),t}(),zo=function(t){s(n,Vo);var e=a(n);function n(t,i,r){var s;f(this,n);var o=r&&r.cluster,a=r&&r.filter?r.filter:function(){return!0},u=r?r.style:null,l=r&&r.hoverStyle||u,h=function(t,e){return s.selectInteraction.getFeatures().clear(),s.filter(t,e)},c=function(t,e){var n=-1!==s.selectInteraction.getFeatures().getArray().indexOf(t);return s.filter(t,e)&&!n},d=new Bo({filter:c,condition:qs,style:l}),g=new Bo({style:u}),v=new Bo({filter:h});(s=e.call(this,[g,v,d])).cluster=o,s.filter=a,s.layer=t,s.style=u,s.hoverStyle=l,s.hoverInteraction=d,s.markInteraction=g,s.selectInteraction=v,s.hoverInteraction.on("select",function(){var t=s.map.getTargetElement();s.hoverInteraction.getFeatures().getLength()>0?t.style.cursor="pointer":t.style.cursor=""}),s.selectedFeature=null,s.getLayer=function(){return t};return s.selectInteraction.on("select",function(t){if(s.markInteraction.getFeatures().clear(),s.selectInteraction.getFeatures().getLength()>0){1===s.selectInteraction.getFeatures().getLength()?s.selectedFeature=s.selectInteraction.getFeatures().getArray()[0]:s.selectedFeature=function(t){var e=t.getArray().indexOf(s.selectedFeature)+1;return e>t.getLength()-1&&(e=0),t.getArray()[e]}(s.selectInteraction.getFeatures()),i&&i(s.selectedFeature,t,s.getLayer(null))}else s.selectedFeature=null,i&&i()}),s.selectInteractionFilter=h,s.hoverInteractionFilter=c,s}return g(n,[{key:"_fixClusterBehavior",value:function(){var t=this;if(this.selectedFeature){var e=this.selectedFeature.get("features")||[this.selectedFeature];this.selectInteraction.getFeatures().clear(),this.markInteraction.getFeatures().clear(),e&&e.forEach(function(e){e.getId()&&t.markFeatureWithId(e.getId())})}}},{key:"getClusterWithFeatureId",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n].get("features");if(i&&this.getFeatureById(i,e))return t[n]}}},{key:"getFeatureById",value:function(t,e){for(var n=0;n<t.length;n++)if(t[n].getId()===e)return t[n]}},{key:"clearFeatures",value:function(){this.selectInteraction.getFeatures().clear(),this.markInteraction.getFeatures().clear(),this.hoverInteraction.getFeatures().clear()}},{key:"activate",value:function(){var t=this;this.cluster&&this.map&&(this._fixClusterBehaviorListener=function(){return t._fixClusterBehavior()},this.map.on("moveend",this._fixClusterBehaviorListener),this.selectInteraction.on("select",this._fixClusterBehaviorListener)),i(c(n.prototype),"activate",this).call(this)}},{key:"deactivate",value:function(){this._fixClusterBehaviorListener&&(this.map.un("moveend",this._fixClusterBehaviorListener),this.selectInteraction.un("select",this._fixClusterBehaviorListener)),this.clearFeatures(),i(c(n.prototype),"deactivate",this).call(this)}},{key:"selectFeature",value:function(t){this.selectInteraction.getFeatures().push(t),this.selectInteraction.dispatchEvent({type:"select",feature:t})}},{key:"getSelectedFeatures",value:function(){return this.selectInteraction.getFeatures()}},{key:"vergeetLaatstGeselecteerdeFeature",value:function(){this.selectedFeature=null}},{key:"markFeatureWithId",value:function(t,e){var n=(e=e||this.layer).getSource().getFeatureById(t)||this.getClusterWithFeatureId(e.getSource().getFeatures(),t);n&&-1===this.markInteraction.getFeatures().getArray().indexOf(n)&&this.markInteraction.getFeatures().push(n)}},{key:"isMarked",value:function(t){var e=!1;return this.markInteraction.getFeatures().forEach(function(n){n===t&&(e=!0)}),e}},{key:"demarkAllFeatures",value:function(){this.markInteraction.getFeatures().clear()}}]),n}(),qo=function(t){s(n,zo);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t,function(t){t&&i([t])},r)).dragBoxInteraction=new no({style:new Oo({stroke:new Lo({color:[0,0,255,1]})})}),s.addInteraction(s.dragBoxInteraction),s.dragBoxInteraction.on("boxdrag",function(){var e=s.dragBoxInteraction.getGeometry().getExtent();s.hoverInteraction.getFeatures().clear(),t.getSource().forEachFeatureIntersectingExtent(e,function(t){s.hoverInteraction.getFeatures().push(t)})}),s.dragBoxInteraction.on("boxend",function(){s.hoverInteraction.getFeatures().getLength()>0&&i(s.hoverInteraction.getFeatures().getArray().slice(0))}),s}return n}(),Yo=function(t){s(n,qo);var e=a(n);function n(t,i,r){var s;f(this,n);var o=new Oo({fill:new No({color:"rgba(217, 83, 79, 0.6)"}),stroke:new Lo({color:"#d9534f",width:5}),image:new wo({radius:4,stroke:new Lo({color:"#d9534f",width:5}),fill:new No({color:"rgba(217, 83, 79, 0.6)"})})}),a=r&&r.style||o,u=function(e){e&&t.getSource().getFeatureById(e.getId())===e&&t.getSource().removeFeature(e)};return s=e.call(this,t,function(t){i&&null!=i?i(t,function(t){u(t),s.clearFeatures()},function(){s.clearFeatures()}):(t.forEach(function(t){u(t)}),s.clearFeatures())},{style:a})}return n}(),Xo=function(t){s(n,rn);var e=a(n);function n(t,i,r){var s;if(f(this,n),s=e.call(this),void 0!==r&&void 0===i)s.setFlatCoordinates(r,t);else{var o=i||0;s.setCenterAndRadius(t,o,r)}return u(s)}return g(n,[{key:"clone",value:function(){return new n(this.flatCoordinates.slice(),void 0,this.layout)}},{key:"closestPointXY",value:function(t,e,n,i){var r=this.flatCoordinates,s=t-r[0],o=e-r[1],a=s*s+o*o;if(a<i){if(0===a)for(var u=0;u<this.stride;++u)n[u]=r[u];else{var l=this.getRadius()/Math.sqrt(a);n[0]=r[0]+l*s,n[1]=r[1]+l*o;for(var h=2;h<this.stride;++h)n[h]=r[h]}return n.length=this.stride,a}return i}},{key:"containsXY",value:function(t,e){var n=this.flatCoordinates,i=t-n[0],r=e-n[1];return i*i+r*r<=this.getRadiusSquared_()}},{key:"getCenter",value:function(){return this.flatCoordinates.slice(0,this.stride)}},{key:"computeExtent",value:function(t){var e=this.flatCoordinates,n=e[this.stride]-e[0];return bt(e[0]-n,e[1]-n,e[0]+n,e[1]+n,t)}},{key:"getRadius",value:function(){return Math.sqrt(this.getRadiusSquared_())}},{key:"getRadiusSquared_",value:function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}},{key:"getType",value:function(){return _t}},{key:"intersectsExtent",value:function(t){if(Zt(t,this.getExtent())){var e=this.getCenter();return t[0]<=e[0]&&t[2]>=e[0]||t[1]<=e[1]&&t[3]>=e[1]||Vt(t,this.intersectsCoordinate.bind(this))}return!1}},{key:"setCenter",value:function(t){var e=this.stride,n=this.flatCoordinates[e]-this.flatCoordinates[0],i=t.slice();i[e]=i[0]+n;for(var r=1;r<e;++r)i[e+r]=t[r];this.setFlatCoordinates(this.layout,i),this.changed()}},{key:"setCenterAndRadius",value:function(t,e,n){this.setLayout(n,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var i=this.flatCoordinates,r=hn(i,0,t,this.stride);i[r++]=i[0]+e;for(var s=1,o=this.stride;s<o;++s)i[r++]=i[s];i.length=r,this.changed()}},{key:"getCoordinates",value:function(){return null}},{key:"setCoordinates",value:function(t,e){}},{key:"setRadius",value:function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}},{key:"rotate",value:function(t,e){var n=this.getCenter(),i=this.getStride();this.setCenter(Ye(n,0,n.length,i,t,e,n)),this.changed()}},{key:"translate",value:function(t,e){var n=this.getCenter(),i=this.getStride();this.setCenter(Xe(n,0,n.length,i,t,e,n)),this.changed()}}]),n}();Xo.prototype.transform;var Uo=Xo,Wo="renderOrder",Ho=function(t){s(n,zr);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=p({},r);return delete s.style,delete s.renderBuffer,delete s.updateWhileAnimating,delete s.updateWhileInteracting,(i=e.call(this,s)).declutter_=void 0!==r.declutter&&r.declutter,i.renderBuffer_=void 0!==r.renderBuffer?r.renderBuffer:100,i.style_=null,i.styleFunction_=void 0,i.setStyle(r.style),i.updateWhileAnimating_=void 0!==r.updateWhileAnimating&&r.updateWhileAnimating,i.updateWhileInteracting_=void 0!==r.updateWhileInteracting&&r.updateWhileInteracting,i}return g(n,[{key:"getDeclutter",value:function(){return this.declutter_}},{key:"getFeatures",value:function(t){return i(c(n.prototype),"getFeatures",this).call(this,t)}},{key:"getRenderBuffer",value:function(){return this.renderBuffer_}},{key:"getRenderOrder",value:function(){return this.get(Wo)}},{key:"getStyle",value:function(){return this.style_}},{key:"getStyleFunction",value:function(){return this.styleFunction_}},{key:"getUpdateWhileAnimating",value:function(){return this.updateWhileAnimating_}},{key:"getUpdateWhileInteracting",value:function(){return this.updateWhileInteracting_}},{key:"setRenderOrder",value:function(t){this.set(Wo,t)}},{key:"setStyle",value:function(t){this.style_=void 0!==t?t:bo,this.styleFunction_=null===t?void 0:function(t){var e,n;"function"==typeof t?e=t:(Array.isArray(t)?n=t:(y("function"==typeof t.getZIndex,41),n=[t]),e=function(){return n});return e}(this.style_),this.changed()}}]),n}(),jo={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ko=[jo.FILL],Zo=[jo.STROKE],Jo=[jo.BEGIN_PATH],Qo=[jo.CLOSE_PATH],$o=jo,ta=function(t){s(n,Qr);var e=a(n);function n(t,i,r,s){var o;return f(this,n),(o=e.call(this)).tolerance=t,o.maxExtent=i,o.pixelRatio=s,o.maxLineWidth=0,o.resolution=r,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return g(n,[{key:"applyPixelRatio",value:function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})}},{key:"appendFlatCoordinates",value:function(t,e,n,i,r,s){var o=this.coordinates.length,a=this.getBufferedMaxExtent();s&&(e+=i);var u,l,h,c=t[e],f=t[e+1],d=this.tmpCoordinate_,g=!0;for(u=e+i;u<n;u+=i)d[0]=t[u],d[1]=t[u+1],(h=Tt(a,d))!==l?(g&&(this.coordinates[o++]=c,this.coordinates[o++]=f),this.coordinates[o++]=d[0],this.coordinates[o++]=d[1],g=!1):h===mt?(this.coordinates[o++]=d[0],this.coordinates[o++]=d[1],g=!1):g=!0,c=d[0],f=d[1],l=h;return(r&&g||u===e+i)&&(this.coordinates[o++]=c,this.coordinates[o++]=f),o}},{key:"drawCustomCoordinates_",value:function(t,e,n,i,r){for(var s=0,o=n.length;s<o;++s){var a=n[s],u=this.appendFlatCoordinates(t,e,a,i,!1,!1);r.push(u),e=a}return e}},{key:"drawCustom",value:function(t,e,n){this.beginGeometry(t,e);var i,r,s,o,a,u=t.getType(),l=t.getStride(),h=this.coordinates.length;if(u==gt){i=(t=t).getOrientedFlatCoordinates(),o=[];var c=t.getEndss();a=0;for(var f=0,d=c.length;f<d;++f){var g=[];a=this.drawCustomCoordinates_(i,a,c[f],l,g),o.push(g)}this.instructions.push([$o.CUSTOM,h,o,t,n,vn])}else u==ct||u==dt?(s=[],i=u==ct?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(i,0,t.getEnds(),l,s),this.instructions.push([$o.CUSTOM,h,s,t,n,gn])):u==ht||u==ft?(i=t.getFlatCoordinates(),r=this.appendFlatCoordinates(i,0,i.length,l,!1,!1),this.instructions.push([$o.CUSTOM,h,r,t,n,dn])):u==lt&&(i=t.getFlatCoordinates(),this.coordinates.push(i[0],i[1]),r=this.coordinates.length,this.instructions.push([$o.CUSTOM,h,r,t,n]));this.endGeometry(e)}},{key:"beginGeometry",value:function(t,e){var n=t.getExtent();this.beginGeometryInstruction1_=[$o.BEGIN_GEOMETRY,e,0,n],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[$o.BEGIN_GEOMETRY,e,0,n],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}},{key:"finish",value:function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}},{key:"reverseHitDetectionInstructions",value:function(){var t,e=this.hitDetectionInstructions;e.reverse();var n,i,r=e.length,s=-1;for(t=0;t<r;++t)(i=(n=e[t])[0])==$o.END_GEOMETRY?s=t:i==$o.BEGIN_GEOMETRY&&(n[2]=t,V(this.hitDetectionInstructions,s,t),s=-1)}},{key:"setFillStrokeStyle",value:function(t,e){var n=this.state;if(t){var i=t.getColor();n.fillStyle=Jr(i||"#000")}else n.fillStyle=void 0;if(e){var r=e.getColor();n.strokeStyle=Jr(r||"#000");var s=e.getLineCap();n.lineCap=void 0!==s?s:"round";var o=e.getLineDash();n.lineDash=o?o.slice():$r;var a=e.getLineDashOffset();n.lineDashOffset=a||0;var u=e.getLineJoin();n.lineJoin=void 0!==u?u:"round";var l=e.getWidth();n.lineWidth=void 0!==l?l:1;var h=e.getMiterLimit();n.miterLimit=void 0!==h?h:10,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}},{key:"createFill",value:function(t){var e=t.fillStyle,n=[$o.SET_FILL_STYLE,e];return"string"!=typeof e&&n.push(!0),n}},{key:"applyStroke",value:function(t){this.instructions.push(this.createStroke(t))}},{key:"createStroke",value:function(t){return[$o.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}},{key:"updateFillStyle",value:function(t,e){var n=t.fillStyle;"string"==typeof n&&t.currentFillStyle==n||(void 0!==n&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}},{key:"updateStrokeStyle",value:function(t,e){var n=t.strokeStyle,i=t.lineCap,r=t.lineDash,s=t.lineDashOffset,o=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=i||r!=t.currentLineDash&&!q(t.currentLineDash,r)||t.currentLineDashOffset!=s||t.currentLineJoin!=o||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==n&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=i,t.currentLineDash=r,t.currentLineDashOffset=s,t.currentLineJoin=o,t.currentLineWidth=a,t.currentMiterLimit=u)}},{key:"endGeometry",value:function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[$o.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}},{key:"getBufferedMaxExtent",value:function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=wt(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;St(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}]),n}(),ea=function(t){s(n,ta);var e=a(n);function n(t,i,r,s){var o;return f(this,n),(o=e.call(this,t,i,r,s)).declutterGroups_=null,o.hitDetectionImage_=null,o.image_=null,o.anchorX_=void 0,o.anchorY_=void 0,o.height_=void 0,o.opacity_=void 0,o.originX_=void 0,o.originY_=void 0,o.rotateWithView_=void 0,o.rotation_=void 0,o.scale_=void 0,o.width_=void 0,o}return g(n,[{key:"drawCoordinates_",value:function(t,e,n,i){return this.appendFlatCoordinates(t,e,n,i,!1,!1)}},{key:"drawPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,s=this.drawCoordinates_(n,0,n.length,i);this.instructions.push([$o.DRAW_IMAGE,r,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([$o.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}}},{key:"drawMultiPoint",value:function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,s=this.drawCoordinates_(n,0,n.length,i);this.instructions.push([$o.DRAW_IMAGE,r,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([$o.DRAW_IMAGE,r,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(e)}}},{key:"finish",value:function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,i(c(n.prototype),"finish",this).call(this)}},{key:"setImageStyle",value:function(t,e){var n=t.getAnchor(),i=t.getSize(),r=t.getHitDetectionImage(1),s=t.getImage(1),o=t.getOrigin();this.anchorX_=n[0],this.anchorY_=n[1],this.declutterGroups_=e,this.hitDetectionImage_=r,this.image_=s,this.height_=i[1],this.opacity_=t.getOpacity(),this.originX_=o[0],this.originY_=o[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=i[0]}}]),n}(),na=function(t){s(n,ta);var e=a(n);function n(t,i,r,s){return f(this,n),e.call(this,t,i,r,s)}return g(n,[{key:"drawFlatCoordinates_",value:function(t,e,n,i){var r=this.coordinates.length,s=this.appendFlatCoordinates(t,e,n,i,!1,!1),o=[$o.MOVE_TO_LINE_TO,r,s];return this.instructions.push(o),this.hitDetectionInstructions.push(o),n}},{key:"drawLineString",value:function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([$o.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],Jo);var s=t.getFlatCoordinates(),o=t.getStride();this.drawFlatCoordinates_(s,0,s.length,o),this.hitDetectionInstructions.push(Zo),this.endGeometry(e)}}},{key:"drawMultiLineString",value:function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([$o.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],Jo);for(var s=t.getEnds(),o=t.getFlatCoordinates(),a=t.getStride(),u=0,l=0,h=s.length;l<h;++l)u=this.drawFlatCoordinates_(o,u,s[l],a);this.hitDetectionInstructions.push(Zo),this.endGeometry(e)}}},{key:"finish",value:function(){var t=this.state;return null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Zo),this.reverseHitDetectionInstructions(),this.state=null,i(c(n.prototype),"finish",this).call(this)}},{key:"applyStroke",value:function(t){null!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Zo),t.lastStroke=this.coordinates.length),t.lastStroke=0,i(c(n.prototype),"applyStroke",this).call(this,t),this.instructions.push(Jo)}}]),n}(),ia=function(t){s(n,ta);var e=a(n);function n(t,i,r,s){return f(this,n),e.call(this,t,i,r,s)}return g(n,[{key:"drawFlatCoordinatess_",value:function(t,e,n,i){var r=this.state,s=void 0!==r.fillStyle,o=void 0!==r.strokeStyle,a=n.length;this.instructions.push(Jo),this.hitDetectionInstructions.push(Jo);for(var u=0;u<a;++u){var l=n[u],h=this.coordinates.length,c=this.appendFlatCoordinates(t,e,l,i,!0,!o),f=[$o.MOVE_TO_LINE_TO,h,c];this.instructions.push(f),this.hitDetectionInstructions.push(f),o&&(this.instructions.push(Qo),this.hitDetectionInstructions.push(Qo)),e=l}return s&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),o&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),e}},{key:"drawCircle",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([$o.SET_FILL_STYLE,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([$o.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var s=t.getFlatCoordinates(),o=t.getStride(),a=this.coordinates.length;this.appendFlatCoordinates(s,0,s.length,o,!1,!1);var u=[$o.CIRCLE,a];this.instructions.push(Jo,u),this.hitDetectionInstructions.push(Jo,u),void 0!==n.fillStyle&&(this.instructions.push(Ko),this.hitDetectionInstructions.push(Ko)),void 0!==n.strokeStyle&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),this.endGeometry(e)}}},{key:"drawPolygon",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([$o.SET_FILL_STYLE,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([$o.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var s=t.getEnds(),o=t.getOrientedFlatCoordinates(),a=t.getStride();this.drawFlatCoordinatess_(o,0,s,a),this.endGeometry(e)}}},{key:"drawMultiPolygon",value:function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(),this.beginGeometry(t,e),void 0!==n.fillStyle&&this.hitDetectionInstructions.push([$o.SET_FILL_STYLE,"#000"]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([$o.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);for(var s=t.getEndss(),o=t.getOrientedFlatCoordinates(),a=t.getStride(),u=0,l=0,h=s.length;l<h;++l)u=this.drawFlatCoordinatess_(o,u,s[l],a);this.endGeometry(e)}}},{key:"finish",value:function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t)for(var e=this.coordinates,r=0,s=e.length;r<s;++r)e[r]=wn(e[r],t);return i(c(n.prototype),"finish",this).call(this)}},{key:"setFillStrokeStyles_",value:function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)}}]),n}();function ra(t,e,n,i,r){var s,o,a,u,l,h,c,f,d,g=n,v=n,_=0,y=0,p=n;for(s=n;s<i;s+=r){var m=e[s],k=e[s+1];void 0!==u&&(f=m-u,d=k-l,a=Math.sqrt(f*f+d*d),void 0!==h&&(y+=o,Math.acos((h*f+c*d)/(o*a))>t&&(y>_&&(_=y,g=p,v=s),y=0,p=s-r)),o=a,h=f,c=d),u=m,l=k}return(y+=a)>_?[p,s]:[g,v]}var sa={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},oa={Circle:ia,Default:ta,Image:ea,LineString:na,Polygon:ia,Text:function(t){s(n,ta);var e=a(n);function n(t,i,r,s){var o;return f(this,n),(o=e.call(this,t,i,r,s)).declutterGroups_,o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o}return g(n,[{key:"finish",value:function(){var t=i(c(n.prototype),"finish",this).call(this);return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}},{key:"drawText",value:function(t,e){var n=this.textFillState_,i=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(n||i)){var s,o,a=this.coordinates.length,u=t.getType(),l=null,h=2,c=2;if("line"===r.placement){if(!Zt(this.getBufferedMaxExtent(),t.getExtent()))return;var f;if(l=t.getFlatCoordinates(),c=t.getStride(),u==ht)f=[l.length];else if(u==dt)f=t.getEnds();else if(u==ct)f=t.getEnds().slice(0,1);else if(u==gt){var d=t.getEndss();for(f=[],s=0,o=d.length;s<o;++s)f.push(d[s][0])}this.beginGeometry(t,e);for(var g,v=r.textAlign,_=0,y=0,p=f.length;y<p;++y){if(null==v){var m=ra(r.maxAngle,l,_,f[y],c);_=m[0],g=m[1]}else g=f[y];for(s=_;s<g;s+=c)this.coordinates.push(l[s],l[s+1]);h=this.coordinates.length,_=f[y];var k=this.declutterGroups_?0===y?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,h,k),a=h}this.endGeometry(e)}else{var x=null;switch(r.overflow||(x=[]),u){case lt:case ft:h=(l=t.getFlatCoordinates()).length;break;case ht:l=t.getFlatMidpoint();break;case _t:l=t.getCenter();break;case dt:h=(l=t.getFlatMidpoints()).length;break;case ct:l=t.getFlatInteriorPoint(),r.overflow||x.push(l[2]/this.resolution),c=3;break;case gt:var E=t.getFlatInteriorPoints();for(l=[],s=0,o=E.length;s<o;s+=3)r.overflow||x.push(E[s+2]/this.resolution),l.push(E[s],E[s+1]);if(0==(h=l.length))return}h=this.appendFlatCoordinates(l,0,h,c,!1,!1),this.saveTextStates_(),(r.backgroundFill||r.backgroundStroke)&&(this.setFillStrokeStyle(r.backgroundFill,r.backgroundStroke),r.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),r.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var C=this.pixelRatio;this.instructions.push([$o.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,r.padding==ts?ts:r.padding.map(function(t){return t*C}),!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.hitDetectionInstructions.push([$o.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,r.padding,!!r.backgroundFill,!!r.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,x]),this.endGeometry(e)}}}},{key:"saveTextStates_",value:function(){var t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,i=this.strokeKey_;t&&(i in this.strokeStates||(this.strokeStates[i]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||"center",textBaseline:e.textBaseline||"middle",scale:e.scale});var s=this.fillKey_;n&&(s in this.fillStates||(this.fillStates[s]={fillStyle:n.fillStyle}))}},{key:"drawChars_",value:function(t,e,n){var i=this.textStrokeState_,r=this.textState_,s=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();var u=this.pixelRatio,l=sa[r.textBaseline],h=this.textOffsetY_*u,c=this.text_,f=r.scale,d=i?i.lineWidth*f/2:0;this.instructions.push([$o.DRAW_CHARS,t,e,l,n,r.overflow,a,r.maxAngle,u,h,s,d*u,c,o,1]),this.hitDetectionInstructions.push([$o.DRAW_CHARS,t,e,l,n,r.overflow,a,r.maxAngle,1,h,s,d,c,o,1/u])}},{key:"setTextStyle",value:function(t,e){var n,i,r;if(t){this.declutterGroups_=e;var s=t.getFill();s?((i=this.textFillState_)||(i={},this.textFillState_=i),i.fillStyle=Jr(s.getColor()||"#000")):(i=null,this.textFillState_=i);var o=t.getStroke();if(o){(r=this.textStrokeState_)||(r={},this.textStrokeState_=r);var a=o.getLineDash(),u=o.getLineDashOffset(),l=o.getWidth(),h=o.getMiterLimit();r.lineCap=o.getLineCap()||"round",r.lineDash=a?a.slice():$r,r.lineDashOffset=void 0===u?0:u,r.lineJoin=o.getLineJoin()||"round",r.lineWidth=void 0===l?1:l,r.miterLimit=void 0===h?10:h,r.strokeStyle=Jr(o.getColor()||"#000")}else r=null,this.textStrokeState_=r;n=this.textState_;var c=t.getFont()||"10px sans-serif";ss(c);var f=t.getScale();n.overflow=t.getOverflow(),n.font=c,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.textBaseline=t.getTextBaseline()||"middle",n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||ts,n.scale=void 0===f?1:f;var g=t.getOffsetX(),v=t.getOffsetY(),_=t.getRotateWithView(),y=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===g?0:g,this.textOffsetY_=void 0===v?0:v,this.textRotateWithView_=void 0!==_&&_,this.textRotation_=void 0===y?0:y,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:d(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.textBaseline||"?"),this.fillKey_=i?"string"==typeof i.fillStyle?i.fillStyle:"|"+d(i.fillStyle):""}else this.text_=""}}]),n}()},aa=function(){function t(e,n,i,r,s){f(this,t),this.declutter_=s,this.declutterGroups_=null,this.tolerance_=e,this.maxExtent_=n,this.pixelRatio_=r,this.resolution_=i,this.buildersByZIndex_={}}return g(t,[{key:"addDeclutter",value:function(t){var e=null;return this.declutter_&&(t?(e=this.declutterGroups_)[0][4]++:(e=[[1/0,1/0,-1/0,-1/0]],this.declutterGroups_=e,e[0].push(1))),e}},{key:"finish",value:function(){var t={};for(var e in this.buildersByZIndex_){t[e]=t[e]||{};var n=this.buildersByZIndex_[e];for(var i in n){var r=n[i].finish();t[e][i]=r}}return t}},{key:"getBuilder",value:function(t,e){var n=void 0!==t?t.toString():"0",i=this.buildersByZIndex_[n];void 0===i&&(i={},this.buildersByZIndex_[n]=i);var r=i[e];return void 0===r&&(r=new(0,oa[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[e]=r),r}}]),t}();function ua(t,e,n,i,r,s,o,a,u,l,h){for(var c,f,d=[],g=t[e]>t[n-i],v=r.length,_=t[e],y=t[e+1],p=t[e+=i],m=t[e+1],k=0,x=Math.sqrt(Math.pow(p-_,2)+Math.pow(m-y,2)),E=!1,C=0;C<v;++C){for(var I=r[c=g?v-C-1:C],S=a*u(l,I,h),w=s+S/2;e<n-i&&k+x<w;)_=p,y=m,p=t[e+=i],m=t[e+1],k+=x,x=Math.sqrt(Math.pow(p-_,2)+Math.pow(m-y,2));var N=w-k,L=Math.atan2(m-y,p-_);if(g&&(L+=L>0?-Math.PI:Math.PI),void 0!==f){var R=L-f;if(E=E||0!==R,R+=R>Math.PI?-2*Math.PI:R<-Math.PI?2*Math.PI:0,Math.abs(R)>o)return null}f=L;var T=N/x,b=ut(_,p,T),P=ut(y,m,T);d[c]=[b,P,S/2,L,I],s+=S}return E?d:[[d[0][0],d[0][1],d[0][2],d[0][3],r]]}var la=r(0),ha=r.n(la),ca=[1/0,1/0,-1/0,-1/0],fa=[1,0,0,1,0,0],da=[],ga=[],va=[],_a=[],ya=function(){function t(e,n,i,r){f(this,t),this.overlaps=i,this.pixelRatio=n,this.resolution=e,this.alignFill_,this.declutterItems=[],this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=[1,0,0,1,0,0],this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return g(t,[{key:"createLabel",value:function(t,e,n,i){var r=t+e+n+i;if(this.labels_[r])return this.labels_[r];var s=i?this.strokeStates[i]:null,o=n?this.fillStates[n]:null,a=this.textStates[e],u=this.pixelRatio,l=a.scale*u,h=sa[a.textAlign||"center"],c=i&&s.lineWidth?s.lineWidth:0,f=t.split("\n"),d=f.length,g=[],v=function(t,e,n){for(var i=e.length,r=0,s=0;s<i;++s){var o=us(t,e[s]);r=Math.max(r,o),n.push(o)}return r}(a.font,f,g),_=os(a.font),y=_*d,p=v+c,m=[],k={width:Math.ceil((p+2)*l),height:Math.ceil((y+c)*l),contextInstructions:m};1!=l&&m.push("scale",[l,l]),m.push("font",a.font),i&&(m.push("strokeStyle",s.strokeStyle),m.push("lineWidth",c),m.push("lineCap",s.lineCap),m.push("lineJoin",s.lineJoin),m.push("miterLimit",s.miterLimit),(Mi?OffscreenCanvasRenderingContext2D:CanvasRenderingContext2D).prototype.setLineDash&&(m.push("setLineDash",[s.lineDash]),m.push("lineDashOffset",s.lineDashOffset))),n&&m.push("fillStyle",o.fillStyle),m.push("textBaseline","middle"),m.push("textAlign","center");var x,E=.5-h,C=h*p+E*c;if(i)for(x=0;x<d;++x)m.push("strokeText",[f[x],C+E*g[x],.5*(c+_)+x*_]);if(n)for(x=0;x<d;++x)m.push("fillText",[f[x],C+E*g[x],.5*(c+_)+x*_]);return this.labels_[r]=k,k}},{key:"replayTextBackground_",value:function(t,e,n,i,r,s,o){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,i),t.lineTo.apply(t,r),t.lineTo.apply(t,e),s&&(this.alignFill_=s[2],this.fill_(t)),o&&(this.setStrokeStyle_(t,o),t.stroke())}},{key:"replayImageOrLabel_",value:function(t,e,n,i,r,s,o,a,u,l,h,c,f,d,g,v,_,y){var p=_||y;e-=r*=f,n-=s*=f;var m=g+l>i.width?i.width-l:g,k=a+h>i.height?i.height-h:a,x=v[3]+m*f+v[1],E=v[0]+k*f+v[2],C=e-v[3],I=n-v[0];(p||0!==c)&&(da[0]=C,_a[0]=C,da[1]=I,ga[1]=I,ga[0]=C+x,va[0]=ga[0],va[1]=I+E,_a[1]=va[1]);var S=null;if(0!==c){var w=e+r,N=n+s;S=We(fa,w,N,1,1,c,-w,-N),Ue(fa,da),Ue(fa,ga),Ue(fa,va),Ue(fa,_a),bt(Math.min(da[0],ga[0],va[0],_a[0]),Math.min(da[1],ga[1],va[1],_a[1]),Math.max(da[0],ga[0],va[0],_a[0]),Math.max(da[1],ga[1],va[1],_a[1]),ca)}else bt(C,I,C+x,I+E,ca);var L=t.canvas,R=y?y[2]*f/2:0,T=ca[0]-R<=L.width&&ca[2]+R>=0&&ca[1]-R<=L.height&&ca[3]+R>=0;if(d&&(e=Math.round(e),n=Math.round(n)),o){if(!T&&1==o[4])return;Dt(o,ca);var b=T?[t,S?S.slice(0):null,u,i,l,h,m,k,e,n,f]:null;b&&(p&&b.push(_,y,da.slice(0),ga.slice(0),va.slice(0),_a.slice(0)),o.push(b))}else T&&(p&&this.replayTextBackground_(t,da,ga,va,_a,_,y),cs(t,S,u,i,l,h,m,k,e,n,f))}},{key:"fill_",value:function(t){if(this.alignFill_){var e=Ue(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}},{key:"setStrokeStyle_",value:function(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.setLineDash&&(t.lineDashOffset=e[7],t.setLineDash(e[6]))}},{key:"renderDeclutter",value:function(t,e,n,i){if(t&&t.length>5){var r=t[4];if(1==r||r==t.length-5){var s={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};if(i||(i=new ha.a(9)),!i.collides(s)){i.insert(s);for(var o=5,a=t.length;o<a;++o){var u=t[o],l=u[0],h=l.globalAlpha;h!==n&&(l.globalAlpha=n),u.length>11&&this.replayTextBackground_(u[0],u[13],u[14],u[15],u[16],u[11],u[12]),cs.apply(void 0,u),h!==n&&(l.globalAlpha=h)}}t.length=5,Pt(t)}}return i}},{key:"drawLabelWithPointPlacement_",value:function(t,e,n,i){var r=this.textStates[e],s=this.createLabel(t,e,i,n),o=this.strokeStates[n],a=this.pixelRatio,u=sa[r.textAlign||"center"],l=sa[r.textBaseline||"middle"],h=o&&o.lineWidth?o.lineWidth:0;return{label:s,anchorX:u*(s.width/a-2*r.scale)+2*(.5-u)*h,anchorY:l*s.height/a+2*(.5-l)*h}}},{key:"execute_",value:function(t,e,n,i,r,s){var o,a,u;this.declutterItems.length=0,this.pixelCoordinates_&&q(e,this.renderedTransform_)?o=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),o=qe(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),u=e,(a=this.renderedTransform_)[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5]);for(var l,h,c,f,d,g,v,_,y,p,m,k,x,E,C,I,S,w=0,N=n.length,L=0,R=0,T=0,b=null,P=null,M=this.coordinateCache_,O=this.viewRotation_,F=Math.round(1e12*Math.atan2(-e[1],e[0]))/1e12,D={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:O},A=this.instructions!=n||this.overlaps?0:200;w<N;){var G=n[w];switch(G[0]){case $o.BEGIN_GEOMETRY:(C=G[1]).getGeometry()?void 0===s||Zt(s,G[3])?++w:w=G[2]+1:w=G[2];break;case $o.BEGIN_PATH:R>A&&(this.fill_(t),R=0),T>A&&(t.stroke(),T=0),R||T||(t.beginPath(),f=NaN,d=NaN),++w;break;case $o.CIRCLE:var B=o[L=G[1]],V=o[L+1],z=o[L+2]-B,Y=o[L+3]-V,X=Math.sqrt(z*z+Y*Y);t.moveTo(B+X,V),t.arc(B,V,X,0,2*Math.PI,!0),++w;break;case $o.CLOSE_PATH:t.closePath(),++w;break;case $o.CUSTOM:L=G[1],l=G[2];var U=G[3],W=G[4],H=6==G.length?G[5]:void 0;D.geometry=U,D.feature=C,w in M||(M[w]=[]);var j=M[w];H?H(o,L,l,2,j):(j[0]=o[L],j[1]=o[L+1],j.length=2),W(j,D),++w;break;case $o.DRAW_IMAGE:L=G[1],l=G[2],p=G[3],h=G[4],c=G[5],y=r?null:G[6];var K=G[7],Z=G[8],J=G[9],Q=G[10],$=G[11],tt=G[12],et=G[13],nt=void 0,it=void 0,rt=void 0,st=void 0,ot=G[14];if(!p&&G.length>=19){m=G[18],k=G[19],x=G[20],E=G[21];var at=this.drawLabelWithPointPlacement_(m,k,x,E);p=at.label,G[3]=p;var ut=G[22];h=(at.anchorX-ut)*this.pixelRatio,G[4]=h;var lt=G[23];c=(at.anchorY-lt)*this.pixelRatio,G[5]=c,K=p.height,G[7]=K,ot=p.width,G[14]=ot}G.length>24&&(nt=G[24]),G.length>16?(it=G[15],rt=G[16],st=G[17]):(it=ts,rt=!1,st=!1),$&&F?tt+=O:$||F||(tt-=O);for(var ht=0,ct=0;L<l;L+=2)if(!(nt&&nt[ht++]<ot/this.pixelRatio)){if(y){var ft=Math.floor(ct);y.length<ft+1&&((_=[1/0,1/0,-1/0,-1/0]).push(y[0][4]),y.push(_)),_=y[ft]}this.replayImageOrLabel_(t,o[L],o[L+1],p,h,c,_,K,Z,J,Q,tt,et,i,ot,it,rt?b:null,st?P:null),_&&(ct===Math.floor(ct)&&this.declutterItems.push(this,_,C),ct+=1/_[4])}++w;break;case $o.DRAW_CHARS:var dt=G[1],gt=G[2],vt=G[3];_=r?null:G[4];var _t=G[5];E=G[6];var yt=G[7],pt=G[8],mt=G[9];x=G[10];var kt=G[11];m=G[12],k=G[13];var xt=G[14],Et=this.textStates[k],Ct=Et.font,It=Et.scale*pt,St=void 0;Ct in this.widths_?St=this.widths_[Ct]:(St={},this.widths_[Ct]=St);var wt=In(o,dt,gt,2),Nt=It*ls(Ct,m,St);if(_t||Nt<=wt){var Lt=this.textStates[k].textAlign,Rt=ua(o,dt,gt,2,m,(wt-Nt)*sa[Lt],yt,It,ls,Ct,St);if(Rt){var Tt=void 0,bt=void 0,Pt=void 0,Mt=void 0,Ot=void 0;if(x)for(Tt=0,bt=Rt.length;Tt<bt;++Tt)Pt=(Ot=Rt[Tt])[4],Mt=this.createLabel(Pt,k,"",x),h=Ot[2]+kt,c=vt*Mt.height+2*(.5-vt)*kt-mt,this.replayImageOrLabel_(t,Ot[0],Ot[1],Mt,h,c,_,Mt.height,1,0,0,Ot[3],xt,!1,Mt.width,ts,null,null);if(E)for(Tt=0,bt=Rt.length;Tt<bt;++Tt)Pt=(Ot=Rt[Tt])[4],Mt=this.createLabel(Pt,k,E,""),h=Ot[2],c=vt*Mt.height-mt,this.replayImageOrLabel_(t,Ot[0],Ot[1],Mt,h,c,_,Mt.height,1,0,0,Ot[3],xt,!1,Mt.width,ts,null,null)}}this.declutterItems.push(this,_,C),++w;break;case $o.END_GEOMETRY:if(void 0!==r){var Ft=r(C=G[1]);if(Ft)return Ft}++w;break;case $o.FILL:A?R++:this.fill_(t),++w;break;case $o.MOVE_TO_LINE_TO:for(L=G[1],l=G[2],I=o[L],v=(S=o[L+1])+.5|0,(g=I+.5|0)===f&&v===d||(t.moveTo(I,S),f=g,d=v),L+=2;L<l;L+=2)g=(I=o[L])+.5|0,v=(S=o[L+1])+.5|0,L!=l-2&&g===f&&v===d||(t.lineTo(I,S),f=g,d=v);++w;break;case $o.SET_FILL_STYLE:b=G,this.alignFill_=G[2],R&&(this.fill_(t),R=0,T&&(t.stroke(),T=0)),t.fillStyle=G[1],++w;break;case $o.SET_STROKE_STYLE:P=G,T&&(t.stroke(),T=0),this.setStrokeStyle_(t,G),++w;break;case $o.STROKE:A?T++:t.stroke(),++w;break;default:++w}}R&&this.fill_(t),T&&t.stroke()}},{key:"execute",value:function(t,e,n,i){this.viewRotation_=n,this.execute_(t,e,this.instructions,i,void 0,void 0)}},{key:"executeHitDetection",value:function(t,e,n,i,r){return this.viewRotation_=n,this.execute_(t,e,this.hitDetectionInstructions,!0,i,r)}}]),t}(),pa=[ms,"Circle",ps,ys,ks,_s],ma={0:[[!0]]};function ka(t,e,n){var i,r=Math.floor(t.length/2);if(e>=r)for(i=r;i<e;i++)t[i][n]=!0;else if(e<r)for(i=e+1;i<r;i++)t[i][n]=!0}var xa=function(){function t(e,n,i,r,s,o){f(this,t),this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=n,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=[1,0,0,1,0,0],this.createExecutors_(s)}return g(t,[{key:"clip",value:function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}},{key:"createExecutors_",value:function(t){for(var e in t){var n=this.executorsByZIndex_[e];void 0===n&&(n={},this.executorsByZIndex_[e]=n);var i=t[e];for(var r in i){var s=i[r];n[r]=new ya(this.resolution_,this.pixelRatio_,this.overlaps_,s)}}}},{key:"hasExecutors",value:function(t){for(var e in this.executorsByZIndex_)for(var n=this.executorsByZIndex_[e],i=0,r=t.length;i<r;++i)if(t[i]in n)return!0;return!1}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r,s){var o=2*(i=Math.round(i))+1,a=We(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-n,-t[0],-t[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Di(o,o));var u,l=this.hitDetectionContext_;l.canvas.width!==o||l.canvas.height!==o?(l.canvas.width=o,l.canvas.height=o):l.clearRect(0,0,o,o),void 0!==this.renderBuffer_&&(At(u=[1/0,1/0,-1/0,-1/0],t),St(u,e*(this.renderBuffer_+i),u));var h,c=function(t){if(void 0!==ma[t])return ma[t];for(var e=2*t+1,n=new Array(e),i=0;i<e;i++)n[i]=new Array(e);for(var r=t,s=0,o=0;r>=s;)ka(n,t+r,t+s),ka(n,t+s,t+r),ka(n,t-s,t+r),ka(n,t-r,t+s),ka(n,t-r,t-s),ka(n,t-s,t-r),ka(n,t+s,t-r),ka(n,t+r,t-s),2*((o+=1+2*++s)-r)+1>0&&(o+=1-2*(r-=1));return ma[t]=n,n}(i);function f(t){for(var e=l.getImageData(0,0,o,o).data,n=0;n<o;n++)for(var i=0;i<o;i++)if(c[n][i]&&e[4*(i*o+n)+3]>0){var a=void 0;return(!s||h!=ys&&h!=ks||-1!==s.indexOf(t))&&(a=r(t)),a||void l.clearRect(0,0,o,o)}}var d,g,v,_,y,p=Object.keys(this.executorsByZIndex_).map(Number);for(p.sort(A),d=p.length-1;d>=0;--d){var m=p[d].toString();for(v=this.executorsByZIndex_[m],g=pa.length-1;g>=0;--g)if(void 0!==(_=v[h=pa[g]])&&(y=_.executeHitDetection(l,a,n,f,u)))return y}}},{key:"getClipCoords",value:function(t){var e=this.maxExtent_;if(!e)return null;var n=e[0],i=e[1],r=e[2],s=e[3],o=[n,i,n,s,r,s,r,i];return qe(o,0,8,2,t,o),o}},{key:"isEmpty",value:function(){return x(this.executorsByZIndex_)}},{key:"execute",value:function(t,e,n,i,r,s){var o=Object.keys(this.executorsByZIndex_).map(Number);o.sort(A),this.maxExtent_&&(t.save(),this.clip(t,e));var a,u,l,h,c,f,d=r||pa;for(a=0,u=o.length;a<u;++a){var g=o[a].toString();for(c=this.executorsByZIndex_[g],l=0,h=d.length;l<h;++l){var v=d[l];if(void 0!==(f=c[v]))if(!s||v!=ys&&v!=ks)f.execute(t,e,n,i);else{var _=s[g];_?_.push(f,e.slice(0)):s[g]=[f,e.slice(0)]}}}this.maxExtent_&&t.restore()}}]),t}(),Ea=function(t){s(n,Z);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).boundHandleImageChange_=i.handleImageChange_.bind(l(i)),i.layer_=t,i}return g(n,[{key:"getFeatures",value:function(t){return o()}},{key:"prepareFrame",value:function(t){return o()}},{key:"renderFrame",value:function(t,e){return o()}},{key:"loadedTileCallback",value:function(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}},{key:"createLoadedTileFinder",value:function(t,e,n){return function(i,r){var s=this.loadedTileCallback.bind(this,n,i);return t.forEachLoadedTile(e,i,r,s)}.bind(this)}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r){}},{key:"getDataAtPixel",value:function(t,e,n){return o()}},{key:"getLayer",value:function(){return this.layer_}},{key:"handleFontsChanged",value:function(){}},{key:"handleImageChange_",value:function(t){t.target.getState()===gs&&this.renderIfReadyAndVisible()}},{key:"loadImage",value:function(t){var e=t.getState();return e!=gs&&e!=vs&&t.addEventListener(S,this.boundHandleImageChange_),e==ds&&(t.load(),e=t.getState()),e==gs}},{key:"renderIfReadyAndVisible",value:function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Dr&&t.changed()}}]),n}(),Ca=function(t){s(n,Ea);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this,t)).container=null,i.renderedResolution,i.tempTransform_=[1,0,0,1,0,0],i.pixelTransform=[1,0,0,1,0,0],i.inversePixelTransform=[1,0,0,1,0,0],i.context=null,i.containerReused=!1,i}return g(n,[{key:"useContainer",value:function(t,e,n){var i,r,s=this.getLayer().getClassName();if(t&&""===t.style.opacity&&t.className===s){var o=t.firstElementChild;o instanceof HTMLCanvasElement&&(r=o.getContext("2d"))}if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(i=document.createElement("div")).className=s;var a=i.style;a.position="absolute",a.width="100%",a.height="100%";var u=(r=Di()).canvas;i.appendChild(u),(a=u.style).position="absolute",a.left="0",a.transformOrigin="top left",this.container=i,this.context=r}}},{key:"clip",value:function(t,e,n){var i=e.pixelRatio,r=e.size[0]*i/2,s=e.size[1]*i/2,o=e.viewState.rotation,a=Ht(n),u=jt(n),l=qt(n),h=zt(n);Ue(e.coordinateToPixelTransform,a),Ue(e.coordinateToPixelTransform,u),Ue(e.coordinateToPixelTransform,l),Ue(e.coordinateToPixelTransform,h),t.save(),hs(t,-o,r,s),t.beginPath(),t.moveTo(a[0]*i,a[1]*i),t.lineTo(u[0]*i,u[1]*i),t.lineTo(l[0]*i,l[1]*i),t.lineTo(h[0]*i,h[1]*i),t.clip(),hs(t,o,r,s)}},{key:"clipUnrotated",value:function(t,e,n){var i=Ht(n),r=jt(n),s=qt(n),o=zt(n);Ue(e.coordinateToPixelTransform,i),Ue(e.coordinateToPixelTransform,r),Ue(e.coordinateToPixelTransform,s),Ue(e.coordinateToPixelTransform,o);var a=this.inversePixelTransform;Ue(a,i),Ue(a,r),Ue(a,s),Ue(a,o),t.save(),t.beginPath(),t.moveTo(Math.round(i[0]),Math.round(i[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.clip()}},{key:"dispatchRenderEvent_",value:function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){var r=new qr(t,this.inversePixelTransform,n,e);i.dispatchEvent(r)}}},{key:"preRender",value:function(t,e){this.dispatchRenderEvent_("prerender",t,e)}},{key:"postRender",value:function(t,e){this.dispatchRenderEvent_("postrender",t,e)}},{key:"getRenderTransform",value:function(t,e,n,i,r,s,o){var a=r/2,u=s/2,l=i/e,h=-l,c=-t[0]+o,f=-t[1];return We(this.tempTransform_,a,u,l,h,-n,c,f)}},{key:"getDataAtPixel",value:function(t,e,n){var i,r=Ue(this.inversePixelTransform,t.slice()),s=this.context;try{i=s.getImageData(Math.round(r[0]),Math.round(r[1]),1,1).data}catch(t){return"SecurityError"===t.name?new Uint8Array:i}return 0===i[3]?null:i}}]),n}(),Ia="fraction";var Sa=function(t){s(i,j);var n=a(i);function i(t,e,r,s,o,a){var u;return f(this,i),(u=n.call(this)).hitDetectionImage_=null,u.image_=t||new Image,null!==s&&(u.image_.crossOrigin=s),u.canvas_=a?document.createElement("canvas"):null,u.color_=a,u.unlisten_=null,u.imageState_=o,u.size_=r,u.src_=e,u.tainted_,u}return g(i,[{key:"isTainted_",value:function(t){if(void 0===this.tainted_&&this.imageState_===gs){t||(t=Di(1,1)).drawImage(this.image_,0,0);try{t.getImageData(0,0,1,1),this.tainted_=!1}catch(t){this.tainted_=!0}}return!0===this.tainted_}},{key:"dispatchChangeEvent_",value:function(){this.dispatchEvent(S)}},{key:"handleImageError_",value:function(){this.imageState_=vs,this.unlistenImage_(),this.dispatchChangeEvent_()}},{key:"handleImageLoad_",value:function(){this.imageState_=gs,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()}},{key:"getImage",value:function(t){return this.canvas_?this.canvas_:this.image_}},{key:"getImageState",value:function(){return this.imageState_}},{key:"getHitDetectionImage",value:function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],n=this.size_[1],i=Di(e,n);i.fillRect(0,0,e,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}},{key:"getSize",value:function(){return this.size_}},{key:"getSrc",value:function(){return this.src_}},{key:"load",value:function(){if(this.imageState_==ds){this.imageState_=1;try{this.image_.src=this.src_}catch(e){this.handleImageError_()}this.unlisten_=function(t,e,n){var i=t;if(i.src&&Oi){var r=i.decode(),s=!0;return r.then(function(){s&&e()}).catch(function(t){s&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())}),function(){s=!1}}var o=[C(i,b,e),C(i,w,n)];return function(){o.forEach(I)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}},{key:"replaceColor_",value:function(){if(this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");if(t.drawImage(this.image_,0,0),this.isTainted_(t)){var e=this.color_;return t.globalCompositeOperation="multiply",t.fillStyle="rgb("+e[0]+","+e[1]+","+e[2]+")",t.fillRect(0,0,this.image_.width,this.image_.height),t.globalCompositeOperation="destination-in",void t.drawImage(this.image_,0,0)}for(var n=t.getImageData(0,0,this.image_.width,this.image_.height),i=n.data,r=this.color_[0]/255,s=this.color_[1]/255,o=this.color_[2]/255,a=0,u=i.length;a<u;a+=4)i[a]*=r,i[a+1]*=s,i[a+2]*=o;t.putImageData(n,0,0)}}},{key:"unlistenImage_",value:function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}]),i}(),wa="bottom-left",Na="bottom-right",La="top-left",Ra="top-right",Ta=function(t){s(n,Io);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=void 0!==r.opacity?r.opacity:1,o=void 0!==r.rotation?r.rotation:0,a=void 0!==r.scale?r.scale:1,u=void 0!==r.rotateWithView&&r.rotateWithView;(i=e.call(this,{opacity:s,rotation:o,scale:a,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:u})).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],i.normalizedAnchor_=null,i.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:La,i.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:Ia,i.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:Ia,i.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var l=void 0!==r.img?r.img:null,h=void 0!==r.imgSize?r.imgSize:null,c=r.src;y(!(void 0!==c&&l),4),y(!l||l&&h,5),void 0!==c&&0!==c.length||!l||(c=l.src||d(l)),y(void 0!==c&&c.length>0,6);var g=void 0!==r.src?ds:gs;return i.color_=void 0!==r.color?Wr(r.color):null,i.iconImage_=function(t,e,n,i,r,s){var o=Zr.get(e,i,s);return o||(o=new Sa(t,e,n,i,r,s),Zr.set(e,i,s,o)),o}(l,c,h,i.crossOrigin_,g,i.color_),i.offset_=void 0!==r.offset?r.offset:[0,0],i.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:La,i.origin_=null,i.size_=void 0!==r.size?r.size:null,i}return g(n,[{key:"clone",value:function(){return new n({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})}},{key:"getAnchor",value:function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==Ia||this.anchorYUnits_==Ia){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==Ia&&(t[0]*=e[0]),this.anchorYUnits_==Ia&&(t[1]*=e[1])}if(this.anchorOrigin_!=La){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Ra&&this.anchorOrigin_!=Na||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=wa&&this.anchorOrigin_!=Na||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_}},{key:"setAnchor",value:function(t){this.anchor_=t,this.normalizedAnchor_=null}},{key:"getColor",value:function(){return this.color_}},{key:"getImage",value:function(t){return this.iconImage_.getImage(t)}},{key:"getImageSize",value:function(){return this.iconImage_.getSize()}},{key:"getHitDetectionImageSize",value:function(){return this.getImageSize()}},{key:"getImageState",value:function(){return this.iconImage_.getImageState()}},{key:"getHitDetectionImage",value:function(t){return this.iconImage_.getHitDetectionImage(t)}},{key:"getOrigin",value:function(){if(this.origin_)return this.origin_;var t=this.offset_,e=this.getDisplacement();if(this.offsetOrigin_!=La){var n=this.getSize(),i=this.iconImage_.getSize();if(!n||!i)return null;t=t.slice(),this.offsetOrigin_!=Ra&&this.offsetOrigin_!=Na||(t[0]=i[0]-n[0]-t[0]),this.offsetOrigin_!=wa&&this.offsetOrigin_!=Na||(t[1]=i[1]-n[1]-t[1])}return t[0]+=e[0],t[1]+=e[1],this.origin_=t,this.origin_}},{key:"getSrc",value:function(){return this.iconImage_.getSrc()}},{key:"getSize",value:function(){return this.size_?this.size_:this.iconImage_.getSize()}},{key:"listenImageChange",value:function(t){this.iconImage_.addEventListener(S,t)}},{key:"load",value:function(){this.iconImage_.load()}},{key:"unlistenImageChange",value:function(t){this.iconImage_.removeEventListener(S,t)}}]),n}(),ba=function(t){s(n,Ca);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this,t)).boundHandleStyleImageChange_=i.handleStyleImageChange_.bind(l(i)),i.animatingOrInteracting_,i.dirty_=!1,i.hitDetectionImageData_=null,i.renderedFeatures_=null,i.renderedRevision_=-1,i.renderedResolution_=NaN,i.renderedExtent_=[1/0,1/0,-1/0,-1/0],i.renderedRotation_,i.renderedCenter_=null,i.renderedProjection_=null,i.renderedRenderOrder_=null,i.replayGroup_=null,i.replayGroupChanged=!0,i}return g(n,[{key:"useContainer",value:function(t,e,r){r<1&&(t=null),i(c(n.prototype),"useContainer",this).call(this,t,e,r)}},{key:"renderFrame",value:function(t,e){var n=t.pixelRatio,i=t.layerStatesArray[t.layerIndex];!function(t,e,n){!function(t,e,n,i,r,s,o){t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=s,t[5]=o}(t,e,0,0,n,0,0)}(this.pixelTransform,1/n,1/n),He(this.inversePixelTransform,this.pixelTransform);var r=function(t){return"matrix("+t.join(", ")+")"}(this.pixelTransform);this.useContainer(e,r,i.opacity);var s=this.context,o=s.canvas,a=this.replayGroup_;if(!a||a.isEmpty())return!this.containerReused&&o.width>0&&(o.width=0),this.container;var u=Math.round(t.size[0]*n),l=Math.round(t.size[1]*n);o.width!=u||o.height!=l?(o.width=u,o.height=l,o.style.transform!==r&&(o.style.transform=r)):this.containerReused||s.clearRect(0,0,u,l),this.preRender(s,t);var h=t.extent,c=t.viewState,f=c.center,d=c.resolution,g=c.projection,v=c.rotation,_=g.getExtent(),y=this.getLayer().getSource(),p=!1;if(i.extent){var m=Me(i.extent,g);(p=!Lt(m,t.extent)&&Zt(m,t.extent))&&this.clip(s,t,m)}var k=t.viewHints,x=!(k[0]||k[1]),E=this.getRenderTransform(f,d,v,n,u,l,0),C=this.getLayer().getDeclutter()?{}:null;if(a.execute(s,E,v,x,void 0,C),y.getWrapX()&&g.canWrapX()&&!Lt(_,h)){for(var I,S=h[0],w=Kt(_),N=0;S<_[0];){I=w*--N;var L=this.getRenderTransform(f,d,v,n,u,l,I);a.execute(s,L,v,x,void 0,C),S+=w}for(N=0,S=h[2];S>_[2];){I=w*++N;var R=this.getRenderTransform(f,d,v,n,u,l,I);a.execute(s,R,v,x,void 0,C),S-=w}}if(C){var T=t.viewHints;!function(t,e,n,i,r,s){for(var o=Object.keys(t).map(Number).sort(A),a=0,u=o.length;a<u;++a)for(var l=t[o[a].toString()],h=void 0,c=0,f=l.length;c<f;){var d=l[c++];d!==h&&(h=d,s.push({items:d.declutterItems,opacity:1}));var g=l[c++];d.execute(e,g,n,r)}}(C,s,v,0,!(T[0]||T[1]),t.declutterItems)}p&&s.restore(),this.postRender(s,t);var b=i.opacity,P=this.container;return b!==parseFloat(P.style.opacity)&&(P.style.opacity=1===b?"":b),this.container}},{key:"getFeatures",value:function(t){return new Promise(function(e,n){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var i=[this.context.canvas.width,this.context.canvas.height];Ue(this.pixelTransform,i);var r=this.renderedCenter_,s=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,u=this.renderedExtent_,l=this.getLayer(),h=[],c=i[0]/2,f=i[1]/2;h.push(this.getRenderTransform(r,s,o,.5,c,f,0).slice());var d=l.getSource(),g=a.getExtent();if(d.getWrapX()&&a.canWrapX()&&!Lt(g,u)){for(var v,_=u[0],y=Kt(g),p=0;_<g[0];)v=y*--p,h.push(this.getRenderTransform(r,s,o,.5,c,f,v).slice()),_+=y;for(p=0,_=u[2];_>g[2];)v=y*++p,h.push(this.getRenderTransform(r,s,o,.5,c,f,v).slice()),_-=y}this.hitDetectionImageData_=function(t,e,n,i,r,s,o){var a=Di(t[0]/2,t[1]/2);a.imageSmoothingEnabled=!1;for(var u=a.canvas,l=new fs(a,.5,r,null,o),h=n.length,c=Math.floor(16777215/h),f={},d=1;d<=h;++d){var g=n[d-1],v=g.getStyleFunction()||i;if(i){var _=v(g,s);if(_){Array.isArray(_)||(_=[_]);for(var y="#"+("000000"+(d*c).toString(16)).slice(-6),p=0,m=_.length;p<m;++p){var k=_[p],x=k.clone(),E=x.getFill();E&&E.setColor(y);var C=x.getStroke();C&&C.setColor(y),x.setText(void 0);var I=k.getImage();if(I){var S=I.getImageSize();if(!S)continue;var w=document.createElement("canvas");w.width=S[0],w.height=S[1];var N=w.getContext("2d",{alpha:!1});N.fillStyle=y;var L=N.canvas;N.fillRect(0,0,L.width,L.height),Di(S?S[0]:L.width,S?S[1]:L.height).drawImage(L,0,0),x.setImage(new Ta({img:L,imgSize:S,anchor:I.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:I.getOrigin(),size:I.getSize(),opacity:I.getOpacity(),scale:I.getScale(),rotation:I.getRotation(),rotateWithView:I.getRotateWithView()}))}var R=Number(x.getZIndex()),T=f[R];T||(T={},f[R]=T,T[ct]=[],T[_t]=[],T[ht]=[],T[lt]=[]);var b=x.getGeometryFunction()(g);b&&Zt(r,b.getExtent())&&T[b.getType().replace("Multi","")].push(b,x)}}}}for(var P=Object.keys(f).map(Number).sort(A),M=0,O=P.length;M<O;++M){var F=f[P[M]];for(var D in F)for(var G=F[D],B=0,V=G.length;B<V;B+=2){l.setStyle(G[B+1]);for(var z=0,q=e.length;z<q;++z)l.setTransform(e[z]),l.drawGeometry(G[B])}}return document.body.appendChild(a.canvas),a.getImageData(0,0,u.width,u.height)}(i,h,this.renderedFeatures_,l.getStyleFunction(),u,s,o)}e(function(t,e,n){var i=[];if(n){var r=4*(Math.round(t[0]/2)+Math.round(t[1]/2)*n.width),s=n.data[r],o=n.data[r+1],a=n.data[r+2]+256*(o+256*s),u=Math.floor(16777215/e.length);a&&a%u==0&&i.push(e[a/u-1])}return i}(t,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))}},{key:"forEachFeatureAtCoordinate",value:function(t,e,n,i,r){if(this.replayGroup_){var s=e.viewState.resolution,o=e.viewState.rotation,a=this.getLayer(),u={};return this.replayGroup_.forEachFeatureAtCoordinate(t,s,o,n,function(t){var e=d(t);if(!(e in u))return u[e]=!0,i(t,a)},a.getDeclutter()?r:null)}}},{key:"handleFontsChanged",value:function(){var t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}},{key:"handleStyleImageChange_",value:function(t){this.renderIfReadyAndVisible()}},{key:"prepareFrame",value:function(t){var e=this.getLayer(),n=e.getSource();if(!n)return!1;var i=t.viewHints[0],r=t.viewHints[1],s=e.getUpdateWhileAnimating(),o=e.getUpdateWhileInteracting();if(!this.dirty_&&!s&&i||!o&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var a=t.extent,u=t.viewState,l=u.projection,h=u.resolution,c=t.pixelRatio,f=e.getRevision(),d=e.getRenderBuffer(),g=e.getRenderOrder();void 0===g&&(g=Es);var v=u.center.slice(),_=St(a,d*h),y=[_.slice()],p=l.getExtent();if(n.getWrapX()&&l.canWrapX()&&!Lt(p,t.extent)){var m=Kt(p),k=Math.max(Kt(_)/2,m);_[0]=p[0]-k,_[2]=p[2]+k,fi(v,l);var x=function(t,e){var n=e.getExtent(),i=Yt(t);if(e.canWrapX()&&(i[0]<n[0]||i[0]>=n[2])){var r=Kt(n),s=Math.floor((i[0]-n[0])/r)*r;t[0]-=s,t[2]-=s}return t}(y[0],l);x[0]<p[0]&&x[2]<p[2]?y.push([x[0]+m,x[1],x[2]+m,x[3]]):x[0]>p[0]&&x[2]>p[2]&&y.push([x[0]-m,x[1],x[2]-m,x[3]])}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&Lt(this.renderedExtent_,_))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var E,C=new aa(Cs(h,c),_,h,c,e.getDeclutter()),I=Re();if(I){for(var S=0,w=y.length;S<w;++S)n.loadFeatures(Pe(y[S],l),h,I);E=xe(I,l)}else for(var N=0,L=y.length;N<L;++N)n.loadFeatures(y[N],h,l);var R=function(t,e){var n=Cs(t,e);return n*n}(h,c),T=function(t){var n,i=t.getStyleFunction()||e.getStyleFunction();if(i&&(n=i(t,h)),n){var r=this.renderFeature(t,R,n,C,E);this.dirty_=this.dirty_||r}}.bind(this),b=Pe(_,l),P=n.getFeaturesInExtent(b);g&&P.sort(g);for(var M=0,O=P.length;M<O;++M)T(P[M]);this.renderedFeatures_=P;var F=C.finish(),D=new xa(_,h,c,n.getOverlaps(),F,e.getRenderBuffer());return this.renderedResolution_=h,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=_,this.renderedRotation_=u.rotation,this.renderedCenter_=v,this.renderedProjection_=l,this.replayGroup_=D,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}},{key:"renderFeature",value:function(t,e,n,i,r){if(!n)return!1;var s=!1;if(Array.isArray(n))for(var o=0,a=n.length;o<a;++o)s=Is(i,t,n[o],e,this.boundHandleStyleImageChange_,r)||s;else s=Is(i,t,n,e,this.boundHandleStyleImageChange_,r);return s}}]),n}(),Pa=function(t){s(n,Ho);var e=a(n);function n(t){return f(this,n),e.call(this,t)}return g(n,[{key:"createRenderer",value:function(){return new ba(this)}}]),n}(),Ma=!1;function Oa(t,e){return function(t,e,n,i){return function(n,r,s){var o=new XMLHttpRequest;o.open("GET","function"==typeof t?t(n,r,s):t,!0),e.getType()==De&&(o.responseType="arraybuffer"),o.withCredentials=Ma,o.onload=function(t){if(!o.status||o.status>=200&&o.status<300){var r,a=e.getType();a==Ae||a==Ge?r=o.responseText:a==Be?(r=o.responseXML)||(r=(new DOMParser).parseFromString(o.responseText,"application/xml")):a==De&&(r=o.response),r?function(t,e){"function"==typeof this.addFeatures&&this.addFeatures(t)}.call(this,e.readFeatures(r,{extent:n,featureProjection:s}),e.readProjection(r)):i.call(this)}else i.call(this)}.bind(this),o.onerror=function(){i.call(this)}.bind(this),o.send()}}(t,e,0,U)}function Fa(t,e){return[[-1/0,-1/0,1/0,1/0]]}function Da(t){return t?Array.isArray(t)?function(e){return t}:"function"==typeof t?t:function(e){return[t]}:null}var Aa=function(t){s(n,tt);var e=a(n);function n(t){var i;return f(this,n),(i=e.call(this)).projection_=pe(t.projection),i.attributions_=Da(t.attributions),i.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,i.loading=!1,i.state_=void 0!==t.state?t.state:Dr,i.wrapX_=void 0!==t.wrapX&&t.wrapX,i}return g(n,[{key:"getAttributions",value:function(){return this.attributions_}},{key:"getAttributionsCollapsible",value:function(){return this.attributionsCollapsible_}},{key:"getProjection",value:function(){return this.projection_}},{key:"getResolutions",value:function(){return o()}},{key:"getState",value:function(){return this.state_}},{key:"getWrapX",value:function(){return this.wrapX_}},{key:"refresh",value:function(){this.changed()}},{key:"setAttributions",value:function(t){this.attributions_=Da(t),this.changed()}},{key:"setState",value:function(t){this.state_=t,this.changed()}}]),n}(),Ga="addfeature",Ba="removefeature",Va=function(){function t(e){f(this,t),this.rbush_=new ha.a(e),this.items_={}}return g(t,[{key:"insert",value:function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[d(e)]=n}},{key:"load",value:function(t,e){for(var n=new Array(e.length),i=0,r=e.length;i<r;i++){var s=t[i],o=e[i],a={minX:s[0],minY:s[1],maxX:s[2],maxY:s[3],value:o};n[i]=a,this.items_[d(o)]=a}this.rbush_.load(n)}},{key:"remove",value:function(t){var e=d(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)}},{key:"update",value:function(t,e){var n=this.items_[d(e)];Ft([n.minX,n.minY,n.maxX,n.maxY],t)||(this.remove(e),this.insert(t,e))}},{key:"getAll",value:function(){return this.rbush_.all().map(function(t){return t.value})}},{key:"getInExtent",value:function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})}},{key:"forEach",value:function(t){return this.forEach_(this.getAll(),t)}},{key:"forEachInExtent",value:function(t,e){return this.forEach_(this.getInExtent(t),e)}},{key:"forEach_",value:function(t,e){for(var n,i=0,r=t.length;i<r;i++)if(n=e(t[i]))return n;return n}},{key:"isEmpty",value:function(){return x(this.items_)}},{key:"clear",value:function(){this.rbush_.clear(),this.items_={}}},{key:"getExtent",value:function(t){var e=this.rbush_.toJSON();return bt(e.minX,e.minY,e.maxX,e.maxY,t)}},{key:"concat",value:function(t){for(var e in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[e]=t.items_[e]}}]),t}(),za=function(t){s(n,H);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this,t)).feature=i,r}return n}(),qa=function(t){s(n,Aa);var e=a(n);function n(t){var i;f(this,n);var r=t||{};(i=e.call(this,{attributions:r.attributions,projection:void 0,state:Dr,wrapX:void 0===r.wrapX||r.wrapX})).loader_=U,i.format_=r.format,i.overlaps_=void 0===r.overlaps||r.overlaps,i.url_=r.url,void 0!==r.loader?i.loader_=r.loader:void 0!==i.url_&&(y(i.format_,7),i.loader_=Oa(i.url_,i.format_)),i.strategy_=void 0!==r.strategy?r.strategy:Fa;var s,o,a=void 0===r.useSpatialIndex||r.useSpatialIndex;return i.featuresRtree_=a?new Va:null,i.loadedExtentsRtree_=new Va,i.nullGeometryFeatures_={},i.idIndex_={},i.uidIndex_={},i.featureChangeKeys_={},i.featuresCollection_=null,Array.isArray(r.features)?o=r.features:r.features&&(o=(s=r.features).getArray()),a||void 0!==s||(s=new fr(o)),void 0!==o&&i.addFeaturesInternal(o),void 0!==s&&i.bindFeaturesCollection_(s),i}return g(n,[{key:"addFeature",value:function(t){this.addFeatureInternal(t),this.changed()}},{key:"addFeatureInternal",value:function(t){var e=d(t);if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new za(Ga,t))}else this.featuresCollection_&&this.featuresCollection_.remove(t)}},{key:"setupChangeEvents_",value:function(t,e){this.featureChangeKeys_[t]=[E(e,S,this.handleFeatureChange_,this),E(e,F,this.handleFeatureChange_,this)]}},{key:"addToIndex_",value:function(t,e){var n=!0,i=e.getId();return void 0!==i&&(i.toString()in this.idIndex_?n=!1:this.idIndex_[i.toString()]=e),n&&(y(!(t in this.uidIndex_),30),this.uidIndex_[t]=e),n}},{key:"addFeatures",value:function(t){this.addFeaturesInternal(t),this.changed()}},{key:"addFeaturesInternal",value:function(t){for(var e=[],n=[],i=[],r=0,s=t.length;r<s;r++){var o=t[r],a=d(o);this.addToIndex_(a,o)&&n.push(o)}for(var u=0,l=n.length;u<l;u++){var h=n[u],c=d(h);this.setupChangeEvents_(c,h);var f=h.getGeometry();if(f){var g=f.getExtent();e.push(g),i.push(h)}else this.nullGeometryFeatures_[c]=h}this.featuresRtree_&&this.featuresRtree_.load(e,i);for(var v=0,_=n.length;v<_;v++)this.dispatchEvent(new za(Ga,n[v]))}},{key:"bindFeaturesCollection_",value:function(t){var e=!1;this.addEventListener(Ga,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(Ba,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(lr,function(t){e||(e=!0,this.addFeature(t.element),e=!1)}.bind(this)),t.addEventListener(hr,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)}.bind(this)),this.featuresCollection_=t}},{key:"clear",value:function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(I);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var n in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var i=new za("clear");this.dispatchEvent(i),this.changed()}},{key:"forEachFeature",value:function(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}},{key:"forEachFeatureAtCoordinateDirect",value:function(t,e){var n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(n){return n.getGeometry().intersectsCoordinate(t)?e(n):void 0})}},{key:"forEachFeatureInExtent",value:function(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}},{key:"forEachFeatureIntersectingExtent",value:function(t,e){return this.forEachFeatureInExtent(t,function(n){if(n.getGeometry().intersectsExtent(t)){var i=e(n);if(i)return i}})}},{key:"getFeaturesCollection",value:function(){return this.featuresCollection_}},{key:"getFeatures",value:function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),x(this.nullGeometryFeatures_)||z(t,k(this.nullGeometryFeatures_))),t}},{key:"getFeaturesAtCoordinate",value:function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e}},{key:"getFeaturesInExtent",value:function(t){return this.featuresRtree_?this.featuresRtree_.getInExtent(t):this.featuresCollection_?this.featuresCollection_.getArray():[]}},{key:"getClosestFeatureToCoordinate",value:function(t,e){var n=t[0],i=t[1],r=null,s=[NaN,NaN],o=1/0,a=[-1/0,-1/0,1/0,1/0],u=e||Y;return this.featuresRtree_.forEachInExtent(a,function(t){if(u(t)){var e=t.getGeometry(),l=o;if((o=e.closestPointXY(n,i,s,o))<l){r=t;var h=Math.sqrt(o);a[0]=n-h,a[1]=i-h,a[2]=n+h,a[3]=i+h}}}),r}},{key:"getExtent",value:function(t){return this.featuresRtree_.getExtent(t)}},{key:"getFeatureById",value:function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null}},{key:"getFeatureByUid",value:function(t){var e=this.uidIndex_[t];return void 0!==e?e:null}},{key:"getFormat",value:function(){return this.format_}},{key:"getOverlaps",value:function(){return this.overlaps_}},{key:"getUrl",value:function(){return this.url_}},{key:"handleFeatureChange_",value:function(t){var e=t.target,n=d(e),i=e.getGeometry();if(i){var r=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var s=e.getId();if(void 0!==s){var o=s.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new za("changefeature",e))}},{key:"hasFeature",value:function(t){var e=t.getId();return void 0!==e?e in this.idIndex_:d(t)in this.uidIndex_}},{key:"isEmpty",value:function(){return this.featuresRtree_.isEmpty()&&x(this.nullGeometryFeatures_)}},{key:"loadFeatures",value:function(t,e,n){var i=this,r=this.loadedExtentsRtree_,s=this.strategy_(t,e);this.loading=!1;for(var o=function(t,o){var a=s[t];r.forEachInExtent(a,function(t){return Lt(t.extent,a)})||(i.loader_.call(i,a,e,n),r.insert(a,{extent:a.slice()}),i.loading=i.loader_!==U)},a=0,u=s.length;a<u;++a)o(a)}},{key:"refresh",value:function(){this.clear(!0),this.loadedExtentsRtree_.clear(),i(c(n.prototype),"refresh",this).call(this)}},{key:"removeLoadedExtent",value:function(t){var e,n=this.loadedExtentsRtree_;n.forEachInExtent(t,function(n){if(Ft(n.extent,t))return e=n,!0}),e&&n.remove(e)}},{key:"removeFeature",value:function(t){var e=d(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()}},{key:"removeFeatureInternal",value:function(t){var e=d(t);this.featureChangeKeys_[e].forEach(I),delete this.featureChangeKeys_[e];var n=t.getId();void 0!==n&&delete this.idIndex_[n.toString()],delete this.uidIndex_[e],this.dispatchEvent(new za(Ba,t))}},{key:"removeFromIdIndex_",value:function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e}},{key:"setLoader",value:function(t){this.loader_=t}},{key:"setUrl",value:function(t){y(this.format_,7),this.setLoader(Oa(t,this.format_))}}]),n}(),Ya="Point",Xa="LineString",Ua="Polygon",Wa="Circle",Ha="drawstart",ja=function(t){s(n,H);var e=a(n);function n(t,i){var r;return f(this,n),(r=e.call(this,t)).feature=i,r}return n}();function Ka(){var t=Po();return function(e,n){return t[e.getGeometry().getType()]}}var Za=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t;r.stopDown||(r.stopDown=X),(i=e.call(this,r)).shouldHandle_=!1,i.downPx_=null,i.downTimeout_,i.lastDragTime_,i.freehand_=!1,i.source_=t.source?t.source:null,i.features_=t.features?t.features:null,i.snapTolerance_=t.snapTolerance?t.snapTolerance:12,i.type_=t.type,i.mode_=function(t){var e;return t===lt||t===ft?e=Ya:t===ht||t===dt?e=Xa:t===ct||t===gt?e=Ua:t===_t&&(e=Wa),e}(i.type_),i.stopClick_=!!t.stopClick,i.minPoints_=t.minPoints?t.minPoints:i.mode_===Ua?3:2,i.maxPoints_=t.maxPoints?t.maxPoints:1/0,i.finishCondition_=t.finishCondition?t.finishCondition:Y;var s=t.geometryFunction;if(!s)if(i.type_===_t)s=function(t,e,n){var i=e||new Uo([NaN,NaN]),r=be(t[0],n),s=li(r,be(t[1],n));i.setCenterAndRadius(r,Math.sqrt(s));var o=Re();return o&&i.transform(n,o),i};else{var o,a=i.mode_;a===Ya?o=bn:a===Xa?o=Rn:a===Ua&&(o=Yn),s=function(t,e,n){var i=e;return i?a===Ua?t[0].length?i.setCoordinates([t[0].concat([t[0][0]])]):i.setCoordinates([]):i.setCoordinates(t):i=new o(t),i}}return i.geometryFunction_=s,i.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,i.finishCoordinate_=null,i.sketchFeature_=null,i.sketchPoint_=null,i.sketchCoords_=null,i.sketchLine_=null,i.sketchLineCoords_=null,i.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,i.overlay_=new Pa({source:new qa({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:Ka(),updateWhileInteracting:!0}),i.geometryName_=t.geometryName,i.condition_=t.condition?t.condition:Xs,i.freehandCondition_,t.freehand?i.freehandCondition_=Bs:i.freehandCondition_=t.freehandCondition?t.freehandCondition:Us,i.addEventListener($(Ps),i.updateState_),i}return g(n,[{key:"setMap",value:function(t){i(c(n.prototype),"setMap",this).call(this,t),this.updateState_()}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleEvent",value:function(t){t.originalEvent.type===N&&t.preventDefault(),this.freehand_=this.mode_!==Ya&&this.freehandCondition_(t);var e=t.type===vr.POINTERMOVE,r=!0;return!this.freehand_&&this.lastDragTime_&&t.type===vr.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===vr.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),r=!1):this.freehand_&&t.type===vr.POINTERDOWN?r=!1:e?(r=t.type===vr.POINTERMOVE)&&this.freehand_?r=this.handlePointerMove_(t):("mouse"==t.pointerEvent.pointerType||t.type===vr.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===vr.DBLCLICK&&(r=!1),i(c(n.prototype),"handleEvent",this).call(this,t)&&r}},{key:"handleDownEvent",value:function(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new _r(vr.POINTERMOVE,t.map,t.pointerEvent,!1,t.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}},{key:"handleUpEvent",value:function(t){var e=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);var n=this.mode_===Wa;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||n?this.finishDrawing():this.atFinish_(t)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate):(this.startDrawing_(t),this.mode_===Ya&&this.finishDrawing()),e=!1):this.freehand_&&this.abortDrawing(),!e&&this.stopClick_&&t.stopPropagation(),e}},{key:"handlePointerMove_",value:function(t){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var e=this.downPx_,n=t.pixel,i=e[0]-n[0],r=e[1]-n[1],s=i*i+r*r;if(this.shouldHandle_=this.freehand_?s>this.squaredClickTolerance_:s<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(t):this.createOrUpdateSketchPoint_(t),!0}},{key:"atFinish_",value:function(t){var e=!1;if(this.sketchFeature_){var n=!1,i=[this.finishCoordinate_];if(this.mode_===Xa)n=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===Ua){var r=this.sketchCoords_;n=r[0].length>this.minPoints_,i=[r[0][0],r[0][r[0].length-2]]}if(n)for(var s=t.map,o=0,a=i.length;o<a;o++){var u=i[o],l=s.getPixelFromCoordinate(u),h=t.pixel,c=h[0]-l[0],f=h[1]-l[1],d=this.freehand_?1:this.snapTolerance_;if(e=Math.sqrt(c*c+f*f)<=d){this.finishCoordinate_=u;break}}}return e}},{key:"createOrUpdateSketchPoint_",value:function(t){var e=t.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(e):(this.sketchPoint_=new et(new bn(e)),this.updateSketchFeatures_())}},{key:"startDrawing_",value:function(t){var e=t.coordinate,n=t.map.getView().getProjection();this.finishCoordinate_=e,this.mode_===Ya?this.sketchCoords_=e.slice():this.mode_===Ua?(this.sketchCoords_=[[e.slice(),e.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[e.slice(),e.slice()],this.sketchLineCoords_&&(this.sketchLine_=new et(new Rn(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_,void 0,n);this.sketchFeature_=new et,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new ja(Ha,this.sketchFeature_))}},{key:"modifyDrawing_",value:function(t){var e,n,i,r=t.coordinate,s=this.sketchFeature_.getGeometry(),o=t.map.getView().getProjection();if(this.mode_===Ya?n=this.sketchCoords_:this.mode_===Ua?(n=(e=this.sketchCoords_[0])[e.length-1],this.atFinish_(t)&&(r=this.finishCoordinate_.slice())):n=(e=this.sketchCoords_)[e.length-1],n[0]=r[0],n[1]=r[1],this.geometryFunction_(this.sketchCoords_,s,o),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(r),s.getType()==ct&&this.mode_!==Ua){this.sketchLine_||(this.sketchLine_=new et);var a=s.getLinearRing(0);(i=this.sketchLine_.getGeometry())?(i.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),i.changed()):(i=new Rn(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(i))}else this.sketchLineCoords_&&(i=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()}},{key:"addToDrawing_",value:function(t){var e,n,i=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===Xa?(this.finishCoordinate_=t.slice(),(n=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?n.pop():e=!0),n.push(t.slice()),this.geometryFunction_(n,i,r)):this.mode_===Ua&&((n=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?n.pop():e=!0),n.push(t.slice()),e&&(this.finishCoordinate_=n[0]),this.geometryFunction_(this.sketchCoords_,i,r)),this.updateSketchFeatures_(),e&&this.finishDrawing()}},{key:"removeLastPoint",value:function(){if(this.sketchFeature_){var t,e=this.sketchFeature_.getGeometry(),n=this.getMap().getView().getProjection();this.mode_===Xa?((t=this.sketchCoords_).splice(-2,1),this.geometryFunction_(t,e,n),t.length>=2&&(this.finishCoordinate_=t[t.length-2].slice())):this.mode_===Ua&&((t=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(t),this.geometryFunction_(this.sketchCoords_,e,n)),0===t.length&&this.abortDrawing(),this.updateSketchFeatures_()}}},{key:"finishDrawing",value:function(){var t=this.abortDrawing_();if(t){var e=this.sketchCoords_,n=t.getGeometry(),i=this.getMap().getView().getProjection();this.mode_===Xa?(e.pop(),this.geometryFunction_(e,n,i)):this.mode_===Ua&&(e[0].pop(),this.geometryFunction_(e,n,i),e=n.getCoordinates()),this.type_===ft?t.setGeometry(new Pn([e])):this.type_===dt?t.setGeometry(new Tn([e])):this.type_===gt&&t.setGeometry(new Wn([e])),this.dispatchEvent(new ja("drawend",t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t)}}},{key:"abortDrawing_",value:function(){this.finishCoordinate_=null;var t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),t}},{key:"abortDrawing",value:function(){var t=this.abortDrawing_();t&&this.dispatchEvent(new ja("drawabort",t))}},{key:"appendCoordinates",value:function(t){var e=this.mode_,n=[];e===Xa?n=this.sketchCoords_:e===Ua&&(n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var i=n.pop(),r=0;r<t.length;r++)this.addToDrawing_(t[r]);this.addToDrawing_(i)}},{key:"extend",value:function(t){var e=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=e.getCoordinates();var n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new ja(Ha,this.sketchFeature_))}},{key:"updateSketchFeatures_",value:function(){var t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);var e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}},{key:"updateState_",value:function(){var t=this.getMap(),e=this.getActive();t&&e||this.abortDrawing(),this.overlay_.setMap(e?t:null)}}]),n}();function Ja(t){return t.feature?t.feature:t.element?t.element:void 0}var Qa=[],$a=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r=t||{},s=r;return s.handleDownEvent||(s.handleDownEvent=Y),s.stopDown||(s.stopDown=X),(i=e.call(this,s)).source_=r.source?r.source:null,i.vertex_=void 0===r.vertex||r.vertex,i.edge_=void 0===r.edge||r.edge,i.features_=r.features?r.features:null,i.featuresListenerKeys_=[],i.featureChangeListenerKeys_={},i.indexedFeaturesExtents_={},i.pendingFeatures_={},i.pixelTolerance_=void 0!==r.pixelTolerance?r.pixelTolerance:10,i.rBush_=new Va,i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(l(i)),LineString:i.writeLineStringGeometry_.bind(l(i)),LinearRing:i.writeLineStringGeometry_.bind(l(i)),Polygon:i.writePolygonGeometry_.bind(l(i)),MultiPoint:i.writeMultiPointGeometry_.bind(l(i)),MultiLineString:i.writeMultiLineStringGeometry_.bind(l(i)),MultiPolygon:i.writeMultiPolygonGeometry_.bind(l(i)),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(l(i)),Circle:i.writeCircleGeometry_.bind(l(i))},i}return g(n,[{key:"addFeature",value:function(t,e){var n=void 0===e||e,i=d(t),r=t.getGeometry();if(r){var s=this.SEGMENT_WRITERS_[r.getType()];s&&(this.indexedFeaturesExtents_[i]=r.getExtent([1/0,1/0,-1/0,-1/0]),s(t,r))}n&&(this.featureChangeListenerKeys_[i]=E(t,S,this.handleFeatureChange_,this))}},{key:"forEachFeatureAdd_",value:function(t){this.addFeature(t)}},{key:"forEachFeatureRemove_",value:function(t){this.removeFeature(t)}},{key:"getFeatures_",value:function(){var t;return this.features_?t=this.features_:this.source_&&(t=this.source_.getFeatures()),t}},{key:"handleEvent",value:function(t){var e=this.snapTo(t.pixel,t.coordinate,t.map);return e.snapped&&(t.coordinate=e.vertex.slice(0,2),t.pixel=e.vertexPixel),i(c(n.prototype),"handleEvent",this).call(this,t)}},{key:"handleFeatureAdd_",value:function(t){var e=Ja(t);this.addFeature(e)}},{key:"handleFeatureRemove_",value:function(t){var e=Ja(t);this.removeFeature(e)}},{key:"handleFeatureChange_",value:function(t){var e=t.target;if(this.handlingDownUpSequence){var n=d(e);n in this.pendingFeatures_||(this.pendingFeatures_[n]=e)}else this.updateFeature_(e)}},{key:"handleUpEvent",value:function(t){var e=k(this.pendingFeatures_);return e.length&&(e.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1}},{key:"removeFeature",value:function(t,e){var n=void 0===e||e,i=d(t),r=this.indexedFeaturesExtents_[i];if(r){var s=this.rBush_,o=[];s.forEachInExtent(r,function(e){t===e.feature&&o.push(e)});for(var a=o.length-1;a>=0;--a)s.remove(o[a])}n&&(I(this.featureChangeListenerKeys_[i]),delete this.featureChangeListenerKeys_[i])}},{key:"setMap",value:function(t){var e=this.getMap(),r=this.featuresListenerKeys_,s=this.getFeatures_();e&&(r.forEach(I),r.length=0,s.forEach(this.forEachFeatureRemove_.bind(this))),i(c(n.prototype),"setMap",this).call(this,t),t&&(this.features_?r.push(E(this.features_,lr,this.handleFeatureAdd_,this),E(this.features_,hr,this.handleFeatureRemove_,this)):this.source_&&r.push(E(this.source_,Ga,this.handleFeatureAdd_,this),E(this.source_,Ba,this.handleFeatureRemove_,this)),s.forEach(this.forEachFeatureAdd_.bind(this)))}},{key:"snapTo",value:function(t,e,n){var i=It([n.getCoordinateFromPixel([t[0]-this.pixelTolerance_,t[1]+this.pixelTolerance_]),n.getCoordinateFromPixel([t[0]+this.pixelTolerance_,t[1]-this.pixelTolerance_])]),r=this.rBush_.getInExtent(i);this.vertex_&&!this.edge_&&(r=r.filter(function(t){return t.feature.getGeometry().getType()!==_t}));var s=!1,o=null,a=null;if(0===r.length)return{snapped:s,vertex:o,vertexPixel:a};for(var u,l=n.getView().getProjection(),h=be(e,l),c=1/0,f=0;f<r.length;++f){var d=r[f];Qa[0]=be(d.segment[0],l),Qa[1]=be(d.segment[1],l);var g=ci(h,Qa);g<c&&(u=d,c=g)}var v=u.segment;if(this.vertex_&&!this.edge_){var _=n.getPixelFromCoordinate(v[0]),y=n.getPixelFromCoordinate(v[1]),p=li(t,_),m=li(t,y);Math.sqrt(Math.min(p,m))<=this.pixelTolerance_&&(s=!0,o=p>m?v[1]:v[0],a=n.getPixelFromCoordinate(o))}else if(this.edge_){var k=u.feature.getGeometry().getType()===_t;if(k){var x=u.feature.getGeometry(),E=Re();E&&(x=x.clone().transform(E,l)),o=Te(function(t,e){var n=e.getRadius(),i=e.getCenter(),r=i[0],s=i[1],o=t[0]-r,a=t[1]-s;0===o&&0===a&&(o=1);var u=Math.sqrt(o*o+a*a);return[r+n*o/u,s+n*a/u]}(h,x),l)}else Qa[0]=be(v[0],l),Qa[1]=be(v[1],l),o=Te(oi(h,Qa),l);if(hi(t,a=n.getPixelFromCoordinate(o))<=this.pixelTolerance_&&(s=!0,this.vertex_&&!k)){var C=n.getPixelFromCoordinate(v[0]),I=n.getPixelFromCoordinate(v[1]),S=li(a,C),w=li(a,I);Math.sqrt(Math.min(S,w))<=this.pixelTolerance_&&(o=S>w?v[1]:v[0],a=n.getPixelFromCoordinate(o))}}return s&&(a=[Math.round(a[0]),Math.round(a[1])]),{snapped:s,vertex:o,vertexPixel:a}}},{key:"updateFeature_",value:function(t){this.removeFeature(t,!1),this.addFeature(t,!1)}},{key:"writeCircleGeometry_",value:function(t,e){var n=this.getMap().getView().getProjection(),i=e,r=Re();r&&(i=i.clone().transform(r,n));var s=Un(i);r&&s.transform(n,r);for(var o=s.getCoordinates()[0],a=0,u=o.length-1;a<u;++a){var l=o.slice(a,a+2),h={feature:t,segment:l};this.rBush_.insert(It(l),h)}}},{key:"writeGeometryCollectionGeometry_",value:function(t,e){for(var n=e.getGeometriesArray(),i=0;i<n.length;++i){var r=this.SEGMENT_WRITERS_[n[i].getType()];r&&r(t,n[i])}}},{key:"writeLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length-1;i<r;++i){var s=n.slice(i,i+2),o={feature:t,segment:s};this.rBush_.insert(It(s),o)}}},{key:"writeMultiLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length-1;o<a;++o){var u=s.slice(o,o+2),l={feature:t,segment:u};this.rBush_.insert(It(u),l)}}},{key:"writeMultiPointGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i){var s=n[i],o={feature:t,segment:[s,s]};this.rBush_.insert(e.getExtent(),o)}}},{key:"writeMultiPolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length;o<a;++o)for(var u=s[o],l=0,h=u.length-1;l<h;++l){var c=u.slice(l,l+2),f={feature:t,segment:c};this.rBush_.insert(It(c),f)}}},{key:"writePointGeometry_",value:function(t,e){var n=e.getCoordinates(),i={feature:t,segment:[n,n]};this.rBush_.insert(e.getExtent(),i)}},{key:"writePolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length-1;o<a;++o){var u=s.slice(o,o+2),l={feature:t,segment:u};this.rBush_.insert(It(u),l)}}}]),n}(),tu=function(t){s(n,$a);var e=a(n);function n(t){var i;f(this,n);var r={source:t?t.getSource():null,pixelTolerance:7};return(i=e.call(this,r)).snapOptions=r,i}return n}(),eu=function(t){s(n,Vo);var e=a(n);function n(t,i,r,s){var o;f(this,n);var a=[],u=s||{};u.source=t.getSource(),u.type=i;var l=new Za(u);return a.push(l),u.snapping&&a.push(new tu(u.snapping.layer||t)),l.on("drawstart",function(t){if(u.measure){var e=t.feature;u.measure="object"==v(u.measure)?u.measure:{},u.measure.tooltip=u.measure.tooltip||{};var n=document.createElement("div");n.setAttribute("class","measure-tooltip"),o.tooltip=new Hi({offset:u.measure.tooltip.offset||[-15,10],positioning:"bottom-center"}),o.map.addOverlay(o.tooltip),o.measurePointermoveHandler=o.map.on("pointermove",function(){o._showMeasureTooltip(e,o.tooltip,n)})}}),l.on("drawend",function(e){var n=e.feature;r(n,function(){try{t.getSource().removeFeature(n)}catch(e){var i=t.getSource().on("addfeature",function(e){t.getSource().removeFeature(e.feature),K(i)})}}),o._cleanUp()}),(o=e.call(this,a)).drawOptions=u,o.drawInteraction=l,o}return g(n,[{key:"deactivate",value:function(){this._cleanUp(),i(c(n.prototype),"deactivate",this).call(this)}},{key:"_cleanUp",value:function(){this.drawOptions.measure&&(K(this.measurePointermoveHandler),this._removeTooltip())}},{key:"_removeTooltip",value:function(){this.tooltip&&(this.map.removeOverlay(this.tooltip),this.tooltip=void 0)}},{key:"_showMeasureTooltip",value:function(t,e){if(this.tooltip){var n=this._getLengthOfLastSegment(t.getGeometry());0!==n&&(e.textContent=n+" m",this.tooltip.setElement(e),this.tooltip.setPosition(t.getGeometry().getLastCoordinate()))}}},{key:"_getLengthOfLastSegment",value:function(t){return t&&t instanceof Rn?new Rn(this._getCoordinatesOfLastSegment(t)).getLength().toFixed(2):t&&t instanceof Yn?new Rn(this._getCoordinatesOfLastSegment(t.getLinearRing(0))).getLength().toFixed(2):0}},{key:"_getCoordinatesOfLastSegment",value:function(t){var e=t.getCoordinates().length;return t.getCoordinates().slice(e-2)}}]),n}(),nu=function(t){s(n,eu);var e=a(n);function n(t,i,r){var s;return f(this,n),(r=r||{}).maxPoints=2,(s=e.call(this,t,"LineString",i,r)).drawLijnstukOptions=r,s}return n}(),iu=function(t){s(n,eu);var e=a(n);function n(t,i,r){var s;f(this,n);var o=r||{};return o.maxPoints=2,o.geometryFunction=function(t,e){e||(e=new Yn([]));var n=t[0],i=t[1];return e.setCoordinates([[n,[n[0],i[1]],i,[i[0],n[1]],n]]),e},(s=e.call(this,t,"LineString",i,o)).drawRectangleOptions=o,s}return n}(),ru=function(t){s(n,Vo);var e=a(n);function n(t,i){var r;f(this,n);var s=new Bo({layers:[t],condition:qs,style:i?i.style:null});return(r=e.call(this,[s])).layer=t,r.highlightInteraction=s,r}return g(n,[{key:"deactivate",value:function(){this.dehighlightAllFeatures(),i(c(n.prototype),"deactivate",this).call(this)}},{key:"highlightFeatureWithId",value:function(t){if(t){var e=this.layer.getSource().getFeatureById(t)||this._getClusterByFeatureId(this.layer.getSource().getFeatures(),t);e&&-1===this.highlightInteraction.getFeatures().getArray().indexOf(e)&&this.highlightInteraction.getFeatures().push(e)}}},{key:"_getClusterByFeatureId",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n].get("features");if(i&&this._getFeatureById(i,e))return t[n]}}},{key:"_getFeatureById",value:function(t,e){for(var n=0;n<t.length;n++)if(t[n].getId()===e)return t[n]}},{key:"isHighlighted",value:function(t){var e=!1;return this.highlightInteraction.getFeatures().forEach(function(n){n===t&&(e=!0)}),e}},{key:"dehighlightAllFeatures",value:function(){this.highlightInteraction.getFeatures().clear()}}]),n}(),su=function(t){s(n,eu);var e=a(n);function n(t,i){var r;f(this,n),r=e.call(this,t,"LineString",function(){K(r.measurePointermoveHandler)},i);var s=0;r.layer=t,r.measureTooltips=[],r.measurePointermoveHandler=void 0,r.drawInteraction.on("drawstart",function(t){var e=s++,n=t.feature;n.setId(e);var i=document.createElement("div");i.setAttribute("class","measure-tooltip");var o=new Hi({offset:[-15,10],positioning:"bottom-center"});r.map.addOverlay(o),r.measureTooltips[e]=o,r.measurePointermoveHandler=r.map.on("pointermove",function(){return function(t,e,n){var i=t.getGeometry().getLength().toFixed(2);n.textContent=i+" m",e.setElement(n),e.setPosition(t.getGeometry().getLastCoordinate())}(n,o,i)})});var o=function(t){r.map.removeOverlay(r.measureTooltips[t]),r.measureTooltips[t]=null};return r.layer.getSource().on("removefeature",function(t){o(t.feature.getId())}),r.cleanUp=function(){K(r.measurePointermoveHandler);var t=[];r.measureTooltips.forEach(function(e,n){null==r.layer.getSource().getFeatureById(n)&&t.push(n)}),t.forEach(function(t){o(t)})},r.getTooltipFor=function(t){return r.measureTooltips[t]},r.measureOptions=i,r}return g(n,[{key:"deactivate",value:function(){this.cleanUp(),i(c(n.prototype),"deactivate",this).call(this,this)}}]),n}(),ou=[0,0,0,0],au=[],uu="modifyend",lu=function(t){s(n,H);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t)).features=i,s.mapBrowserEvent=r,s}return n}();function hu(t,e){return t.index-e.index}function cu(t,e,n){var i=e.geometry;if(i.getType()===_t){var r=i;if(1===e.index){var s=Re();s&&(r=r.clone().transform(s,n));var o=li(r.getCenter(),be(t,n)),a=Math.sqrt(o)-r.getRadius();return a*a}}var u=be(t,n);return au[0]=be(e.segment[0],n),au[1]=be(e.segment[1],n),ci(u,au)}function fu(t,e,n){var i=e.geometry;if(i.getType()===_t&&1===e.index){var r=i,s=Re();return s&&(r=r.clone().transform(s,n)),Te(r.getClosestPoint(be(t,n)),n)}var o=be(t,n);return au[0]=be(e.segment[0],n),au[1]=be(e.segment[1],n),Te(oi(o,au),n)}function du(){var t=Po();return function(e,n){return t[lt]}}var gu=function(t){s(n,Zs);var e=a(n);function n(t){var i,r;if(f(this,n),(i=e.call(this,t)).boundHandleFeatureChange_=i.handleFeatureChange_.bind(l(i)),i.condition_=t.condition?t.condition:js,i.defaultDeleteCondition_=function(t){return function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey}(t)&&Ys(t)},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Bs,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.modified_=!1,i.rBush_=new Va,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new Pa({source:new qa({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:du(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(l(i)),LineString:i.writeLineStringGeometry_.bind(l(i)),LinearRing:i.writeLineStringGeometry_.bind(l(i)),Polygon:i.writePolygonGeometry_.bind(l(i)),MultiPoint:i.writeMultiPointGeometry_.bind(l(i)),MultiLineString:i.writeMultiLineStringGeometry_.bind(l(i)),MultiPolygon:i.writeMultiPolygonGeometry_.bind(l(i)),Circle:i.writeCircleGeometry_.bind(l(i)),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(l(i))},i.source_=null,t.source?(i.source_=t.source,r=new fr(i.source_.getFeatures()),i.source_.addEventListener(Ga,i.handleSourceAdd_.bind(l(i))),i.source_.addEventListener(Ba,i.handleSourceRemove_.bind(l(i)))):r=t.features,!r)throw new Error("The modify interaction requires features or a source");return i.features_=r,i.features_.forEach(i.addFeature_.bind(l(i))),i.features_.addEventListener(lr,i.handleFeatureAdd_.bind(l(i))),i.features_.addEventListener(hr,i.handleFeatureRemove_.bind(l(i))),i.lastPointerEvent_=null,u(i)}return g(n,[{key:"addFeature_",value:function(t){var e=t.getGeometry();if(e){var n=this.SEGMENT_WRITERS_[e.getType()];n&&n(t,e)}var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),t.addEventListener(S,this.boundHandleFeatureChange_)}},{key:"willModifyFeatures_",value:function(t){this.modified_||(this.modified_=!0,this.dispatchEvent(new lu("modifystart",this.features_,t)))}},{key:"removeFeature_",value:function(t){this.removeFeatureSegmentData_(t),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),t.removeEventListener(S,this.boundHandleFeatureChange_)}},{key:"removeFeatureSegmentData_",value:function(t){var e=this.rBush_,n=[];e.forEach(function(e){t===e.feature&&n.push(e)});for(var i=n.length-1;i>=0;--i){for(var r=n[i],s=this.dragSegments_.length-1;s>=0;--s)this.dragSegments_[s][0]===r&&this.dragSegments_.splice(s,1);e.remove(r)}}},{key:"setActive",value:function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),i(c(n.prototype),"setActive",this).call(this,t)}},{key:"setMap",value:function(t){this.overlay_.setMap(t),i(c(n.prototype),"setMap",this).call(this,t)}},{key:"getOverlay",value:function(){return this.overlay_}},{key:"handleSourceAdd_",value:function(t){t.feature&&this.features_.push(t.feature)}},{key:"handleSourceRemove_",value:function(t){t.feature&&this.features_.remove(t.feature)}},{key:"handleFeatureAdd_",value:function(t){this.addFeature_(t.element)}},{key:"handleFeatureChange_",value:function(t){if(!this.changingFeature_){var e=t.target;this.removeFeature_(e),this.addFeature_(e)}}},{key:"handleFeatureRemove_",value:function(t){var e=t.element;this.removeFeature_(e)}},{key:"writePointGeometry_",value:function(t,e){var n=e.getCoordinates(),i={feature:t,geometry:e,segment:[n,n]};this.rBush_.insert(e.getExtent(),i)}},{key:"writeMultiPointGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i){var s=n[i],o={feature:t,geometry:e,depth:[i],index:i,segment:[s,s]};this.rBush_.insert(e.getExtent(),o)}}},{key:"writeLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length-1;i<r;++i){var s=n.slice(i,i+2),o={feature:t,geometry:e,index:i,segment:s};this.rBush_.insert(It(s),o)}}},{key:"writeMultiLineStringGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length-1;o<a;++o){var u=s.slice(o,o+2),l={feature:t,geometry:e,depth:[i],index:o,segment:u};this.rBush_.insert(It(u),l)}}},{key:"writePolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length-1;o<a;++o){var u=s.slice(o,o+2),l={feature:t,geometry:e,depth:[i],index:o,segment:u};this.rBush_.insert(It(u),l)}}},{key:"writeMultiPolygonGeometry_",value:function(t,e){for(var n=e.getCoordinates(),i=0,r=n.length;i<r;++i)for(var s=n[i],o=0,a=s.length;o<a;++o)for(var u=s[o],l=0,h=u.length-1;l<h;++l){var c=u.slice(l,l+2),f={feature:t,geometry:e,depth:[o,i],index:l,segment:c};this.rBush_.insert(It(c),f)}}},{key:"writeCircleGeometry_",value:function(t,e){var n=e.getCenter(),i={feature:t,geometry:e,index:0,segment:[n,n]},r={feature:t,geometry:e,index:1,segment:[n,n]},s=[i,r];i.featureSegments=s,r.featureSegments=s,this.rBush_.insert(Mt(n),i);var o=e,a=Re();if(a&&this.getMap()){var u=this.getMap().getView().getProjection();o=Un(o=o.clone().transform(a,u)).transform(u,a)}this.rBush_.insert(o.getExtent(),r)}},{key:"writeGeometryCollectionGeometry_",value:function(t,e){for(var n=e.getGeometriesArray(),i=0;i<n.length;++i){var r=n[i];(0,this.SEGMENT_WRITERS_[r.getType()])(t,r)}}},{key:"createOrUpdateVertexFeature_",value:function(t){var e=this.vertexFeature_;return e?e.getGeometry().setCoordinates(t):(e=new et(new bn(t)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e)),e}},{key:"handleEvent",value:function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=vr.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(e=!(t.type!=vr.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==vr.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),i(c(n.prototype),"handleEvent",this).call(this,t)&&!e);var e}},{key:"handleDragEvent",value:function(t){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(t);for(var e=t.coordinate,n=0,i=this.dragSegments_.length;n<i;++n){for(var r=this.dragSegments_[n],s=r[0],o=s.depth,a=s.geometry,u=void 0,l=s.segment,h=r[1];e.length<a.getStride();)e.push(l[h][e.length]);switch(a.getType()){case lt:u=e,l[0]=e,l[1]=e;break;case ft:(u=a.getCoordinates())[s.index]=e,l[0]=e,l[1]=e;break;case ht:(u=a.getCoordinates())[s.index+h]=e,l[h]=e;break;case dt:case ct:(u=a.getCoordinates())[o[0]][s.index+h]=e,l[h]=e;break;case gt:(u=a.getCoordinates())[o[1]][o[0]][s.index+h]=e,l[h]=e;break;case _t:if(l[0]=e,l[1]=e,0===s.index)this.changingFeature_=!0,a.setCenter(e),this.changingFeature_=!1;else{this.changingFeature_=!0;var c=t.map.getView().getProjection(),f=hi(be(a.getCenter(),c),be(e,c)),d=Re();if(d){var g=a.clone().transform(d,c);g.setRadius(f),f=g.transform(c,d).getRadius()}a.setRadius(f),this.changingFeature_=!1}}u&&this.setGeometryCoordinates_(a,u)}this.createOrUpdateVertexFeature_(e)}},{key:"handleDownEvent",value:function(t){if(!this.condition_(t))return!1;var e=t.coordinate;this.handlePointerAtPixel_(t.pixel,t.map,e),this.dragSegments_.length=0,this.modified_=!1;var n=this.vertexFeature_;if(n){var i=t.map.getView().getProjection(),r=[],s=n.getGeometry().getCoordinates(),o=It([s]),a=this.rBush_.getInExtent(o),u={};a.sort(hu);for(var l=0,h=a.length;l<h;++l){var c=a[l],f=c.segment,g=d(c.feature),v=c.depth;if(v&&(g+="-"+v.join("-")),u[g]||(u[g]=new Array(2)),c.geometry.getType()!==_t||1!==c.index)if(!ai(f[0],s)||u[g][0])if(!ai(f[1],s)||u[g][1])d(f)in this.vertexSegments_&&!u[g][0]&&!u[g][1]&&this.insertVertexCondition_(t)&&r.push([c,s]);else{if((c.geometry.getType()===ht||c.geometry.getType()===dt)&&u[g][0]&&0===u[g][0].index)continue;this.dragSegments_.push([c,1]),u[g][1]=c}else this.dragSegments_.push([c,0]),u[g][0]=c;else ai(fu(e,c,i),s)&&!u[g][0]&&(this.dragSegments_.push([c,0]),u[g][0]=c)}r.length&&this.willModifyFeatures_(t);for(var _=r.length-1;_>=0;--_)this.insertVertex_.apply(this,r[_])}return!!this.vertexFeature_}},{key:"handleUpEvent",value:function(t){for(var e=this.dragSegments_.length-1;e>=0;--e){var n=this.dragSegments_[e][0],i=n.geometry;if(i.getType()===_t){var r=i.getCenter(),s=n.featureSegments[0],o=n.featureSegments[1];s.segment[0]=r,s.segment[1]=r,o.segment[0]=r,o.segment[1]=r,this.rBush_.update(Mt(r),s);var a=i,u=Re();if(u){var l=t.map.getView().getProjection();a=Un(a=a.clone().transform(u,l)).transform(l,u)}this.rBush_.update(a.getExtent(),o)}else this.rBush_.update(It(n.segment),n)}return this.modified_&&(this.dispatchEvent(new lu(uu,this.features_,t)),this.modified_=!1),!1}},{key:"handlePointerMove_",value:function(t){this.lastPixel_=t.pixel,this.handlePointerAtPixel_(t.pixel,t.map,t.coordinate)}},{key:"handlePointerAtPixel_",value:function(t,e,n){var i=n||e.getCoordinateFromPixel(t),r=e.getView().getProjection(),s=Pe(St(Me(Mt(i,ou),r),e.getView().getResolution()*this.pixelTolerance_,ou),r),o=this.rBush_.getInExtent(s);if(o.length>0){o.sort(function(t,e){return cu(i,t,r)-cu(i,e,r)});var a=o[0],u=a.segment,l=fu(i,a,r),h=e.getPixelFromCoordinate(l),c=hi(t,h);if(c<=this.pixelTolerance_){var f={};if(a.geometry.getType()===_t&&1===a.index)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l);else{var g=e.getPixelFromCoordinate(u[0]),v=e.getPixelFromCoordinate(u[1]),_=li(h,g),y=li(h,v);c=Math.sqrt(Math.min(_,y)),this.snappedToVertex_=c<=this.pixelTolerance_,this.snappedToVertex_&&(l=_>y?u[1]:u[0]),this.createOrUpdateVertexFeature_(l);for(var p=1,m=o.length;p<m;++p){var k=o[p].segment;if(!(ai(u[0],k[0])&&ai(u[1],k[1])||ai(u[0],k[1])&&ai(u[1],k[0])))break;f[d(k)]=!0}}return f[d(u)]=!0,void(this.vertexSegments_=f)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}},{key:"insertVertex_",value:function(t,e){for(var n,i=t.segment,r=t.feature,s=t.geometry,o=t.depth,a=t.index;e.length<s.getStride();)e.push(0);switch(s.getType()){case dt:case ct:(n=s.getCoordinates())[o[0]].splice(a+1,0,e);break;case gt:(n=s.getCoordinates())[o[1]][o[0]].splice(a+1,0,e);break;case ht:(n=s.getCoordinates()).splice(a+1,0,e);break;default:return}this.setGeometryCoordinates_(s,n);var u=this.rBush_;u.remove(t),this.updateSegmentIndices_(s,a,o,1);var l={segment:[i[0],e],feature:r,geometry:s,depth:o,index:a};u.insert(It(l.segment),l),this.dragSegments_.push([l,1]);var h={segment:[e,i[1]],feature:r,geometry:s,depth:o,index:a+1};u.insert(It(h.segment),h),this.dragSegments_.push([h,0]),this.ignoreNextSingleClick_=!0}},{key:"removePoint",value:function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=vr.POINTERDRAG){var t=this.lastPointerEvent_;this.willModifyFeatures_(t);var e=this.removeVertex_();return this.dispatchEvent(new lu(uu,this.features_,t)),this.modified_=!1,e}return!1}},{key:"removeVertex_",value:function(){var t,e,n,i,r,s,o,a,u,l,h,c=this.dragSegments_,f={},g=!1;for(r=c.length-1;r>=0;--r)h=d((l=(n=c[r])[0]).feature),l.depth&&(h+="-"+l.depth.join("-")),h in f||(f[h]={}),0===n[1]?(f[h].right=l,f[h].index=l.index):1==n[1]&&(f[h].left=l,f[h].index=l.index+1);for(h in f){switch(u=f[h].right,o=f[h].left,(a=(s=f[h].index)-1)<0&&(a=0),t=e=(i=(l=void 0!==o?o:u).geometry).getCoordinates(),g=!1,i.getType()){case dt:e[l.depth[0]].length>2&&(e[l.depth[0]].splice(s,1),g=!0);break;case ht:e.length>2&&(e.splice(s,1),g=!0);break;case gt:t=t[l.depth[1]];case ct:(t=t[l.depth[0]]).length>4&&(s==t.length-1&&(s=0),t.splice(s,1),g=!0,0===s&&(t.pop(),t.push(t[0]),a=t.length-1))}if(g){this.setGeometryCoordinates_(i,e);var v=[];if(void 0!==o&&(this.rBush_.remove(o),v.push(o.segment[0])),void 0!==u&&(this.rBush_.remove(u),v.push(u.segment[1])),void 0!==o&&void 0!==u){var _={depth:l.depth,feature:l.feature,geometry:l.geometry,index:a,segment:v};this.rBush_.insert(It(_.segment),_)}this.updateSegmentIndices_(i,s,l.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),c.length=0}}return g}},{key:"setGeometryCoordinates_",value:function(t,e){this.changingFeature_=!0,t.setCoordinates(e),this.changingFeature_=!1}},{key:"updateSegmentIndices_",value:function(t,e,n,i){this.rBush_.forEachInExtent(t.getExtent(),function(r){r.geometry===t&&(void 0===n||void 0===r.depth||q(r.depth,n))&&r.index>e&&(r.index+=i)})}}]),n}(),vu=function(t){s(n,zo);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t,null,{filter:r?r.filter:null})).modifyInteraction=new gu({features:s.selectInteraction.getFeatures()}),s.addInteraction(s.modifyInteraction),r&&r.snapping&&s.addInteraction(new tu(r.snapping.layer||t)),s.modifyInteraction.on("modifystart",function(t){s.currentGeometryBeingModified=t.features.getArray()[0].getGeometry().clone()}),s.modifyInteraction.on("modifyend",function(t){t.features.forEach(function(t){i(t,function(t){t.setGeometry(s.currentGeometryBeingModified)})})}),s}return n}(),_u=function(t){s(n,H);var e=a(n);function n(t,i,r,s,o){var a;return f(this,n),(a=e.call(this,t)).features=i,a.coordinate=r,a.startCoordinate=s,a.mapBrowserEvent=o,a}return n}(),yu=function(t){s(n,Zs);var e=a(n);function n(t){var i;f(this,n);var r,s=t||{};if((i=e.call(this,s)).lastCoordinate_=null,i.startCoordinate_=null,i.features_=void 0!==s.features?s.features:null,s.layers)if("function"==typeof s.layers)r=s.layers;else{var o=s.layers;r=function(t){return G(o,t)}}else r=Y;return i.layerFilter_=r,i.filter_=s.filter?s.filter:Y,i.hitTolerance_=s.hitTolerance?s.hitTolerance:0,i.lastFeature_=null,i.addEventListener($(Ps),i.handleActiveChanged_),u(i)}return g(n,[{key:"handleDownEvent",value:function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new fr([this.lastFeature_]);return this.dispatchEvent(new _u("translatestart",e,t.coordinate,this.startCoordinate_,t)),!0}return!1}},{key:"handleUpEvent",value:function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new fr([this.lastFeature_]);return this.dispatchEvent(new _u("translateend",e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}},{key:"handleDragEvent",value:function(t){if(this.lastCoordinate_){var e=t.coordinate,n=e[0]-this.lastCoordinate_[0],i=e[1]-this.lastCoordinate_[1],r=this.features_||new fr([this.lastFeature_]);r.forEach(function(t){var e=t.getGeometry();e.translate(n,i),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new _u("translating",r,e,this.startCoordinate_,t))}}},{key:"handleMoveEvent",value:function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}},{key:"featuresAtPixel_",value:function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||G(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}},{key:"getHitTolerance",value:function(){return this.hitTolerance_}},{key:"setHitTolerance",value:function(t){this.hitTolerance_=t}},{key:"setMap",value:function(t){var e=this.getMap();i(c(n.prototype),"setMap",this).call(this,t),this.updateState_(e)}},{key:"handleActiveChanged_",value:function(){this.updateState_(null)}},{key:"updateState_",value:function(t){var e=this.getMap(),n=this.getActive();e&&n||!(e=e||t)||e.getViewport().classList.remove("ol-grab","ol-grabbing")}}]),n}(),pu=function(t){s(n,vu);var e=a(n);function n(t,i,r){var s;return f(this,n),(s=e.call(this,t,i,r)).translateInteraction=new yu({features:s.selectInteraction.getFeatures()}),s.addInteraction(s.translateInteraction),s.translateInteraction.on("translateend",function(t){t.features.forEach(function(t){i(t,function(t){t.getGeometry().setCoordinates(t.get("entity").geometry.coordinates)}),s.selectInteraction.getFeatures().clear()})}),s}return n}(),mu=function(t){s(n,zo);var e=a(n);function n(t,i,r){var s;f(this,n);var o=t.map(function(t){return t.layer}),a=function(t){var e=s._getLayer(t),n=s._getLayerStyle(e);return n&&"function"==typeof n?n(t):n},u=function(t){var e=s._getLayer(t),n=s._getLayerHoverStyle(e);return n&&"function"==typeof n?n(t):n},l=function(t,e){var n=!1;return s.layers.forEach(function(t){t==e&&(n=!0)}),r&&r.filter?n&&r.filter(t):n};return(s=e.call(this,o,i,{filter:l,style:a,hoverStyle:u})).layerConfiguraties=t,s.layers=o,s.style=a,s.hoverStyle=u,s.filter=l,s}return g(n,[{key:"_getLayer",value:function(t){return this.layers.find(function(e){return-1!==e.getSource().getFeatures().indexOf(t)})}},{key:"_getLayerStyle",value:function(t,e){var n=this.layerConfiguraties.find(function(e){return e.layer===t});return n?n[e||"style"]:null}},{key:"_getLayerHoverStyle",value:function(t){return this._getLayerStyle(t,"hoverStyle")||this._getLayerStyle(t)}},{key:"markFeatureWithId",value:function(t,e){var r=this;e?i(c(n.prototype),"markFeatureWithId",this).call(this,t,e):this.layers.forEach(function(e){i(c(n.prototype),"markFeatureWithId",r).call(r,t,e)})}}]),n}(),ku=function t(e,n,i,r){var s=this;f(this,t),this.layer=e,e.tooltips=[],this.showTooltip=function(t,s,o,a){a=a||{};var u=document.createElement("div");u.innerHTML="<span class='content'></span><div class='arrow'></div>",u.setAttribute("class","info-tooltip");var l=new Hi({offset:a.offset||[0,-10],positioning:"bottom-center",insertFirst:!1});l.setElement(u),t.addOverlay(l),e.tooltips.push(l);var h=function(t){u.childNodes[0].innerHTML=t,l.setPosition(o),l.setElement(u),u.parentNode.style.position="fixed"},c=0,f=setTimeout(function(){c=500,h("<span class='icon'></span> "+(i||"Info berekenen  ..."))},100);n(s,o).then(function(e){setTimeout(function(){clearTimeout(f),h(e),t.render(),r&&r(s,o)},c)})},this.clear=function(t){s.layer.tooltips.forEach(function(e){return t.removeOverlay(e)})}},xu=function(t){s(n,eu);var e=a(n);function n(t,i,r,s){var o;f(this,n);var a=new ku(t,i,r);return(o=e.call(this,t,"Point",function(t){o.tooltips.showTooltip(o.map,t,t.getGeometry().getCoordinates(),s)})).layer=t,o.tooltips=a,o}return g(n,[{key:"clear",value:function(){this.tooltips.clear(this.map),this.layer.getSource().clear()}},{key:"deactivate",value:function(){this.clear(),i(c(n.prototype),"deactivate",this).call(this)}}]),n}(),Eu=function(t){s(n,zo);var e=a(n);function n(t,i,r,s,o){var a;return f(this,n),(a=e.call(this,t,function(t,e){if(t){var n=t.getGeometry().getClosestPoint(e.mapBrowserEvent.coordinate);a.tooltips.showTooltip(a.map,t,n,o)}})).tooltips=new ku(t,i,r,s),a.layer=t,a}return g(n,[{key:"clear",value:function(){this.tooltips.clear(this.map)}},{key:"deactivate",value:function(){this.clear(),this.layer.setVisible(this.visible),i(c(n.prototype),"deactivate",this).call(this)}},{key:"activate",value:function(){this.visible=this.layer.getVisible(),this.layer.setVisible(!0),i(c(n.prototype),"activate",this).call(this)}}]),n}(),Cu=r(1),Iu=function(t){s(n,Vo);var e=a(n);function n(t,i,r){var s;f(this,n);var o=new Cu.io.OL3Parser;o.inject(bn,Rn,Fn,Yn,Pn,Tn,Wn);var a=[],u=new zo(t,function(t){t&&(s.selectAction.deactivate(),s.drawAction.activate())},r),l=new eu(t,"LineString",function(t){var e=s.selectAction.selectedFeature,n=o.read(e.getGeometry().getPolygons()[0]),r=o.read(t.getGeometry()),a=n.getExteriorRing().union(r),u=new Cu.operation.polygonize.Polygonizer;u.add(a);for(var l=[],h=u.getPolygons().iterator();h.hasNext();){var c=new Wn([]);c.appendPolygon(o.write(h.next())),l.push(new et({geometry:c}))}i&&i(e,l),s.selectAction.clearFeatures(),setTimeout(function(){s.drawAction.deactivate(),s.selectAction.activate()})},r);return(s=e.call(this,a)).interactions=a,s.selectAction=u,s.drawAction=l,s}return g(n,[{key:"activate",value:function(){this.map.addAction(this.selectAction),this.map.addAction(this.drawAction),this.selectAction.activate()}},{key:"deactivate",value:function(){this.selectAction.deactivate(),this.drawAction.deactivate()}}]),n}(),Su=function(t){s(n,Vo);var e=a(n);function n(t,i){var r;f(this,n);var s=new Bo({layers:[t],style:t.selectionStyle}),o={features:s.getFeatures(),layers:[t]},a=new yu(o);return(r=e.call(this,[s,a])).selectInteraction=s,r.translateInteraction=a,r.translateInteraction.on("translateend",function(t){t.features.forEach(function(t){i(t,function(t){t.getGeometry().setCoordinates(t.get("entity").geometry.coordinates)}),r.selectInteraction.getFeatures().clear()})}),r.translateOptions=o,r}return g(n,[{key:"deactivate",value:function(){this.selectInteraction.getFeatures().clear(),i(c(n.prototype),"deactivate",this).call(this)}}]),n}()}]);
},{}],"Focm":[function(require,module,exports) {
module.exports={CustomMap:require("../dist/vl-mapactions.js").CustomMap,MapWithActions:require("../dist/vl-mapactions.js").MapWithActions,SnapInteraction:require("../dist/vl-mapactions.js").SnapInteraction,BoxSelectAction:require("../dist/vl-mapactions.js").BoxSelectAction,DeleteAction:require("../dist/vl-mapactions.js").DeleteAction,DrawAction:require("../dist/vl-mapactions.js").DrawAction,DrawLijnstukAction:require("../dist/vl-mapactions.js").DrawLijnstukAction,DrawRectangleAction:require("../dist/vl-mapactions.js").DrawRectangleAction,HighlightAction:require("../dist/vl-mapactions.js").HighlightAction,MapAction:require("../dist/vl-mapactions.js").MapAction,MeasureAction:require("../dist/vl-mapactions.js").MeasureAction,ModifyAction:require("../dist/vl-mapactions.js").ModifyAction,ModifyAndTranslateAction:require("../dist/vl-mapactions.js").ModifyAndTranslateAction,SelectAction:require("../dist/vl-mapactions.js").SelectAction,SelectActions:require("../dist/vl-mapactions.js").SelectActions,ShowInfoAction:require("../dist/vl-mapactions.js").ShowInfoAction,ShowInfoSelectAction:require("../dist/vl-mapactions.js").ShowInfoSelectAction,SplitAction:require("../dist/vl-mapactions.js").SplitAction,Tooltips:require("../dist/vl-mapactions.js").Tooltips,TranslateAction:require("../dist/vl-mapactions.js").TranslateAction};
},{"../dist/vl-mapactions.js":"c3Uk"}]},{},["Focm"], null)
//# sourceMappingURL=/vl-mapactions.js.map