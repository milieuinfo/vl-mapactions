import{defaults}from"../node_modules/ol/src/ol/interaction";import Map from"../node_modules/ol/src/ol/Map";export class MapWithActions extends Map{static get CLICK_COUNT_TIMEOUT(){return 300}constructor(t){const i=!(t=t||{}).disableRotation,e=!t.disableMouseWheelZoom,o=defaults({altShiftDragRotate:i,pinchRotate:i,mouseWheelZoom:e});if(t&&t.interactions&&t.interactions.forEach((function(t){o.push(t)})),t.interactions=o,super(t),this.actions=[],t.actions.forEach(t=>{this.addAction(t)}),setTimeout(()=>{this.activateDefaultAction()}),!t.disableEscapeKey){const t=t=>{t&&t.keyCode&&27==t.keyCode&&this.activateDefaultAction()};document.body.removeEventListener("keydown",t),document.body.addEventListener("keydown",t)}}activateAction(t){if(this.currentAction){if(this.currentAction==t)return!1;this.currentAction.deactivate(),clearTimeout(this.timeout)}this.currentAction=t,this.timeout=setTimeout((function(){t.activate()}),MapWithActions.CLICK_COUNT_TIMEOUT)}addAction(t){this.actions.push(t),t.map=this,t.interactions.forEach(t=>{this.addInteraction(t)})}removeAction(t){this.currentAction==t&&this.activateDefaultAction(),t.interactions.forEach(t=>{this.removeInteraction(t)}),this.actions.splice(this.actions.indexOf(t),1)}activateDefaultAction(){this.actions.length>0&&this.actions[0]&&(this.currentAction==this.actions[0]&&(this.currentAction.deactivate(),this.currentAction=void 0),this.activateAction(this.actions[0]))}}
